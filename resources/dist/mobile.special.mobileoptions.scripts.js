(self.webpackChunkmfModules=self.webpackChunkmfModules||[]).push([[898],{"./node_modules/@wikimedia/mediawiki.skins.clientpreferences/clientPreferences.js":e=>{function t(e){return document.documentElement.classList.contains(e+"-clientpref--excluded")}function n(e,t,n,s){const i=n[e],c=i.callback||(()=>{}),o=mw.hook("skin-client-preference.change");mw.user.isNamed()?(n[e].options.forEach((t=>{document.documentElement.classList.remove(`${e}-clientpref-${t}`)})),document.documentElement.classList.add(`${e}-clientpref-${t}`),window.dispatchEvent(new Event("resize")),mw.util.debounce((()=>{(s=s||new mw.Api).saveOptions({[i.preferenceKey]:t}).then((()=>{c()}))}),100)()):(mw.user.clientPrefs.set(e,t),c()),o.fire(e,t)}const s=(e,t)=>`skin-client-pref-${e}-value-${t}`;function i(e,t,n){const i=document.createElement("input"),c=`skin-client-pref-${t}-group`,o=s(t,n);return i.name=c,i.id=o,i.type=e,"checkbox"===e?i.checked="1"===n:i.value=n,i.setAttribute("data-event-name",o),i}function c(e,t){const n=document.createElement("label");n.classList.add("cdx-label"),n.setAttribute("for",s(e,t));const i=document.createElement("span");return i.classList.add("cdx-label__label__text"),i.textContent=mw.msg(`${e}-${t}-label`),n.appendChild(i),n}const o=e=>mw.message(`${e}-name`);function a(e,s,a,l){const r=o(s),d=a[s];if(r.exists()||"qqx"===mw.config.get("wgUserLanguage")){const m=`skin-client-prefs-${s}`,p=mw.util.addPortlet(m,r.text());if(d.betaMessage){const e=function(e){const t=document.createElement("span"),n=document.createElement("span");return n.textContent=mw.message(e).text(),t.appendChild(n),t}(d.betaMessage);p.querySelector(".vector-menu-heading span")||(p.querySelector(".vector-menu-heading").textContent+=" ",p.querySelector(".vector-menu-heading").appendChild(e))}const u=p.querySelector("label"),f=mw.message(`${s}-description`);if(f.exists()){const e=document.createElement("span");e.classList.add("skin-client-pref-description"),e.innerHTML=f.parse(),u&&u.parentNode&&u.appendChild(e)}const g=mw.message(`${s}-exclusion-notice`);if(g.exists()){const e=p.querySelector(".vector-menu-content"),t=document.createElement("span");t.classList.add("skin-client-pref-exclusion-notice"),t.textContent=g.text(),e&&e.appendChild(t)}e.appendChild(p);const w=function(e,s,a){const l=s[e],r=t(e);if(!l)return null;const d=mw.user.clientPrefs.get(e);if("boolean"==typeof d&&!r)return null;const m=function(){const e=document.createElement("div");return e.setAttribute("class",""),e}(),p=document.createElement("form");switch(l.type||"radio"){case"radio":l.options.forEach((o=>{!function(e,s,o,a,l,r){const d=i("radio",s,o);d.classList.add("cdx-radio__input"),a===o&&(d.checked=!0),t(s)&&(d.disabled=!0);const m=document.createElement("span");m.classList.add("cdx-radio__icon");const p=c(s,o);p.classList.add("cdx-radio__label");const u=document.createElement("div");u.classList.add("cdx-radio"),u.appendChild(d),u.appendChild(m),u.appendChild(p),e.appendChild(u),d.addEventListener("change",(()=>{n(s,o,l,r)})),d.addEventListener("keydown",(e=>{e.key.startsWith("Arrow")&&e.repeat&&e.preventDefault()}))}(p,e,o,String(d),s,a)}));break;case"switch":{const t=document.createElement("label");t.textContent=o(e).text(),function(e,t,s,o,a,l){const r=i("checkbox",t,o);r.classList.add("cdx-toggle-switch__input");const d=document.createElement("span");d.classList.add("cdx-toggle-switch__switch");const m=document.createElement("span");m.classList.add("cdx-toggle-switch__switch__grip"),d.appendChild(m);const p=s||c(t,o);p.classList.add("cdx-toggle-switch__label");const u=document.createElement("span");u.classList.add("cdx-toggle-switch"),u.appendChild(r),u.appendChild(d),u.appendChild(p),r.addEventListener("change",(()=>{n(t,r.checked?"1":"0",a,l)})),e.appendChild(u)}(p,e,t,String(d),s,a);break}default:throw new Error("Unknown client preference! Only switch or radio are supported.")}if(m.appendChild(p),r){const t=function(e){const t=document.createElement("p"),n=mw.message(`${e}-exclusion-notice`);return t.classList.add("exclusion-notice",`${e}-exclusion-notice`),t.textContent=n.text(),t}(e);m.appendChild(t)}return m}(s,a,l);if(w){const e=mw.util.addPortletLink(m,"","");if(e){const t=e.querySelector("a");t&&t.replaceWith(w)}if(a[s].linkLabelUrl&&!t(s)){const e=document.createElement("span");e.id=`${s}-beta-notice`,mw.user.isAnon()||function(e,t){const n=t.linkLabelUrl,s=t.linkLabelMessage,i=t.linkLabelTooltip,c=t.linkLabelUrlParameter;if(!s||!n||!mw.msg(n))return;let o="";if(c){const e=`[https://${window.location.hostname+mw.util.getUrl(mw.config.get("wgPageName"))} ${mw.config.get("wgTitle")}]`;o=mw.message(c,e).text()}const a=mw.msg(n,window.location.host,o),l=mw.message(s).text(),r=document.createElement("a");r.setAttribute("href",a),r.setAttribute("target","_blank"),i&&r.setAttribute("title",mw.msg(i)),r.textContent=l;const d=function(e){e.stopPropagation();const t=document.createElement("span");t.classList.add("vector-icon","vector-icon--heart"),r.textContent=mw.msg("vector-night-mode-issue-reporting-link-notification"),r.classList.add("skin-theme-beta-notice-success"),r.prepend(t),r.removeEventListener("click",d)};t.linkLabelUrlParameter&&r.addEventListener("click",(e=>d(e))),e.appendChild(r)}(e,d),w.appendChild(e)}}}}function l(e,t,n){const s=document.querySelector(e);return s?new Promise((e=>{(function(e){const t=Array.from(document.documentElement.classList).filter((e=>e.match(/-clientpref-/))).map((e=>e.split("-clientpref-")[0]));return Object.keys(e).filter((e=>t.includes(e)))})(t).forEach((e=>{n=n||new mw.Api,a(s,e,t,n)})),mw.requestIdleCallback((()=>{e(s)}))})):Promise.reject()}e.exports={bind:function(e,t,n,s){let i=!1;const c=document.querySelector(e);c&&(s||(s=new mw.Api),c.checked?(l(t,n,s),i=!0):c.addEventListener("input",(()=>{i||(l(t,n,s),i=!0)})))},toggleDocClassAndSave:n,render:l}},"./src/mobile.special.mobileoptions.scripts.js":(e,t,n)=>{const s=n("./node_modules/@wikimedia/mediawiki.skins.clientpreferences/clientPreferences.js"),i=n("./src/mobile.startup/showOnPageReload.js"),c="mf-expand-sections",o="wp25eastereggs-enable",a=mw.msg,l="mf-font-size";function r(e){e?i.showOnPageReload(a("mobile-frontend-settings-save")):mw.notify(a("mobile-frontend-settings-save"))}let d;function m(e){return d=d||new mw.Api,d.saveOptions(e,{global:"update"})}function p(e,t){const n=document.createElement("div"),i="mf-client-preferences";return n.id=i,e.prepend(n),s.render(`#${i}`,t,{saveOptions:m})}window.QUnit||mw.loader.using("oojs-ui-widgets").then((function(){const e=$("#mobile-options"),t=$("#enable-amc-toggle");t.length&&function(e,t){const n=e.$el,s=OO.ui.infuse(n),i=s.$element,c=new OO.ui.ToggleSwitchWidget({value:s.isSelected()});c.$element.insertAfter(i),i.hide(),i.on("change",(()=>{i.attr("disabled",!0),c.setValue(s.isSelected())})),c.on("change",(n=>{e.onToggle(n),c.setValue=function(){},i.find("input").prop("checked",n),r(!0),setTimeout((()=>{t.trigger("submit")}),250)}))}({$el:t},e);const n={};mw.config.get("wgMFEnableFontChanger")&&(n[l]={options:["small","regular","large"],preferenceKey:l,callback:r});const s=mw.config.get("skin");function i(e){e.find(".skin-client-pref-description").appendTo(e.find(".cdx-toggle-switch__label")),e.find("> label").remove()}n["skin-theme"]={options:["day","night","os"],preferenceKey:`${s}-theme`},n[c]={options:["0","1"],type:"switch",preferenceKey:c,callback:r},"minerva"===s&&(n[o]={options:["0","1"],type:"switch",preferenceKey:o,callback:r}),mw.user.isAnon()||(n["mw-mf-amc"]={options:["0","1"],type:"switch",preferenceKey:"mf_amc_optin",callback:()=>location.reload()}),p(e,n).then((()=>{if($("#amc-field .option-links").appendTo("#skin-client-prefs-mw-mf-amc"),i($("#skin-client-prefs-mf-expand-sections")),i($("#skin-client-prefs-wp25eastereggs-enable")),i($("#skin-client-prefs-mw-mf-amc")),$("#amc-field").remove(),mw.config.get("wgReaderExperimentsStickyHeaders")&&"enrolled"===mw.config.get("wgReaderExperimentsStickyHeaders")){const e=$("#skin-client-prefs-mf-expand-sections input");e&&(e.prop("checked",!0),e.prop("disabled",!0))}}))})),e.exports={test:{addClientPreferencesToForm:p}}}},e=>{e.O(0,[569],(()=>e(e.s="./src/mobile.special.mobileoptions.scripts.js")));var t=e.O();(this.mfModules=this.mfModules||{})["mobile.special.mobileoptions.scripts"]=t}]);
//# sourceMappingURL=mobile.special.mobileoptions.scripts.js.map.json