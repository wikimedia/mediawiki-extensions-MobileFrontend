{"version":3,"sources":["webpack://mfModules.[name]/./src/mobile.amcOutreachDrawer/AmcEnableForm.js","webpack://mfModules.[name]/./src/mobile.amcOutreachDrawer/amcOutreachDrawer.js","webpack://mfModules.[name]/./src/mobile.amcOutreachDrawer/mobile.amcOutreachDrawer.js","webpack://mfModules.[name]/./src/mobile.startup/Anchor.js","webpack://mfModules.[name]/./src/mobile.startup/Button.js","webpack://mfModules.[name]/./src/mobile.startup/Drawer.js","webpack://mfModules.[name]/./src/mobile.startup/Icon.js","webpack://mfModules.[name]/./src/mobile.startup/View.js","webpack://mfModules.[name]/./src/mobile.startup/mfExtend.js","webpack://mfModules.[name]/./src/mobile.startup/moduleLoader.js","webpack://mfModules.[name]/./src/mobile.startup/moduleLoaderSingleton.js","webpack://mfModules.[name]/./src/mobile.startup/util.js"],"names":["Button","require","util","View","AmcEnableForm","this","$el","append","tagName","progressive","label","options","buttonLabel","template","module","exports","Drawer","Anchor","Icon","AMC_ENABLE_FIELD_NAME","AMC_ENABLE_FIELD_VALUE","action","promoCampaign","mwMessage","mwUtil","currentPage","toast","editToken","className","closeOnScroll","children","additionalClassNames","name","parseHTML","text","postUrl","getUrl","returnto","title","fields","value","events","submit","makeActionIneligible","showOnPageReload","href","onBeforeHide","show","m","amcOutreachDrawer","define","undefined","destructive","mfExtend","call","isTemplateMode","defaults","disabled","block","quiet","collapseIcon","props","extend","concat","trim","click .cancel","ev","preventDefault","hide","bind","click","stopPropagation","minHideDelay","d","Deferred","isVisible","resolve","setTimeout","addClass","parent","$window","getWindow","one","promise","removeClass","off","hasClass","toggle","appendToElement","postRender","prepend","docReady","appendTo","hasText","modifier","preRender","setRotationClass","rotation","_rotationClass","Error","glyphPrefix","isSmall","base","getClassName","attr","getGlyphClassName","toHtmlString","html","mw","log","deprecate","prototype","delegateEventSplitter","idCounter","initialize","apply","arguments","OO","mixinClass","EventEmitter","templatePartials","self","cid","prefix","id","toString","uniqueId","compile","el","$","length","_postInitialize","isBorderBox","render","data","undelegateEvents","skipTemplateRender","replaceWith","delegateEvents","match","key","method","delegate","eventName","selector","listener","on","undelegate","document","forEach","prop","make","view","$child","Child","ParentOrPrototype","inheritClass","initClass","ModuleLoader","_register","args","registry","localRequire","Object","hasOwnProperty","split","loader","e","obj","deprecatedId","replacement","msg","saveButtonMessage","config","get","Promise","all","promises","when","escapeSelector","grep","fn","getDocument","documentElement","window","ctx","isNumeric","escapeHash","hash","replace","isModifiedEvent","altKey","ctrlKey","metaKey","shiftKey","repeatEvent","src","proxy","event","emit","source","getSource","partials","partialSource","keys","Mustache"],"mappings":"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","file":"mobile.amcOutreachDrawer.js","sourcesContent":["const\n\tButton = require( '../mobile.startup/Button' ),\n\tutil = require( '../mobile.startup/util' ),\n\tView = require( '../mobile.startup/View' );\n\n/**\n * @typedef {Object} FormField\n * @property {string} name\n * @property {string} value\n */\n\n/**\n * @param {Object} options\n * @param {string} options.postUrl Form will POST to this endpoint\n * @param {FormField[]} options.fields An array of hidden form fields\n * @param {string} options.buttonLabel Label for submit button\n * submitted\n * @extends View\n */\nclass AmcEnableForm extends View {\n\t/** @inheritdoc */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\n\t/** @inheritdoc */\n\tget template() {\n\t\treturn util.template( `\n<form class=\"amc-enable-form\" action=\"{{postUrl}}\" method=\"POST\">\n\t{{#fields}}\n\t\t<input type=\"hidden\" name=\"{{name}}\" value=\"{{value}}\">\n\t{{/fields}}\n</form>\n\t\t` );\n\t}\n\n\t/** @inheritdoc */\n\tpostRender() {\n\t\tthis.$el.append(\n\t\t\tnew Button( {\n\t\t\t\ttagName: 'button',\n\t\t\t\tprogressive: true,\n\t\t\t\tlabel: this.options.buttonLabel\n\t\t\t} ).$el\n\t\t);\n\t}\n}\n\nmodule.exports = AmcEnableForm;\n","const\n\tDrawer = require( '../mobile.startup/Drawer' ),\n\tAnchor = require( '../mobile.startup/Anchor' ),\n\tIcon = require( '../mobile.startup/Icon' ),\n\tutil = require( '../mobile.startup/util' ),\n\tAmcEnableForm = require( './AmcEnableForm' ),\n\t// These constants should be kept in sync with SpecialMobileOptions.php\n\tAMC_ENABLE_FIELD_NAME = 'enableAMC',\n\tAMC_ENABLE_FIELD_VALUE = '1';\n\n/**\n * @param {string} action\n * @param {PromoCampaign} promoCampaign\n * @param {mw.message} mwMessage Used for i18n\n * @param {mw.util} mwUtil Used to determine POST url for the enable form\n * @param {Page} currentPage Used to determine what page to redirect to after form submission\n * @param {Toast} toast Displays success message after user submits enable form\n * @param {string} editToken Used as a CSRF token\n * @return {Drawer} Returns the drawer that is shown\n */\nfunction amcOutreachDrawer(\n\taction,\n\tpromoCampaign,\n\tmwMessage,\n\tmwUtil,\n\tcurrentPage,\n\ttoast,\n\teditToken\n) {\n\treturn new Drawer( {\n\t\tclassName: 'amc-outreach-drawer',\n\t\tcloseOnScroll: false,\n\t\tchildren: [\n\t\t\tnew Icon( {\n\t\t\t\tadditionalClassNames: 'mw-ui-icon-large',\n\t\t\t\ttagName: 'span',\n\t\t\t\tname: 'amc-outreach'\n\t\t\t} ).$el,\n\t\t\tutil.parseHTML( '<p>' ).append(\n\t\t\t\tutil.parseHTML( '<strong>' ).text(\n\t\t\t\t\tmwMessage( 'mobile-frontend-amc-outreach-intro' ).text()\n\t\t\t\t)\n\t\t\t),\n\t\t\tutil.parseHTML( '<p>' ).text(\n\t\t\t\tmwMessage( 'mobile-frontend-amc-outreach-description' ).text()\n\t\t\t),\n\t\t\tnew AmcEnableForm( {\n\t\t\t\tpostUrl: mwUtil.getUrl( 'Special:MobileOptions', {\n\t\t\t\t\treturnto: currentPage.title\n\t\t\t\t} ),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'updateSingleOption',\n\t\t\t\t\t\tvalue: AMC_ENABLE_FIELD_NAME\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'enableAMC',\n\t\t\t\t\t\tvalue: AMC_ENABLE_FIELD_VALUE\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'token',\n\t\t\t\t\t\tvalue: editToken\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tbuttonLabel: mwMessage( 'mobile-frontend-amc-outreach-enable' ).text(),\n\t\t\t\tevents: {\n\t\t\t\t\tsubmit: () => {\n\t\t\t\t\t\tpromoCampaign.makeActionIneligible( action );\n\t\t\t\t\t\ttoast.showOnPageReload( mwMessage( 'mobile-frontend-amc-outreach-enabled-message' ).text() );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ).$el,\n\t\t\tnew Anchor( {\n\t\t\t\thref: '#',\n\t\t\t\tadditionalClassNames: 'cancel',\n\t\t\t\tprogressive: true,\n\t\t\t\tlabel: mwMessage( 'mobile-frontend-amc-outreach-no-thanks' ).text()\n\t\t\t} ).$el\n\t\t],\n\t\tonBeforeHide: () => {\n\t\t\tpromoCampaign.makeActionIneligible( action );\n\t\t\ttoast.show( mwMessage( 'mobile-frontend-amc-outreach-dismissed-message' ).text() );\n\t\t}\n\t} );\n}\n\nmodule.exports = amcOutreachDrawer;\n","const\n\tm = require( '../mobile.startup/moduleLoaderSingleton' ),\n\tamcOutreachDrawer = require( './amcOutreachDrawer' );\n\n// Needed for lazy loading\nm.define( 'mobile.amcOutreachDrawer', {\n\tamcOutreachDrawer: amcOutreachDrawer\n} );\n","var\n\tView = require( './View' ),\n\tutil = require( './util' );\n\n/**\n * A wrapper for creating an anchor.\n * @extends View\n */\nclass Anchor extends View {\n\t/**\n\t * @inheritdoc\n\t */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\t/**\n\t * @memberof Anchor\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {boolean} defaults.progressive is progressive action\n\t * @property {boolean} defaults.destructive is destructive action\n\t * @property {string} defaults.additionalClassNames Additional class name(s).\n\t * @property {string} defaults.href url\n\t * @property {string} defaults.label of anchor\n\t */\n\tget defaults() {\n\t\treturn {\n\t\t\tprogressive: undefined,\n\t\t\tdestructive: undefined,\n\t\t\tadditionalClassNames: '',\n\t\t\thref: undefined,\n\t\t\tlabel: undefined\n\t\t};\n\t}\n\t/**\n\t * @inheritdoc\n\t */\n\tget template() {\n\t\treturn util.template( `\n<a {{#href}}href=\"{{href}}\"{{/href}} class=\"mw-ui-anchor\n\t{{#progressive}} mw-ui-progressive{{/progressive}}\n\t{{#destructive}} mw-ui-destructive{{/destructive}}\n\t {{additionalClassNames}}\">{{label}}</a>\n\t` );\n\t}\n}\n\nmodule.exports = Anchor;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * A wrapper for creating a button.\n * @class Button\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Button( options ) {\n\tif ( options.href ) {\n\t\toptions.tagName = 'a';\n\t}\n\tView.call( this, options );\n}\n\nmfExtend( Button, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Button\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Button\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.tagName The name of the tag in which the button is wrapped.\n\t * @property {boolean} defaults.block is stacked button\n\t * @property {boolean} defaults.progressive is progressive action\n\t * @property {boolean} defaults.quiet is quiet button\n\t * @property {boolean} defaults.destructive is destructive action\n\t * @property {string} defaults.additionalClassNames Additional class name(s).\n\t * @property {string} defaults.href url\n\t * @property {string} defaults.label of button\n\t * @property {boolean} defaults.disabled should only be used with tagName button\n\t */\n\tdefaults: {\n\t\ttagName: 'a',\n\t\tdisabled: false,\n\t\tblock: undefined,\n\t\tprogressive: undefined,\n\t\tdestructive: undefined,\n\t\tquiet: undefined,\n\t\tadditionalClassNames: '',\n\t\thref: undefined,\n\t\tlabel: undefined\n\t},\n\t/**\n\t * @memberof Button\n\t * @instance\n\t */\n\ttemplate: util.template( `<{{tagName}} {{#disabled}}disabled{{/disabled}}\n{{#href}}href=\"{{href}}\"{{/href}}\nclass=\"mw-ui-button {{#progressive}}mw-ui-progressive{{/progressive}}\n\t{{#block}}mw-ui-block{{/block}}\n\t{{#quiet}}mw-ui-quiet{{/quiet}}\n\t{{#destructive}}mw-ui-destructive{{/destructive}} {{additionalClassNames}}\n\">{{label}}</{{tagName}}>` )\n} );\n\nmodule.exports = Button;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' ),\n\tutil = require( './util' ),\n\tIcon = require( './Icon' ),\n\tcollapseIcon = new Icon( {\n\t\tname: 'arrow',\n\t\tadditionalClassNames: 'cancel'\n\t} );\n\n/**\n * A {@link View} that pops up from the bottom of the screen.\n * @class Drawer\n * @extends View\n * @final\n * @param {Object} [props]\n * @param {string} [props.className] Additional CSS classes to add\n * @param {JQuery.Element[]} [props.children] An array of elements to append to\n * @param {Function} [props.onBeforeHide] Callback called before hiding the drawer\n * @param {boolean} [props.closeOnScroll] Whether the drawer should disappear on a scroll event\n * the drawer.\n */\nfunction Drawer( props ) {\n\tView.call( this,\n\t\tutil.extend(\n\t\t\t{\n\t\t\t\tcloseOnScroll: true,\n\t\t\t\tonBeforeHide: () => {}\n\t\t\t},\n\t\t\tprops,\n\t\t\t{ className: `drawer position-fixed ${props && props.className || ''}`.trim() },\n\t\t\t{ events: util.extend( {\n\t\t\t\t'click .cancel': function ( ev ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\tthis.hide();\n\t\t\t\t}.bind( this ),\n\t\t\t\tclick: function ( ev ) {\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t}\n\t\t\t}, ( props || {} ).events ) }\n\t\t)\n\t);\n}\n\nmfExtend( Drawer, View, {\n\t// in milliseconds\n\tminHideDelay: 10,\n\n\t/**\n\t * Shows panel after a slight delay\n\t * @memberof View\n\t * @instance\n\t * @method\n\t * @return {JQuery.Promise}\n\t */\n\tshow: function () {\n\t\tconst d = util.Deferred();\n\t\tif ( !this.isVisible() ) {\n\t\t\t// use setTimeout to allow the browser to redraw if render() was called\n\t\t\t// just before show(); this is important for animations to work\n\t\t\t// (0ms doesn't work on Firefox, 10ms is enough)\n\t\t\t//\n\t\t\t// FIXME: setTimeout should be reconsidered in T209129\n\t\t\tsetTimeout( function () {\n\t\t\t\tthis.$el.addClass( 'visible animated' );\n\t\t\t\tconst closeOnScroll = this.options.closeOnScroll;\n\t\t\t\tthis.$el.parent().addClass( `drawer-visible${closeOnScroll ? '' : ' has-drawer--with-scroll-locked'}` );\n\n\t\t\t\tsetTimeout( function () {\n\t\t\t\t\tvar $window = util.getWindow();\n\t\t\t\t\t$window.one( 'click.drawer', this.hide.bind( this ) );\n\t\t\t\t\tif ( closeOnScroll ) {\n\t\t\t\t\t\t$window.one( 'scroll.drawer', this.hide.bind( this ) );\n\t\t\t\t\t}\n\t\t\t\t\td.resolve();\n\t\t\t\t}.bind( this ), this.minHideDelay );\n\t\t\t}.bind( this ), this.minHideDelay );\n\t\t} else {\n\t\t\td.resolve();\n\t\t}\n\t\treturn d.promise();\n\t},\n\n\t/**\n\t * Hides panel\n\t * @memberof View\n\t * @instance\n\t */\n\thide: function () {\n\t\t// see comment in show()\n\t\tsetTimeout( function () {\n\t\t\tthis.$el.removeClass( 'visible' );\n\t\t\tthis.options.onBeforeHide();\n\t\t\tthis.$el.parent().removeClass( 'drawer-visible has-drawer--with-scroll-locked' );\n\t\t\t// .one() registers one callback for scroll and click independently\n\t\t\t// if one fired, get rid of the other one\n\t\t\tutil.getWindow().off( '.drawer' );\n\t\t}.bind( this ), this.minHideDelay );\n\t},\n\n\t/**\n\t * Determines if panel is visible\n\t * @memberof View\n\t * @instance\n\t * @return {boolean} View is visible\n\t */\n\tisVisible: function () {\n\t\treturn this.$el.hasClass( 'visible' );\n\t},\n\n\t/**\n\t * Shows or hides panel\n\t * @memberof View\n\t * @instance\n\t */\n\ttoggle: function () {\n\t\tif ( this.isVisible() ) {\n\t\t\tthis.hide();\n\t\t} else {\n\t\t\tthis.show();\n\t\t}\n\t},\n\n\t/**\n\t * Defines an element that the Drawer should automatically be appended to.\n\t * @memberof Drawer\n\t * @instance\n\t * @property {string}\n\t */\n\tappendToElement: 'body',\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Drawer\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\t// append the collapse icon at the top of the drawer\n\t\tthis.$el.prepend( collapseIcon.$el );\n\n\t\tif ( this.options.children ) {\n\t\t\t// append children\n\t\t\tthis.$el.append( this.options.children );\n\t\t}\n\n\t\t// This module might be loaded at the top of the page e.g. Special:Uploads\n\t\t// Thus ensure we wait for the DOM to be loaded\n\t\tutil.docReady( function () {\n\t\t\tthis.appendTo( this.appendToElement );\n\t\t\tthis.$el.parent().addClass( 'has-drawer' );\n\t\t}.bind( this ) );\n\t}\n} );\n\nmodule.exports = Drawer;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * A wrapper for creating an icon.\n * @class Icon\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Icon( options ) {\n\tif ( options.hasText ) {\n\t\toptions.modifier = `mw-ui-icon-before ${options.modifier || ''}`;\n\t}\n\tif ( options.href ) {\n\t\toptions.tagName = 'a';\n\t}\n\tView.call( this, options );\n}\n\nmfExtend( Icon, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Icon\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tthis.setRotationClass();\n\t},\n\t/**\n\t * Internal method that sets the correct rotation class for the icon\n\t * based on the value of rotation\n\t * @memberof Icon\n\t * @instance\n\t * @private\n\t */\n\tsetRotationClass: function () {\n\t\tvar options = this.options;\n\t\tif ( options.rotation ) {\n\t\t\tswitch ( options.rotation ) {\n\t\t\t\tcase -180:\n\t\t\t\tcase 180:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-flip';\n\t\t\t\t\tbreak;\n\t\t\t\tcase -90:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-anti-clockwise';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 90:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-clockwise';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Bad value for rotation given. Must be ±90, 0 or ±180.' );\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Icon\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Icon\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {boolean} defaults.hasText Whether the icon has text.\n\t * @property {boolean} defaults.isSmall Whether the icon should be small.\n\t * @property {string} [defaults.href] value of href attribute,\n\t *  when set tagName will default to anchor tag\n\t * @property {string} defaults.tagName The name of the tag in which the icon is wrapped.\n\t *  Defaults to 'a' when href option present.\n\t * @property {string} defaults.base String used as a base for generating class names.\n\t * Defaults to 'mw-ui-icon'.\n\t * @property {string} defaults.name Name of the icon.\n\t * @property {string} defaults.modifier Additional class name.\n\t * Defaults to 'mw-ui-icon-element'.\n\t * @property {string} defaults.title Tooltip text.\n\t * @property {boolean} defaults.rotation will rotate the icon by a certain number\n\t *  of degrees.\n\t *  Must be ±90, 0 or ±180 or will throw exception.\n\t */\n\tdefaults: {\n\t\trotation: 0,\n\t\thasText: false,\n\t\thref: undefined,\n\t\tglyphPrefix: 'mf',\n\t\ttagName: 'div',\n\t\tisSmall: false,\n\t\tbase: 'mw-ui-icon',\n\t\tname: '',\n\t\tmodifier: 'mw-ui-icon-element',\n\t\ttitle: ''\n\t},\n\t/**\n\t * Return the full class name that is required for the icon to render\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\tgetClassName: function () {\n\t\treturn this.$el.attr( 'class' );\n\t},\n\t/**\n\t * Return the class that relates to the icon glyph\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\tgetGlyphClassName: function () {\n\t\treturn this.options.base + '-' + this.options.glyphPrefix + '-' + this.options.name;\n\t},\n\t/**\n\t * Return the HTML representation of this view. Deprecated for reasons given in T149909.\n\t * @memberof Icon\n\t * @instance\n\t * @deprecated\n\t * @return {string}\n\t */\n\ttoHtmlString: function () {\n\t\treturn this.parseHTML( '<div>' ).append( this.$el ).html();\n\t},\n\ttemplate: util.template( `\n<{{tagName}} class=\"{{base}} {{base}}-{{glyphPrefix}}-{{name}} {{modifier}} {{#isSmall}}mw-ui-icon-small{{/isSmall}} {{#_rotationClass}}{{_rotationClass}}{{/_rotationClass}} {{additionalClassNames}}\"\n{{#id}}id=\"{{id}}\"{{/id}}\n{{#href}}href=\"{{href}}\"{{/href}}\n{{#title}}title=\"{{title}}\"{{/title}}>{{label}}</{{tagName}}>\n\t` )\n} );\n\nmw.log.deprecate( Icon.prototype, 'toHtmlString', Icon.prototype.toHtmlString );\nmodule.exports = Icon;\n","/* global $, document */\nvar util = require( './util' ),\n\tmfExtend = require( './mfExtend' ),\n\t// Cached regex to split keys for `delegate`.\n\tdelegateEventSplitter = /^(\\S+)\\s*(.*)$/,\n\tidCounter = 0;\n\n/**\n * Generate a unique integer id (unique within the entire client session).\n * Useful for temporary DOM ids.\n * @param {string} prefix Prefix to be used when generating the id.\n * @return {string}\n */\nfunction uniqueId( prefix ) {\n\tvar id = ( ++idCounter ).toString();\n\treturn prefix ? prefix + id : id;\n}\n\n/**\n * Should be extended using extend().\n *\n * When options contains el property, this.$el in the constructed object\n * will be set to the corresponding jQuery object. Otherwise, this.$el\n * will be an empty div.\n *\n * When extended using extend(), if the extended prototype contains\n * template property, this.$el will be filled with rendered template (with\n * options parameter used as template data).\n *\n * template property can be a string which will be passed to mw.template.compile()\n * or an object that has a render() function which accepts an object with\n * template data as its argument (similarly to an object created by\n * mw.template.compile()).\n *\n * You can also define a defaults property which should be an object\n * containing default values for the template (if they're not present in\n * the options parameter).\n *\n * If this.$el is not a jQuery object bound to existing DOM element, the\n * view can be attached to an element using appendTo(), prependTo(),\n * insertBefore(), insertAfter() proxy functions.\n *\n * append(), prepend(), before(), after() can be used to modify $el. on()\n * can be used to bind events.\n *\n * You can also use declarative DOM events binding by specifying an `events`\n * map on the class. The keys will be 'event selector' and the value can be\n * either the name of a method to call, or a function. All methods and\n * functions will be executed on the context of the View.\n *\n * Inspired from Backbone.js\n * https://github.com/jashkenas/backbone/blob/master/backbone.js#L1128\n *\n * Example:\n * ```js\n *     var\n *       MyComponent = View.extend( {\n *         edit: function ( ev ) {\n *           //...\n *         },\n *         save: function ( ev ) {\n *           //...\n *         }\n *       } ),\n *       instance = new MyComponent({\n *         events: {\n *           'mousedown .title': 'edit',\n *           'click .button': 'save',\n *           'click .open': function(e) { ... }\n *         }\n *       });\n * ```\n *\n * Example:\n * ```js\n *     var View, section;\n *     function Section( options ) {\n *       var defaultOptions = {\n *         events: {\n *           // ...\n *         }\n *       }\n *       View.call( this, util.extends( {}, defaultOptions, options ) );\n *     }\n *     View = require( './View' );\n *     require( './mfExtend' )( Section, View, {\n *       template: mw.template.compile( \"&lt;h2&gt;{{title}}&lt;/h2&gt;\" ),\n *     } );\n *     section = new Section( { title: 'Test', text: 'Test section body' } );\n *     section.appendTo( 'body' );\n * ```\n *\n * @class View\n * @mixins OO.EventEmitter\n */\n\nfunction View() {\n\tthis.initialize.apply( this, arguments );\n}\nOO.mixinClass( View, OO.EventEmitter );\nmfExtend( View, {\n\t/**\n\t * Name of tag that contains the rendered template\n\t * @memberof View\n\t * @instance\n\t * @property {string} tagName\n\t */\n\ttagName: 'div',\n\t/**\n\t * Tells the View to ignore tagName and className when constructing the element\n\t * and to rely solely on the template\n\t * @memberof View\n\t * @instance\n\t * @property {boolean} isTemplateMode\n\t */\n\tisTemplateMode: false,\n\t/**\n\t * @memberof View\n\t * @instance\n\t * @property {Mixed}\n\t * Specifies the template used in render(). Object|string|HoganTemplate\n\t */\n\ttemplate: undefined,\n\n\t/**\n\t * Specifies partials (sub-templates) for the main template. Example:\n\t *\n\t *     @example\n\t *     // example content for the \"some\" template (sub-template will be\n\t *     // inserted where {{>content}} is):\n\t *     // <h1>Heading</h1>\n\t *     // {{>content}}\n\t *\n\t *     oo.mfExtend( SomeView, View, {\n\t *       template: util.template( '<source-code>' ),\n\t *       templatePartials: { content: util.template( '<source-code>' ) }\n\t *     }\n\t *\n\t * @memberof View\n\t * @instance\n\t * @property {Object}\n\t */\n\ttemplatePartials: {},\n\n\t/**\n\t * A set of default options that are merged with options passed into the initialize\n\t * function.\n\t * @memberof View\n\t * @instance\n\t * @property {Object} defaults Default options hash.\n\t * @property {jQuery.Object|string} [defaults.el] jQuery selector to use for rendering.\n\t * @property {boolean} [defaults.skipTemplateRender] Whether to enhance views already in\n\t * DOM. When enabled, the template is disabled so that it is not rendered in the DOM.\n\t * Use in conjunction with View::defaults.$el to associate the View with an existing\n\t * already rendered element in the DOM.\n\t */\n\tdefaults: {},\n\n\t/**\n\t * Run once during construction to set up the View\n\t * @memberof View\n\t * @instance\n\t * @param {Object} options Object passed to the constructor.\n\t * @param {Object.<string, string>} [options.events]\n\t */\n\tinitialize: function ( options ) {\n\t\tvar self = this;\n\n\t\tOO.EventEmitter.call( this );\n\t\toptions = util.extend( {}, this.defaults, options );\n\t\tthis.options = options;\n\t\t// Assign a unique id for dom events binding/unbinding\n\t\tthis.cid = uniqueId( 'view' );\n\n\t\t// TODO: if template compilation is too slow, don't compile them on a\n\t\t// per object basis, but don't worry about it now (maybe add cache to\n\t\t// M.template.compile())\n\t\tif ( typeof this.template === 'string' ) {\n\t\t\tthis.template = mw.template.compile( this.template );\n\t\t}\n\n\t\tif ( options.el ) {\n\t\t\t// Note the element may not be in the document so must use global jQuery here\n\t\t\tthis.$el = $( options.el );\n\t\t} else {\n\t\t\tthis.$el = this.parseHTML( '<' + this.tagName + '>' );\n\t\t}\n\n\t\t// Make sure the element is ready to be manipulated\n\t\tif ( this.$el.length ) {\n\t\t\tthis._postInitialize( options );\n\t\t} else {\n\t\t\tutil.docReady( function () {\n\t\t\t\t// Note the element may not be in the document so must use global jQuery here\n\t\t\t\tself.$el = $( options.el );\n\t\t\t\tself._postInitialize( options );\n\t\t\t} );\n\t\t}\n\t},\n\n\t/**\n\t * Called when this.$el is ready.\n\t * @memberof View\n\t * @instance\n\t * @private\n\t * @param {Object} props\n\t */\n\t_postInitialize: function ( props ) {\n\t\tvar\n\t\t\tBORDER_BOX_CLASS = 'view-border-box',\n\t\t\tclassName = props.className;\n\n\t\tthis.$el.addClass( className );\n\t\t// border-box will be added provided this flag is not set\n\t\tif ( props.isBorderBox !== false ) {\n\t\t\tthis.$el.addClass( BORDER_BOX_CLASS );\n\t\t}\n\n\t\tthis.render( {} );\n\t},\n\n\t/**\n\t * Function called before the view is rendered. Can be redefined in\n\t * objects that extend View.\n\t * @memberof View\n\t * @instance\n\t */\n\tpreRender: function () {},\n\n\t/**\n\t * Function called after the view is rendered. Can be redefined in\n\t * objects that extend View.\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\tpostRender: function () {},\n\n\t// eslint-disable-next-line valid-jsdoc\n\t/**\n\t * Fill this.$el with template rendered using data if template is set.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} data Template data. Will be merged into the view's\n\t * options\n\t * @chainable\n\t */\n\trender: function ( data ) {\n\t\tvar $el, html;\n\t\tutil.extend( this.options, data );\n\t\tthis.preRender();\n\t\tthis.undelegateEvents();\n\t\tif ( this.template && !this.options.skipTemplateRender ) {\n\t\t\thtml = this.template.render( this.options, this.templatePartials );\n\t\t\tif ( this.isTemplateMode ) {\n\t\t\t\t$el = $( html );\n\t\t\t\tthis.$el.replaceWith( $el );\n\t\t\t\tthis.$el = $el;\n\t\t\t} else {\n\t\t\t\tthis.$el.html( html );\n\t\t\t}\n\t\t}\n\t\tthis.postRender();\n\t\tthis.delegateEvents();\n\t\treturn this;\n\t},\n\n\t/**\n\t * Set callbacks, where `this.options.events` is a hash of\n\t *\n\t * { 'event selector': 'callback' }\n\t *\n\t * {\n\t *   'mousedown .title': 'edit',\n\t *   'click .button': 'save',\n\t *   'click .open': function(e) { ... }\n\t * }\n\t *\n\t * pairs. Callbacks will be bound to the view, with `this` set properly.\n\t * Uses event delegation for efficiency.\n\t * Omitting the selector binds the event to `this.el`.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} events Optionally set this events instead of the ones on this.\n\t */\n\tdelegateEvents: function ( events ) {\n\t\tvar match, key, method;\n\t\tevents = events || this.options.events;\n\t\tif ( events ) {\n\t\t\t// Remove current events before re-binding them\n\t\t\tthis.undelegateEvents();\n\t\t\tfor ( key in events ) {\n\t\t\t\tmethod = events[ key ];\n\t\t\t\t// If the method is a string name of this.method, get it\n\t\t\t\tif ( typeof method !== 'function' ) {\n\t\t\t\t\tmethod = this[ events[ key ] ];\n\t\t\t\t}\n\t\t\t\tif ( method ) {\n\t\t\t\t\t// Extract event and selector from the key\n\t\t\t\t\tmatch = key.match( delegateEventSplitter );\n\t\t\t\t\tthis.delegate( match[ 1 ], match[ 2 ], method.bind( this ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Add a single event listener to the view's element (or a child element\n\t * using `selector`). This only works for delegate-able events: not `focus`,\n\t * `blur`, and not `change`, `submit`, and `reset` in Internet Explorer.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} eventName\n\t * @param {string} selector\n\t * @param {Function} listener\n\t */\n\tdelegate: function ( eventName, selector, listener ) {\n\t\tthis.$el.on( eventName + '.delegateEvents' + this.cid, selector,\n\t\t\tlistener );\n\t},\n\n\t/**\n\t * Clears all callbacks previously bound to the view by `delegateEvents`.\n\t * You usually don't need to use this, but may wish to if you have multiple\n\t * views attached to the same DOM element.\n\t * @memberof View\n\t * @instance\n\t */\n\tundelegateEvents: function () {\n\t\tif ( this.$el ) {\n\t\t\tthis.$el.off( '.delegateEvents' + this.cid );\n\t\t}\n\t},\n\n\t/**\n\t * A finer-grained `undelegateEvents` for removing a single delegated event.\n\t * `selector` and `listener` are both optional.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} eventName\n\t * @param {string} selector\n\t * @param {Function} listener\n\t */\n\tundelegate: function ( eventName, selector, listener ) {\n\t\tthis.$el.off( eventName + '.delegateEvents' + this.cid, selector,\n\t\t\tlistener );\n\t},\n\n\t/**\n\t * See parseHTML method of util singleton\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} html to turn into a jQuery object.\n\t * @return {jQuery.Object}\n\t */\n\tparseHTML: function ( html ) {\n\t\t// document is explicitly passed due to a bug we found in Safari 11.1.2 where failure\n\t\t// to use document resulted in an element without access to the documentElement\n\t\t// this should be redundant, but no problem in being explicit (T214451).\n\t\treturn util.parseHTML( html, document );\n\t}\n} );\n\n/**\n * @memberof View\n * @instance\n * @func append\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func append\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prepend\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prepend\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func appendTo\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prependTo\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func after\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func after\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func before\n * @param {...(string|Node|Node[]|JQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func before\n * @param {function(number, string): string|Node|Node[]|JQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @property {jQuery.Object} $el\n */\n\n/**\n * @memberof View\n * @instance\n * @func insertAfter\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func insertBefore\n * @param {string|Node|Node[]|JQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func remove\n * @param {string} [selector]\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func detach\n * @param {string} [selector]\n * @return {this}\n */\n\n[\n\t'append',\n\t'prepend',\n\t'appendTo',\n\t'prependTo',\n\t'after',\n\t'before',\n\t'insertAfter',\n\t'insertBefore',\n\t'remove',\n\t'detach'\n].forEach( function ( prop ) {\n\tView.prototype[prop] = function () {\n\t\tthis.$el[prop].apply( this.$el, arguments );\n\t\treturn this;\n\t};\n} );\n\n/**\n * Generates a view with children\n *\n * @param {Object} options\n * @param {jQuery.Element[]} children\n * @return {View}\n */\nView.make = function ( options = {}, children = [] ) {\n\tvar view = new View( options );\n\tchildren.forEach( function ( $child ) {\n\t\tview.append( $child );\n\t} );\n\treturn view;\n};\n\nmodule.exports = View;\n","/**\n * Extends a class with new methods and member properties.\n *\n * @param {Function} Child function\n * @param {Object|Function} ParentOrPrototype class to inherit from\n *  OR if no inheriting class a prototype to extend the class with\n * @param {Object} [prototype]\n */\nfunction mfExtend( Child, ParentOrPrototype, prototype ) {\n\tvar key;\n\tif ( prototype ) {\n\t\tOO.inheritClass( Child, ParentOrPrototype );\n\t} else {\n\t\tOO.initClass( Child );\n\t\tprototype = ParentOrPrototype;\n\t}\n\tfor ( key in prototype ) {\n\t\tChild.prototype[key] = prototype[key];\n\t}\n}\n\nmodule.exports = mfExtend;\n","/**\n * Class for managing modules\n *\n * A module in this context is essentially a Javascript class (not to be confused with\n * ResourceLoader modules).\n *\n * @class ModuleLoader\n */\nfunction ModuleLoader() {\n\t/**\n\t * @property {Object} register of defined modules\n\t * @private\n\t */\n\tthis._register = {};\n}\n\nModuleLoader.prototype = {\n\t/**\n\t * Require (import) a module previously defined using define().\n\t * Searches core module registry using mw.loader.require before consulting\n\t * its own local registry. This method is deprecated, please do not use.\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Required module id.\n\t * @return {Object} Required module, can be any JavaScript object.\n\t */\n\trequire: function ( id ) {\n\t\tvar module, args,\n\t\t\tregistry = this._register;\n\n\t\t/**\n\t\t * @return {Object} Module\n\t\t */\n\t\tfunction localRequire() {\n\t\t\tif ( !Object.hasOwnProperty.call( registry, id ) ) {\n\t\t\t\tthrow new Error( 'MobileFrontend Module not found: ' + id );\n\t\t\t}\n\t\t\treturn registry[ id ];\n\t\t}\n\t\targs = id.split( '/' );\n\t\ttry {\n\t\t\tmodule = mw.loader.require( args[0] );\n\t\t\tif ( module[ args[1] ] ) {\n\t\t\t\treturn module[ args[1] ];\n\t\t\t} else {\n\t\t\t\treturn localRequire();\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\treturn localRequire();\n\t\t}\n\t},\n\n\t/**\n\t * Define a module which can be later required (imported) using require().\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Defined module id.\n\t * @param {Object} obj Defined module body, can be any JavaScript object.\n\t * @return {Object}\n\t */\n\tdefine: function ( id, obj ) {\n\t\tvar self = this;\n\n\t\tif ( Object.hasOwnProperty.call( this._register, id ) ) {\n\t\t\tthrow new Error( 'Module already exists: ' + id );\n\t\t}\n\t\tthis._register[ id ] = obj;\n\t\t// return an object of additionally functions to do with the registered module\n\t\treturn {\n\t\t\t/**\n\t\t\t * @see ModuleLoader#deprecate\n\t\t\t * @param {string} deprecatedId Defined module id, which is deprecated.\n\t\t\t * @ignore\n\t\t\t */\n\t\t\tdeprecate: function ( deprecatedId ) {\n\t\t\t\tself.deprecate( deprecatedId, obj, id );\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t * Deprecate a module and give an replacement (if there is any).\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Defined module id, which is deprecated.\n\t * @param {Object} obj Defined module body, can be any JavaScript object.\n\t * @param {string} [replacement] Give an optional replacement for this module (which\n\t * needs to be already defined!)\n\t */\n\tdeprecate: function ( id, obj, replacement ) {\n\t\tvar msg;\n\t\tif ( replacement ) {\n\t\t\t// add an alternative for this module, if any given\n\t\t\tmsg = 'Use ' + replacement + ' instead.';\n\t\t}\n\t\t// register it as a deprecated one\n\t\tmw.log.deprecate( this._register, id, obj, msg );\n\t}\n};\n\nmodule.exports = ModuleLoader;\n","var ModuleLoader = require( './moduleLoader' );\n\nmodule.exports = new ModuleLoader();\n","/* global $ */\n\n/**\n * Utility library\n * @class util\n * @singleton\n */\nmodule.exports = {\n\t/**\n\t * Obtains the correct label for the save button which is project specific. It's either\n\t * \"save\" or \"publish\"\n\t * @return {string}\n\t */\n\tsaveButtonMessage: function () {\n\t\treturn mw.config.get( 'wgEditSubmitButtonLabelPublish' ) ?\n\t\t\tmw.msg( 'mobile-frontend-editor-publish' ) : mw.msg( 'mobile-frontend-editor-save' );\n\t},\n\t/**\n\t * Wrapper class for Promises\n\t * @memberof util\n\t * @instance\n\t */\n\tPromise: {\n\t\t/**\n\t\t * Wrapper class for the $.when that is compatible with Promise.all\n\t\t * @memberof util\n\t\t * @param {jQuery.Promise[]} promises\n\t\t * @instance\n\t\t * @return {jQuery.Promise}\n\t\t */\n\t\tall: function ( promises ) {\n\t\t\treturn $.when.apply( $, promises );\n\t\t}\n\t},\n\t/**\n\t * Escape a string for use as a css selector\n\t * @memberof util\n\t * @instance\n\t * @param {string} selector\n\t * @return {string}\n\t */\n\tescapeSelector: function ( selector ) {\n\t\treturn $.escapeSelector( selector );\n\t},\n\t/**\n\t * Wrapper class for the $.grep\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\tgrep: function () {\n\t\treturn $.grep.apply( $, arguments );\n\t},\n\t/**\n\t * Run method when document is ready.\n\t * @memberof util\n\t * @instance\n\t * @param {Function} fn\n\t * @return {jQuery.Object}\n\t */\n\tdocReady: function ( fn ) {\n\t\treturn $( fn );\n\t},\n\t/**\n\t * Wrapper class for the Deferred method\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\tDeferred: function () {\n\t\treturn $.Deferred();\n\t},\n\t/**\n\t * Adds a class to the document\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Object} element representing the documentElement\n\t */\n\tgetDocument: function () {\n\t\treturn $( document.documentElement );\n\t},\n\t/**\n\t * Get the window object\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Object}\n\t */\n\tgetWindow: function () {\n\t\treturn $( window );\n\t},\n\t/**\n\t * Given some html, create new element(s).\n\t * Unlike jQuery.parseHTML this will return a jQuery object\n\t * not an array.\n\t * @memberof util\n\t * @instance\n\t * @param {string} html\n\t * @param {Element} [ctx] Document element to serve as the context\n\t *  in which the HTML fragment will be created\n\t * @return {jQuery.Object}\n\t */\n\tparseHTML: function ( html, ctx ) {\n\t\tctx = ctx || document;\n\t\treturn $( $.parseHTML( html, ctx ) );\n\t},\n\t/**\n\t * wrapper for jQuery util function to check if something is numeric\n\t * @memberof util\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisNumeric: function () {\n\t\treturn $.isNumeric.apply( $, arguments );\n\t},\n\t/**\n\t * Wrapper for jQuery.extend method. In future this can be bound to Object.assign\n\t * when support allows.\n\t *\n\t * Warning: if only one argument is supplied to util.extend(), this means the target argument\n\t * was omitted. In this case, the jQuery object itself is assumed to be the target.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {Object}\n\t */\n\textend: function () {\n\t\treturn $.extend.apply( $, arguments );\n\t},\n\t/**\n\t * Escape dots and colons in a hash, jQuery doesn't like them because they\n\t * look like CSS classes and pseudoclasses. See\n\t * http://bugs.jquery.com/ticket/5241\n\t * http://stackoverflow.com/questions/350292/how-do-i-get-jquery-to-select-elements-with-a-period-in-their-id\n\t * @memberof util\n\t * @instance\n\t * @param {string} hash A hash to escape\n\t * @return {string}\n\t */\n\tescapeHash: function ( hash ) {\n\t\treturn hash.replace( /(:|\\.)/g, '\\\\$1' );\n\t},\n\n\t/**\n\t * Heuristic for determining whether an Event should be handled by\n\t * MobileFrontend or allowed to bubble to the browser.\n\t * @memberof util\n\t * @instance\n\t * @param {Event} ev\n\t * @return {boolean} True if event is modified with control, alt, meta, or\n\t *                   shift keys and should probably be handled by the\n\t *                   browser.\n\t *\n\t * todo: move this function to a ClickUtil file once bundling and code\n\t * splitting is supported.\n\t */\n\tisModifiedEvent: function ( ev ) {\n\t\treturn ev.altKey || ev.ctrlKey || ev.metaKey || ev.shiftKey;\n\t},\n\n\t/**\n\t * Pipe event emitted by source through proxy. Subscribers to proxy will receive the event as\n\t * though proxy was the originator.\n\t *\n\t * @param {OO.EventEmitter} src\n\t * @param {OO.EventEmitter} proxy\n\t * @param {string} event Event type to listen for.\n\t * @param {any[]} [args] Arguments to pass to\n\t *  subscribers, will be prepended to emitted arguments.\n\t * @return {OO.EventEmitter} The source.\n\t */\n\trepeatEvent: function ( src, proxy, event, args ) {\n\t\treturn src.on( event, function ( args ) {\n\t\t\treturn proxy.emit( event, args );\n\t\t}, args );\n\t},\n\n\t/**\n\t * @typedef {Object} Template\n\t * @property {Function} render returning string of rendered HTML\n\t *\n\t * Centralised place for template rendering.\n\t *\n\t * T223927: We depend on the global Mustache brought in by the\n\t * mediawiki.template.mustache module but do not delegate to\n\t * mediawiki.template.mustache.js because its render method returns a JQuery\n\t * object, but our MobileFrontend code depends on .render returning a string.\n\t *\n\t * @param {string} source code of template that is Mustache compatible.\n\t * @return {Template}\n\t */\n\ttemplate: function ( source ) {\n\t\treturn {\n\t\t\t/**\n\t\t\t * @ignore\n\t\t\t * @return {string} The raw source code of the template\n\t\t\t */\n\t\t\tgetSource: function () {\n\t\t\t\treturn source;\n\t\t\t},\n\t\t\t/**\n\t\t\t * @ignore\n\t\t\t * @param {Object} data Data to render\n\t\t\t * @param {Object} partials Map partial names to Mustache template objects\n\t\t\t * @return {string} Rendered HTML\n\t\t\t */\n\t\t\trender: function ( data, partials ) {\n\t\t\t\tconst partialSource = {};\n\t\t\t\t// Map MobileFrontend templates to partial strings\n\t\t\t\tObject.keys( partials || {} ).forEach( ( key ) => {\n\t\t\t\t\tpartialSource[ key ] = partials[ key ].getSource();\n\t\t\t\t} );\n\n\t\t\t\t// Use global Mustache which is loaded by mediawiki.template.mustache (a\n\t\t\t\t// dependency of the mobile.startup module)\n\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\treturn Mustache.render(\n\t\t\t\t\tsource.trim(),\n\t\t\t\t\tdata,\n\t\t\t\t\tpartialSource\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t}\n};\n"],"sourceRoot":""}