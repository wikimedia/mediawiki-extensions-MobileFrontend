(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./src/mobile.init/fakeToolbar.js":function(e,t,i){var n=i("./src/mobile.startup/icons.js");e.exports=function(){var e,t;return e=n.cancel(null,{tagName:"a"}).$el.attr("tabindex","0").attr("role","button"),t=n.spinner({tagName:"span",hasText:!0,additionalClassNames:"",label:mw.msg("mobile-frontend-editor-loading")}).$el,$("<div>").addClass("ve-mobile-fakeToolbar-container").append($("<div>").addClass("ve-mobile-fakeToolbar-header").addClass("header").append($("<div>").addClass("ve-mobile-fakeToolbar").append(e,t)))}},"./src/mobile.startup/Anchor.js":function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var l=i("./src/mobile.startup/View.js"),c=i("./src/mobile.startup/util.js"),u=function(e){"use strict";function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a(this,r(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(t,l),function(e,t,i){t&&s(e.prototype,t),i&&s(e,i)}(t,[{key:"isTemplateMode",get:function(){return!0}},{key:"defaults",get:function(){return{progressive:void 0,destructive:void 0,additionalClassNames:"",href:void 0,label:void 0}}},{key:"template",get:function(){return c.template('\n<a {{#href}}href="{{href}}"{{/href}} class="mw-ui-anchor\n\t{{#progressive}} mw-ui-progressive{{/progressive}}\n\t{{#destructive}} mw-ui-destructive{{/destructive}}\n\t {{additionalClassNames}}">{{label}}</a>\n\t')}}]),t}();e.exports=u},"./src/mobile.startup/Browser.js":function(e,t,i){var n,s=i("./src/mobile.startup/util.js");function a(e){var t=function t(){var i=this["__cache"+t.cacheId]||(this["__cache"+t.cacheId]={}),n=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(i,n)?i[n]:i[n]=e.apply(this,arguments)};return t.cacheId=Date.now().toString()+Math.random().toString(),t}function r(e,t){this.userAgent=e,this.$el=t}r.prototype={isIos:a(function(e){var t=this.userAgent,i=/ipad|iphone|ipod/i.test(t);if(!i||!e)return i;switch(e){case 8:return/OS 8_/.test(t)||/Version\/8/.test(t);case 4:return/OS 4_/.test(t);case 5:return/OS 5_/.test(t);default:return!1}}),isWideScreen:a(function(){var e=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=e}),supportsAnimations:a(function(){var e=document.createElement("foo").style;function t(t){return t in e||"webkit"+t[0].toUpperCase()+t.slice(1)in e}return t("animationName")&&t("transform")&&t("transition")}),supportsTouchEvents:a(function(){return"ontouchstart"in window}),supportsGeoLocation:a(function(){return"geolocation"in window.navigator})},r.getSingleton=function(){var e;return n||(e=s.getDocument(),n=new r(window.navigator.userAgent,e)),n},e.exports=r},"./src/mobile.startup/Button.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/View.js");function r(e){e.href&&(e.tagName="a"),a.call(this,e)}n(r,a,{isTemplateMode:!0,defaults:{tagName:"a",disabled:!1,block:void 0,progressive:void 0,destructive:void 0,quiet:void 0,additionalClassNames:"",href:void 0,label:void 0},template:s.template('<{{tagName}} {{#disabled}}disabled{{/disabled}}\n{{#href}}href="{{href}}"{{/href}}\nclass="mw-ui-button {{#progressive}}mw-ui-progressive{{/progressive}}\n\t{{#block}}mw-ui-block{{/block}}\n\t{{#quiet}}mw-ui-quiet{{/quiet}}\n\t{{#destructive}}mw-ui-destructive{{/destructive}} {{additionalClassNames}}\n">{{label}}</{{tagName}}>')}),e.exports=r},"./src/mobile.startup/CtaDrawer.js":function(e,t,i){var n=i("./src/mobile.startup/Drawer.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/Button.js"),r=i("./src/mobile.startup/Anchor.js");function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=l(e.queryParams,e.returnTo);return new n(s.extend({children:[s.parseHTML("<p>").text(e.content),new a(s.extend({progressive:!0,href:mw.util.getUrl("Special:UserLogin",t),label:mw.msg("mobile-frontend-watchlist-cta-button-login")},e.progressiveButton)).$el,s.parseHTML("<div>").addClass("cta-drawer__anchors").append(new r(s.extend({href:mw.util.getUrl("Special:UserLogin",c(t,e.signupQueryParams)),progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")},e.actionAnchor)).$el)]},e))}function l(e,t){return s.extend({returnto:t||mw.config.get("wgPageName")},e)}function c(){return[].push.call(arguments,{type:"signup"}),s.extend.apply(s,arguments)}o.prototype.test={redirectParams:l,signUpParams:c},e.exports=o},"./src/mobile.startup/Drawer.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/View.js"),a=i("./src/mobile.startup/util.js"),r=new(i("./src/mobile.startup/Icon.js"))({name:"expand",additionalClassNames:"cancel"});function o(e){s.call(this,a.extend({closeOnScroll:!0,onBeforeHide:function(){},showCollapseIcon:!0},e,{className:"drawer position-fixed ".concat(e&&e.className||"").trim()},{events:a.extend({"click .cancel":function(e){e.preventDefault(),this.hide()}.bind(this),click:function(e){e.stopPropagation()}},(e||{}).events)}))}n(o,s,{minHideDelay:10,show:function(){var e=a.Deferred();return this.isVisible()?e.resolve():setTimeout(function(){this.$el.addClass("visible animated");var t=this.options.closeOnScroll;this.$el.parent().addClass("drawer-visible".concat(t?"":" has-drawer--with-scroll-locked")),setTimeout(function(){var i=a.getWindow();i.one("click.drawer",this.hide.bind(this)),t&&i.one("scroll.drawer",this.hide.bind(this)),e.resolve()}.bind(this),this.minHideDelay)}.bind(this),this.minHideDelay),e.promise()},hide:function(){setTimeout(function(){this.$el.removeClass("visible"),this.options.onBeforeHide(),this.$el.parent().removeClass("drawer-visible has-drawer--with-scroll-locked"),a.getWindow().off(".drawer")}.bind(this),this.minHideDelay)},isVisible:function(){return this.$el.hasClass("visible")},toggle:function(){this.isVisible()?this.hide():this.show()},appendToElement:"body",postRender:function(){this.options.showCollapseIcon&&this.$el.prepend(r.$el),this.options.children&&this.$el.append(this.options.children),a.docReady(function(){this.appendTo(this.appendToElement),this.$el.parent().addClass("has-drawer")}.bind(this))}}),e.exports=o},"./src/mobile.startup/Icon.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/View.js");function r(e){e.hasText&&(e.modifier="mw-ui-icon-before ".concat(e.modifier||"")),e.href&&(e.tagName="a"),"button"===e.tagName&&(e.isTypeButton=!0),a.call(this,e)}n(r,a,{preRender:function(){this.setRotationClass()},setRotationClass:function(){var e=this.options;if(e.rotation)switch(e.rotation){case-180:case 180:e._rotationClass="mf-mw-ui-icon-rotate-flip";break;case-90:e._rotationClass="mf-mw-ui-icon-rotate-anti-clockwise";break;case 90:e._rotationClass="mf-mw-ui-icon-rotate-clockwise";break;case 0:break;default:throw new Error("Bad value for rotation given. Must be ±90, 0 or ±180.")}},isTemplateMode:!0,defaults:{rotation:0,hasText:!1,href:void 0,glyphPrefix:"mf",tagName:"div",isSmall:!1,base:"mw-ui-icon",name:"",modifier:"mw-ui-icon-element",title:""},getClassName:function(){return this.$el.attr("class")},getGlyphClassName:function(){return this.options.base+"-"+this.options.glyphPrefix+"-"+this.options.name},toHtmlString:function(){return this.parseHTML("<div>").append(this.$el).html()},template:s.template('<{{tagName}} {{#isTypeButton}}type="button"{{/isTypeButton}} class="{{base}} {{base}}-{{glyphPrefix}}-{{name}} {{modifier}} {{#isSmall}}mw-ui-icon-small{{/isSmall}} {{#_rotationClass}}{{_rotationClass}}{{/_rotationClass}} {{additionalClassNames}}" {{#id}}id="{{id}}"{{/id}} {{#href}}href="{{href}}"{{/href}} {{#title}}title="{{title}}"{{/title}}>{{#hasText}}<span>{{/hasText}}{{label}}{{#hasText}}</span>{{/hasText}}</{{tagName}}>')}),mw.log.deprecate(r.prototype,"toHtmlString",r.prototype.toHtmlString),e.exports=r},"./src/mobile.startup/MessageBox.js":function(e,t,i){var n=i("./src/mobile.startup/View.js"),s=i("./src/mobile.startup/util.js");function a(){n.apply(this,arguments)}i("./src/mobile.startup/mfExtend.js")(a,n,{isTemplateMode:!0,defaults:{},template:s.template('\n<div class="{{className}}">\n\t{{#heading}}<h2>{{heading}}</h2>{{/heading}}\n\t{{{msg}}}\n</div>\n\t')}),e.exports=a},"./src/mobile.startup/Overlay.js":function(e,t,i){var n=i("./src/mobile.startup/View.js"),s=i("./src/mobile.startup/headers.js").header,a=i("./src/mobile.startup/Anchor.js"),r=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/Browser.js").getSingleton();function l(e){this.isIos=o.isIos(),n.call(this,r.extend(!0,{headerChrome:!1,className:"overlay"},e,{events:r.extend({"click .cancel, .confirm, .initial-header .back":"onExitClick",click:function(e){e.stopPropagation()}},e.events)}))}i("./src/mobile.startup/mfExtend.js")(l,n,{template:r.template('\n{{^noHeader}}\n<div class="overlay-header-container header-container{{#headerChrome}}\n\theader-chrome{{/headerChrome}} position-fixed">\n</div>\n{{/noHeader}}\n<div class="overlay-content">\n\t{{>content}}\n</div>\n<div class="overlay-footer-container position-fixed"></div>\n\t'),hideTimeout:null,showSpinner:function(){this.$el.find(".spinner").removeClass("hidden")},hideSpinner:function(){this.$el.find(".spinner").addClass("hidden")},postRender:function(){var e,t=this.options.footerAnchor;this.$overlayContent=this.$el.find(".overlay-content"),this.isIos&&this.$el.addClass("overlay-ios"),t&&this.$el.find(".overlay-footer-container").append(new a(t).$el),e=this.options.headers||[s(this.options.heading,this.options.headerActions)],this.$el.find(".overlay-header-container").append(e)},onExitClick:function(e){var t=function(){this.hide()}.bind(this);e.preventDefault(),e.stopPropagation(),this.options.onBeforeExit?this.options.onBeforeExit(t,function(){}):t()},show:function(){var e=r.getDocument();this.scrollTop=window.pageYOffset,e.addClass("overlay-enabled"),window.scrollTo(0,1),this.$el.addClass("visible"),null!==this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)},hide:function(){return r.getDocument().removeClass("overlay-enabled"),window.scrollTo(window.pageXOffset,this.scrollTop),this.hideTimeout=setTimeout(function(){this.$el.detach(),this.hideTimeout=null}.bind(this),0),this.emit("hide"),!0},showHidden:function(e){this.$el.find(".hideable").addClass("hidden"),this.$el.find(e).removeClass("hidden")}}),l.make=function(e,t){var i=new l(e);return i.$el.find(".overlay-content").append(t.$el),i},e.exports=l},"./src/mobile.startup/OverlayManager.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=null,a="MobileFrontend OverlayManager was here!";function r(e,t){e.on("route",this._checkRoute.bind(this)),this.router=e,this.entries={},this.stack=[],this.hideCurrent=!0,this.container=t}function o(e){e.on("hide",function(){e.emit("_om_hide")})}r.prototype={_onHideOverlay:function(){this.hideCurrent=!1,this.router.back()},_attachOverlay:function(e){e.$el.parents().length||this.container.appendChild(e.$el[0])},_show:function(e){window.history.replaceState(a,null,window.location.href),e.once("_om_hide",this._onHideOverlay.bind(this)),this._attachOverlay(e),e.show()},_hideOverlay:function(e){var t;function i(){t=!0,e.hide()}return e.off("_om_hide"),e.options&&e.options.onBeforeExit?e.options.onBeforeExit(i):i(),t||e.once("_om_hide",this._onHideOverlay.bind(this)),t},_processMatch:function(e){var t,i=this;e&&(e.overlay?i._show(e.overlay):"function"==typeof(t=e.factoryResult).promise?t.then(function(t){e.overlay=t,o(t),i._show(t)}):(e.overlay=t,o(e.overlay),i._show(t)))},_checkRoute:function(e){var t,i=this.stack[0];i||(this.scrollTop=window.pageYOffset),i&&void 0!==i.overlay&&this.hideCurrent&&!this._hideOverlay(i.overlay)?e.preventDefault():((t=Object.keys(this.entries).reduce(function(t,i){return t||this._matchRoute(e.path,this.entries[i])}.bind(this),null))||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(t))},_matchRoute:function(e,t){var i,n=e.match(t.route),s=this.stack[1],a=this;return n?s&&s.path===e?(a.stack.shift(),s):(i={path:e,factoryResult:t.factory.apply(a,n.slice(1))},this.stack[0]&&i.path===this.stack[0].path?a.stack[0]=i:a.stack.unshift(i),i):null},add:function(e,t){var i=this,s={route:e,factory:t};this.entries[e]=s,n.docReady(function(){i._processMatch(i._matchRoute(i.router.getPath(),s))})},replaceCurrent:function(e){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");this._hideOverlay(this.stack[0].overlay),this.stack[0].overlay=e,o(e),this._show(e)}},r.getSingleton=function(){if(!s){var e=document.createElement("div"),t=window.location.hash,i=window.history.state;e.className="mw-overlays-container",document.body.appendChild(e),t&&i!==a&&(window.history.replaceState(null,null,"#"),window.history.pushState(a,null,t)),s=new r(mw.loader.require("mediawiki.router"),e)}return s},e.exports=r},"./src/mobile.startup/Page.js":function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=mw.html,a=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/Section.js"),o=function(){"use strict";function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=t.title||"";a.extend(this,{id:t.id||0,title:i,relevantTitle:t.relevantTitle||i,titleObj:t.titleObj,displayTitle:t.displayTitle||s.escape(i),namespaceNumber:t.namespaceNumber||0,protection:t.protection,sections:[],url:t.url||mw.util.getUrl(i),wikidataDescription:t.wikidataDescription,_isMainPage:t.isMainPage||!1,isMissing:void 0!==t.isMissing?t.isMissing:0===t.id,lastModified:t.lastModified,anchor:t.anchor,revId:t.revId,_isWatched:t.isWatched,thumbnail:!!Object.prototype.hasOwnProperty.call(t,"thumbnail")&&t.thumbnail,_sectionLookup:{}}),(t.sections||[]).forEach(function(e){var t=new r(e);this.sections.push(t),this._sectionLookup[t.id]=t}.bind(this)),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}return function(e,t,i){t&&n(e.prototype,t),i&&n(e,i)}(e,[{key:"getDisplayTitle",value:function(){return this.displayTitle}},{key:"inNamespace",value:function(e){return this.namespaceNumber===mw.config.get("wgNamespaceIds")[e]}},{key:"isWikiText",value:function(){return"wikitext"===mw.config.get("wgPageContentModel")}},{key:"isMainPage",value:function(){return this._isMainPage}},{key:"isWatched",value:function(){return this._isWatched}},{key:"getRevisionId",value:function(){return this.revId}},{key:"getTitle",value:function(){return this.title}},{key:"getNamespaceId",value:function(){var e=this.title.split(":");return e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0}},{key:"getSection",value:function(e){return this._sectionLookup[e]}},{key:"getSections",value:function(){return this.sections}}]),e}();e.exports=o},"./src/mobile.startup/PageGateway.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/Section.js").prototype.template,a=i("./src/mobile.startup/Page.js"),r=i("./src/mobile.startup/actionParams.js"),o={};function l(e){var t,i=e.map(function(e){return e.level}).filter(function(e){return!!e}),n=Math.min.apply(this,i).toString(),a=[];return e.forEach(function(e){e.subsections=[],!t||!e.level||e.level===n||t.subsections.length&&t.subsections[0].level>e.level||t.level&&t.level>=e.level?(a.push(e),t=e):(!function e(t,i){var n;0===t.length?t.push(i):(n=t[t.length-1],parseInt(n.level,10)===parseInt(i.level,10)?t.push(i):e(n.subsections,i))}(t.subsections,e),t.text+=s.render(e))}),a}function c(e){this.api=e}c.prototype={getSections:function(e){var t=n.Deferred();return this.getPage(e).then(function(e){var i=new a(e);t.resolve(i.getSections())},function(e){"missingtitle"===e?t.resolve([]):t.reject()}),t.promise()},getPage:function(e,t,i){var s,a=n.Deferred(),c=t?{url:t,dataType:"jsonp"}:{},u={edit:["*"]};return n.extend(c,r({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:i?0:"all"})),o[e]||(o[e]=this.api.get(c).then(function(t){var i,r,o,c;return t.error?a.reject(t.error):t.mobileview.sections?(i=l((c=t.mobileview).sections),s=new Date(c.lastmodified).getTime()/1e3,r=c.lastmodifiedby,u=Array.isArray(c.protection)?u:n.extend(u,c.protection),o={title:e,id:c.id,revId:c.revId,protection:u,lead:i[0].text,sections:i.slice(1),isMainPage:void 0!==c.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:s,languageCount:c.languagecount,hasVariants:void 0!==c.hasvariants,displayTitle:c.displaytitle},r&&n.extend(o,{lastModifiedUserName:r.name,lastModifiedUserGender:r.gender}),o):a.reject("No sections")},function(e){return a.reject(e)})),o[e]},invalidatePage:function(e){delete o[e]},_getLanguageVariantsFromApiResponse:function(e,t){var i=t.query.general,n=i.variantarticlepath,s=[];return!!i.variants&&(Object.keys(i.variants).forEach(function(t){var a=i.variants[t],r={autonym:a.name,lang:a.code};r.url=n?n.replace("$1",e).replace("$2",a.code):mw.util.getUrl(e,{variant:a.code}),s.push(r)}),s)},getPageLanguages:function(e,t){var i=this,s=r({meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e});return t?(s.llprop="url|autonym|langname",s.llinlanguagecode=t):s.llprop="url|autonym",this.api.get(s).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:i._getLanguageVariantsFromApiResponse(e,t)}},function(){return n.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var i=this.tagName.substr(1),n=e.find(this).find(".mw-headline");n.length&&t.push({level:i,line:n.html(),anchor:n.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return l(this._getAPIResponseFromHTML(e))}},e.exports=c},"./src/mobile.startup/PageHTMLParser.js":function(e,t,i){function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=i("./src/mobile.startup/Thumbnail.js"),a=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),r=["noviewer","metadata"],o=function(){"use strict";function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.$headings=this.$el.find(a)}return function(e,t,i){t&&n(e.prototype,t),i&&n(e,i)}(e,[{key:"findSectionHeadingByIndex",value:function(e){return e<1?$([]):this.$headings.filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(e-1)}},{key:"findChildInSectionLead",value:function(e,t){var i,n,s,r,o=a;function l(e){return e.find(t).addBack()}return 0===e?(r=this.getLeadSectionElement())&&r.length?l(r.children(t)):(i=this.findSectionHeadingByIndex(1)).length?l(i.prevAll(t)):this.$el.find(t):(i=this.findSectionHeadingByIndex(e)).hasClass("section-heading")?(n=(s=i.next()).find(o).eq(0)).length?l(n.prevAll(t)):l(s.children(t)):(n=i.eq(0).nextAll(o).eq(0),i.nextUntil(n,t))}},{key:"getLeadSectionElement",value:function(){var e=this.$el.find(".mf-section-0");return e.length?e:null}},{key:"getThumbnails",value:function(e){var t="."+r.join(",."),i=[];return(e=e||this.$el).find("a.image, a.thumbimage").not(t).each(function(){var n=e.find(this),a=n.find(".lazy-image-placeholder"),o=0===n.parents(t).length&&0===n.find(t).length,l=n.attr("href").match(/title=([^/&]+)/),c=n.attr("href").match(/[^/]+$/);a.length&&o&&(o=!new RegExp("\\b("+r.join("|")+")\\b").test(a.data("class"))),o&&(l||c)&&i.push(new s({el:n,filename:decodeURIComponent(l?l[1]:c[0])}))}),i}},{key:"getRedLinks",value:function(){return this.$el.find(".new")}}]),e}();o.HEADING_SELECTOR=a,e.exports=o},"./src/mobile.startup/PageList.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js"),a=i("./src/mobile.startup/View.js"),r=i("./src/mobile.startup/Browser.js").getSingleton();function o(){a.apply(this,arguments)}s(o,a,{defaults:{pages:[]},renderPageImages:function(){var e=this;setTimeout(function(){e.$el.find(".list-thumb").each(function(){var t=e.$el.find(this).data("style");e.$el.find(this).attr("style",t)})},r.isWideScreen()?0:1e3)},postRender:function(){this.renderPageImages()},template:n.template('\n<ul class="page-list thumbs actionable">\n\t{{#pages}}\n\t\t{{>item}}\n\t{{/pages}}\n</ul>\n\t'),templatePartials:{item:n.template('\n<li title="{{title}}" data-id="{{id}}" class="page-summary">\n  <a href="{{url}}" class="title {{#isMissing}}new{{/isMissing}}"\n    {{#anchor}}name="{{anchor}}"{{/anchor}}\n    {{#latitude}}data-latlng="{{latitude}},{{longitude}}"{{/latitude}}\n    data-title="{{title}}">\n    <div class="list-thumb\n      {{^thumbnail}}list-thumb-none list-thumb-x{{/thumbnail}}\n      {{#thumbnail.isLandscape}}list-thumb-y{{/thumbnail.isLandscape}}\n      {{^thumbnail.isLandscape}}list-thumb-x{{/thumbnail.isLandscape}}"\n      {{#thumbnail}}data-style="background-image: url( {{thumbnail.source}} )"{{/thumbnail}}></div>\n    <h3>{{{displayTitle}}}</h3>\n    {{#wikidataDescription}}\n    <div class="wikidata-description">{{wikidataDescription}}</div>\n    {{/wikidataDescription}}\n    {{#lastModified}}\n    <div class="info">{{lastModified}}</div>\n    {{/lastModified}}\n    {{#proximity}}\n    <div class="info proximity">{{proximity}}</div>\n    {{/proximity}}\n  </a>\n</li>\n\t')}}),e.exports=o},"./src/mobile.startup/ScrollEndEventEmitter.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js");function a(e,t){this.threshold=t||100,this.eventBus=e,this.enable(),OO.EventEmitter.call(this)}OO.mixinClass(a,OO.EventEmitter),a.EVENT_SCROLL_END="ScrollEndEventEmitter-scrollEnd",s(a,{_bindScroll:function(){this._scrollHandler||(this._scrollHandler=this._onScroll.bind(this),this.eventBus.on("scroll:throttled",this._scrollHandler))},_unbindScroll:function(){this._scrollHandler&&(this.eventBus.off("scroll:throttled",this._scrollHandler),this._scrollHandler=null)},_onScroll:function(){this.$el&&this.enabled&&this.scrollNearEnd()&&(this.disable(),this.emit(a.EVENT_SCROLL_END))},scrollNearEnd:function(){var e=n.getWindow(),t=e.scrollTop()+e.height(),i=this.$el.offset().top+this.$el.outerHeight();return t+this.threshold>i},enable:function(){this.enabled=!0,this._bindScroll()},disable:function(){this.enabled=!1,this._unbindScroll()},setElement:function(e){this.$el=e}}),e.exports=a},"./src/mobile.startup/Section.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js"),a=i("./src/mobile.startup/View.js");function r(e){var t=this;e.tag="h"+e.level,this.line=e.line,this.text=e.text,this.hasReferences=e.hasReferences||!1,this.id=e.id||null,this.anchor=e.anchor,this.subsections=[],(e.subsections||[]).forEach(function(e){t.subsections.push(new r(e))}),a.call(this,e)}s(r,a,{template:n.template('\n<h{{level}} id="{{anchor}}">{{{line}}}</h{{level}}>\n{{{text}}}\n\t'),defaults:{line:void 0,text:""}}),e.exports=r},"./src/mobile.startup/Skin.js":function(e,t,i){var n,s=i("./src/mobile.startup/Browser.js").getSingleton(),a=i("./src/mobile.startup/lazyImages/lazyImageLoader.js"),r=i("./src/mobile.startup/lazyImages/lazyImageTransformer.js"),o=i("./src/mobile.startup/View.js"),l=i("./src/mobile.startup/util.js"),c=i("./src/mobile.startup/currentPage.js"),u=i("./src/mobile.startup/eventBusSingleton.js");function d(e){var t=this,i=l.extend({},e);this.page=i.page,this.name=i.name,this.eventBus=i.eventBus,i.isBorderBox=!1,o.call(this,i),mw.config.get("wgMFLazyLoadImages")&&l.docReady(function(){var e=document.getElementById("content"),i=e&&a.queryPlaceholders(e)||[];t.lazyImageTransformer=r.newLazyImageTransformer(t.eventBus,t.$el.find.bind(t.$el),1.5*l.getWindow().height(),i),t.lazyImageTransformer.loadImages()})}i("./src/mobile.startup/mfExtend.js")(d,o,{defaults:{page:void 0},postRender:function(){var e=this,t=this.$el;s.supportsAnimations()&&t.addClass("animations"),s.supportsTouchEvents()&&t.addClass("touch-events"),l.parseHTML('<div class="transparent-shield cloaked-element">').appendTo(t.find("#mw-mf-page-center")),this.lazyImageTransformer&&this.lazyImageTransformer.loadImages(),this.$el.find("#mw-mf-page-center").on("click",function(t){e.emit("click",t)})},getLicenseMsg:function(){var e,t=mw.config.get("wgMFLicense"),i=mw.language.convertNumber(t.plural);return t.link&&(e=this.$el.find("#footer-places-terms-use").length>0?mw.msg("mobile-frontend-editor-licensing-with-terms",mw.message("mobile-frontend-editor-terms-link",this.$el.find("#footer-places-terms-use a").attr("href")).parse(),t.link,i):mw.msg("mobile-frontend-editor-licensing",t.link,i)),e}}),d.getSingleton=function(){return n||(n=new d({el:"body",page:c(),eventBus:u})),n},e.exports=d},"./src/mobile.startup/Thumbnail.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/View.js");function r(e){a.call(this,s.extend({isBorderBox:!1},e))}n(r,a,{defaults:{filename:void 0},postRender:function(){this.options.description=this.$el.siblings(".thumbcaption").text()},getDescription:function(){return this.options.description},getFileName:function(){return this.options.filename}}),e.exports=r},"./src/mobile.startup/Toggler.js":function(e,t,i){var n=i("./src/mobile.startup/Browser.js").getSingleton(),s=i("./src/mobile.startup/util.js"),a=s.escapeHash,r={name:"expand",isSmall:!0,additionalClassNames:"indicator mw-ui-icon-flush-left"},o=i("./src/mobile.startup/Icon.js");function l(e){this.eventBus=e.eventBus,this._enable(e.$container,e.prefix,e.page,e.isClosed)}function c(e){var t=JSON.parse(mw.storage.get("expandedSections")||"{}");return t[e.title]=t[e.title]||{},t}function u(e){mw.storage.set("expandedSections",JSON.stringify(e))}function d(e,t,i){var n,s,a=c(i);t.find(".section-heading span").each(function(){s=t.find(this),n=s.parents(".section-heading"),a[i.title][s.attr("id")]&&!n.hasClass("open-block")&&e.toggle(n,i)})}function h(e){var t=(new Date).getTime(),i=c(e);Object.keys(i).forEach(function(e){var n=i[e];Object.keys(n).forEach(function(s){var a=n[s];Math.floor((t-a)/1e3/60/60/24)>=1&&delete i[e][s]})}),u(i)}l.prototype.toggle=function(e,t){var i,s=e.is(".open-block"),a=e.next();e.toggleClass("open-block"),e.data("indicator").remove(),r.rotation=s?0:180,i=new o(r).prependTo(e),e.data("indicator",i),a.toggleClass("open-block").attr({"aria-pressed":!s,"aria-expanded":!s}),this.eventBus.emit("section-toggled",{expanded:s,isReferenceSection:Boolean(a.attr("data-is-reference-section")),$heading:e}),n.isWideScreen()||function(e,t){var i=e.find("span").attr("id"),n=e.hasClass("open-block"),s=c(t);i&&(n?s[t.title][i]=(new Date).getTime():delete s[t.title][i],u(s))}(e,t)},l.prototype.reveal=function(e,t,i){var n,s;try{(s=(n=t.find(a(e))).parents(".collapsible-heading")).length||(s=n.parents(".collapsible-block").prev(".collapsible-heading")),s.length&&!s.hasClass("open-block")&&this.toggle(s,i),s.length&&window.scrollTo(0,n.offset().top)}catch(e){}},l.prototype._enable=function(e,t,i,a){var l,c,u,p,m,f=this,g=mw.config.get("wgMFCollapseSectionsByDefault");function w(){var t=window.location.hash;0===t.indexOf("#")&&f.reveal(decodeURIComponent(t),e,i)}l=e.find("> h1,> h2,> h3,> h4,> h5,> h6,.section-heading").eq(0).prop("tagName")||"H1",void 0===g&&(g=!0),c=!g||"true"===mw.storage.get("expandSections"),e.children(l).each(function(s){var l,d=e.find(this),h=d.find(".indicator"),m=t+"collapsible-block-"+s;d.next().is("div")&&(p=d.next("div"),l=Boolean(p.attr("data-is-reference-section")),d.addClass("collapsible-heading ").data("section-number",s).attr({tabindex:0,"aria-haspopup":"true","aria-controls":m}).on("click",function(e){e.target.href||(e.preventDefault(),f.toggle(d,i))}),r.rotation=c?180:0,u=new o(r),h.length?h.replaceWith(u.$el):u.prependTo(d),d.data("indicator",u.$el),p.addClass("collapsible-block").eq(0).attr({id:m,"aria-pressed":"false","aria-expanded":"false"}),function(e,t,i){t.on("keypress",function(n){13!==n.which&&32!==n.which||e.toggle(t,i)}).find("a").on("keypress mouseup",function(e){e.stopPropagation()})}(f,d,i),!l&&(!a&&n.isWideScreen()||c)&&f.toggle(d,i))}),function(){var t=mw.config.get("wgInternalRedirectTargetUrl"),n=!!t&&t.split("#")[1];n&&(window.location.hash=n,f.reveal(n,e,i))}(),w(),(m=e.find("a:not(.reference a)")).on("click",function(){void 0!==m.attr("href")&&m.attr("href").indexOf("#")>-1&&w()}),s.getWindow().on("hashchange",function(){w()}),!n.isWideScreen()&&i&&(d(this,e,i),h(i))},l._getExpandedSections=c,l._expandStoredSections=d,l._cleanObsoleteStoredSections=h,e.exports=l},"./src/mobile.startup/View.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js"),a=/^(\S+)\s*(.*)$/,r=0;function o(){this.initialize.apply(this,arguments)}OO.mixinClass(o,OO.EventEmitter),s(o,{tagName:"div",isTemplateMode:!1,template:void 0,templatePartials:{},defaults:{},initialize:function(e){var t=this;OO.EventEmitter.call(this),e=n.extend({},this.defaults,e),this.options=e,this.cid=function(e){var t=(++r).toString();return e?e+t:t}("view"),"string"==typeof this.template&&(this.template=mw.template.compile(this.template)),e.el?this.$el=$(e.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize(e):n.docReady(function(){t.$el=$(e.el),t._postInitialize(e)})},_postInitialize:function(e){var t=e.className;this.$el.addClass(t),!1!==e.isBorderBox&&this.$el.addClass("view-border-box"),this.render({})},preRender:function(){},postRender:function(){},render:function(e){var t,i;return n.extend(this.options,e),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(i=this.template.render(this.options,this.templatePartials),this.isTemplateMode?(t=$(i),this.$el.replaceWith(t),this.$el=t):this.$el.html(i)),this.postRender(),this.delegateEvents(),this},delegateEvents:function(e){var t,i,n;if(e=e||this.options.events)for(i in this.undelegateEvents(),e)"function"!=typeof(n=e[i])&&(n=this[e[i]]),n&&(t=i.match(a),this.delegate(t[1],t[2],n.bind(this)))},delegate:function(e,t,i){this.$el.on(e+".delegateEvents"+this.cid,t,i)},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid)},undelegate:function(e,t,i){this.$el.off(e+".delegateEvents"+this.cid,t,i)},parseHTML:function(e){return n.parseHTML(e,document)}}),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(e){o.prototype[e]=function(){return this.$el[e].apply(this.$el,arguments),this}}),o.make=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=new o(e);return t.forEach(function(e){i.append(e)}),i},e.exports=o},"./src/mobile.startup/actionParams.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s={action:"query",formatversion:2};e.exports=function(e){var t=mw.config.get("wgMFContentProviderScriptPath");return n.extend({},s,{origin:t?"*":void 0},e)}},"./src/mobile.startup/amcOutreach/amcOutreach.js":function(e,t,i){var n,s=i("./src/mobile.startup/moduleLoaderSingleton.js"),a=i("./src/mobile.startup/toast.js"),r=i("./src/mobile.startup/promoCampaign/promoCampaign.js"),o=i("./src/mobile.startup/currentPage.js"),l={onLoad:"onLoad"};e.exports={loadCampaign:function(){return n||(n=r(function(e){mw.loader.using("mobile.amcOutreachDrawer").then(function(){s.require("mobile.amcOutreachDrawer").amcOutreachDrawer(e,n,mw.message,mw.util,o(),a,mw.user.tokens.get("csrfToken")).show()})},l,"amc-outreach",!!mw.config.get("wgMFAmcOutreachActive"),!!mw.config.get("wgMFAmcOutreachUserEligible"),mw.storage))},ACTIONS:l}},"./src/mobile.startup/context.js":function(e,t){e.exports={getMode:function(){return mw.config.get("wgMFMode")}}},"./src/mobile.startup/currentPage.js":function(e,t,i){var n,s=i("./src/mobile.startup/Page.js"),a=i("./src/mobile.startup/PageGateway.js");e.exports=function(){if(n)return n;var e=mw.config.get("wgRestrictionEdit",[]),t=$("#content #bodyContent"),i=new a(new mw.Api),r=mw.Title.newFromText(mw.config.get("wgRelevantPageName")),o=mw.Title.newFromText(mw.config.get("wgPageName"));return 0===e.length&&e.push("*"),n=new s({title:o.getPrefixedText(),titleObj:o,relevantTitle:r.getPrefixedText(),protection:{edit:e},revId:mw.config.get("wgRevisionId"),isMainPage:mw.config.get("wgIsMainPage"),isWatched:$("#ca-watch").hasClass("watched"),sections:i.getSectionsFromHTML(t),isMissing:0===mw.config.get("wgArticleId"),id:mw.config.get("wgArticleId"),namespaceNumber:mw.config.get("wgNamespaceNumber")})}},"./src/mobile.startup/currentPageHTMLParser.js":function(e,t,i){var n,s=i("./src/mobile.startup/PageHTMLParser.js");e.exports=function(){return n||(n=new s($("#content #bodyContent")))}},"./src/mobile.startup/eventBusSingleton.js":function(e,t){e.exports=new OO.EventEmitter},"./src/mobile.startup/extendSearchParams.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/actionParams.js");e.exports=function(e){var t,i,a=mw.config.get("wgMFDisplayWikibaseDescriptions")||{search:!0,nearby:!0,watchlist:!0,tagline:!1},r=mw.config.get("wgMFContentProviderScriptPath");if(!Object.prototype.hasOwnProperty.call(a,e))throw new Error('"'+e+"\" isn't a feature that shows Wikibase descriptions.");return(t=Array.prototype.slice.call(arguments,1)).unshift({prop:[]}),t.push(mw.config.get("wgMFSearchAPIParams")),(i=n.extend.apply({},t)).prop=i.prop.concat(mw.config.get("wgMFQueryPropModules")),a[e]&&-1===i.prop.indexOf("description")&&i.prop.push("description"),r&&(i.origin="*"),s(i)}},"./src/mobile.startup/headers.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/Button.js"),a=i("./src/mobile.startup/icons.js");function r(e,t,i,s){var r,o="string"==typeof e?e:void 0,l={hasActions:t&&t.length,isHidden:!1,heading:o},c=n.template('\n<div class="overlay-header header '.concat(s||"",' hideable">\n\t<ul class="header-cancel">\n\t\t<li></li>\n\t</ul>\n\t{{{heading}}}\n\t{{#hasActions}}\n\t<div class="header-action"></div>\n\t{{/hasActions}}\n</div>\n\t\t')).render(l);return i=i||a.cancel(),(r=n.parseHTML(c)).find("h2 span").addClass("truncated-text"),r.find(".header-cancel li").append(i.$el),void 0===o&&e.$el.insertAfter(r.find(".header-cancel")),t&&t.length&&r.find(".header-action").append(t.map(function(e){return e.$el})),r[0]}function o(e,t,i,n){return r(e='<div class="overlay-title"><h2>'.concat(e,"</h2></div>"),t,i,n)}e.exports={savingHeader:function(e){return o(e,[a.spinner({additionalClassNames:"savespinner loading"})],a.cancel(),"saving-header hidden")},saveHeader:function(e,t){return o(e,[new s({tagName:"button",additionalClassNames:"save submit",disabled:!0,label:n.saveButtonMessage()})],a.back(),t)},formHeader:function(e,t,i,n){return r(e,t,i,n)},header:o}},"./src/mobile.startup/icons.js":function(e,t,i){var n=i("./src/mobile.startup/Icon.js"),s=i("./src/mobile.startup/util.js");e.exports={CANCEL_GLYPH:"close",Icon:n,back:function(){return new n({tagName:"button",name:"arrowPrevious-base20",additionalClassNames:"back",label:mw.msg("mobile-frontend-overlay-close")})},cancel:function(e,t){var i=e?"".concat("close","-").concat(e):"".concat("close","-base20");return new this.Icon(s.extend({tagName:"button",name:i,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},t||{}))},spinner:function(e){return void 0===(e=e||{}).additionalClassNames&&(e.additionalClassNames="spinner loading"),new this.Icon(s.extend(e,{name:"spinner",label:mw.msg("mobile-frontend-loading-message")}))},error:function(){return new n({name:"alert-invert",additionalClassNames:"load-fail-msg-icon"})},watchIcon:function(){return new this.Icon({name:"star-base20",glyphPrefix:"wikimedia",additionalClassNames:"watch-this-article"})},watchedIcon:function(){return new this.Icon({name:"unStar-progressive",glyphPrefix:"wikimedia",additionalClassNames:"watch-this-article watched"})}}},"./src/mobile.startup/lazyImages/lazyImageLoader.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s="lazy-image-placeholder";e.exports={queryPlaceholders:function(e){return Array.prototype.slice.call(e.getElementsByClassName(s))},loadImages:function(t){return n.Promise.all(t.map(function(t){return e.exports.loadImage(t).promise}))},loadImage:function(e){var t=n.Deferred(),i=e.dataset.width||"0",s=e.dataset.height||"0",a=new Image(parseInt(i,10),parseInt(s,10));return a.className=e.dataset.class||"",a.alt=e.dataset.alt||"",a.style.cssText=e.style.cssText||"",a.addEventListener("load",function(){a.classList.add("image-lazy-loaded"),e.parentNode&&e.parentNode.replaceChild(a,e),t.resolve("load")},{once:!0}),a.addEventListener("error",function(){t.resolve("error")},{once:!0}),a.src=e.dataset.src||"",a.srcset=e.dataset.srcset||"",{promise:t,image:a}},test:{placeholderClass:s}}},"./src/mobile.startup/lazyImages/lazyImageTransformer.js":function(e,t,i){var n=i("./src/mobile.startup/lazyImages/lazyImageLoader.js"),s=i("./src/mobile.startup/util.js");e.exports={newLazyImageTransformer:function(e,t,i,a){function r(){var o=[];return(a=s.grep(a,function(e){var n=t(e);return!n.length||!function(e,t){return mw.viewport.isElementCloseToViewport(e[0],t)&&(e.is(":visible")||0===e.height())}(n,i)||(o.push(e),!1)})).length||(e.off("scroll:throttled",r),e.off("resize:throttled",r),e.off("section-toggled",r)),n.loadImages(o)}return e.on("scroll:throttled",r),e.on("resize:throttled",r),e.on("section-toggled",r),{loadImages:r}}}},"./src/mobile.startup/mfExtend.js":function(e,t){e.exports=function(e,t,i){var n;for(n in i?OO.inheritClass(e,t):(OO.initClass(e),i=t),i)e.prototype[n]=i[n]}},"./src/mobile.startup/moduleLoader.js":function(e,t){function i(){this._register={}}i.prototype={require:function(e){var t,i,n=this._register;function s(){if(!Object.hasOwnProperty.call(n,e))throw new Error("MobileFrontend Module not found: "+e);return n[e]}i=e.split("/");try{return(t=mw.loader.require(i[0]))[i[1]]?t[i[1]]:s()}catch(e){return s()}},define:function(e,t){var i=this;if(Object.hasOwnProperty.call(this._register,e))throw new Error("Module already exists: "+e);return this._register[e]=t,{deprecate:function(n){i.deprecate(n,t,e)}}},deprecate:function(e,t,i){var n;i&&(n="Use "+i+" instead."),mw.log.deprecate(this._register,e,t,n)}},e.exports=i},"./src/mobile.startup/moduleLoaderSingleton.js":function(e,t,i){var n=i("./src/mobile.startup/moduleLoader.js");e.exports=new n},"./src/mobile.startup/page/pageJSONParser.js":function(e,t,i){var n=i("./src/mobile.startup/Page.js"),s=i("./src/mobile.startup/time.js"),a=i("./src/mobile.startup/util.js");e.exports={parse:function(e){var t,i,r=e.thumbnail,o=e.pageprops||{displaytitle:mw.html.escape(e.title)},l=e.terms;return(o||l)&&(i=l&&l.label?mw.html.escape(l.label[0]):o.displaytitle),e.wikidataDescription=e.description||void 0,r&&(e.thumbnail.isLandscape=r.width>r.height),e.revisions&&e.revisions[0]&&(t=e.revisions[0],e.lastModified=s.getLastModifiedMessage(new Date(t.timestamp).getTime()/1e3,t.user)),new n(a.extend(e,{id:e.pageid,isMissing:!!e.missing,url:mw.util.getUrl(e.title),displayTitle:i}))}}},"./src/mobile.startup/promisedView.js":function(e,t,i){var n=i("./src/mobile.startup/icons.js"),s=i("./src/mobile.startup/View.js");e.exports=function(e){var t=new s({className:"promised-view"});return t.$el.append(n.spinner().$el),e.then(function(e){t.$el.replaceWith(e.$el),t.$el=e.$el},function(e){e&&e.$el&&(t.$el.replaceWith(e.$el),t.$el=e.$el)}),t}},"./src/mobile.startup/promoCampaign/promoCampaign.js":function(e,t){e.exports=function(e,t,i,n,s,a){var r,o,l={};for(r in t)o=t[r],l[o]="mobile-frontend-".concat(i,"-ineligible-").concat(o);function c(){return n}function u(e){if(!(e in t))throw new Error("Action '".concat(e,"' not found in 'actions' object. Please add this to\n\t\t\t\tthe object when creating a campaign with promoCampaign.js if you believe\n\t\t\t\tthis is a valid action."))}return{showIfEligible:function(t){(function(e){return u(e),c()&&s&&null===a.get(l[e])})(t)&&e(t)},makeActionIneligible:function(e){return u(e),a.set(l[e],"~")},makeAllActionsIneligible:function(){var e,i;for(e in t)i=t[e],this.makeActionIneligible(i)},isCampaignActive:c}}},"./src/mobile.startup/search/SearchGateway.js":function(e,t,i){var n=i("./src/mobile.startup/page/pageJSONParser.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/extendSearchParams.js");function r(e){this.api=e,this.searchCache={},this.generator=mw.config.get("wgMFSearchGenerator")}r.prototype={searchNamespace:0,getApiData:function(e){var t=this.generator.prefix,i=a("search",{generator:this.generator.name});return i.redirects="",i["g"+t+"search"]=e,i["g"+t+"namespace"]=this.searchNamespace,i["g"+t+"limit"]=15,i.pilimit&&(i.pilimit=15,i.pithumbsize=mw.config.get("wgMFThumbnailSizes").tiny),i},_createSearchRegEx:function(e){return e=e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),new RegExp("^("+e+")","ig")},_highlightSearchTerm:function(e,t){return e=s.parseHTML("<span>").text(e).html(),t=s.parseHTML("<span>").text(t).html(),e.replace(this._createSearchRegEx(t),"<strong>$1</strong>")},_getPage:function(e,t){var i=n.parse(t);return i.displayTitle=this._highlightSearchTerm(t.displaytext?t.displaytext:i.title,e),i.index=t.index,i},_processData:function(e,t){var i=this,n=[];return t.query&&(n=t.query.pages||{},(n=Object.keys(n).map(function(t){return i._getPage(e,n[t])})).sort(function(e,t){return e.index<t.index?-1:1})),n},search:function(e){var t,i,n=this;return this.isCached(e)||(i=(t=this.api.get(this.getApiData(e))).then(function(t){return{query:e,results:n._processData(e,t)}},function(){n.searchCache[e]=void 0}),this.searchCache[e]=i.promise({abort:function(){t.abort()}})),this.searchCache[e]},isCached:function(e){return Boolean(this.searchCache[e])}},e.exports=r},"./src/mobile.startup/time.js":function(e,t,i){var n=["seconds","minutes","hours","days","months","years"],s=i("./src/mobile.startup/util.js"),a=[1,60,3600,86400,2592e3,31536e3];function r(e){for(var t=0;t<a.length&&e>a[t+1];)++t;return{value:Math.round(e/a[t]),unit:n[t]}}function o(e){return r(Math.round((new Date).getTime()/1e3)-e)}function l(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,i,n){var a,r,c=[];return i=i||"unknown",l(a=o(e))?c.push("mobile-frontend-last-modified-with-user-just-now",i,t):c.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[a.unit],i,t,mw.language.convertNumber(a.value)),c.push(n||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),r=mw.message.apply(this,c).parse(),n?r:s.parseHTML("<div>").html(r).text()},getRegistrationMessage:function(e,t){var i,n=[];return t=t||"unknown",l(i=o(parseInt(e,10)))?n.push("mobile-frontend-joined-just-now",t):n.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[i.unit],t,mw.language.convertNumber(i.value)),mw.message.apply(this,n).parse()},timeAgo:r,getTimeAgoDelta:o,isNow:l,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},"./src/mobile.startup/toast.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s="mobileFrontend/toast";function a(){mw.requestIdleCallback(this._showPending.bind(this))}a.prototype.show=function(e,t){"string"==typeof t&&(mw.log.warn("The use of the cssClass parameter of Toast.show is deprecated, please convert it to an options object."),t={type:t}),t=n.extend({tag:"toast"},t),this.notification=mw.notify(e,t)},a.prototype.hide=function(){void 0!==this.notification&&this.notification.then(function(e){e.close()})},a.prototype.showOnPageReload=function(e,t){mw.storage.get(s)?mw.log.warn("A pending toast message already exits. The page should have been reloaded by now."):mw.storage.set(s,JSON.stringify({content:e,options:t}))},a.prototype._showPending=function(){var e=mw.storage.get(s);e&&(e=JSON.parse(e),this.show(e.content,e.options),mw.storage.remove(s))},e.exports=new a},"./src/mobile.startup/util.js":function(e,t){e.exports={saveButtonMessage:function(){return mw.config.get("wgEditSubmitButtonLabelPublish")?mw.msg("mobile-frontend-editor-publish"):mw.msg("mobile-frontend-editor-save")},Promise:{all:function(e){return $.when.apply($,e)}},escapeSelector:function(e){return $.escapeSelector(e)},grep:function(){return $.grep.apply($,arguments)},docReady:function(e){return $(e)},Deferred:function(){return $.Deferred()},getDocument:function(){return $(document.documentElement)},getWindow:function(){return $(window)},parseHTML:function(e,t){return t=t||document,$($.parseHTML(e,t))},isNumeric:function(){return $.isNumeric.apply($,arguments)},extend:function(){return $.extend.apply($,arguments)},escapeHash:function(e){return e.replace(/(:|\.)/g,"\\$1")},isModifiedEvent:function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},repeatEvent:function(e,t,i,n){return e.on(i,function(e){return t.emit(i,e)},n)},template:function(e){return{getSource:function(){return e},render:function(t,i){var n={};return Object.keys(i||{}).forEach(function(e){n[e]=i[e].getSource()}),Mustache.render(e.trim(),t,n)}}}}},"./src/mobile.startup/watchstar/Watchstar.js":function(e,t,i){var n=i("./src/mobile.startup/View.js"),s=i("./src/mobile.startup/watchstar/WatchstarGateway.js"),a=i("./src/mobile.startup/icons.js"),r=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/mfExtend.js"),l=i("./src/mobile.startup/toast.js"),c=i("./src/mobile.startup/CtaDrawer.js");function u(e){n.call(this,r.extend(!0,{className:a.watchIcon().getClassName(),events:{click:"onStatusToggle"}},e))}o(u,n,{defaults:{page:void 0,funnel:"unknown"},ctaDrawerOptions:{content:mw.msg("mobile-frontend-watchlist-cta"),queryParams:{warning:"mobile-frontend-watchlist-purpose",campaign:"mobile_watchPageActionCta",returntoquery:"article_action=watch"},signupQueryParams:{warning:"mobile-frontend-watchlist-signup-action"}},initialize:function(e){var t=n.prototype.initialize;this._watched=e.isWatched,this.gateway=new s(e.api),t.call(this,e)},preRender:function(){this.options.tooltip=this._watched?mw.msg("unwatch"):mw.msg("watch")},postRender:function(){var e=a.watchIcon().getGlyphClassName(),t=a.watchedIcon().getGlyphClassName()+" watched";this.$el.text(this.options.tooltip),!mw.user.isAnon()&&this._watched?this.$el.addClass(t).removeClass(e):this.$el.addClass(e).removeClass(t),this.$el.removeClass("hidden")},onStatusToggleAnon:function(){this.drawer||(this.drawer=new c(this.ctaDrawerOptions)),this.drawer.show()},onStatusToggleUser:function(){var e,t=this,i=this.gateway,n=this.options.page,s=!this._watched;function a(){clearInterval(e)}e=setInterval(function(){l.show(mw.msg("mobile-frontend-watchlist-please-wait"))},1e3),i.postStatusesByTitle([n.getTitle()],s).then(function(){a(),t._watched=s,s?(t.render(),t.emit("watch"),l.show(mw.msg("mobile-frontend-watchlist-add",n.title))):(t.emit("unwatch"),t.render(),l.show(mw.msg("mobile-frontend-watchlist-removed",n.title)))},function(){a(),l.show(mw.msg("mobile-frontend-watchlist-error"),{type:"error"})})},onStatusToggle:function(e){e.preventDefault(),mw.user.isAnon()?this.onStatusToggleAnon.apply(this,arguments):this.onStatusToggleUser.apply(this,arguments)}}),e.exports=u},"./src/mobile.startup/watchstar/WatchstarGateway.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/actionParams.js");function a(e){this.api=e}a.prototype={getStatuses:function(e,t){return n.Promise.all([this.getStatusesByID(e),this.getStatusesByTitle(t)]).then(function(){return n.extend.apply(n,arguments)})},getStatusesByID:function(e){var t=this;return e.length?this.api.get({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:e}).then(function(e){return t._unmarshalGetResponse(e)}):n.Deferred().resolve({})},getStatusesByTitle:function(e){var t=this;return e.length?this.api.get(s({prop:"info",inprop:"watched",titles:e})).then(function(e){return t._unmarshalGetResponse(e)}):n.Deferred().resolve({})},postStatusesByTitle:function(e,t){var i={action:"watch",titles:e};return t||(i.unwatch=!t),this.api.postWithToken("watch",i)},_unmarshalGetResponse:function(e){return(e&&e.query&&e.query.pages||[]).reduce(function(e,t){return e[t.title]=t.watched,e},{})}},e.exports=a},"./src/mobile.startup/watchstar/WatchstarPageList.js":function(e,t,i){var n=i("./src/mobile.startup/PageList.js"),s=i("./src/mobile.startup/watchstar/Watchstar.js"),a=mw.user,r=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/Page.js"),l=i("./src/mobile.startup/mfExtend.js"),c=i("./src/mobile.startup/watchstar/WatchstarGateway.js");function u(e){this.wsGateway=new c(e.api),n.apply(this,arguments)}l(u,n,{postRender:function(){var e,t,i=this,s=[],a=[];return n.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=this.parsePagesFromItems(e),Object.keys(t).forEach(function(e){var i=t[e];i&&"0"!==i?s.push(i):a.push(e)}),this.getPages(s,a).then(function(t){i.renderItems(e,t)})},queryUnitializedItems:function(){return this.$el.find("li:not(.with-watchstar)")},getPages:function(e,t){return a.isAnon()?r.Deferred().resolve({}):this.wsGateway.getStatuses(e,t)},parsePagesFromItems:function(e){var t=this,i={};return e.each(function(e,n){var s=t.$el.find(n);i[s.attr("title")]=s.data("id")}),i},renderItems:function(e,t){var i=this;a.isAnon()||e.each(function(e,n){var s=i.$el.find(n),a=new o({sections:[],title:s.attr("title"),id:s.data("id")}),r=i.parseHTML("<div>").appendTo(s),l=t[a.getTitle()];i._appendWatchstar(r,a,l),s.addClass("with-watchstar")})},_appendWatchstar:function(e,t,i){var n=new s({api:this.options.api,funnel:this.options.funnel,isAnon:a.isAnon(),isWatched:i,page:t,el:e});return r.repeatEvent(n,this,"watch"),r.repeatEvent(n,this,"unwatch"),n}}),e.exports=u}}]);
//# sourceMappingURL=mobile.common.js.map.json