(self.webpackChunkmfModules=self.webpackChunkmfModules||[]).push([[569],{"./src/mobile.startup/Anchor.js":(t,e,s)=>{const i=s("./src/mobile.startup/View.js"),n=s("./src/mobile.startup/util.js");t.exports=class extends i{get isTemplateMode(){return!0}get defaults(){return{progressive:void 0,destructive:void 0,additionalClassNames:"",href:void 0,label:void 0}}get template(){return n.template('\n<a {{#href}}href="{{href}}"{{/href}} class="mw-mf-anchor\n\t{{#progressive}} mw-mf-anchor-progressive{{/progressive}}\n\t{{#destructive}} mw-mf-anchor-destructive{{/destructive}}\n\t {{additionalClassNames}}">{{label}}</a>\n\t')}}},"./src/mobile.startup/Browser.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js");let n;function a(t){const e=function(){const s=this["__cache"+e.cacheId]||(this["__cache"+e.cacheId]={}),i=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(s,i)?s[i]:s[i]=t.apply(this,arguments)};return e.cacheId=Date.now().toString()+Math.random().toString(),e}class r{constructor(t,e){this.userAgent=t,this.$el=e,this.isIos=a((function(t){const e=this.userAgent,s=/ipad|iphone|ipod/i.test(e);if(!s||!t)return s;switch(t){case 8:return/OS 8_/.test(e)||/Version\/8/.test(e);case 4:return/OS 4_/.test(e);case 5:return/OS 5_/.test(e);default:return!1}})),this.isWideScreen=a((()=>{const t=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=t})),this.supportsTouchEvents=a((()=>"ontouchstart"in window))}static getSingleton(){let t;return n||(t=i.getDocument(),n=new r(window.navigator.userAgent,t)),n}}t.exports=r},"./src/mobile.startup/Button.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/View.js"),a=s("./src/mobile.startup/IconButton.js");t.exports=class extends n{constructor(t){super(t)}get isTemplateMode(){return!0}get defaults(){return{tagName:"a",disabled:!1,block:void 0,progressive:void 0,destructive:void 0,quiet:void 0,additionalClassNames:"",href:void 0,label:void 0,size:"medium"}}get template(){return i.template("{{{_buttonHTML}}}")}preRender(){let t="default";this.options.progressive?t="progressive":this.options.destructive&&(t="destructive");let e=this.options.quiet?"quiet":"normal";(this.options.progressive||this.options.destructive)&&(e="primary"),this.options.block&&(this.options.additionalClassNames+=" mf-button-block");const s=i.extend({weight:e,action:t,isIconOnly:!1,icon:null},this.options);this._button=new a(s),this.options._buttonHTML=this._button.$el.get(0).outerHTML}}},"./src/mobile.startup/CtaDrawer.js":(t,e,s)=>{const i=s("./src/mobile.startup/Drawer.js"),n=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/Button.js"),r=s("./src/mobile.startup/Anchor.js");function o(t={}){const e=l(t.queryParams,t.returnTo);return new i(n.extend({children:[n.parseHTML("<p>").text(t.content),new a(n.extend({progressive:!0,href:mw.util.getUrl("Special:UserLogin",e),label:mw.msg("mobile-frontend-watchlist-cta-button-login")},t.progressiveButton)).$el,n.parseHTML("<div>").addClass("cta-drawer__anchors").append(new r(n.extend({href:mw.util.getUrl("Special:UserLogin",c(e,t.signupQueryParams)),progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")},t.actionAnchor)).$el)]},t))}function l(t,e){return n.extend({returnto:e||mw.config.get("wgPageName")},t)}function c(){return[].push.call(arguments,{type:"signup"}),n.extend.apply(n,arguments)}o.prototype.test={redirectParams:l,signUpParams:c},t.exports=o},"./src/mobile.startup/Drawer.js":(t,e,s)=>{const i=s("./src/mobile.startup/View.js"),n=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/IconButton.js");t.exports=class extends i{constructor(t){super(n.extend({onBeforeHide:()=>{},showCollapseIcon:!0},t,{events:n.extend({"click .drawer-container__mask":()=>{this.hide()},"click .cancel":t=>{t.preventDefault(),this.hide()},click(t){t.stopPropagation()}},t.events)}))}initialize(t){this.drawerClassName=t.className||"",t.className="drawer-container",this.collapseIcon=new a({icon:"expand",additionalClassNames:"cancel",label:mw.msg("mobile-frontend-drawer-arrow-label")}),this.minHideDelay=100,super.initialize(t)}show(){const t=n.Deferred();this.$el.prepend(this.$mask),this.$el.width();const e=this.$el.find(".drawer");return this.$mask.addClass("drawer-container__mask--visible"),e.hasClass("visible")?t.resolve():(e.addClass("visible"),mw.hook("mobileFrontend.loadLazyImages").fire(this.$el),this.options.onShow&&this.options.onShow(t),requestAnimationFrame((()=>t.resolve()))),t.promise()}hide(){this.$el.find(".drawer").removeClass("visible"),this.$mask.removeClass("drawer-container__mask--visible"),setTimeout((()=>{this.$mask.detach()}),100),requestAnimationFrame((()=>{this.options.onBeforeHide(this)}))}postRender(){this.$mask=n.parseHTML("<div>").addClass("drawer-container__mask");const t=this.options,e=n.parseHTML("<div>").addClass(`drawer drawer-container__drawer position-fixed ${this.drawerClassName}`.trim());t.showCollapseIcon&&e.prepend(this.collapseIcon.$el),t.children&&e.append(t.children),this.$el.append(e)}}},"./src/mobile.startup/Icon.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/View.js");t.exports=class extends n{constructor(t){super(t)}preRender(){this.options._iconClasses=this.getIconClasses()}getRotationClass(){let t="";if(this.options.rotation)switch(this.options.rotation){case-180:case 180:t="mf-icon-rotate-flip";break;case-90:t="mf-icon-rotate-anti-clockwise";break;case 90:t="mf-icon-rotate-clockwise";break;case 0:break;default:throw new Error("Bad value for rotation given. Must be ±90, 0 or ±180.")}return t}getIconClasses(){const t=this.options.base,e=this.options.icon,s=this.options.isSmall,i=this.getRotationClass(),n=this.options.additionalClassNames;let a=t+" ";return e&&(a+=this.getGlyphClassName()+" "),s&&(a+="mf-icon--small "),n&&(a+=n+" "),a+i}get isTemplateMode(){return!0}get defaults(){return{base:"mf-icon",glyphPrefix:null,icon:"",rotation:0,isSmall:!1,additionalClassNames:null}}getClassName(){return this.$el.attr("class")}getGlyphClassName(){return this.options.glyphPrefix?"mf-icon-"+this.options.glyphPrefix+"-"+this.options.icon:"mf-icon-"+this.options.icon}get template(){return i.template('<span class="{{_iconClasses}}"> </span>')}}},"./src/mobile.startup/IconButton.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/View.js"),a=s("./src/mobile.startup/Icon.js");t.exports=class extends n{constructor(t){t.href&&(t.tagName="a"),"button"===t.tagName&&(t.isTypeButton=!0),super(t)}preRender(){this.options._buttonClasses=this.getButtonClasses(),this.options._iconHTML="",this.options.icon&&(this._icon=new a({base:this.options.base,glyphPrefix:this.options.glyphPrefix,icon:this.options.icon,rotation:this.options.rotation,isSmall:this.options.isSmall}),this.options._iconHTML=this._icon.$el.get(0).outerHTML)}getButtonClasses(){const t=this.options.additionalClassNames,e=this.options.size,s=this.options.weight,i=this.options.action,n=this.options.isIconOnly;let a="cdx-button ";return"button"!==this.options.tagName&&(a+="cdx-button--fake-button cdx-button--fake-button--enabled "),e&&(a+=`cdx-button--size-${e} `),s&&(a+=`cdx-button--weight-${s} `),i&&(a+=`cdx-button--action-${i} `),n&&(a+="cdx-button--icon-only "),a+t}get isTemplateMode(){return!0}get defaults(){return{tagName:"button",href:void 0,additionalClassNames:"",title:"",size:"large",weight:"quiet",action:"",isIconOnly:!0,disabled:!1,base:"mf-icon",icon:"",rotation:0,isSmall:!1}}getClassName(){return this.$el.attr("class")}getIcon(){return this._icon}get template(){return i.template('\n\t\t<{{tagName}}\n\t\t\ttype="button"\n\t\t\t{{#isTypeButton}}{{#disabled}}disabled{{/disabled}}{{/isTypeButton}}\n\t\t\tclass="{{_buttonClasses}}"\n\t\t\t{{#id}}id="{{id}}"{{/id}}\n\t\t\t{{#href}}href="{{href}}"{{/href}}\n\t\t\t{{#title}}title="{{title}}"{{/title}}>\n\t\t\t\t{{{_iconHTML}}}\n\t\t\t\t<span>{{label}}</span>\n\t\t</{{tagName}}>\n\t\t')}}},"./src/mobile.startup/Overlay.js":(t,e,s)=>{const i=s("./src/mobile.startup/View.js"),n=s("./src/mobile.startup/headers.js").header,a=s("./src/mobile.startup/Anchor.js"),r=s("./src/mobile.startup/util.js"),o=s("./src/mobile.startup/Browser.js").getSingleton();class l extends i{constructor(t){super(r.extend(!0,{headerChrome:!1,className:"overlay"},t,{events:r.extend({"click .cancel, .confirm, .initial-header .back":"onExitClick",click:t=>t.stopPropagation()},t.events)}))}get template(){return r.template('\n{{^noHeader}}\n<div class="overlay-header-container header-container{{#headerChrome}}\n\theader-chrome{{/headerChrome}} position-fixed">\n</div>\n{{/noHeader}}\n<div class="overlay-content">\n\t{{>content}}\n</div>\n<div class="overlay-footer-container position-fixed"></div>\n\t')}get isIos(){return o.isIos()}set hideTimeout(t){this._hideTimeout=t}get hideTimeout(){return this._hideTimeout}showSpinner(){this.$el.find(".spinner").removeClass("hidden")}hideSpinner(){this.$el.find(".spinner").addClass("hidden")}postRender(){const t=this.options.footerAnchor;this.$overlayContent=this.$el.find(".overlay-content"),this.isIos&&this.$el.addClass("overlay-ios"),t&&this.$el.find(".overlay-footer-container").append(new a(t).$el);const e=this.options.headers||[n(this.options.heading,this.options.headerActions)];this.$el.find(".overlay-header-container").append(e)}onExitClick(t){const e=()=>{this.hide()};t.preventDefault(),t.stopPropagation(),this.options.onBeforeExit?this.options.onBeforeExit(e,(()=>{})):e()}show(){const t=r.getDocument();this.scrollTop=window.pageYOffset,t.addClass("overlay-enabled"),window.scrollTo(0,1),this.$el.addClass("visible"),null!==this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}hide(){return r.getDocument().removeClass("overlay-enabled"),window.scrollTo(window.pageXOffset,this.scrollTop),this.hideTimeout=setTimeout((()=>{this.$el.detach(),this.hideTimeout=null}),0),this.emit("hide"),!0}showHidden(t){this.$el.find(".hideable").addClass("hidden"),this.$el.find(t).removeClass("hidden")}}l.make=function(t,e){const s=new l(t);return s.$el.find(".overlay-content").append(e.$el),s},t.exports=l},"./src/mobile.startup/OverlayManager.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js");let n=null;const a="MobileFrontend OverlayManager was here!";class r{constructor(t,e){t.on("route",this._checkRoute.bind(this)),this.router=t,this.entries={},this.stack=[],this.hideCurrent=!0,this.container=e}_onHideOverlayOutsideOverlayManager(){if(!this.stack.length)return;const t=this.stack[0].route,e="string"==typeof t,s=this.router.getPath(),i=e&&s===t||s.match(t);this.hideCurrent=!1,i&&this.router.back()}_attachOverlay(t){t.$el.parents().length||this.container.appendChild(t.$el[0])}_show(t){window.history.replaceState(a,null,window.location.href),t.once("_om_hide",(()=>this._onHideOverlayOutsideOverlayManager())),this._attachOverlay(t),t.show()}_hideOverlay(t,e){let s;function i(){s=!0,t.hide()}return t.off("_om_hide"),t.options&&t.options.onBeforeExit?t.options.onBeforeExit(i,e):i(),s||t.once("_om_hide",(()=>this._onHideOverlayOutsideOverlayManager())),s}_processMatch(t){if(t)if(t.overlay)this._show(t.overlay);else{const e=t.factoryResult;e&&(t.overlay=e,o(t.overlay),this._show(e))}}_checkRoute(t){const e=this.stack[0];if(e||(this.scrollTop=window.pageYOffset),e&&void 0!==e.overlay&&this.hideCurrent&&!this._hideOverlay(e.overlay,(()=>{t.preventDefault()})))return;const s=Object.keys(this.entries).reduce(((e,s)=>e||this._matchRoute(t.path,this.entries[s])),null);s||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(s)}_matchRoute(t,e){let s,i,n;const a=this.stack[1];"string"==typeof e.route?(s=e.route===t,i=[]):(n=t.match(e.route),s=!!n,i=s?n.slice(1):[]);const r=()=>({path:t,route:e.route,factoryResult:e.factory.apply(this,i)});if(s){if(a&&a.path===t)return this.stack.shift(),a;{const t=r();return this.stack[0]&&t.path===this.stack[0].path?this.stack[0]=t:this.stack.unshift(t),t}}return null}add(t,e){const s={route:t,factory:e};this.entries[t]=s,i.docReady((()=>this._processMatch(this._matchRoute(this.router.getPath(),s))))}replaceCurrent(t){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");const e=this.stack[0].overlay;e&&this._hideOverlay(e),this.stack[0].overlay=t,o(t),this._show(t)}static getSingleton(){if(!n){const t=require("mediawiki.router"),e=document.createElement("div"),s=t.getPath(),i=window.history.state;e.className="mw-overlays-container",document.body.appendChild(e),s&&i!==a&&(window.history.replaceState(null,null,"#"),window.history.pushState(a,null,`#${s}`)),n=new r(t,e)}return n}}function o(t){t.on("hide",(()=>t.emit("_om_hide")))}r.test={MANAGED_STATE:a,__clearCache:()=>{n=null}},t.exports=r},"./src/mobile.startup/Page.js":(t,e,s)=>{const i=mw.html,n=s("./src/mobile.startup/util.js");t.exports=class{constructor(t){const e=t.title||"";n.extend(this,{id:t.id||0,title:e,relevantTitle:t.relevantTitle||e,titleObj:t.titleObj,displayTitle:t.displayTitle||i.escape(e),namespaceNumber:t.namespaceNumber||0,protection:t.protection,url:t.url||mw.util.getUrl(e),wikidataDescription:t.wikidataDescription,_isMainPage:t.isMainPage||!1,isMissing:void 0!==t.isMissing?t.isMissing:0===t.id,anchor:t.anchor,revId:t.revId,_isWatched:t.isWatched,thumbnail:!!Object.prototype.hasOwnProperty.call(t,"thumbnail")&&t.thumbnail}),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}getDisplayTitle(){return this.displayTitle}inNamespace(t){return this.namespaceNumber===mw.config.get("wgNamespaceIds")[t]}isWikiText(){return"wikitext"===mw.config.get("wgPageContentModel")}isVEAvailable(){return!!mw.config.get("wgVisualEditorConfig")&&!mw.config.get("wgVisualEditorDisabledByHook")&&this.isWikiText()}isVEVisualAvailable(){return!!this.isVEAvailable()&&-1!==(mw.config.get("wgVisualEditorConfig").namespaces||[]).indexOf(mw.config.get("wgNamespaceNumber"))}isVESourceAvailable(){return this.isVEAvailable()&&mw.config.get("wgMFEnableVEWikitextEditor")}isMainPage(){return this._isMainPage}isWatched(){return this._isWatched}getRevisionId(){return this.revId}getTitle(){return this.title}getNamespaceId(){let t;const e=this.title.split(":");return t=e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0,t}}},"./src/mobile.startup/PageHTMLParser.js":(t,e,s)=>{const i=s("./src/mobile.startup/Thumbnail.js"),n=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),a=["noviewer","metadata"],r=a.map((t=>`:not(.${t})`)).join(""),o=["a.image","a.thumbimage, a.mw-file-description"].map((t=>`${t}${r}`)).join(",");class l{constructor(t){this.$el=t,this.$headings=this.$el.find(n)}findSectionHeadingByIndex(t){return t<1?$([]):this.$headings.filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(t-1)}findChildInSectionLead(t,e){let s,i;const a=n;function r(t){return t.find(e).addBack()}if(0===t){const t=this.getLeadSectionElement();if(t&&t.length){const s=t.find('section[data-mw-section-id="0"]');return s.length?r(s.children(e)):r(t.children(e))}return s=this.findSectionHeadingByIndex(1),s.length?r(s.prevAll(e)):this.$el.find(e)}if(s=this.findSectionHeadingByIndex(t),s.hasClass("section-heading")){const t=s.next();return i=t.find(a).eq(0),i.length?r(i.prevAll(e)):r(t.children(e))}return i=s.eq(0).nextAll(a).eq(0),s.nextUntil(i,e)}getLeadSectionElement(){const t=this.$el.find(".mf-section-0");return t.length?t:null}getThumbnail(t){const e="."+a.join(",."),s=t.find(".lazy-image-placeholder"),n=t.attr("href"),r=n&&new URL(n,location.href),o=r&&r.searchParams.get("title"),l=r&&r.pathname.match(/[^/]+$/);let c=0===t.parents(e).length&&0===t.find(e).length;return s.length&&c&&(c=!new RegExp("\\b("+a.join("|")+")\\b").test(s.data("class"))),c&&(null!==o||l)?new i({el:t,filename:mw.util.percentDecodeFragment(null!==o?o:l[0])}):null}getThumbnails(t){const e=[];return(t=t||this.$el).find(o).each(((s,i)=>{const n=t.find(i),a=this.getThumbnail(n);a&&e.push(a)})),e}getRedLinks(){return this.$el.find(".new")}getLanguages(t){const e=e=>{const s=e.textContent,i=e.getAttribute("data-language-local-name")||s,n=e.getAttribute("data-title")||t;return{lang:e.getAttribute("hreflang"),autonym:s,langname:i,title:n,url:e.getAttribute("href")}};return{languages:Array.prototype.map.call(document.querySelectorAll("#p-lang .interlanguage-link a"),e),variants:Array.prototype.map.call(document.querySelectorAll("#p-variants li a"),e)}}}l.HEADING_SELECTOR=n,l.THUMB_SELECTOR=o,t.exports=l},"./src/mobile.startup/PageList.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/View.js"),a=s("./src/mobile.startup/Browser.js").getSingleton();t.exports=class extends n{constructor(t){super(t)}get defaults(){return{pages:[]}}renderPageImages(){setTimeout((()=>{this.$el.find(".list-thumb").each(((t,e)=>{const s=this.$el.find(e).data("style");this.$el.find(e).attr("style",s)}))}),a.isWideScreen()?0:1e3)}postRender(){this.renderPageImages()}get template(){return i.template('\n<ul class="mw-mf-page-list thumbs actionable">\n\t{{#pages}}\n\t\t{{>item}}\n\t{{/pages}}\n</ul>\n\t')}get templatePartials(){return{item:i.template('\n\t<li title="{{title}}" data-id="{{id}}" class="page-summary">\n\t<a href="{{url}}" class="title {{#isMissing}}new{{/isMissing}}"\n\t\t{{#anchor}}name="{{anchor}}"{{/anchor}}\n\t\tdata-title="{{title}}">\n\t\t<div class="list-thumb\n\t\t{{#thumbnail.isLandscape}}list-thumb-y{{/thumbnail.isLandscape}}\n\t\t{{^thumbnail.isLandscape}}list-thumb-x{{/thumbnail.isLandscape}}"\n\t\t{{#thumbnail}}data-style="background-image: url( {{thumbnail.source}} )"{{/thumbnail}}>\n\t\t{{^thumbnail}}<span class="mf-icon-image"></span>{{/thumbnail}}\n\t\t</div>\n\t\t<h3>{{{displayTitle}}}</h3>\n\t\t{{#wikidataDescription}}\n\t\t<div class="wikidata-description">{{wikidataDescription}}</div>\n\t\t{{/wikidataDescription}}\n\t</a>\n\t</li>\n\t\t')}}}},"./src/mobile.startup/Skin.js":(t,e,s)=>{const i=s("./src/mobile.startup/Browser.js").getSingleton(),n=s("./src/mobile.startup/View.js"),a=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/currentPage.js"),o=s("./src/mobile.startup/eventBusSingleton.js");let l;class c extends n{constructor(t){const e=a.extend({isBorderBox:!1},t);super(e),this.page=e.page,this.name=e.name,this.eventBus=e.eventBus}get defaults(){return{page:void 0}}postRender(){const t=this.$el;i.supportsTouchEvents()&&t.addClass("touch-events"),this.$el.find("#mw-mf-page-center").on("click",(t=>{this.emit("click",t)}))}getLicenseLinks(){const t=mw.message("mobile-frontend-license-links"),e=t.exists()&&t.text();return"qqx"===mw.config.get("wgUserLanguage")||e?t.parseDom():this.$el.find("#footer-info-copyright a").clone()}getLicenseMsg(){const t=this.getLicenseLinks();let e;if(t.length){const s=mw.language.convertNumber(t.filter("a").length);if(this.$el.find("#footer-places-terms-use").length>0){const i=mw.message("mobile-frontend-editor-terms-link",this.$el.find("#footer-places-terms-use a").attr("href")).parseDom();e=mw.message("mobile-frontend-editor-licensing-with-terms",i,t,s).parse()}else e=mw.message("mobile-frontend-editor-licensing",t,s).parse()}return e}}c.getSingleton=function(){return l||(l=new c({el:"body",page:r(),eventBus:o})),l},t.exports=c},"./src/mobile.startup/Thumbnail.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/View.js");t.exports=class extends n{constructor(t){super(i.extend({isBorderBox:!1},t))}get defaults(){return{filename:void 0}}postRender(){this.options.description=this.$el.siblings(".thumbcaption, figcaption").prop("innerText")||""}getDescription(){return this.options.description}getFileName(){return this.options.filename}}},"./src/mobile.startup/View.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=/^(\S+)\s*(.*)$/;let a=0;class r{constructor(t){this.initialize(t)}get template(){}get templatePartials(){return{}}get defaults(){return{}}get tagName(){return"div"}get isTemplateMode(){return!1}initialize(t){OO.EventEmitter.call(this),t=i.extend({},this.defaults,t),this.options=t,this.cid=function(t){const e=(++a).toString();return t?t+e:e}("view"),t.el?this.$el=$(t.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize(t):i.docReady((()=>{this.$el=$(t.el),this._postInitialize(t)}))}_postInitialize(t){this.$el.addClass(t.className),!1!==t.isBorderBox&&this.$el.addClass("view-border-box"),this.render({})}preRender(){}postRender(){}render(t){let e,s;return i.extend(this.options,t),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(s=this.template.render(this.options,this.templatePartials),this.isTemplateMode?(e=$(s),this.$el.replaceWith(e),this.$el=e):this.$el.html(s)),this.postRender(),this.delegateEvents(),this}delegateEvents(t){let e,s,i;if(t=t||this.options.events)for(s in this.undelegateEvents(),t)i=t[s],"function"!=typeof i&&(i=this[t[s]]),i&&(e=s.match(n),this.delegate(e[1],e[2],i.bind(this)))}delegate(t,e,s){this.$el.on(t+".delegateEvents"+this.cid,e,s)}undelegateEvents(){this.$el&&this.$el.off(".delegateEvents"+this.cid)}undelegate(t,e,s){this.$el.off(t+".delegateEvents"+this.cid,e,s)}parseHTML(t){return i.parseHTML(t,document)}static make(t={},e=[]){const s=new r(t);return e.forEach((t=>s.append(t))),s}}OO.mixinClass(r,OO.EventEmitter),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach((t=>{r.prototype[t]=function(){return this.$el[t].apply(this.$el,arguments),this}})),t.exports=r},"./src/mobile.startup/actionParams.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n={action:"query",formatversion:2};t.exports=function(t){const e=mw.config.get("wgMFScriptPath");return i.extend({},n,{origin:e?"*":void 0},t)}},"./src/mobile.startup/amcOutreach/AmcEnableForm.js":(t,e,s)=>{const i=s("./src/mobile.startup/Button.js"),n=s("./src/mobile.startup/util.js"),a=s("./src/mobile.startup/View.js");t.exports=class extends a{constructor(t){super(t)}get isTemplateMode(){return!0}get template(){return n.template('\n<form class="amc-enable-form" action="{{postUrl}}" method="POST">\n\t{{#fields}}\n\t\t<input type="hidden" name="{{name}}" value="{{value}}">\n\t{{/fields}}\n</form>\n\t\t')}postRender(){this.$el.append(new i({tagName:"button",progressive:!0,label:this.options.buttonLabel}).$el)}}},"./src/mobile.startup/amcOutreach/amcOutreach.js":(t,e,s)=>{const i=s("./src/mobile.startup/showOnPageReload.js"),n=s("./src/mobile.startup/promoCampaign/promoCampaign.js"),a=s("./src/mobile.startup/amcOutreach/amcOutreachDrawer.js"),r={onDesktopLink:"onDesktopLink",onHistoryLink:"onHistoryLink",onTalkLink:"onTalkLink"};let o;t.exports={loadCampaign:()=>o||(o=n(((t,e,s,n)=>a(t,o,mw.message,mw.util,i,mw.user.tokens.get("csrfToken"),e,s,n)),r,"amc-outreach",!!mw.config.get("wgMFAmcOutreachActive"),!!mw.config.get("wgMFAmcOutreachUserEligible"),mw.storage),o),ACTIONS:r}},"./src/mobile.startup/amcOutreach/amcOutreachDrawer.js":(t,e,s)=>{const i=s("./src/mobile.startup/Drawer.js"),n=s("./src/mobile.startup/Anchor.js"),a=s("./src/mobile.startup/util.js"),r=s("./src/mobile.startup/amcOutreach/AmcEnableForm.js");t.exports=function(t,e,s,o,l,c,d,h,u){return new i({className:"amc-outreach-drawer",children:[a.parseHTML("<div>").addClass("amc-outreach-image"),a.parseHTML("<p>").append(a.parseHTML("<strong>").text(s("mobile-frontend-amc-outreach-intro").text())),a.parseHTML("<p>").text(s("mobile-frontend-amc-outreach-description").text()),new r({postUrl:o.getUrl("Special:MobileOptions",{returnto:h,returntoquery:u||""}),fields:[{name:"updateSingleOption",value:"enableAMC"},{name:"enableAMC",value:"1"},{name:"token",value:c}],buttonLabel:s("mobile-frontend-amc-outreach-enable").text(),events:{submit:()=>{e.makeActionIneligible(t),l.showOnPageReload(s("mobile-frontend-amc-outreach-enabled-message").text())}}}).$el,new n({href:"#",additionalClassNames:"cancel",progressive:!0,label:s("mobile-frontend-amc-outreach-no-thanks").text()}).$el],onBeforeHide:()=>{e.makeActionIneligible(t),d()}})}},"./src/mobile.startup/currentPage.js":(t,e,s)=>{const i=s("./src/mobile.startup/Page.js");let n;t.exports=function(){if(n)return n;const t=[].concat(mw.config.get("wgRestrictionEdit",[])),e=mw.Title.newFromText(mw.config.get("wgRelevantPageName")),s=mw.Title.newFromText(mw.config.get("wgPageName"));return 0===t.length&&t.push("*"),n=new i({title:s.getPrefixedText(),titleObj:s,relevantTitle:e.getPrefixedText(),protection:{edit:t},revId:mw.config.get("wgRevisionId"),isMainPage:mw.config.get("wgIsMainPage"),isWatched:$("#ca-watch").hasClass("watched"),isMissing:0===mw.config.get("wgArticleId"),id:mw.config.get("wgArticleId"),namespaceNumber:mw.config.get("wgNamespaceNumber")}),n}},"./src/mobile.startup/currentPageHTMLParser.js":(t,e,s)=>{const i=s("./src/mobile.startup/PageHTMLParser.js");let n;t.exports=function(){return n||(n=new i($("#content #bodyContent")),n)}},"./src/mobile.startup/eventBusSingleton.js":t=>{t.exports=new OO.EventEmitter},"./src/mobile.startup/extendSearchParams.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/actionParams.js");t.exports=function(t){const e=mw.config.get("wgMFDisplayWikibaseDescriptions")||{search:!0,watchlist:!0,tagline:!1},s=mw.config.get("wgMFScriptPath");if(!Object.prototype.hasOwnProperty.call(e,t))throw new Error('"'+t+"\" isn't a feature that shows Wikibase descriptions.");const a=Array.prototype.slice.call(arguments,1);a.unshift({prop:[]}),a.push(mw.config.get("wgMFSearchAPIParams"));const r=i.extend.apply({},a);return r.prop=r.prop.concat(mw.config.get("wgMFQueryPropModules")),e[t]&&-1===r.prop.indexOf("description")&&r.prop.push("description"),s&&(r.origin="*"),n(r)}},"./src/mobile.startup/headers.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/Button.js"),a=s("./src/mobile.startup/icons.js");function r(t,e,s,n){const r="string"==typeof t?t:void 0,o={hasActions:e&&e.length,isHidden:!1,heading:r},l=i.template(`\n<div class="overlay-header header ${n||""} hideable">\n\t<ul class="header-cancel">\n\t\t<li></li>\n\t</ul>\n\t{{{heading}}}\n\t{{#hasActions}}\n\t<div class="header-action"></div>\n\t{{/hasActions}}\n</div>\n\t\t`).render(o);s=s||a.cancel();const c=i.parseHTML(l);return c.find("h2 span").addClass("truncated-text"),c.find(".header-cancel li").append(s.$el),void 0===r&&t.$el.insertAfter(c.find(".header-cancel")),e&&e.length&&c.find(".header-action").append(e.map((t=>t.$el))),c[0]}function o(t,e,s,i){return r(t=`<div class="overlay-title"><h2>${t}</h2></div>`,e,s,i)}t.exports={savingHeader:function(t){return o(t,[a.spinner({additionalClassNames:"savespinner loading"})],a.cancel(),"saving-header hidden")},saveHeader:function(t,e){return o(t,[new n({tagName:"button",additionalClassNames:"save submit",disabled:!0,label:i.saveButtonMessage(),size:"large"})],a.back(),e)},formHeader:function(t,e,s,i){return r(t,e,s,i)},header:o}},"./src/mobile.startup/icons.js":(t,e,s)=>{const i="close",n=s("./src/mobile.startup/Icon.js"),a=s("./src/mobile.startup/IconButton.js"),r={CANCEL_GLYPH:i,Icon:n,IconButton:a,back:()=>new r.IconButton({tagName:"button",icon:"previous",additionalClassNames:"back",label:mw.msg("mobile-frontend-overlay-close")}),cancel(t,e={}){const s=t?`${i}-${t}`:`${i}`;return e.additionalClassNames=e.additionalClassNames||"",e.additionalClassNames+=" cancel",new r.IconButton(Object.assign({tagName:"button",icon:s,label:mw.msg("mobile-frontend-overlay-close")},e))},spinner(t={}){void 0===t.additionalClassNames&&(t.additionalClassNames="spinner loading");const e=new r.IconButton(Object.assign({tagName:"span",icon:"spinner",label:mw.msg("mobile-frontend-loading-message")},t));return e.$el.removeClass(),e.$el.addClass(t.additionalClassNames),e.$el.attr("type",""),e.options.isIconOnly&&e.$el.addClass("mf-spinner-icon-element"),e},error:()=>new r.IconButton({icon:"alert-invert",additionalClassNames:"load-fail-msg-icon"}),watch:(t={})=>(t.additionalClassNames=t.additionalClassNames||"",t.additionalClassNames+=" watch-this-article",new r.IconButton(Object.assign({icon:"star-subtle"},t))),watched:(t={})=>(t.additionalClassNames=t.additionalClassNames||"",t.additionalClassNames+=" watch-this-article watched",new r.IconButton(Object.assign({icon:"unStar-progressive"},t)))};t.exports=r},"./src/mobile.startup/lazyImages/lazyImageLoader.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n="lazy-image-placeholder";t.exports={placeholderClass:n,queryPlaceholders:function(t){return Array.prototype.slice.call(t.getElementsByClassName(n))},loadImages:function(e){return i.Promise.all(e.map((e=>t.exports.loadImage(e).promise)))},loadImage:function(t){const e=i.Deferred(),s=t.dataset.width,n=t.dataset.height,a=new Image;return s&&a.setAttribute("width",parseInt(s,10)),n&&a.setAttribute("height",parseInt(n,10)),a.className=t.dataset.class||"",a.alt=t.dataset.alt||"",a.useMap=t.dataset.usemap,a.style.cssText=t.style.cssText||"",a.addEventListener("load",(()=>{a.classList.add("image-lazy-loaded"),t.parentNode&&t.parentNode.replaceChild(a,t),e.resolve("load")}),{once:!0}),a.addEventListener("error",(()=>{t.parentNode&&t.parentNode.replaceChild(a,t),e.resolve("error")}),{once:!0}),a.src=t.dataset.src||"",a.srcset=t.dataset.srcset||"",{promise:e,image:a}},test:{placeholderClass:n}}},"./src/mobile.startup/moduleLoader.js":t=>{t.exports=class{constructor(){this._register={}}require(t){const e=this._register;function s(){if(!Object.hasOwnProperty.call(e,t))throw new Error("MobileFrontend Module not found: "+t);return e[t]}const i=t.split("/");try{const t=require(i[0]);return t[i[1]]?t[i[1]]:s()}catch(t){return s()}}define(t,e){if(Object.hasOwnProperty.call(this._register,t))throw new Error("Module already exists: "+t);return this._register[t]=e,{deprecate:s=>{this.deprecate(s,e,t)}}}deprecate(t,e,s){let i;s&&(i="Use "+s+" instead."),mw.log.deprecate(this._register,t,e,i)}}},"./src/mobile.startup/moduleLoaderSingleton.js":(t,e,s)=>{const i=s("./src/mobile.startup/moduleLoader.js");t.exports=new i},"./src/mobile.startup/page/pageJSONParser.js":(t,e,s)=>{const i=s("./src/mobile.startup/Page.js"),n=s("./src/mobile.startup/util.js");t.exports={parse:function(t){let e;const s=t.thumbnail,a=t.pageprops||{displaytitle:mw.html.escape(t.title)},r=t.terms||t.entityterms;return(a||r)&&(e=r&&r.label?mw.html.escape(r.label[0]):a.displaytitle),t.wikidataDescription=t.description||void 0,s&&(t.thumbnail.isLandscape=s.width>s.height),new i(n.extend(t,{id:t.pageid,isMissing:!!t.missing,url:mw.util.getUrl(t.title),displayTitle:e}))}}},"./src/mobile.startup/promoCampaign/promoCampaign.js":t=>{t.exports=function(t,e,s,i,n,a){const r={};for(const t in e){const i=e[t];r[i]=`mobile-frontend-${s}-ineligible-${i}`}function o(){return i}function l(t){if(!(t in e))throw new Error(`Action '${t}' not found in 'actions' object. Please add this to\n\t\t\t\tthe object when creating a campaign with promoCampaign.js if you believe\n\t\t\t\tthis is a valid action.`)}return{showIfEligible:(e,...s)=>function(t){return l(t),o()&&n&&null===a.get(r[t])}(e)?t(e,...s):null,makeActionIneligible:t=>(l(t),a.set(r[t],"~")),makeAllActionsIneligible(){let t,s;for(t in e)s=e[t],this.makeActionIneligible(s)},isCampaignActive:o}}},"./src/mobile.startup/showOnPageReload.js":t=>{const e="mobileFrontend/toast";mw.requestIdleCallback((function(){let t=mw.storage.get(e);t&&(t=JSON.parse(t),mw.notify(t.content,t.options),mw.storage.remove(e))})),t.exports={showOnPageReload:function(t,s){mw.storage.get(e)?mw.log.warn("A pending toast message already exits. The page should have been reloaded by now."):mw.storage.set(e,JSON.stringify({content:t,options:s}))}}},"./src/mobile.startup/util.js":t=>{t.exports={saveButtonMessage:()=>mw.config.get("wgEditSubmitButtonLabelPublish")?mw.msg("mobile-frontend-editor-publish"):mw.msg("mobile-frontend-editor-save"),Promise:{all:t=>$.when.apply($,t)},escapeSelector:t=>$.escapeSelector(t),docReady:t=>$(t),Deferred:()=>$.Deferred(),getDocument:()=>$(document.documentElement),getWindow:()=>$(window),parseHTML:(t,e)=>(e=e||document,$($.parseHTML(t,e))),extend(){return $.extend.apply($,arguments)},template:t=>({getSource:()=>t,render(e,s){const i={};return Object.keys(s||{}).forEach((t=>{i[t]=s[t].getSource()})),Mustache.render(t.trim(),e,i)}})}},"./src/mobile.startup/watchstar/WatchstarGateway.js":(t,e,s)=>{const i=s("./src/mobile.startup/util.js"),n=s("./src/mobile.startup/actionParams.js");t.exports=class{constructor(t){this.api=t}getStatuses(t,e){return i.Promise.all([this.getStatusesByID(t),this.getStatusesByTitle(e)]).then((function(){return i.extend.apply(i,arguments)}))}getStatusesByID(t){return t.length?this.api.get({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:t}).then((t=>this._unmarshalGetResponse(t))):i.Deferred().resolve({})}getStatusesByTitle(t){return t.length?this.api.get(n({prop:"info",inprop:"watched",titles:t})).then((t=>this._unmarshalGetResponse(t))):i.Deferred().resolve({})}postStatusesByTitle(t,e){const s={action:"watch",titles:t};return e||(s.unwatch=!e),this.api.postWithToken("watch",s)}_unmarshalGetResponse(t){return(t&&t.query&&t.query.pages||[]).reduce(((t,e)=>(t[e.title]=e.watched,t)),{})}}},"./src/mobile.startup/watchstar/WatchstarPageList.js":(t,e,s)=>{const i=s("./src/mobile.startup/PageList.js"),n=s("./src/mobile.startup/watchstar/watchstar.js"),a=mw.user,r=s("./src/mobile.startup/util.js"),o=s("./src/mobile.startup/Page.js"),l=s("./src/mobile.startup/watchstar/WatchstarGateway.js");t.exports=class extends i{constructor(t){super(t)}initialize(t){this.wsGateway=new l(t.api),super.initialize(t)}postRender(){const t=[],e=[];super.postRender();const s=this.queryUnitializedItems(),i=this.parsePagesFromItems(s);return Object.keys(i).forEach((s=>{const n=i[s];n&&"0"!==n?t.push(n):e.push(s)})),this.getPages(t,e).then((t=>this.renderItems(s,t)))}queryUnitializedItems(){return this.$el.find("li:not(.with-watchstar)")}getPages(t,e){return a.isAnon()?r.Deferred().resolve({}):this.wsGateway.getStatuses(t,e)}parsePagesFromItems(t){const e={};return t.each(((t,s)=>{const i=this.$el.find(s);e[i.attr("title")]=i.data("id")})),e}renderItems(t,e){a.isAnon()||t.each(((t,s)=>{const i=this.$el.find(s),n=new o({sections:[],title:i.attr("title"),id:i.data("id")}),a=e[n.getTitle()];this._appendWatchstar(i,n,a),i.addClass("with-watchstar")}))}_appendWatchstar(t,e,s){n({isWatched:s,page:e}).appendTo(t)}}},"./src/mobile.startup/watchstar/watchstar.js":(t,e,s)=>{const i=s("./src/mobile.startup/icons.js");t.exports=function(t){const e=t.isWatched,s=require("mediawiki.page.watch.ajax").watchstar,n=e?"unwatch":"watch",a={href:mw.Title.newFromText(t.page.title).getUrl({action:n})},r=i.watch(a),o=i.watched(a),l=r.getClassName(),c=o.getClassName(),d=r.getIcon().getClassName(),h=o.getIcon().getClassName(),u=e?o:r;return s(u.$el,t.page.title,((t,e)=>{t.attr("class",e?c:l),t.find(".mf-icon").attr("class",e?h:d)})),u}}}]);
//# sourceMappingURL=mobile.common.js.map.json