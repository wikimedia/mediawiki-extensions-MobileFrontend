{"version":3,"file":"mobile.special.mobileoptions.scripts.js","mappings":"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","sources":["webpack://mfModules/./node_modules/@wikimedia/mediawiki.skins.clientpreferences/clientPreferences.js","webpack://mfModules/./src/mobile.special.mobileoptions.scripts.js"],"sourcesContent":["/**\n * @typedef {Object} ClientPreference\n * @property {string[]} options that are valid for this client preference\n * @property {string} preferenceKey for registered users.\n * @property {string} [betaMessage] whether to show a notice indicating this feature is in beta.\n * @property {string} [linkLabelMessage] message key for link label.\n * @property {string} [linkLabelUrl] URL for link label.\n * @property {string} [linkLabelTooltip] tooltip for link label.\n * @property {string} [linkLabelUrlParameter] message key for URL parameter (which itself takes\n * a URL to the current page)\n * @property {string} [type] defaults to radio. Supported: radio, switch\n * @property {Function} [callback] callback executed after a client preference has been modified.\n */\n\n/**\n * @typedef {Object} UserPreferencesApi\n * @property {Function} saveOptions\n */\n/**\n * @typedef {Object} PreferenceOption\n * @property {string} label\n * @property {string} value\n */\n\n/**\n * Get the list of client preferences that are active on the page, including hidden.\n *\n * @return {string[]} of active client preferences\n */\nfunction getClientPreferences() {\n\treturn Array.from( document.documentElement.classList ).filter(\n\t\t( className ) => className.match( /-clientpref-/ )\n\t).map( ( className ) => className.split( '-clientpref-' )[ 0 ] );\n}\n\n/**\n * Check if the feature is excluded from the current page.\n *\n * @param {string} featureName\n * @return {boolean}\n */\nfunction isFeatureExcluded( featureName ) {\n\treturn document.documentElement.classList.contains( featureName + '-clientpref--excluded' );\n}\n\n/**\n * Get the list of client preferences that are active on the page and not hidden.\n *\n * @param {Record<string,ClientPreference>} config\n * @return {string[]} of user facing client preferences\n */\nfunction getVisibleClientPreferences( config ) {\n\tconst active = getClientPreferences();\n\t// Order should be based on key in config.json\n\treturn Object.keys( config ).filter( ( key ) => active.includes( key ) );\n}\n\n/**\n * @param {string} featureName\n * @param {string} value\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} [userPreferences]\n */\nfunction toggleDocClassAndSave( featureName, value, config, userPreferences ) {\n\tconst pref = config[ featureName ];\n\tconst callback = pref.callback || ( () => {} );\n\tconst hook = mw.hook( 'skin-client-preference.change' );\n\tif ( mw.user.isNamed() ) {\n\t\t// FIXME: Ideally this would be done in mw.user.clientprefs API.\n\t\t// mw.user.clientPrefs.get is marked as being only stable for anonymous and temporary users.\n\t\t// So instead we have to keep track of all the different possible values and remove them\n\t\t// before adding the new class.\n\t\tconfig[ featureName ].options.forEach( ( possibleValue ) => {\n\t\t\tdocument.documentElement.classList.remove( `${ featureName }-clientpref-${ possibleValue }` );\n\t\t} );\n\t\tdocument.documentElement.classList.add( `${ featureName }-clientpref-${ value }` );\n\t\t// Client preferences often change the layout of the page significantly, so emit\n\t\t// a window resize event for other apps that need to update (T374092).\n\t\t// This is used by VisualEditor. If you plan to use this event for any other\n\t\t// purpose please let web team know so we can understand the use case better\n\t\t// (T375559 for more details).\n\t\twindow.dispatchEvent( new Event( 'resize' ) );\n\t\t// Ideally this should be taken care of via a single core helper function.\n\t\tmw.util.debounce( () => {\n\t\t\tuserPreferences = userPreferences || new mw.Api();\n\t\t\tuserPreferences.saveOptions( { [ pref.preferenceKey ]: value } ).then( () => {\n\t\t\t\tcallback();\n\t\t\t} );\n\t\t}, 100 )();\n\t\t// END FIXME.\n\t} else {\n\t\t// This case is much simpler, the API transparently takes care of classes as well as storage\n\t\tmw.user.clientPrefs.set( featureName, value );\n\t\tcallback();\n\t}\n\thook.fire( featureName, value );\n}\n\n/**\n * @param {string} featureName\n * @param {string} value\n * @return {string}\n */\nconst getInputId = ( featureName, value ) => `skin-client-pref-${ featureName }-value-${ value }`;\n\n/**\n * @param {string} type\n * @param {string} featureName\n * @param {string} value\n * @return {HTMLInputElement}\n */\nfunction makeInputElement( type, featureName, value ) {\n\tconst input = document.createElement( 'input' );\n\tconst name = `skin-client-pref-${ featureName }-group`;\n\tconst id = getInputId( featureName, value );\n\tinput.name = name;\n\tinput.id = id;\n\tinput.type = type;\n\tif ( type === 'checkbox' ) {\n\t\tinput.checked = value === '1';\n\t} else {\n\t\tinput.value = value;\n\t}\n\tinput.setAttribute( 'data-event-name', id );\n\treturn input;\n}\n\n/**\n * @param {string} featureName\n * @param {string} value\n * @return {HTMLLabelElement}\n */\nfunction makeLabelElement( featureName, value ) {\n\tconst label = document.createElement( 'label' );\n\tlabel.classList.add( 'cdx-label' );\n\tlabel.setAttribute( 'for', getInputId( featureName, value ) );\n\n\tconst labelText = document.createElement( 'span' );\n\tlabelText.classList.add( 'cdx-label__label__text' );\n\t// eslint-disable-next-line mediawiki/msg-doc\n\tlabelText.textContent = mw.msg( `${ featureName }-${ value }-label` );\n\n\tlabel.appendChild( labelText );\n\treturn label;\n}\n\n/**\n * Create an element that informs users that a feature is not functional\n * on a given page. This message is hidden by default and made visible in\n * CSS if a specific exclusion class exists.\n *\n * @param {string} featureName\n * @return {HTMLElement}\n */\nfunction makeExclusionNotice( featureName ) {\n\tconst p = document.createElement( 'p' );\n\t// eslint-disable-next-line mediawiki/msg-doc\n\tconst noticeMessage = mw.message( `${ featureName }-exclusion-notice` );\n\tp.classList.add( 'exclusion-notice', `${ featureName }-exclusion-notice` );\n\tp.textContent = noticeMessage.text();\n\treturn p;\n}\n\n/**\n * @param {string} messageKey\n * @return {HTMLElement}\n */\nfunction makeBetaInfoTag( messageKey ) {\n\tconst infoTag = document.createElement( 'span' );\n\t// custom style to avoid moving heading bottom border.\n\tconst infoTagText = document.createElement( 'span' );\n\t/* eslint-disable-next-line mediawiki/msg-doc */\n\tinfoTagText.textContent = mw.message( messageKey ).text();\n\tinfoTag.appendChild( infoTagText );\n\treturn infoTag;\n}\n\n/**\n * @param {HTMLElement} parent\n * @param {string} featureName\n * @param {string} value\n * @param {string} currentValue\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} userPreferences\n */\nfunction appendRadioToggle( parent, featureName, value, currentValue, config, userPreferences ) {\n\tconst input = makeInputElement( 'radio', featureName, value );\n\tinput.classList.add( 'cdx-radio__input' );\n\tif ( currentValue === value ) {\n\t\tinput.checked = true;\n\t}\n\n\tif ( isFeatureExcluded( featureName ) ) {\n\t\tinput.disabled = true;\n\t}\n\n\tconst icon = document.createElement( 'span' );\n\ticon.classList.add( 'cdx-radio__icon' );\n\tconst label = makeLabelElement( featureName, value );\n\tlabel.classList.add( 'cdx-radio__label' );\n\tconst container = document.createElement( 'div' );\n\tcontainer.classList.add( 'cdx-radio' );\n\tcontainer.appendChild( input );\n\tcontainer.appendChild( icon );\n\tcontainer.appendChild( label );\n\tparent.appendChild( container );\n\tinput.addEventListener( 'change', () => {\n\t\ttoggleDocClassAndSave( featureName, value, config, userPreferences );\n\t} );\n\n\t// Prevent repeated arrow key navigation when key is held down\n\t// to avoid rapid color changes that may trigger photosensitive reactions.\n\t// Refer to [[phab:T402285]]\n\tinput.addEventListener( 'keydown', ( event ) => {\n\t\tif ( event.key.startsWith( 'Arrow' ) && event.repeat ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t} );\n}\n\n/**\n * @param {HTMLElement} linkContainer\n * @param {ClientPreference} feature\n */\nfunction makeLink( linkContainer, feature ) {\n\tconst urlKey = feature.linkLabelUrl;\n\tconst labelKey = feature.linkLabelMessage;\n\tconst linkLabelTooltip = feature.linkLabelTooltip;\n\tconst urlParamMsgKey = feature.linkLabelUrlParameter;\n\tif ( !labelKey || !urlKey || !mw.msg( urlKey ) ) {\n\t\treturn;\n\t}\n\tlet urlParam = '';\n\tif ( urlParamMsgKey ) {\n\t\tconst pageWikiLink = `[https://${ window.location.hostname + mw.util.getUrl( mw.config.get( 'wgPageName' ) ) } ${ mw.config.get( 'wgTitle' ) }]`;\n\t\t/* eslint-disable-next-line mediawiki/msg-doc */\n\t\turlParam = mw.message( urlParamMsgKey, pageWikiLink ).text();\n\t}\n\t/* eslint-disable-next-line mediawiki/msg-doc */\n\tconst link = mw.msg( urlKey, window.location.host, urlParam );\n\t/* eslint-disable-next-line mediawiki/msg-doc */\n\tconst linkLabel = mw.message( labelKey ).text();\n\tconst anchor = document.createElement( 'a' );\n\tanchor.setAttribute( 'href', link );\n\tanchor.setAttribute( 'target', '_blank' );\n\tif ( linkLabelTooltip ) {\n\t\t/* eslint-disable-next-line mediawiki/msg-doc */\n\t\tanchor.setAttribute( 'title', mw.msg( linkLabelTooltip ) );\n\t}\n\tanchor.textContent = linkLabel;\n\n\t/**\n\t * Shows the success message after clicking the beta feedback link.\n\t * Note: event.stopPropagation(); is required to show the success message\n\t * without closing the Appearance menu when it's in a dropdown.\n\t *\n\t * @param {Event} event\n\t */\n\tconst showSuccessFeedback = function ( event ) {\n\t\tevent.stopPropagation();\n\t\tconst icon = document.createElement( 'span' );\n\t\ticon.classList.add( 'vector-icon', 'vector-icon--heart' );\n\t\tanchor.textContent = mw.msg( 'vector-night-mode-issue-reporting-link-notification' );\n\t\tanchor.classList.add( 'skin-theme-beta-notice-success' );\n\t\tanchor.prepend( icon );\n\t\tanchor.removeEventListener( 'click', showSuccessFeedback );\n\t};\n\tif ( feature.linkLabelUrlParameter ) {\n\t\tanchor.addEventListener( 'click', ( event ) => showSuccessFeedback( event ) );\n\t}\n\tlinkContainer.appendChild( anchor );\n}\n\n/**\n * @param {HTMLElement} form\n * @param {string} featureName\n * @param {HTMLElement} labelElement\n * @param {string} currentValue\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} userPreferences\n */\nfunction appendToggleSwitch(\n\tform, featureName, labelElement, currentValue, config, userPreferences\n) {\n\tconst input = makeInputElement( 'checkbox', featureName, currentValue );\n\tinput.classList.add( 'cdx-toggle-switch__input' );\n\tconst switcher = document.createElement( 'span' );\n\tswitcher.classList.add( 'cdx-toggle-switch__switch' );\n\tconst grip = document.createElement( 'span' );\n\tgrip.classList.add( 'cdx-toggle-switch__switch__grip' );\n\tswitcher.appendChild( grip );\n\tconst label = labelElement || makeLabelElement( featureName, currentValue );\n\tlabel.classList.add( 'cdx-toggle-switch__label' );\n\tconst toggleSwitch = document.createElement( 'span' );\n\ttoggleSwitch.classList.add( 'cdx-toggle-switch' );\n\ttoggleSwitch.appendChild( input );\n\ttoggleSwitch.appendChild( switcher );\n\ttoggleSwitch.appendChild( label );\n\tinput.addEventListener( 'change', () => {\n\t\ttoggleDocClassAndSave( featureName, input.checked ? '1' : '0', config, userPreferences );\n\t} );\n\tform.appendChild( toggleSwitch );\n}\n\n/**\n * @param {string} className\n * @return {HTMLElement}\n */\nfunction createRow( className ) {\n\tconst row = document.createElement( 'div' );\n\trow.setAttribute( 'class', className );\n\treturn row;\n}\n\n/**\n * Get the label for the feature.\n *\n * @param {string} featureName\n * @return {MwMessage}\n */\n// eslint-disable-next-line mediawiki/msg-doc\nconst getFeatureLabelMsg = ( featureName ) => mw.message( `${ featureName }-name` );\n\n/**\n * adds a toggle button\n *\n * @param {string} featureName\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} userPreferences\n * @return {HTMLElement|null}\n */\nfunction makeControl( featureName, config, userPreferences ) {\n\tconst pref = config[ featureName ];\n\tconst isExcluded = isFeatureExcluded( featureName );\n\n\tif ( !pref ) {\n\t\treturn null;\n\t}\n\tconst currentValue = mw.user.clientPrefs.get( featureName );\n\t// The client preference was invalid. This shouldn't happen unless a gadget\n\t// or script has modified the documentElement or client preference is excluded.\n\tif ( typeof currentValue === 'boolean' && !isExcluded ) {\n\t\treturn null;\n\t}\n\tconst row = createRow( '' );\n\tconst form = document.createElement( 'form' );\n\tconst type = pref.type || 'radio';\n\tswitch ( type ) {\n\t\tcase 'radio':\n\t\t\tpref.options.forEach( ( value ) => {\n\t\t\t\tappendRadioToggle(\n\t\t\t\t\tform, featureName, value, String( currentValue ), config, userPreferences\n\t\t\t\t);\n\t\t\t} );\n\t\t\tbreak;\n\t\tcase 'switch': {\n\t\t\tconst labelElement = document.createElement( 'label' );\n\t\t\tlabelElement.textContent = getFeatureLabelMsg( featureName ).text();\n\t\t\tappendToggleSwitch(\n\t\t\t\tform, featureName, labelElement, String( currentValue ), config, userPreferences\n\t\t\t);\n\t\t\tbreak;\n\t\t} default:\n\t\t\tthrow new Error( 'Unknown client preference! Only switch or radio are supported.' );\n\t}\n\trow.appendChild( form );\n\n\tif ( isExcluded ) {\n\t\tconst exclusionNotice = makeExclusionNotice( featureName );\n\t\trow.appendChild( exclusionNotice );\n\t}\n\treturn row;\n}\n\n/**\n * @param {HTMLElement} parent\n * @param {string} featureName\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} userPreferences\n */\nfunction makeClientPreference( parent, featureName, config, userPreferences ) {\n\tconst labelMsg = getFeatureLabelMsg( featureName );\n\tconst feature = config[ featureName ];\n\t// If the user is not debugging messages and no language exists,\n\t// exit as its a hidden client preference.\n\tif ( !labelMsg.exists() && mw.config.get( 'wgUserLanguage' ) !== 'qqx' ) {\n\t\treturn;\n\t} else {\n\t\tconst id = `skin-client-prefs-${ featureName }`;\n\t\t// @ts-ignore TODO: upstream patch URL\n\t\tconst portlet = mw.util.addPortlet( id, labelMsg.text() );\n\n\t\tif ( feature.betaMessage ) {\n\t\t\tconst betaInfoTag = makeBetaInfoTag( feature.betaMessage );\n\t\t\tif ( !portlet.querySelector( '.vector-menu-heading span' ) ) {\n\t\t\t\tportlet.querySelector( '.vector-menu-heading' ).textContent += ' ';\n\t\t\t\tportlet.querySelector( '.vector-menu-heading' ).appendChild( betaInfoTag );\n\t\t\t}\n\t\t}\n\n\t\tconst labelElement = portlet.querySelector( 'label' );\n\n\t\t// Add additional description for mobile\n\t\t// eslint-disable-next-line mediawiki/msg-doc\n\t\tconst descriptionMsg = mw.message( `${ featureName }-description` );\n\t\tif ( descriptionMsg.exists() ) {\n\t\t\tconst desc = document.createElement( 'span' );\n\t\t\tdesc.classList.add( 'skin-client-pref-description' );\n\t\t\t// Description can include links so parse rather than text.\n\t\t\tdesc.innerHTML = descriptionMsg.parse();\n\t\t\tif ( labelElement && labelElement.parentNode ) {\n\t\t\t\tlabelElement.appendChild( desc );\n\t\t\t}\n\t\t}\n\n\t\t// Add exclusion notice for desktop\n\t\t// eslint-disable-next-line mediawiki/msg-doc\n\t\tconst exclusionNoticeMsg = mw.message( `${ featureName }-exclusion-notice` );\n\t\tif ( exclusionNoticeMsg.exists() ) {\n\t\t\tconst content = portlet.querySelector( '.vector-menu-content' );\n\t\t\tconst notice = document.createElement( 'span' );\n\t\t\tnotice.classList.add( 'skin-client-pref-exclusion-notice' );\n\t\t\tnotice.textContent = exclusionNoticeMsg.text();\n\t\t\tif ( content ) {\n\t\t\t\tcontent.appendChild( notice );\n\t\t\t}\n\t\t}\n\n\t\tparent.appendChild( portlet );\n\t\tconst row = makeControl( featureName, config, userPreferences );\n\t\tif ( row ) {\n\t\t\tconst tmp = mw.util.addPortletLink( id, '', '' );\n\t\t\t// create a dummy link\n\t\t\tif ( tmp ) {\n\t\t\t\tconst link = tmp.querySelector( 'a' );\n\t\t\t\tif ( link ) {\n\t\t\t\t\tlink.replaceWith( row );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( config[ featureName ].linkLabelUrl && !isFeatureExcluded( featureName ) ) {\n\t\t\t\tconst linkContainer = document.createElement( 'span' );\n\t\t\t\tlinkContainer.id = `${ featureName }-beta-notice`;\n\t\t\t\t// per requirements: only logged in users can report errors (T372754)\n\t\t\t\tif ( !mw.user.isAnon() ) {\n\t\t\t\t\tmakeLink( linkContainer, feature );\n\t\t\t\t}\n\t\t\t\trow.appendChild( linkContainer );\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * Fills the client side preference dropdown with controls.\n *\n * @param {string} selector of element to fill with client preferences\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} [userPreferences]\n * @return {Promise<HTMLElement>}\n */\nfunction render( selector, config, userPreferences ) {\n\t/** @type {HTMLElement|null} */\n\tconst el = document.querySelector( selector );\n\tif ( !el ) {\n\t\treturn Promise.reject();\n\t}\n\treturn new Promise( ( resolve ) => {\n\t\tgetVisibleClientPreferences( config ).forEach( ( pref ) => {\n\t\t\tuserPreferences = userPreferences || new mw.Api();\n\t\t\tmakeClientPreference( el, pref, config, userPreferences );\n\t\t} );\n\t\tmw.requestIdleCallback( () => {\n\t\t\tresolve( el );\n\t\t} );\n\t} );\n}\n\n/**\n * @param {string} clickSelector what to click\n * @param {string} renderSelector where to render\n * @param {Record<string,ClientPreference>} config\n * @param {UserPreferencesApi} [userPreferences]\n */\nfunction bind( clickSelector, renderSelector, config, userPreferences ) {\n\tlet enhanced = false;\n\tconst chk = /** @type {HTMLInputElement} */ (\n\t\tdocument.querySelector( clickSelector )\n\t);\n\tif ( !chk ) {\n\t\treturn;\n\t}\n\tif ( !userPreferences ) {\n\t\tuserPreferences = new mw.Api();\n\t}\n\tif ( chk.checked ) {\n\t\trender( renderSelector, config, userPreferences );\n\t\tenhanced = true;\n\t} else {\n\t\tchk.addEventListener( 'input', () => {\n\t\t\tif ( enhanced ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trender( renderSelector, config, userPreferences );\n\t\t\tenhanced = true;\n\t\t} );\n\t}\n}\nmodule.exports = {\n\tbind,\n\ttoggleDocClassAndSave,\n\trender\n};\n","/* global $ */\n/* See T354224 for information on the @wikimedia/mediawiki.skins.clientpreferences module. */\nconst clientPrefs = require( '@wikimedia/mediawiki.skins.clientpreferences' ),\n\ttoast = require( './mobile.startup/showOnPageReload' ),\n\tEXPAND_SECTIONS_KEY = 'mf-expand-sections',\n\tWP25_EASTER_EGGS_KEY = 'wp25eastereggs-enable',\n\tmsg = mw.msg,\n\tUSER_FONT_SIZE_SMALL = 'small',\n\tUSER_FONT_SIZE_REGULAR = 'regular',\n\tUSER_FONT_SIZE_LARGE = 'large',\n\tTHEME = 'skin-theme',\n\t// FIXME: This value should be synced between back-end and front-end code,\n\t// but it's currently hard-coded because ResourceLoader virtual imports\n\t// i.e. require( './config.json') are incompatible with the\n\t// Webpack build. Requires updating to Webpack 5 and common.js magic comments.\n\t// https://webpack.js.org/configuration/module/#moduleparserjavascriptcommonjsmagiccomments\n\t// e.g: require(/* webpackIgnore: true */ './config.json');\n\tFONT_SIZE_KEY = 'mf-font-size';\n\n/**\n * Notifies the user that settings were asynchronously saved.\n *\n * @private\n * @param {boolean} [isPending] if set toast will show after page has been reloaded.\n */\nfunction notify( isPending ) {\n\tif ( isPending ) {\n\t\ttoast.showOnPageReload( msg( 'mobile-frontend-settings-save' ) );\n\t} else {\n\t\tmw.notify( msg( 'mobile-frontend-settings-save' ) );\n\t}\n}\n\nlet api;\n/**\n * @ignore\n * @param {Object<string,string|number>} options\n * @return {JQuery.Promise<Object>}\n */\nfunction saveOptions( options ) {\n\tapi = api || new mw.Api();\n\t// @ts-ignore\n\treturn api.saveOptions( options, {\n\t\tglobal: 'update'\n\t} );\n}\n\n/**\n * Adds a font changer field to the form\n *\n * @private\n * @param {jQuery.Object} $form\n * @param {Record<string,ClientPreference>} clientPreferences\n * @return {Promise<Node>}\n */\nfunction addClientPreferencesToForm( $form, clientPreferences ) {\n\tconst cp = document.createElement( 'div' );\n\tconst id = 'mf-client-preferences';\n\tcp.id = id;\n\t$form.prepend( cp );\n\treturn clientPrefs.render( `#${ id }`, clientPreferences, { saveOptions } );\n}\n\n/**\n * Helper method to infuse checkbox elements with OO magic\n * Additionally it applies all known hacks to make it mobile friendly\n *\n * @private\n * @param {Object} toggleObject a toggle object to infuse\n * @param {jQuery.Object} $form form to submit when there is interaction with toggle\n */\nfunction infuseToggle( toggleObject, $form ) {\n\tconst $toggleElement = toggleObject.$el;\n\tconst enableToggle = OO.ui.infuse( $toggleElement );\n\tconst $checkbox = enableToggle.$element;\n\tconst toggleSwitch = new OO.ui.ToggleSwitchWidget( {\n\t\tvalue: enableToggle.isSelected()\n\t} );\n\n\t// Strangely the ToggleSwitchWidget does not behave as an input so any change\n\t// to it is not reflected in the form. (see T182466)\n\t// Ideally we'd replaceWith here and not have to hide the original element.\n\ttoggleSwitch.$element.insertAfter( $checkbox );\n\t// although the checkbox is hidden already, that is done via visibility\n\t// as a result, it still takes up space. We don't want it to any more now that the\n\t// new toggle switch has been added.\n\t$checkbox.hide();\n\n\t// listening on checkbox change is required to make the clicking on label working.\n\t// Otherwise clicking on label changes the checkbox \"checked\" state\n\t// but it's not reflected in the toggle switch\n\t$checkbox.on( 'change', () => {\n\t\t// disable checkbox as submit is delayed by 0.25s\n\t\t$checkbox.attr( 'disabled', true );\n\t\ttoggleSwitch.setValue( enableToggle.isSelected() );\n\t} );\n\ttoggleSwitch.on( 'change', ( value ) => {\n\t\t// execute callback\n\t\ttoggleObject.onToggle( value );\n\n\t\t// ugly hack, we're delaying submit form by 0.25s\n\t\t// and we want to disable registering clicks\n\t\t// we want to disable the toggleSwitch\n\t\t// but we cannot use setDisabled(true) as it makes button gray\n\t\ttoggleSwitch.setValue = function () {};\n\n\t\t$checkbox.find( 'input' )\n\t\t\t.prop( 'checked', value );\n\t\tnotify( true );\n\t\t// On some Android devices animation gets stuck in the middle as browser\n\t\t// starts submitting the form.\n\t\t// Let's call submit on the form after toggle button transition is done\n\t\t// (0.25s, defined in OOUI)\n\t\tsetTimeout( () => {\n\t\t\t$form.trigger( 'submit' );\n\t\t}, 250 );\n\t} );\n}\n\n/**\n * Add features, that depends on localStorage, such as \"expand all sections\" or \"fontchanger\".\n * The checkbox is used for turning on/off expansion of all sections on page load.\n *\n * @private\n */\nfunction initMobileOptions() {\n\tconst $form = $( '#mobile-options' ),\n\t\t$amcToggle = $( '#enable-amc-toggle' );\n\n\tif ( $amcToggle.length ) {\n\t\tinfuseToggle( { $el: $amcToggle }, $form );\n\t}\n\n\tconst clientPreferences = {};\n\n\tif ( mw.config.get( 'wgMFEnableFontChanger' ) ) {\n\t\tclientPreferences[ FONT_SIZE_KEY ] = {\n\t\t\toptions: [\n\t\t\t\tUSER_FONT_SIZE_SMALL,\n\t\t\t\tUSER_FONT_SIZE_REGULAR,\n\t\t\t\tUSER_FONT_SIZE_LARGE\n\t\t\t],\n\t\t\tpreferenceKey: FONT_SIZE_KEY,\n\t\t\tcallback: notify\n\t\t};\n\t}\n\n\tconst skin = mw.config.get( 'skin' );\n\tclientPreferences[ THEME ] = {\n\t\toptions: [ 'day', 'night', 'os' ],\n\t\tpreferenceKey: `${ skin }-theme`\n\t};\n\n\tclientPreferences[ EXPAND_SECTIONS_KEY ] = {\n\t\toptions: [\n\t\t\t'0',\n\t\t\t'1'\n\t\t],\n\t\ttype: 'switch',\n\t\tpreferenceKey: EXPAND_SECTIONS_KEY,\n\t\tcallback: notify\n\t};\n\n\tif ( skin === 'minerva' ) {\n\t\tclientPreferences[ WP25_EASTER_EGGS_KEY ] = {\n\t\t\toptions: [\n\t\t\t\t'0',\n\t\t\t\t'1'\n\t\t\t],\n\t\t\ttype: 'switch',\n\t\t\tpreferenceKey: WP25_EASTER_EGGS_KEY,\n\t\t\tcallback: notify\n\t\t};\n\t}\n\n\tif ( !mw.user.isAnon() ) {\n\t\tclientPreferences[ 'mw-mf-amc' ] = {\n\t\t\toptions: [\n\t\t\t\t'0',\n\t\t\t\t'1'\n\t\t\t],\n\t\t\ttype: 'switch',\n\t\t\tpreferenceKey: 'mf_amc_optin',\n\t\t\tcallback: () => location.reload()\n\t\t};\n\t}\n\n\t// Transport existing links to new layout.\n\n\t/**\n\t * Currently toggle switches have duplicate headings and a description that is not\n\t * part of the toggle switch layout.\n\t * This works around this to retain the classic MobileFrontend layout for these\n\t * controls.\n\t * FIXME: This should be upstreamed to @wikimedia/mediawiki.skins.clientpreferences\n\t *\n\t * @param {jQuery} $node\n\t */\n\tfunction modifyToggleSwitch( $node ) {\n\t\t// Move the description from the heading into the label.\n\t\t$node.find( '.skin-client-pref-description' )\n\t\t\t.appendTo( $node.find( '.cdx-toggle-switch__label' ) );\n\t\t// Drop the duplicate label.\n\t\t$node.find( '> label' ).remove();\n\t}\n\n\taddClientPreferencesToForm( $form, clientPreferences ).then( () => {\n\t\t// Make some modifications that are currently not supported by the Vector client preferences\n\t\t// Move the links from the server side preference into the row.\n\t\t$( '#amc-field .option-links' ).appendTo( '#skin-client-prefs-mw-mf-amc' );\n\t\tmodifyToggleSwitch( $( '#skin-client-prefs-mf-expand-sections' ) );\n\t\tmodifyToggleSwitch( $( '#skin-client-prefs-wp25eastereggs-enable' ) );\n\t\tmodifyToggleSwitch( $( '#skin-client-prefs-mw-mf-amc' ) );\n\t\t// Remove the server side rendered OOUI field.\n\t\t$( '#amc-field' ).remove();\n\n\t\t// For the purposes of ReaderExperiments StickyHeaders prototype only:\n\t\t// - This code toggles on and disables the expand section setting for enrolled users T409485\n\t\t// - Please remove code after the stickyHeaders A/B experiment is complete T410754\n\t\tif ( mw.config.get(\n\t\t\t'wgReaderExperimentsStickyHeaders' ) &&\n\t\t\tmw.config.get( 'wgReaderExperimentsStickyHeaders' ) === 'enrolled'\n\t\t) {\n\t\t\tconst $toggleSwitch = $( '#skin-client-prefs-mf-expand-sections input' );\n\n\t\t\tif ( $toggleSwitch ) {\n\t\t\t\t$toggleSwitch.prop( 'checked', true );\n\t\t\t\t$toggleSwitch.prop( 'disabled', true );\n\t\t\t}\n\t\t}\n\t} );\n}\n\nif ( !window.QUnit ) {\n\tmw.loader.using( 'oojs-ui-widgets' ).then( initMobileOptions );\n}\n\nmodule.exports = {\n\ttest: {\n\t\taddClientPreferencesToForm\n\t}\n};\n"],"names":["isFeatureExcluded","featureName","document","documentElement","classList","contains","toggleDocClassAndSave","value","config","userPreferences","pref","callback","hook","mw","user","isNamed","options","forEach","possibleValue","remove","add","window","dispatchEvent","Event","util","debounce","Api","saveOptions","preferenceKey","then","clientPrefs","set","fire","getInputId","makeInputElement","type","input","createElement","name","id","checked","setAttribute","makeLabelElement","label","labelText","textContent","msg","appendChild","getFeatureLabelMsg","message","makeClientPreference","parent","labelMsg","feature","exists","get","portlet","addPortlet","text","betaMessage","betaInfoTag","messageKey","infoTag","infoTagText","makeBetaInfoTag","querySelector","labelElement","descriptionMsg","desc","innerHTML","parse","parentNode","exclusionNoticeMsg","content","notice","row","isExcluded","currentValue","createRow","form","disabled","icon","container","addEventListener","event","key","startsWith","repeat","preventDefault","appendRadioToggle","String","switcher","grip","toggleSwitch","appendToggleSwitch","Error","exclusionNotice","p","noticeMessage","makeExclusionNotice","makeControl","tmp","addPortletLink","link","replaceWith","linkLabelUrl","linkContainer","isAnon","urlKey","labelKey","linkLabelMessage","linkLabelTooltip","urlParamMsgKey","linkLabelUrlParameter","urlParam","pageWikiLink","location","hostname","getUrl","host","linkLabel","anchor","showSuccessFeedback","stopPropagation","prepend","removeEventListener","makeLink","render","selector","el","Promise","resolve","active","Array","from","filter","className","match","map","split","Object","keys","includes","getVisibleClientPreferences","requestIdleCallback","reject","module","exports","bind","clickSelector","renderSelector","enhanced","chk","toast","EXPAND_SECTIONS_KEY","WP25_EASTER_EGGS_KEY","FONT_SIZE_KEY","notify","isPending","showOnPageReload","api","global","addClientPreferencesToForm","$form","clientPreferences","cp","QUnit","loader","using","$","$amcToggle","length","toggleObject","$toggleElement","$el","enableToggle","OO","ui","infuse","$checkbox","$element","ToggleSwitchWidget","isSelected","insertAfter","hide","on","attr","setValue","onToggle","find","prop","setTimeout","trigger","infuseToggle","skin","modifyToggleSwitch","$node","appendTo","reload","$toggleSwitch","test"],"sourceRoot":""}