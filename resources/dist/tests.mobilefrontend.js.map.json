{"version":3,"sources":["webpack://mfModules.[name]/./node_modules/@sinonjs/formatio/lib/formatio.js","webpack://mfModules.[name]/./node_modules/@wikimedia/mw-node-qunit/index.js","webpack://mfModules.[name]/./node_modules/@wikimedia/mw-node-qunit/src/dom.js","webpack://mfModules.[name]/./node_modules/@wikimedia/mw-node-qunit/src/jQuery.js","webpack://mfModules.[name]/./node_modules/@wikimedia/mw-node-qunit/src/mustache.js","webpack://mfModules.[name]/./node_modules/@wikimedia/mw-node-qunit/src/mw.js","webpack://mfModules.[name]/./node_modules/@wikimedia/mw-node-qunit/src/oo.js","webpack://mfModules.[name]/./node_modules/lodash.get/index.js","webpack://mfModules.[name]/./node_modules/lolex/lolex.js","webpack://mfModules.[name]/./node_modules/mustache/mustache.js","webpack://mfModules.[name]/./node_modules/nise/nise.js","webpack://mfModules.[name]/./node_modules/process/browser.js","webpack://mfModules.[name]/./node_modules/samsam/lib/samsam.js","webpack://mfModules.[name]/./node_modules/setimmediate/setImmediate.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/assert.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/behavior.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/call.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/collect-own-methods.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/collection.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/color.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/default-behaviors.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/match.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/mock-expectation.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/mock.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/sandbox.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/spy-formatters.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/spy.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/stub-entire-object.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/stub.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/throw-on-falsy-object.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/called-in-order.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/deep-equal.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/default-config.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/deprecated.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/every.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/extend.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/format.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/function-name.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/function-to-string.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/get-property-descriptor.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/is-es-module.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/iterable-to-string.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/order-by-first-call.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/times-in-words.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/typeOf.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/value-to-string.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/walk.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/core/wrap-method.js","webpack://mfModules.[name]/./node_modules/sinon/lib/sinon/util/fake_timers.js","webpack://mfModules.[name]/./node_modules/sinon/node_modules/diff/dist/diff.js","webpack://mfModules.[name]/./node_modules/supports-color/browser.js","webpack://mfModules.[name]/./node_modules/timers-browserify/main.js","webpack://mfModules.[name]/./node_modules/type-detect/type-detect.js","webpack://mfModules.[name]/(webpack)/buildin/global.js","webpack://mfModules.[name]/./src/mobile.categories.overlays/CategoryGateway.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/BlockMessageDetails.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/EditorGateway.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/EditorOverlayBase.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/SourceEditorOverlay.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/VisualEditorOverlay.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/blockMessageDrawer.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/identifyLeadParagraph.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/parseBlockInfo.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/saveFailureMessage.js","webpack://mfModules.[name]/./src/mobile.editor.overlay/setPreferredEditor.js","webpack://mfModules.[name]/./src/mobile.init/editorLoadingOverlay.js","webpack://mfModules.[name]/./src/mobile.init/fakeToolbar.js","webpack://mfModules.[name]/./src/mobile.languages.structured/LanguageSearcher.js","webpack://mfModules.[name]/./src/mobile.languages.structured/rtlLanguages.js","webpack://mfModules.[name]/./src/mobile.languages.structured/util.js","webpack://mfModules.[name]/./src/mobile.mediaViewer/ImageCarousel.js","webpack://mfModules.[name]/./src/mobile.mediaViewer/ImageGateway.js","webpack://mfModules.[name]/./src/mobile.mediaViewer/LoadErrorMessage.js","webpack://mfModules.[name]/./src/mobile.special.nearby.scripts/NearbyGateway.js","webpack://mfModules.[name]/./src/mobile.special.watchlist.scripts/WatchList.js","webpack://mfModules.[name]/./src/mobile.special.watchlist.scripts/WatchListGateway.js","webpack://mfModules.[name]/./src/mobile.startup/Anchor.js","webpack://mfModules.[name]/./src/mobile.startup/Browser.js","webpack://mfModules.[name]/./src/mobile.startup/Button.js","webpack://mfModules.[name]/./src/mobile.startup/CtaDrawer.js","webpack://mfModules.[name]/./src/mobile.startup/Drawer.js","webpack://mfModules.[name]/./src/mobile.startup/Icon.js","webpack://mfModules.[name]/./src/mobile.startup/MessageBox.js","webpack://mfModules.[name]/./src/mobile.startup/Overlay.js","webpack://mfModules.[name]/./src/mobile.startup/OverlayManager.js","webpack://mfModules.[name]/./src/mobile.startup/Page.js","webpack://mfModules.[name]/./src/mobile.startup/PageGateway.js","webpack://mfModules.[name]/./src/mobile.startup/PageHTMLParser.js","webpack://mfModules.[name]/./src/mobile.startup/PageList.js","webpack://mfModules.[name]/./src/mobile.startup/ScrollEndEventEmitter.js","webpack://mfModules.[name]/./src/mobile.startup/Section.js","webpack://mfModules.[name]/./src/mobile.startup/Thumbnail.js","webpack://mfModules.[name]/./src/mobile.startup/Toggler.js","webpack://mfModules.[name]/./src/mobile.startup/View.js","webpack://mfModules.[name]/./src/mobile.startup/actionParams.js","webpack://mfModules.[name]/./src/mobile.startup/amcOutreach/AmcEnableForm.js","webpack://mfModules.[name]/./src/mobile.startup/amcOutreach/amcOutreachDrawer.js","webpack://mfModules.[name]/./src/mobile.startup/cache.js","webpack://mfModules.[name]/./src/mobile.startup/extendSearchParams.js","webpack://mfModules.[name]/./src/mobile.startup/headers.js","webpack://mfModules.[name]/./src/mobile.startup/icons.js","webpack://mfModules.[name]/./src/mobile.startup/languageOverlay/getDeviceLanguage.js","webpack://mfModules.[name]/./src/mobile.startup/languageOverlay/languageOverlay.js","webpack://mfModules.[name]/./src/mobile.startup/lazyImages/lazyImageLoader.js","webpack://mfModules.[name]/./src/mobile.startup/mfExtend.js","webpack://mfModules.[name]/./src/mobile.startup/moduleLoader.js","webpack://mfModules.[name]/./src/mobile.startup/moduleLoaderSingleton.js","webpack://mfModules.[name]/./src/mobile.startup/page/pageJSONParser.js","webpack://mfModules.[name]/./src/mobile.startup/promisedView.js","webpack://mfModules.[name]/./src/mobile.startup/promoCampaign/promoCampaign.js","webpack://mfModules.[name]/./src/mobile.startup/references/ReferencesGateway.js","webpack://mfModules.[name]/./src/mobile.startup/references/ReferencesHtmlScraperGateway.js","webpack://mfModules.[name]/./src/mobile.startup/references/references.js","webpack://mfModules.[name]/./src/mobile.startup/search/MobileWebSearchLogger.js","webpack://mfModules.[name]/./src/mobile.startup/search/SearchGateway.js","webpack://mfModules.[name]/./src/mobile.startup/search/SearchHeaderView.js","webpack://mfModules.[name]/./src/mobile.startup/search/SearchOverlay.js","webpack://mfModules.[name]/./src/mobile.startup/search/SearchResultsView.js","webpack://mfModules.[name]/./src/mobile.startup/search/searchHeader.js","webpack://mfModules.[name]/./src/mobile.startup/showOnPageReload.js","webpack://mfModules.[name]/./src/mobile.startup/time.js","webpack://mfModules.[name]/./src/mobile.startup/util.js","webpack://mfModules.[name]/./src/mobile.startup/watchstar/WatchstarGateway.js","webpack://mfModules.[name]/./src/mobile.startup/watchstar/WatchstarPageList.js","webpack://mfModules.[name]/./src/mobile.startup/watchstar/watchstar.js","webpack://mfModules.[name]/./src/mobile.talk.overlays/AddTopicForm.js","webpack://mfModules.[name]/./src/mobile.talk.overlays/TalkSectionAddOverlay.js","webpack://mfModules.[name]/./src/mobile.talk.overlays/TalkSectionOverlay.js","webpack://mfModules.[name]/./src/mobile.talk.overlays/autosign.js","webpack://mfModules.[name]/./src/mobile.talk.overlays/makeAddTopicForm.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.categories.overlays/CategoryGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.editor.overlay/EditorGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.editor.overlay/SourceEditorOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.editor.overlay/identifyLeadParagraph.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.editor.overlay/parseBlockInfo.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.init/editorLoadingOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.languages.structured/LanguageSearcher.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.languages.structured/util.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.mediaViewer/ImageCarousel.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.mediaViewer/ImageGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.special.nearby.scripts/NearbyGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.special.watchlist.scripts/WatchList.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.special.watchlist.scripts/WatchListGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Browser.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Button.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/CtaDrawer.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Drawer.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Overlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/OverlayManager.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Page.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/PageGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/PageHTMLParser.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/ScrollEndEventEmitter.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Section.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/Toggler.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/View.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/amcOutreach/AmcEnableForm.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/amcOutreach/amcOutreachDrawer.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/cache.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/extendSearchParams.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/icons.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/languageOverlay/getDeviceLanguage.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/languageOverlay/languageOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/lazyImages/lazyImageLoader.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/mfExtend.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/moduleLoader.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/page/pageJSONParser.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/promisedView.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/promoCampaign/promoCampaign.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/references/ReferencesHtmlScraperGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/references/references.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/search/MobileWebSearchLogger.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/search/SearchGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/search/SearchOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/search/SearchResultsView.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/time.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/util.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/watchstar/Watchstar.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/watchstar/WatchstarGateway.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.startup/watchstar/WatchstarPageList.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.talk.overlays/AddTopicForm.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.talk.overlays/TalkSectionAddOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.talk.overlays/TalkSectionOverlay.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.talk.overlays/autosign.test.js","webpack://mfModules.[name]/./tests/node-qunit/mobile.talk.overlays/makeAddTopicForm.test.js","webpack://mfModules.[name]/./tests/node-qunit/utils/PageGateway.responses.js","webpack://mfModules.[name]/./tests/node-qunit/utils/PageInputs.html.js","webpack://mfModules.[name]/./tests/node-qunit/utils/blank.js","webpack://mfModules.[name]/./tests/node-qunit/utils/dom.js","webpack://mfModules.[name]/./tests/node-qunit/utils/jQuery.js","webpack://mfModules.[name]/./tests/node-qunit/utils/mustache.js","webpack://mfModules.[name]/./tests/node-qunit/utils/mw.js","webpack://mfModules.[name]/./tests/node-qunit/utils/oo.js","webpack://mfModules.[name]/external \"jquery\"","webpack://mfModules.[name]/external \"jsdom\"","webpack://mfModules.[name]/external \"oojs\""],"names":["samsam","formatio","excludeConstructors","quoteStrings","limitChildrenCount","specialObjects","global","push","object","value","document","window","functionName","func","displayName","name","matches","toString","match","constructorName","f","i","l","constructor","excludes","length","test","isCircular","objects","ascii","processed","indent","qs","RegExp","Object","prototype","call","array","String","Infinity","isElement","element","Set","set","Formatio","options","opt","this","delimiters","pieces","Math","min","str","delimit","join","Array","from","prop","obj","k","properties","keys","sort","cons","prefix","is","attr","attrName","val","tagName","toLowerCase","attrs","attributes","pairs","item","nodeName","replace","nodeValue","formatted","content","innerHTML","substr","configure","self","dom","jQuery","mw","sinon","oojs","mustache","module","exports","setUp","sandbox","create","mediaWiki","$","headless","jsdom","JSDOM","undefined","stub","callsFake","Image","Event","navigator","tearDown","Mustache","newMockMediaWiki","OO","ui","Element","static","getClosestScrollableContainer","Tool","reIsDeepProp","reIsPlainProp","reLeadingDot","rePropName","reEscapeChar","reIsHostCtor","freeGlobal","freeSelf","root","Function","uid","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","hasOwnProperty","objectToString","reIsNative","Symbol","splice","Map","getNative","nativeCreate","symbolProto","symbolToString","Hash","entries","index","clear","entry","ListCache","MapCache","assocIndexOf","key","other","baseGet","path","isArray","type","isSymbol","isKey","stringToPath","toKey","baseIsNative","isObject","tag","isFunction","result","e","isHostObject","toSource","getMapData","map","data","__data__","getValue","has","get","pop","memoize","string","baseToString","number","quote","resolver","TypeError","memoized","args","arguments","apply","cache","Cache","isObjectLike","defaultValue","define","r","n","t","o","require","u","a","Error","code","p","1","withGlobal","_global","userAgent","isRunningInIE","indexOf","maxTimeout","pow","setTimeout","clearTimeout","setInterval","clearInterval","Date","setImmediate","clearImmediate","NOOP","timeoutResult","addTimerReturnsObject","hrtimePresent","process","hrtime","nextTickPresent","nextTick","performancePresent","performance","now","hasPerformancePrototype","Performance","requestAnimationFramePresent","requestAnimationFrame","cancelAnimationFramePresent","cancelAnimationFrame","NativeDate","uniqueTimerId","isNumberFinite","num","Number","isFinite","parseTime","parsed","strings","split","ms","parseInt","fixedFloor","floor","ceil","fixedModulo","m","round","getEpoch","epoch","getTime","inRange","to","timer","callAt","mirrorDateProperties","target","source","clock","parse","UTC","toUTCString","createDate","ClockDate","year","month","date","hour","minute","second","enqueueJob","job","jobs","runJobs","loopLimit","addTimer","immediate","delay","max","interval","animation","timers","id","createdAt","duringTick","res","ref","unref","refresh","compareTimers","b","firstTimerInRange","firstTimer","lastTimer","callTimer","eval","clearTimer","timerId","ttype","schedule","uninstall","config","method","methods","hadOwnProperty","shouldAdvanceTime","attachedInterval","ignore","hijackMethod","doIntervalTick","advanceTimeDelta","tick","ks","createClock","start","hrNow","timeouts","getTimeToNextFrame","updateHrTime","newNow","timeout","slice","runMicrotasks","firstException","oldNow","tickFrom","tickTo","previous","next","runAll","runToFrame","runToLast","reset","setSystemTime","systemTime","difference","proto","getOwnPropertyNames","forEach","prev","oldSecs","install","toFake","filter","intervalTick","bind","intervalId","defaultImplementation","factory","escapeRegExp","hasProperty","propName","regExpTest","nonSpaceRe","isWhitespace","re","testRegExp","entityMap","whiteRe","spaceRe","equalsRe","curlyRe","tagRe","Scanner","tail","pos","Context","view","parentContext","parent","Writer","eos","scan","substring","scanUntil","search","lookup","primitive","intermediateValue","names","context","lookupHit","clearCache","template","tags","cacheKey","tokens","openingTagRe","closingTagRe","closingCurlyRe","sections","spaces","hasTag","nonSpace","stripSpace","compileTags","tagsToCompile","chr","token","openSection","scanner","valueLength","charAt","nestedTokens","collector","numTokens","nestTokens","lastToken","squashedTokens","squashTokens","parseTemplate","render","partials","renderTokens","originalTemplate","symbol","buffer","renderSection","renderInverted","renderPartial","unescapedValue","escapedValue","rawValue","j","escape","version","defaultWriter","to_html","send","s","realSetTimeout","logger","useImmediateExceptions","label","msg","err","message","stack","throwLoggedError","2","CustomEvent","customData","initEvent","detail","3","flattenOptions","capture","Boolean","once","passive","hasListenerFilter","listener","listenerSpec","EventTarget","addEventListener","event","providedOptions","eventListeners","some","removeEventListener","fn","dispatchEvent","defaultPrevented","listeners","handleEvent","4","bubbles","cancelable","currentTarget","stopPropagation","preventDefault","5","ProgressEvent","6","progressEventRaw","loaded","total","lengthComputable","7","lolex","fakeServer","Server","fakeServerWithClock","addRequest","xhr","async","resetClock","longestTimeout","clockSetTimeout","clockSetInterval","server","respond","returnVal","restore","8","formatter","9","fakeXhr","format","configureLogError","pathToRegexp","supportsArrayBuffer","ArrayBuffer","responseArray","handler","response","request","wloc","location","rCurrLoc","protocol","host","requestUrl","url","reqMethod","reqUrl","rmeth","matchMethod","matchUrl","matchOne","getHTTPMethod","ru","concat","incrementRequestCount","count","requestCount","requested","requestedOnce","requestedTwice","requestedThrice","firstRequest","getRequest","secondRequest","thirdRequest","lastRequest","useFakeXMLHttpRequest","requests","queue","responses","onCreate","xhrObj","unsafeHeadersEnabled","whitelist","setting","logError","onSend","handleRequest","respondImmediately","autoRespond","responding","autoRespondAfter","fakeHTTPMethods","requestBody","processRequest","log","respondWith","body","respondAll","shift","aborted","readyState","resetBehavior","resetHistory","10","isSupported","Blob","11","GlobalTextEncoder","TextEncoder","sinonEvent","extend","supportsProgress","supportsCustomEvent","supportsFormData","FormData","supportsBlob","unsafeHeaders","EventTargetHandler","eventName","getHeader","headers","header","h","excludeSetCookie2Header","convertToArrayBuffer","encoding","encode","isXmlContentType","contentType","clearResponse","responseType","responseText","responseXML","fakeXMLHttpRequestFor","globalScope","isReactNative","product","sinonXhr","XMLHttpRequest","FakeXMLHttpRequest","UNSENT","requestHeaders","status","statusText","upload","supportsTimeout","supportsCORS","withCredentials","verifyState","OPENED","sendFlag","GlobalXMLHttpRequest","GlobalActiveXObject","ActiveXObject","supportsActiveX","supportsXHR","workingXHR","getWorkingXHR","verifyRequestOpened","requestErrorSteps","errorFlag","responseHeaders","DONE","readyStateChange","filters","addFilter","defake","xhrArgs","copyAttrs","stateChangeStart","HEADERS_RECEIVED","LOADING","stateChangeEnd","onreadystatechange","useFilters","parseXML","text","DOMParser","parser","parsererrorNS","parsererrors","parseFromString","getElementsByTagName","namespaceURI","getElementsByTagNameNS","xmlDoc","loadXML","parseError","errorCode","statusCodes","100","101","200","201","202","203","204","205","206","207","300","301","302","303","304","305","307","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","422","500","501","502","503","504","505","open","username","password","state","progress","readyStateChangeEvent","timedOut","setRequestHeader","checkUnsafeHeaders","normalizeHeaderValue","existingHeader","setStatus","sanitizedStatus","setResponseHeaders","initiatedTime","clearIntervalId","triggerTimeout","abort","error","getResponseHeader","getAllResponseHeaders","reduce","setResponseBody","verifyRequestSent","verifyHeadersReceived","isString","verifyResponseBodyType","overriddenMimeType","isTextResponse","chunkSize","JSON","blobOptions","convertResponseBody","uploadProgress","downloadProgress","uploadError","overrideMimeType","states","keepOnCreate","objId","globalObject","12","13","pass","14","15","every","prototypes","typeOf","valueToString","16","copyPrototype","17","18","19","function","20","21","22","23","24","25","getClass","identical","isArguments","isDate","isNaN","isSet","isSubset","getClassName","deepEqualCyclic","first","objects1","objects2","paths1","paths2","compared","deepEqual","obj1","obj2","path1","path2","isMatcher","type1","type2","isDate1","isDate2","class1","class2","keys1","keys2","name1","name2","size","value1","value2","isObject1","isObject2","index1","index2","newPath1","stringify","newPath2","combinedPath","use","26","27","28","isNegZero","29","callee","30","31","div","createElement","nodeType","appendChild","removeChild","32","33","34","35","36","s1","s2","compare","allContained","v1","includes","v2","37","representation","38","createMatcher","matcher","subset","arrayContains","getAttribute","39","iterableToString","stringProto","arrayIndexOf","arrayEvery","isPrototypeOf","stringIndexOf","assertType","actual","TYPE_MAP","expectation","matchObject","exp","act","regexp","createPropertyMatcher","propertyTest","messagePrefix","property","onlyProperty","or","m2","m1","and","any","defined","truthy","falsy","same","in","arrayOfExpectations","instanceOf","hasInstance","methodPath","assertMethodExists","hasOwn","hasNested","predicate","deepEquals","sameLength","startsWith","expectedElement","endsWith","offset","contains","bool","40","41","42","arr","43","isCloneable","deep","extenders","len","extender","base","44","45","46","isarray","compile","tokensToFunction","tokensToRegExp","PATH_REGEXP","defaultDelimiter","delimiter","escaped","group","modifier","asterisk","partial","repeat","optional","pattern","escapeGroup","escapeString","encodeURIComponentPretty","encodeURI","c","charCodeAt","toUpperCase","opts","pretty","encodeURIComponent","segment","attachKeys","flags","sensitive","strict","end","route","endsWithDelimiter","groups","regexpToRegexp","parts","arrayToRegexp","stringToRegexp","47","amd","typeDetect","promiseExists","Promise","symbolExists","mapExists","setExists","weakMapExists","WeakMap","weakSetExists","WeakSet","dataViewExists","DataView","symbolIteratorExists","iterator","symbolToStringTagExists","toStringTag","setEntriesExists","mapEntriesExists","setIteratorPrototype","getPrototypeOf","mapIteratorPrototype","arrayIteratorExists","arrayIteratorPrototype","stringIteratorExists","stringIteratorPrototype","typeofObj","mimeTypes","plugins","HTMLElement","stringTag","objPrototype","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","draining","queueIndex","cleanUpNextTick","drainQueue","run","marker","runClearTimeout","Item","noop","title","browser","env","argv","versions","on","addListener","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","valueOf","values1","values2","getIndex","registerImmediate","html","channel","onGlobalMessage","nextHandle","tasksByHandle","currentlyRunningATask","doc","attachTo","handle","runIfPresent","postMessage","importScripts","postMessageIsAsynchronous","oldOnMessage","onmessage","canUsePostMessage","MessageChannel","port1","port2","documentElement","script","random","attachEvent","callback","task","assert","collection","spy","spyCall","mock","createStubInstance","defaultConfig","fakeTimers","useFakeTimers","nise","createSandbox","createFakeServer","createFakeServerWithClock","behavior","addBehavior","setFormatter","calledInOrder","orderByFirstCall","timesInWords","sinonMatch","verifyIsStub","fail","proxy","isSinonProxy","getCall","verifyIsValidAssertion","assertionMethod","assertionArgs","failAssertion","mirrorPropAsAssertion","fake","printf","failException","callOrder","expected","calls","called","callCount","expose","includeFail","instance","exposedName","callCallback","callArgAt","argumentList","reverse","callArgProp","getCallback","getCallbackError","callbackAsync","callbackContext","callbackArguments","createBehavior","defaultBehavior","promiseLibrary","isPresent","exception","exceptionCreator","returnArgAt","returnThis","resolveThis","throwArgAt","fakeFn","returnValueDefined","invoke","returnValue","resolve","reject","callsThrough","wrappedMethod","onCall","onFirstCall","onSecondCall","onThirdCall","withArgs","behaviorMethod","syncFnName","sinonFormat","throwYieldError","callProto","calledOn","thisValue","calledWith","calledWithArgs","arg","calledWithMatch","calledWithMatchArgs","calledWithExactly","notCalledWith","notCalledWithMatch","returned","threw","calledWithNew","calledBefore","callId","calledAfter","calledImmediatelyBefore","calledImmediatelyAfter","callArg","ensureArgIsAFunction","callArgOn","callArgWith","callArgOnWith","throwArg","yield","yieldOn","yieldFn","yieldTo","yieldToOn","yieldArg","callStr","createSpyCall","errorWithCallStack","proxyCall","lastArg","defineProperty","enumerable","configurable","invokeCallback","walk","getPropertyDescriptor","collectMethod","propOwner","sinonSpy","sinonStub","sinonMock","collectOwnMethods","getFakes","fakeCollection","fakes","each","verify","privateResetHistory","verifyAndRestore","add","addUsingPromise","usingPromise","stubbed","isStubbingEntireObject","ownMethods","inject","col","supportsColor","colorize","color","stdout","red","green","cyan","white","bold","throwsException","newException","isPropertyConfigurable","propertyDescriptor","callsArg","callsArgOn","callsArgWith","callsArgOnWith","yields","yieldsRight","yieldsOn","yieldsTo","yieldsToOn","throws","returns","returnsArg","throwsArg","returnsThis","resolves","rejects","reason","resolvesThis","callThrough","getterFunction","rootStub","rootObj","setterFunction","newVal","spyInvoke","spyCallToString","receivedMaxCalls","maxCalls","verifyMatcher","possibleMatcher","mockExpectation","minCalls","methodName","verifyCallAllowed","atLeast","limitsSet","atMost","never","exactly","twice","thrice","met","failed","expectedArguments","expectedThis","expectsExactArgCount","expectedArgument","allowsCall","withExactArgs","expectedCallCountInWords","wrapMethod","mockObject","expects","expectations","proxies","failures","invokeMethod","messages","available","currentArgs","expectationsWithMatchingArgs","arr1","arr2","expectedArgs","expectationsToApply","exhausted","unshift","sinonCollection","sinonAssert","sinonClock","sinonSandbox","exposeValue","injectInto","injectedKeys","serverPrototype","useFakeServer","restoreContext","injectedKey","prepareSandboxFromConfig","exposed","jsDiff","colorSinonMatchText","calledArg","calledArgMessage","colorDiffText","diff","part","added","removed","spyInstance","D","calledArgs","expectedArgMessage","diffJson","C","stringifiedCall","thisValues","deprecated","functionToString","isEsModule","ErrorConstructor","types","descriptor","methodDesc","incrementCallCount","notCalled","calledOnce","calledTwice","calledThrice","createCallProperties","firstCall","secondCall","thirdCall","lastCall","uuid","spyApi","formatters","invoking","returnValues","exceptions","callIds","errorsWithCallStack","spyLength","proxyLength","d","g","createProxy","instantiateFake","matchings","matchingFakes","currentCallId","matching","named","getCalls","spyFn","original","matchingArguments","margs","specifyer","delegateToCalls","matchAny","returnsValues","totalCallCount","currentCall","wrap","defaultMsg","behaviors","stubEntireObject","throwOnFalsyObject","actualDescriptor","isCreatingNewStub","isStubbingNonFuncProperty","isStubbingExistingMethod","arity","getDefaultBehavior","stubInstance","getCurrentBehavior","getParentBehaviour","currentBehavior","stubLength","functionStub","fnStub","orig","spies","callMap","hasCallsLeft","calledBeforeNext","isReallyNaN","success","parentNode","isDOMNode","ignoreCase","multiline","aString","aLength","bLength","deepEqual$matcher","injectIntoThis","wrapped","printWarning","funcName","console","info","hasDontEnumBug","toLocaleString","propertyIsEnumerable","unique","sources","customFormatter","aCustomFormatter","getOwnPropertyDescriptor","aCall","bCall","walkInternal","originalObj","seen","mirrorProperties","hasES5Support","checkWrappedMethod","verb","stackTraceError","simplePropertyAssignment","owned","wrappedMethodDesc","llx","modules","installedModules","__webpack_require__","moduleId","__esModule","canonicalize","convertChangesToXML","convertChangesToDMP","merge","parsePatch","applyPatches","applyPatch","createPatch","createTwoFilesPatch","structuredPatch","diffArrays","diffCss","diffSentences","diffTrimmedLines","diffLines","diffWordsWithSpace","diffWords","diffChars","Diff","_base","_base2","_character","_word","_line","_sentence","_css","_json","_array","_apply","_parse","_merge","_create","_dmp","_xml","buildValues","components","newString","oldString","useLongestToken","componentPos","componentLen","newPos","oldPos","component","tmp","oldValue","lastComponent","equals","clonePath","done","castInput","removeEmpty","tokenize","newLen","oldLen","editLength","maxEditLength","bestPath","extractCommon","execEditLength","diagonalPath","basePath","addPath","removePath","_oldPos","canAdd","canRemove","pushComponent","ret","last","commonCount","left","right","comparator","chars","characterDiff","oldStr","newStr","wordDiff","_params","generateOptions","ignoreWhitespace","extendedWordChars","reWhitespace","defaults","lineDiff","retLines","linesAndNewlines","line","newlineIsToken","trim","sentenceDiff","cssDiff","jsonDiff","_typeof","oldObj","newObj","objectPrototypeToString","replacementStack","replacer","canonicalizedObj","toJSON","sortedKeys","_key","_options","undefinedReplacement","_options$stringifyRep","stringifyReplacer","v","arrayDiff","oldArr","newArr","uniDiff","currentIndex","processIndex","complete","loadFile","updatedContent","patched","_distanceIterator","_distanceIterator2","lines","hunks","compareLine","lineNumber","operation","patchContent","errorCount","fuzzFactor","minLine","removeEOFNL","addEOFNL","hunkFits","hunk","toPos","maxLine","oldLines","localOffset","oldStart","diffOffset","_i","_hunk","_toPos","newLines","linedelimiters","previousOperation","_k","diffstr","list","parseIndex","parseFileHeader","parseHunk","fileHeader","keyPrefix","fileName","chunkHeaderIndex","chunkHeader","newStart","addCount","removeCount","wantForward","backwardExhausted","forwardExhausted","calcLineCount","mine","theirs","loadPatch","newFileName","fileNameChanged","oldFileName","selectField","oldHeader","newHeader","mineIndex","theirsIndex","mineOffset","theirsOffset","mineCurrent","theirsCurrent","hunkBefore","cloneHunk","mergedHunk","mergeLines","_toConsumableArray","_calcOldNewLineCount","calcOldNewLineCount","myCount","theirCount","param","patch","conflict","check","mineLines","theirOffset","theirLines","their","insertLeading","theirCurrent","_hunk$lines","collectChange","_hunk$lines2","removal","mutualChange","insertTrailing","myChanges","theirChanges","allRemoves","_hunk$lines3","_hunk$lines4","arrayStartsWith","skipRemoveSuperset","arrayEqual","_hunk$lines5","swap","_hunk$lines6","matchChanges","changes","merged","matchIndex","contextChanges","conflicted","change","collectContext","insert","removeChanges","delta","changeContent","contextLines","oldRangeStart","newRangeStart","curRange","oldLine","newLine","_loop","current","_curRange","_curRange2","_curRange3","contextSize","oldEOFNewline","newEOFNewline","stderr","Timeout","clearFn","_id","_clearFn","scope","close","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","actionParams","util","SearchGateway","CategoryGateway","continueParams","canContinue","searchNamespace","save","categories","api","postWithToken","action","appendtext","summary","getCategories","params","titles","clprop","cllimit","then","continue","inheritClass","Button","View","Icon","BlockMessageDetails","createDetailsAnchorHref","blockId","getUrl","wpTarget","createDetailsAnchorLabel","createTitle","msgKey","user","isAnon","createBody","anonOnly","noCreateAccount","seeMoreLink","reasonHeader","creatorHeader","expiryHeader","cta","progressive","wiki","href","Title","quiet","additionalClassNames","track","events","click","drawer","$el","find","prepend","getButtonConfig","parsedReason","htmlReason","EditorGateway","sectionId","oldId","isNewPage","fromModified","hasChanged","getBlockInfo","pageObj","blockedError","actions","edit","blockinfo","getContent","Deferred","rvprop","intestactions","intestactionsdetail","rvstartid","rvsection","resp","revision","query","pages","missing","revisions","timestamp","originalContent","setContent","setPrependText","prependtext","apiOptions","errorformat","errorlang","errorsuselocal","formatversion","captchaid","captchaId","captchaword","captchaWord","basetimestamp","starttimestamp","section","newrevid","abortPreview","_pending","getPreview","sectionLine","sectionpreview","disableeditsection","pst","mobileformat","post","anchor","promise","Overlay","parseBlockInfo","PageGateway","icons","toast","mfExtend","blockMessageDrawer","MessageBox","mwUser","EditVeTool","toolGroup","classes","super","EditorOverlayBase","onBeforeExit","className","isBorderBox","placeholder","summaryRequestMsg","pageGateway","editCount","isNewEditor","sessionId","overlayManager","icon","onSelect","onUpdateState","hasToolbar","continueMsg","closeMsg","summaryMsg","captchaMsg","captchaTryAgainMsg","switchMsg","confirmMsg","licenseMsg","editor_interface","editor","editing_session_id","logFeatureUse","confirmSave","confirm","onSaveComplete","newRevId","$window","getWindow","saved","invalidatePage","hook","fire","showOnPageReload","revision_id","hash","reload","onSaveFailure","errors","captcha","badtoken","assertanonfailed","assertuserfailed","assertnameduserfailed","spamblacklist","pagedeleted","editconflict","reportError","errorNotice","heading","$errorNoticeContainer","hideErrorNotice","empty","onStageChanges","showHidden","scrollTo","onSaveBegin","confirmAborted","preRender","formHeader","editSwitcher","editingMsg","readOnly","disabled","cancel","saveHeader","previewingMsg","savingHeader","postRender","show","allowCloseWindow","confirmCloseWindow","namespace","onClickBack","onClickSubmit","onClickContinue","onClickAnonymous","exit","switching","windowManager","getWindowManager","addWindows","widgets","AbandonEditDialog","openWindow","closed","mechanism","release","edited","createAnonWarning","$actions","addClass","$anonWarning","append","returnto","returnTo","returntoquery","warning","queryParams","signupParams","signupQueryParams","anonymousEditorActions","block","getOptionsForSwitch","switched","currentPageHTMLParser","fakeScroll","titleObj","contentLang","contentDir","getLoadingPromise","dataPromise","loader","using","handleCaptcha","details","$input","captchaShown","mime","detach","question","Section","saveFailureMessage","fakeToolbar","setPreferredEditor","VisualEditorOverlay","SourceEditorOverlay","isFirefox","visualEditorConfig","gateway","isVisualEditorEnabled","templatePartials","_resizeEditor","ns","namespaces","onInputWikitextEditor","_hidePreview","showAnonWarning","switchToolbar","switchWindow","toolFactory","ToolFactory","toolGroupFactory","ToolGroupFactory","register","libs","ve","MWEditModeVisualTool","MWEditModeSourceTool","Toolbar","mode","canSwitch","fullRestbaseUrl","allowLossySwitching","_switchToVisualEditor","WindowManager","SwitchConfirmDialog","$element","appendTo","destroy","setup","include","spinner","hideSpinner","$preview","$content","hide","$anonHiddenButtons","one","docEl","scrollTop","blockScroll","_loadContent","hideSpinnerAndShowPreview","getDocument","showSpinner","mainpage","parsedText","parsedSectionLine","parseHTML","el","removeClass","container","$scrollContainer","css","height","wikitext","feature","targetLoader","addPlugin","loadModules","newOverlay","requestPageData","targetName","modified","replaceCurrent","remove","router","identifyLeadParagraph","surfaceReady","origDataPromise","getPrefixedDb","sessionStore","init","MobileArticleTarget","trackingName","targetFactory","getSurface","getModel","load","visualeditor","editHeader","destroyTarget","redoTargetInit","adjustContentPadding","restoreEditSection","scrollToLeadParagraph","editLead","editLeadView","readLead","initialCursorOffset","surface","getMode","getView","$attachedRootNode","getLeadSectionElement","top","setLinearSelection","Range","getRange","getSelection","getSelectionBoundingRect","padding","overlay","switchToEditor","switchToSourceEditor","setReadOnly","navigateTo","useReplaceState","hasBeenModified","Drawer","props","blockDrawer","onBeforeHide","onShow","$drawer","drawerTop","creatorTop","buttonsTop","$seeMore","$container","children","$body","$paragraphs","node","isNonLeadParagraph","cloneNode","textContent","isNotEmptyNode","blockInfo","blockpartial","blocknocreate","blockanononly","creator","blockedby","expiry","duration","blockid","blockexpiry","blockreason","moment","jqueryMsgParse","jqueryMsg","ast","wikiTextToAst","emitter","blockedbyid","makeTitle","Api","contentmodel","catch","readonlyreason","storage","saveOption","afterShow","afterHide","$fakeToolbar","noHeader","$goBack","$loadingMessage","hasText","langUtil","LanguageSearcher","languages","getStructuredLanguages","variants","getFrequentlyUsedLanguages","showSuggestedLanguages","deviceLanguage","inputPlaceholder","allLanguagesHeader","toLocaleUpperCase","suggestedLanguagesHeader","allLanguages","all","allLanguagesCount","suggestedLanguages","suggested","suggestedLanguagesCount","$siteLinksList","$languageItems","$subheaders","onLinkClick","ev","lang","saveLanguageUsageCount","onSearchInput","filterLanguages","filteredList","language","langname","autonym","variant","mfUtils","rtlLanguages","getDir","frequentlyUsedLanguages","maxFrequency","minFrequency","missingDir","addLangDir","parentLanguage","deviceLanguagesWithVariants","getDeviceLanguageOrParent","frequency","toLocaleLowerCase","warn","languageMap","saveFrequentlyUsedLanguages","languageCode","detailsButton","slideLeftButton","rotation","slideRightButton","LoadErrorMessage","ImageGateway","ImageCarousel","eventBus","hasLoadError","licenseLinkMsg","thumbnails","onSlide","newImageCarousel","nextThumbnail","closest","filename","replaceWith","thumbnail","getFileName","caption","getDescription","galleryOffset","_enableArrowImages","thumbs","lastThumb","nextThumb","_disableArrowImages","_handleRetry","$img","$spinner","showLoadFailMsg","retryPath","getPath","prependTo","addImageLoadClass","$details","getThumb","author","descriptionurl","thumbWidth","thumbwidth","thumbHeight","thumbheight","imgRatio","thumburl","_positionImage","extmetadata","LicenseShortName","Artist","adjustDetails","onToggleDetails","toggle","detailsHeight","windowWidth","windowHeight","windowRatio","outerHeight","width","sizeBuckets","findSizeBucket","_cache","cachedThumb","imageSizeMultiplier","devicePixelRatio","iiprop","iiurlwidth","iiurlheight","imageinfo","_findSizeBucket","isTemplateMode","msgToUser","retryTxt","onRetry","pageJSONParser","extendSearchParams","NearbyGateway","_distanceMessage","convertNumber","toFixed","getPages","coords","range","exclude","_search","ggscoord","latitude","longitude","getPagesAroundPage","page","ggspage","requestParams","colimit","generator","ggsradius","ggsnamespace","ggslimit","codistancefrompoint","codistancefrompage","ajax","coordinates","dist","lat","lon","proximity","PageList","WatchstarPageList","ScrollEndEventEmitter","WatchListGateway","WatchList","lastTitle","scrollEndEventEmitter","EVENT_SCROLL_END","_loadPages","getLastTitle","disable","setElement","$items","statuses","queryUnitializedItems","parsePagesFromItems","renderItems","enable","loadWatchlist","appendPage","templateOptions","wikidataDescription","limit","gwrcontinue","shouldSkipFirstTitle","gwrnamespace","gwrlimit","apiUrl","parseData","p1","p2","Anchor","destructive","cacheId","Browser","ua","isIos","ios","isWideScreen","innerWidth","supportsTouchEvents","supportsGeoLocation","getSingleton","$html","CtaDrawer","redirectParams","progressiveButton","signUpParams","actionAnchor","redirectURL","drawerClassName","collapseIcon","showCollapseIcon","minHideDelay","hasClass","$mask","isTypeButton","setRotationClass","_rotationClass","glyphPrefix","isSmall","getGlyphClassName","headerChrome","hideTimeout","footerAnchor","$overlayContent","headerActions","onExitClick","pageYOffset","pageXOffset","make","MANAGED_STATE","OverlayManager","_checkRoute","hideCurrent","attachHideEvent","_onHideOverlayOutsideOverlayManager","currentRoute","routeIsString","currentPath","routeIsSame","back","_attachOverlay","parents","_show","history","replaceState","_hideOverlay","onBeforeExitCancel","_processMatch","factoryResult","_matchRoute","didMatch","captures","docReady","stackOverlay","pushState","__clearCache","HTML","Page","relevantTitle","displayTitle","namespaceNumber","protection","_isMainPage","isMainPage","isMissing","lastModified","revId","_isWatched","isWatched","_sectionLookup","sectionData","isLandscape","sectionTemplate","transformSections","lastSection","existingSectionLevels","level","collapseLevel","subsections","assignToParent","listOfSections","child","_getLanguageVariantsFromApiResponse","generalData","general","variantPath","variantarticlepath","getPageLanguages","meta","siprop","lllimit","llprop","llinlanguagecode","langlinks","_getAPIResponseFromHTML","$headings","$span","getSectionsFromHTML","Thumbnail","HEADING_SELECTOR","BLACKLISTED_THUMBNAIL_CLASS_SELECTORS","PageHTMLParser","sectionIndex","eq","selector","$heading","$nextHeading","$lead","headingSelector","withNestedChildren","$matchingNodes","addBack","findSectionHeadingByIndex","prevAll","nextAll","nextUntil","$leadSection","blacklistSelector","not","$a","$lazyImage","valid","legacyMatch","decodeURIComponent","renderPageImages","style","threshold","EventEmitter","mixinClass","_bindScroll","_scrollHandler","_onScroll","_unbindScroll","enabled","scrollNearEnd","scrollBottom","endPosition","hasReferences","description","siblings","escapeHash","arrowOptions","Toggler","_enable","isClosed","getExpandedSections","expandedSections","session","saveExpandedSections","expandStoredSections","toggler","$sectionHeading","$headline","cleanObsoleteStoredSections","indicator","wasExpanded","$headingLabel","toggleClass","requestIdleCallback","expanded","isReferenceSection","headline","isSectionOpen","storeSectionToggleState","reveal","$target","expandSections","$link","internalRedirect","internalRedirectHash","collapseSectionsByDefault","checkHash","decodedHash","$indicator","tabindex","role","which","enableKeyboardActions","_getExpandedSections","_expandStoredSections","_cleanObsoleteStoredSections","delegateEventSplitter","idCounter","initialize","cid","_postInitialize","undelegateEvents","skipTemplateRender","delegateEvents","delegate","undelegate","$child","defaultParams","otherParams","scriptPath","origin","AmcEnableForm","buttonLabel","promoCampaign","mwMessage","mwUtil","csrfToken","returnToTitle","returnToQuery","postUrl","fields","submit","makeActionIneligible","MemoryCache","NoCache","displayWikibaseDescriptions","nearby","watchlist","tagline","makeHeader","headingOrView","headerCancel","templateData","hasActions","isHidden","insertAfter","saveButtonMessage","formHTMLOrView","CANCEL_GLYPH","glyph","watchIcon","watchedIcon","userLanguage","browserLanguage","systemLanguage","getDeviceLanguage","promisedView","loadLanguageSearcher","languageOverlay","placeholderClass","queryPlaceholders","getElementsByClassName","loadImages","placeholders","loadImage","deferred","dataset","image","class","alt","useMap","usemap","cssText","classList","replaceChild","src","srcset","Child","ParentOrPrototype","initClass","ModuleLoader","_register","registry","localRequire","deprecate","deprecatedId","replacement","thumb","pageprops","displaytitle","terms","pageid","newView","errorView","campaignName","campaignActive","userEligible","mwStorage","ACTIONS_TO_STORAGE_KEYS","isCampaignActive","validateAction","isActionEligible","showIfEligible","makeAllActionsIneligible","ReferencesGateway","getReference","ERROR_NOT_EXIST","ERROR_OTHER","ReferencesHtmlScraperGateway","EXTERNAL_LINK_CLASS","getReferenceFromContainer","$ol","$parent","escapeSelector","getReferenceHtml","parentText","$reference","pageHTMLParser","references","makeOnNestedReferenceClickHandler","onNestedReferenceClick","querySelector","referenceDrawer","errorIcon","showReference","refNumber","onShowNestedReference","reference","nestedDrawer","MobileWebSearchLogger","userSessionToken","searchSessionToken","_newUserSession","generateRandomSessionId","_newSearchSession","searchSessionCreatedAt","onSearchShow","onSearchStart","timeOffsetSinceStart","onSearchResults","resultSetType","numberOfResults","results","timeToDisplayResults","onSearchResultClick","clickIndex","resultIndex","searchOverlay","searchCache","getApiData","redirects","pilimit","pithumbsize","tiny","_createSearchRegEx","_highlightSearchTerm","term","_getPage","pageInfo","displaytext","_processData","isCached","SearchHeaderView","onInput","clearIcon","trigger","searchHeader","SearchResultsView","SearchOverlay","placeholderMsg","performSearch","defaultSearchPage","gatewayClass","onClickSearchContent","$form","onClickOverlayContent","hideKeyboardOnScroll","onClickResult","$result","$results","originalEvent","searchResults","searchContentLabel","noResultsMsg","searchContentNoResultsMsg","clearSearch","$searchContent","$resultContainer","searchData","showKeyboard","setSelectionRange","lastQuery","_pendingQuery","funnel","resetSearch","feedback","prompt","feedbackLink","storageKey","notify","units","limits","timeAgo","timestampDelta","unit","getTimeAgoDelta","isNow","getLastModifiedMessage","ts","gender","historyUrl","historyPageAnchor","userPageAnchor","seconds","minutes","hours","days","months","years","getRegistrationMessage","isRecent","promises","when","grep","ctx","isNumeric","isModifiedEvent","altKey","ctrlKey","metaKey","shiftKey","repeatEvent","getSource","partialSource","WatchstarGateway","getStatuses","ids","getStatusesByID","getStatusesByTitle","inprop","pageids","rsp","_unmarshalGetResponse","postStatusesByTitle","watched","unwatch","watchstar","wsGateway","_","$item","getTitle","_appendWatchstar","iconProps","newFromText","WATCH_CLASS","WATCHED_CLASS","activeIcon","makePanel","panel","AddTopicForm","topicTitlePlaceHolder","topicContentPlaceHolder","$subject","subject","cols","rows","panels","$messageBody","onTextInput","makeAddTopicForm","TalkSectionAddOverlay","editorApi","currentPageTitle","_saveHit","topicForm","$confirm","$ta","confirmMessage","onSaveClick","editMsg","sectiontitle","autosign","lazyImageLoader","TalkSectionOverlay","saveButton","reply","onInputTextarea","$saveButton","_enableComments","$commentBox","$textarea","redirect","oo","QUnit","beforeEach","getSpy","batchcomplete","postSpy","afterEach","notStrictEqual","strictEqual","ok","postStub","apiReject","apiHappy","apiRvNoSection","apiCaptchaFail","apiAbuseFilterDisallow","apiAbuseFilterWarning","apiAbuseFilterOther","apiTestError","apiReadOnly","apiExpiredToken","apiWithSectionLine","apiHappyTestContent","apiEmptySuccessResponse","apiNoSectionLine","apiRejectHttp","happyResponse","API_REQUEST_DATA","apiReadOnlyResponse","0","notOk","given","propEqual","resolveSpy","rejectSpy","expectedReturnValue","messageStub","getContentStub","previewResolve","dBlockedContent","editorOverlay","infobox","stackInfobox","emptyStack","multiStackInfobox","paragraph","cases","expectedSel","$dom","expectedNode","ParseBlockInfo","editorLoadingOverlay","fakeRouter","apiLanguages","zh","en","ko","enterText","searcher","languageSearcher","apiVariants","structuredLanguages","saveSpy","variantsMap","suggestedLanguage","ImageOverlay","imageGateway","nearbyGateway","pageimage","primary","globe","msgKm","msgM","toPrecision","pl","watchIconName","pageimages","picontinue","warnings","pagelanguage","touched","lastrevid","new","response1","watchlistraw","mediawiki","tmpDOM","browser4","browser5","browser2","ipad","iphone","android2","ontouchstart","geolocation","button","defaultURLs","overrideURLs","pageName","outerHTML","assertHidden","$viewport","$headingNode","TestOverlay","overlays","routeEvent","createFakeOverlay","fakeOverlay","singleton","showSpy","overlayManagerEmpty","anotherFakeOverlay","factoryStub","manager","backEvent","backEventPreventDefaultSpy","_exit","escapableOverlay","cannotGoBackOverlay","parentFakeOverlay","parentFactoryStub","examples","page2","testData","getPageLanguagesResponse","input","output","getPageLanguagesCall","getAPIResponseFromHTML","stubPage","mobileTocPage","desktopPage","sectionPage","PARSER_OUTPUT","expect","findChildInSectionLead","testcase","textPage","pLegacyUrls","getThumbnails","pNoViewer","pMetadata","pMetadataNested","pLazyImages","pLazyImagesTypo","metadataTable","is2","emitSpy","subsection","$section0","_session","$section","mwStorageSetSpy","isEmptyObject","mwStorageSetCall","mwStorageSetCall2","localStorageValue","localStorageRemovalValue","expandedSectionsFromToggle","expandedSections2","ChildView","EventsView","onParagraphClick","onClick","TemplateModeView","ContainerView","textFirstRun","view2","amcOutreachDrawer","HTMLFormElement","memoryCache","foo","expectedError","qux","wbptterms","baz","quux","testCase","gatewayDeferred","setAttribute","failureImage","successImage","TestChild","TestPrototype","testPrototype","protoMethod","testChild","getDisplayTitle","testDesc","json","happyView","viewSuccess","viewFailure","sadView","ACTIONS","onLoad","ON_LOAD_STORAGE_KEY","referencesGateway","referencesPage","pageParser","renderSpy","sup","eventWithAnchor","eventWithDiv","60","onBeforeExitSpy","overlayOptions","time","result2","htmlFragment","NaN","testEl","MouseEvent","watchstarSpy","watchedStar","star","GET_RESPONSE","pagelanguagehtmlcode","pagelanguagedir","mockAPI","apiResp","mwApi","apiSpy","pageList","formNoInputEvent","form","toastStub","formNoHandler","getPageHeadings","mobileview","lastmodifiedby","lastmodified","languagecount","lastModifiedUserName","lastModifiedUserGender","lastModifiedTimestamp","languageCount","hasVariants","lead"],"mappings":"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","file":"tests.mobilefrontend.js","sourcesContent":["(function (root, factory) {\n    \"use strict\";\n\n    if (typeof define === \"function\" && define.amd) {\n        // AMD. Register as an anonymous module.\n        define([\"samsam\"], factory);\n    } else if (typeof module === \"object\" && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require(\"samsam\"));\n    } else {\n        // Browser globals (root is window)\n        root.formatio = factory(root.samsam);\n    }\n}(typeof self !== \"undefined\" ? self : this, function (samsam) {\n    \"use strict\";\n\n    var formatio = {\n        excludeConstructors: [\"Object\", /^.$/],\n        quoteStrings: true,\n        limitChildrenCount: 0\n    };\n\n    var specialObjects = [];\n    if (typeof global !== \"undefined\") {\n        specialObjects.push({ object: global, value: \"[object global]\" });\n    }\n    if (typeof document !== \"undefined\") {\n        specialObjects.push({\n            object: document,\n            value: \"[object HTMLDocument]\"\n        });\n    }\n    if (typeof window !== \"undefined\") {\n        specialObjects.push({ object: window, value: \"[object Window]\" });\n    }\n\n    function functionName(func) {\n        if (!func) { return \"\"; }\n        if (func.displayName) { return func.displayName; }\n        if (func.name) { return func.name; }\n        var matches = func.toString().match(/function\\s+([^\\(]+)/m);\n        return (matches && matches[1]) || \"\";\n    }\n\n    function constructorName(f, object) {\n        var name = functionName(object && object.constructor);\n        var excludes = f.excludeConstructors ||\n                formatio.excludeConstructors || [];\n\n        var i, l;\n        for (i = 0, l = excludes.length; i < l; ++i) {\n            if (typeof excludes[i] === \"string\" && excludes[i] === name) {\n                return \"\";\n            } else if (excludes[i].test && excludes[i].test(name)) {\n                return \"\";\n            }\n        }\n\n        return name;\n    }\n\n    function isCircular(object, objects) {\n        if (typeof object !== \"object\") { return false; }\n        var i, l;\n        for (i = 0, l = objects.length; i < l; ++i) {\n            if (objects[i] === object) { return true; }\n        }\n        return false;\n    }\n\n    function ascii(f, object, processed, indent) {\n        if (typeof object === \"string\") {\n            if (object.length === 0) { return \"(empty string)\"; }\n            var qs = f.quoteStrings;\n            var quote = typeof qs !== \"boolean\" || qs;\n            return processed || quote ? \"\\\"\" + object + \"\\\"\" : object;\n        }\n\n        if (typeof object === \"function\" && !(object instanceof RegExp)) {\n            return ascii.func(object);\n        }\n\n        processed = processed || [];\n\n        if (isCircular(object, processed)) { return \"[Circular]\"; }\n\n        if (Object.prototype.toString.call(object) === \"[object Array]\") {\n            return ascii.array.call(f, object, processed);\n        }\n\n        if (!object) { return String((1 / object) === -Infinity ? \"-0\" : object); }\n        if (samsam.isElement(object)) { return ascii.element(object); }\n\n        if (typeof object.toString === \"function\" &&\n                object.toString !== Object.prototype.toString) {\n            return object.toString();\n        }\n\n        var i, l;\n        for (i = 0, l = specialObjects.length; i < l; i++) {\n            if (object === specialObjects[i].object) {\n                return specialObjects[i].value;\n            }\n        }\n\n        if (typeof Set !== \"undefined\" && object instanceof Set) {\n            return ascii.set.call(f, object, processed);\n        }\n\n        return ascii.object.call(f, object, processed, indent);\n    }\n\n    ascii.func = function (func) {\n        return \"function \" + functionName(func) + \"() {}\";\n    };\n\n    function delimit(str, delimiters) {\n        delimiters = delimiters || [\"[\", \"]\"];\n        return delimiters[0] + str + delimiters[1];\n    }\n\n    ascii.array = function (array, processed, delimiters) {\n        processed = processed || [];\n        processed.push(array);\n        var pieces = [];\n        var i, l;\n        l = (this.limitChildrenCount > 0) ?\n            Math.min(this.limitChildrenCount, array.length) : array.length;\n\n        for (i = 0; i < l; ++i) {\n            pieces.push(ascii(this, array[i], processed));\n        }\n\n        if (l < array.length) {\n            pieces.push(\"[... \" + (array.length - l) + \" more elements]\");\n        }\n\n        return delimit(pieces.join(\", \"), delimiters);\n    };\n\n    ascii.set = function (set, processed) {\n        return ascii.array.call(this, Array.from(set), processed, [\"Set {\", \"}\"]);\n    };\n\n    ascii.object = function (object, processed, indent) {\n        processed = processed || [];\n        processed.push(object);\n        indent = indent || 0;\n        var pieces = [];\n        var properties = samsam.keys(object).sort();\n        var length = 3;\n        var prop, str, obj, i, k, l;\n        l = (this.limitChildrenCount > 0) ?\n            Math.min(this.limitChildrenCount, properties.length) : properties.length;\n\n        for (i = 0; i < l; ++i) {\n            prop = properties[i];\n            obj = object[prop];\n\n            if (isCircular(obj, processed)) {\n                str = \"[Circular]\";\n            } else {\n                str = ascii(this, obj, processed, indent + 2);\n            }\n\n            str = (/\\s/.test(prop) ? \"\\\"\" + prop + \"\\\"\" : prop) + \": \" + str;\n            length += str.length;\n            pieces.push(str);\n        }\n\n        var cons = constructorName(this, object);\n        var prefix = cons ? \"[\" + cons + \"] \" : \"\";\n        var is = \"\";\n        for (i = 0, k = indent; i < k; ++i) { is += \" \"; }\n\n        if (l < properties.length)\n        {pieces.push(\"[... \" + (properties.length - l) + \" more elements]\");}\n\n        if (length + indent > 80) {\n            return prefix + \"{\\n  \" + is + pieces.join(\",\\n  \" + is) + \"\\n\" +\n                is + \"}\";\n        }\n        return prefix + \"{ \" + pieces.join(\", \") + \" }\";\n    };\n\n    ascii.element = function (element) {\n        var tagName = element.tagName.toLowerCase();\n        var attrs = element.attributes;\n        var pairs = [];\n        var attr, attrName, i, l, val;\n\n        for (i = 0, l = attrs.length; i < l; ++i) {\n            attr = attrs.item(i);\n            attrName = attr.nodeName.toLowerCase().replace(\"html:\", \"\");\n            val = attr.nodeValue;\n            if (attrName !== \"contenteditable\" || val !== \"inherit\") {\n                if (val) { pairs.push(attrName + \"=\\\"\" + val + \"\\\"\"); }\n            }\n        }\n\n        var formatted = \"<\" + tagName + (pairs.length > 0 ? \" \" : \"\");\n        // SVG elements have undefined innerHTML\n        var content = element.innerHTML || \"\";\n\n        if (content.length > 20) {\n            content = content.substr(0, 20) + \"[...]\";\n        }\n\n        var res = formatted + pairs.join(\" \") + \">\" + content +\n                \"</\" + tagName + \">\";\n\n        return res.replace(/ contentEditable=\"inherit\"/, \"\");\n    };\n\n    function Formatio(options) {\n        // eslint-disable-next-line guard-for-in\n        for (var opt in options) {\n            this[opt] = options[opt];\n        }\n    }\n\n    Formatio.prototype = {\n        functionName: functionName,\n\n        configure: function (options) {\n            return new Formatio(options);\n        },\n\n        constructorName: function (object) {\n            return constructorName(this, object);\n        },\n\n        ascii: function (object, processed, indent) {\n            return ascii(this, object, processed, indent);\n        }\n    };\n\n    return Formatio.prototype;\n}));\n","/* global QUnit */\nconst dom = require( './src/dom' ),\n\tjQuery = require( './src/jQuery' ),\n\tmw = require( './src/mw' ),\n\tsinon = require( 'sinon' ),\n\toojs = require( './src/oo' ),\n\tmustache = require( './src/mustache' );\n\nmodule.exports = {\n\tdom, jQuery, mw, mustache, oojs, sinon,\n\tsetUp: function () {\n\t\tconst sandbox = sinon.sandbox.create();\n\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tglobal.mediaWiki = global.mw;\n\t\tglobal.jQuery = global.$;\n\t\treturn sandbox;\n\t}\n};\n","var\n\theadless = typeof window !== 'object',\n\tjsdom = headless && require( 'jsdom' );\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tconst window = new jsdom.JSDOM().window,\n\t\t\t\tdocument = window.document;\n\n\t\t\tglobal.window = window || undefined;\n\t\t\tglobal.document = document || undefined;\n\t\t\tsandbox.stub( global, 'window' ).callsFake( () => window );\n\t\t\tsandbox.stub( global, 'document' ).callsFake( () => document );\n\t\t\tglobal.Image = global.window.Image;\n\t\t\tglobal.Event = global.window.Event;\n\t\t\tglobal.navigator = global.window.navigator;\n\t\t}\n\t}\n};\n","var headless = typeof window !== 'object';\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tconst $ = require( 'jquery' );\n\t\t\tglobal.$ = $ || undefined;\n\t\t\tsandbox.stub( global, '$' ).callsFake( $ );\n\t\t}\n\t},\n\ttearDown: function () {\n\t\tif ( headless ) {\n\t\t\t// prevent jQuery from caching the global window object.\n\t\t\tdelete require.cache[require.resolve( 'jquery' )];\n\t\t}\n\t}\n};\n","var headless = typeof window !== 'object';\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tif ( headless ) {\n\t\t\tconst Mustache = require( 'mustache' );\n\t\t\tglobal.Mustache = Mustache || undefined;\n\t\t\tsandbox.stub( global, 'Mustache' ).callsFake( () => Mustache );\n\t\t}\n\t}\n};\n","var\n\theadless = typeof window !== 'object',\n\tnewMockMediaWiki = require( './mockMediaWiki' );\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tconst mw = newMockMediaWiki();\n\t\tif ( headless ) {\n\t\t\tglobal.mw = mw || undefined;\n\n\t\t\tsandbox.stub( global, 'mw' ).callsFake( () => mw );\n\t\t}\n\t}\n};\n","var headless = typeof window !== 'object';\n\nmodule.exports = {\n\t/**\n\t * @param {sinon.SinonSandbox} sandbox\n\t * @param {NodeJS.Global} global\n\t * @return {void}\n\t */\n\tsetUp: function ( sandbox, global ) {\n\t\tvar OO;\n\t\tif ( headless ) {\n\t\t\tOO = require( 'oojs' );\n\t\t\tOO.ui = {\n\t\t\t\tElement: {\n\t\t\t\t\tstatic: {\n\t\t\t\t\t\tgetClosestScrollableContainer: function () {}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tTool: function () {}\n\t\t\t};\n\t\t\tglobal.OO = OO || undefined;\n\t\t\tsandbox.stub( global, 'OO' ).callsFake( () => OO );\n\t\t}\n\t}\n};\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.lolex = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n(function (global){\n\"use strict\";\n\nfunction withGlobal(_global) {\n    var userAgent = _global.navigator && _global.navigator.userAgent;\n    var isRunningInIE = userAgent && userAgent.indexOf(\"MSIE \") > -1;\n    var maxTimeout = Math.pow(2, 31) - 1; //see https://heycam.github.io/webidl/#abstract-opdef-converttoint\n\n    // Make properties writable in IE, as per\n    // http://www.adequatelygood.com/Replacing-setTimeout-Globally.html\n    if (isRunningInIE) {\n        _global.setTimeout = _global.setTimeout;\n        _global.clearTimeout = _global.clearTimeout;\n        _global.setInterval = _global.setInterval;\n        _global.clearInterval = _global.clearInterval;\n        _global.Date = _global.Date;\n    }\n\n    // setImmediate is not a standard function\n    // avoid adding the prop to the window object if not present\n    if (_global.setImmediate !== undefined) {\n        _global.setImmediate = _global.setImmediate;\n        _global.clearImmediate = _global.clearImmediate;\n    }\n\n    // node expects setTimeout/setInterval to return a fn object w/ .ref()/.unref()\n    // browsers, a number.\n    // see https://github.com/cjohansen/Sinon.JS/pull/436\n\n    var NOOP = function () { return undefined; };\n    var timeoutResult = _global.setTimeout(NOOP, 0);\n    var addTimerReturnsObject = typeof timeoutResult === \"object\";\n    var hrtimePresent = (_global.process && typeof _global.process.hrtime === \"function\");\n    var nextTickPresent = (_global.process && typeof _global.process.nextTick === \"function\");\n    var performancePresent = (_global.performance && typeof _global.performance.now === \"function\");\n    var hasPerformancePrototype = (_global.Performance && (typeof _global.Performance).match(/^(function|object)$/));\n    var requestAnimationFramePresent = (\n        _global.requestAnimationFrame && typeof _global.requestAnimationFrame === \"function\"\n    );\n    var cancelAnimationFramePresent = (\n        _global.cancelAnimationFrame && typeof _global.cancelAnimationFrame === \"function\"\n    );\n\n    _global.clearTimeout(timeoutResult);\n\n    var NativeDate = _global.Date;\n    var uniqueTimerId = 1;\n\n    function isNumberFinite(num) {\n        if (Number.isFinite) {\n            return Number.isFinite(num);\n        }\n\n        if (typeof num !== \"number\") {\n            return false;\n        }\n\n        return isFinite(num);\n    }\n\n    /**\n     * Parse strings like \"01:10:00\" (meaning 1 hour, 10 minutes, 0 seconds) into\n     * number of milliseconds. This is used to support human-readable strings passed\n     * to clock.tick()\n     */\n    function parseTime(str) {\n        if (!str) {\n            return 0;\n        }\n\n        var strings = str.split(\":\");\n        var l = strings.length;\n        var i = l;\n        var ms = 0;\n        var parsed;\n\n        if (l > 3 || !/^(\\d\\d:){0,2}\\d\\d?$/.test(str)) {\n            throw new Error(\"tick only understands numbers, 'm:s' and 'h:m:s'. Each part must be two digits\");\n        }\n\n        while (i--) {\n            parsed = parseInt(strings[i], 10);\n\n            if (parsed >= 60) {\n                throw new Error(\"Invalid time \" + str);\n            }\n\n            ms += parsed * Math.pow(60, (l - i - 1));\n        }\n\n        return ms * 1000;\n    }\n\n    /**\n     * Floor function that also works for negative numbers\n     */\n    function fixedFloor(n) {\n        return (n >= 0 ? Math.floor(n) : Math.ceil(n));\n    }\n\n    /**\n     * % operator that also works for negative numbers\n     */\n    function fixedModulo(n, m) {\n        return Math.round(((n % m) + m) % m);\n    }\n\n    /**\n     * Used to grok the `now` parameter to createClock.\n     * @param epoch {Date|number} the system time\n     */\n    function getEpoch(epoch) {\n        if (!epoch) { return 0; }\n        if (typeof epoch.getTime === \"function\") { return epoch.getTime(); }\n        if (typeof epoch === \"number\") { return epoch; }\n        throw new TypeError(\"now should be milliseconds since UNIX epoch\");\n    }\n\n    function inRange(from, to, timer) {\n        return timer && timer.callAt >= from && timer.callAt <= to;\n    }\n\n    function mirrorDateProperties(target, source) {\n        var prop;\n        for (prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                target[prop] = source[prop];\n            }\n        }\n\n        // set special now implementation\n        if (source.now) {\n            target.now = function now() {\n                return target.clock.now;\n            };\n        } else {\n            delete target.now;\n        }\n\n        // set special toSource implementation\n        if (source.toSource) {\n            target.toSource = function toSource() {\n                return source.toSource();\n            };\n        } else {\n            delete target.toSource;\n        }\n\n        // set special toString implementation\n        target.toString = function toString() {\n            return source.toString();\n        };\n\n        target.prototype = source.prototype;\n        target.parse = source.parse;\n        target.UTC = source.UTC;\n        target.prototype.toUTCString = source.prototype.toUTCString;\n\n        return target;\n    }\n\n    function createDate() {\n        function ClockDate(year, month, date, hour, minute, second, ms) {\n            // Defensive and verbose to avoid potential harm in passing\n            // explicit undefined when user does not pass argument\n            switch (arguments.length) {\n                case 0:\n                    return new NativeDate(ClockDate.clock.now);\n                case 1:\n                    return new NativeDate(year);\n                case 2:\n                    return new NativeDate(year, month);\n                case 3:\n                    return new NativeDate(year, month, date);\n                case 4:\n                    return new NativeDate(year, month, date, hour);\n                case 5:\n                    return new NativeDate(year, month, date, hour, minute);\n                case 6:\n                    return new NativeDate(year, month, date, hour, minute, second);\n                default:\n                    return new NativeDate(year, month, date, hour, minute, second, ms);\n            }\n        }\n\n        return mirrorDateProperties(ClockDate, NativeDate);\n    }\n\n\n    function enqueueJob(clock, job) {\n        // enqueues a microtick-deferred task - ecma262/#sec-enqueuejob\n        if (!clock.jobs) {\n            clock.jobs = [];\n        }\n        clock.jobs.push(job);\n    }\n\n    function runJobs(clock) {\n        // runs all microtick-deferred tasks - ecma262/#sec-runjobs\n        if (!clock.jobs) {\n            return;\n        }\n        for (var i = 0; i < clock.jobs.length; i++) {\n            var job = clock.jobs[i];\n            job.func.apply(null, job.args);\n            if (clock.loopLimit && i > clock.loopLimit) {\n                throw new Error(\"Aborting after running \" + clock.loopLimit + \" timers, assuming an infinite loop!\");\n            }\n        }\n        clock.jobs = [];\n    }\n\n    function addTimer(clock, timer) {\n        if (timer.func === undefined) {\n            throw new Error(\"Callback must be provided to timer calls\");\n        }\n\n        timer.type = timer.immediate ? \"Immediate\" : \"Timeout\";\n\n        if (timer.hasOwnProperty(\"delay\")) {\n            if (!isNumberFinite(timer.delay)) {\n                timer.delay = 0;\n            }\n            timer.delay = timer.delay > maxTimeout ? 1 : timer.delay;\n            timer.delay = Math.max(0, timer.delay);\n        }\n\n        if (timer.hasOwnProperty(\"interval\")) {\n            timer.type = \"Interval\";\n            timer.interval = timer.interval > maxTimeout ? 1 : timer.interval;\n        }\n\n        if (timer.hasOwnProperty(\"animation\")) {\n            timer.type = \"AnimationFrame\";\n            timer.animation = true;\n        }\n\n        if (!clock.timers) {\n            clock.timers = {};\n        }\n\n        timer.id = uniqueTimerId++;\n        timer.createdAt = clock.now;\n        timer.callAt = clock.now + (parseInt(timer.delay) || (clock.duringTick ? 1 : 0));\n\n        clock.timers[timer.id] = timer;\n\n        if (addTimerReturnsObject) {\n            var res = {\n                id: timer.id,\n                ref: function () { return res; },\n                unref: function () { return res; },\n                refresh: function () { return res; }\n            };\n            return res;\n        }\n\n        return timer.id;\n    }\n\n\n    /* eslint consistent-return: \"off\" */\n    function compareTimers(a, b) {\n        // Sort first by absolute timing\n        if (a.callAt < b.callAt) {\n            return -1;\n        }\n        if (a.callAt > b.callAt) {\n            return 1;\n        }\n\n        // Sort next by immediate, immediate timers take precedence\n        if (a.immediate && !b.immediate) {\n            return -1;\n        }\n        if (!a.immediate && b.immediate) {\n            return 1;\n        }\n\n        // Sort next by creation time, earlier-created timers take precedence\n        if (a.createdAt < b.createdAt) {\n            return -1;\n        }\n        if (a.createdAt > b.createdAt) {\n            return 1;\n        }\n\n        // Sort next by id, lower-id timers take precedence\n        if (a.id < b.id) {\n            return -1;\n        }\n        if (a.id > b.id) {\n            return 1;\n        }\n\n        // As timer ids are unique, no fallback `0` is necessary\n    }\n\n    function firstTimerInRange(clock, from, to) {\n        var timers = clock.timers;\n        var timer = null;\n        var id, isInRange;\n\n        for (id in timers) {\n            if (timers.hasOwnProperty(id)) {\n                isInRange = inRange(from, to, timers[id]);\n\n                if (isInRange && (!timer || compareTimers(timer, timers[id]) === 1)) {\n                    timer = timers[id];\n                }\n            }\n        }\n\n        return timer;\n    }\n\n    function firstTimer(clock) {\n        var timers = clock.timers;\n        var timer = null;\n        var id;\n\n        for (id in timers) {\n            if (timers.hasOwnProperty(id)) {\n                if (!timer || compareTimers(timer, timers[id]) === 1) {\n                    timer = timers[id];\n                }\n            }\n        }\n\n        return timer;\n    }\n\n    function lastTimer(clock) {\n        var timers = clock.timers;\n        var timer = null;\n        var id;\n\n        for (id in timers) {\n            if (timers.hasOwnProperty(id)) {\n                if (!timer || compareTimers(timer, timers[id]) === -1) {\n                    timer = timers[id];\n                }\n            }\n        }\n\n        return timer;\n    }\n\n    function callTimer(clock, timer) {\n        if (typeof timer.interval === \"number\") {\n            clock.timers[timer.id].callAt += timer.interval;\n        } else {\n            delete clock.timers[timer.id];\n        }\n\n        if (typeof timer.func === \"function\") {\n            timer.func.apply(null, timer.args);\n        } else {\n            /* eslint no-eval: \"off\" */\n            eval(timer.func);\n        }\n    }\n\n    function clearTimer(clock, timerId, ttype) {\n        if (!timerId) {\n            // null appears to be allowed in most browsers, and appears to be\n            // relied upon by some libraries, like Bootstrap carousel\n            return;\n        }\n\n        if (!clock.timers) {\n            clock.timers = {};\n        }\n\n        // in Node, timerId is an object with .ref()/.unref(), and\n        // its .id field is the actual timer id.\n        if (typeof timerId === \"object\") {\n            timerId = timerId.id;\n        }\n\n        if (clock.timers.hasOwnProperty(timerId)) {\n            // check that the ID matches a timer of the correct type\n            var timer = clock.timers[timerId];\n            if (timer.type === ttype) {\n                delete clock.timers[timerId];\n            } else {\n                var clear = ttype === \"AnimationFrame\" ? \"cancelAnimationFrame\" : \"clear\" + ttype;\n                var schedule = timer.type === \"AnimationFrame\" ? \"requestAnimationFrame\" : \"set\" + timer.type;\n                throw new Error(\"Cannot clear timer: timer created with \" + schedule\n                    + \"() but cleared with \" + clear + \"()\");\n            }\n        }\n    }\n\n    function uninstall(clock, target, config) {\n        var method,\n            i,\n            l;\n        var installedHrTime = \"_hrtime\";\n        var installedNextTick = \"_nextTick\";\n\n        for (i = 0, l = clock.methods.length; i < l; i++) {\n            method = clock.methods[i];\n            if (method === \"hrtime\" && target.process) {\n                target.process.hrtime = clock[installedHrTime];\n            } else if (method === \"nextTick\" && target.process) {\n                target.process.nextTick = clock[installedNextTick];\n            } else if (method === \"performance\") {\n                target[method] = clock[\"_\" + method];\n            } else {\n                if (target[method] && target[method].hadOwnProperty) {\n                    target[method] = clock[\"_\" + method];\n                    if (method === \"clearInterval\" && config.shouldAdvanceTime === true) {\n                        target[method](clock.attachedInterval);\n                    }\n                } else {\n                    try {\n                        delete target[method];\n                    } catch (ignore) { /* eslint empty-block: \"off\" */ }\n                }\n            }\n        }\n\n        // Prevent multiple executions which will completely remove these props\n        clock.methods = [];\n\n        // return pending timers, to enable checking what timers remained on uninstall\n        if (!clock.timers) {\n            return [];\n        }\n        return Object.keys(clock.timers).map(function mapper(key) {\n            return clock.timers[key];\n        });\n    }\n\n    function hijackMethod(target, method, clock) {\n        var prop;\n        clock[method].hadOwnProperty = Object.prototype.hasOwnProperty.call(target, method);\n        clock[\"_\" + method] = target[method];\n\n        if (method === \"Date\") {\n            var date = mirrorDateProperties(clock[method], target[method]);\n            target[method] = date;\n        } else if (method === \"performance\") {\n            target[method] = clock[method];\n        } else {\n            target[method] = function () {\n                return clock[method].apply(clock, arguments);\n            };\n\n            for (prop in clock[method]) {\n                if (clock[method].hasOwnProperty(prop)) {\n                    target[method][prop] = clock[method][prop];\n                }\n            }\n        }\n\n        target[method].clock = clock;\n    }\n\n    function doIntervalTick(clock, advanceTimeDelta) {\n        clock.tick(advanceTimeDelta);\n    }\n\n    var timers = {\n        setTimeout: _global.setTimeout,\n        clearTimeout: _global.clearTimeout,\n        setImmediate: _global.setImmediate,\n        clearImmediate: _global.clearImmediate,\n        setInterval: _global.setInterval,\n        clearInterval: _global.clearInterval,\n        Date: _global.Date\n    };\n\n    if (hrtimePresent) {\n        timers.hrtime = _global.process.hrtime;\n    }\n\n    if (nextTickPresent) {\n        timers.nextTick = _global.process.nextTick;\n    }\n\n    if (performancePresent) {\n        timers.performance = _global.performance;\n    }\n\n    if (requestAnimationFramePresent) {\n        timers.requestAnimationFrame = _global.requestAnimationFrame;\n    }\n\n    if (cancelAnimationFramePresent) {\n        timers.cancelAnimationFrame = _global.cancelAnimationFrame;\n    }\n\n    var keys = Object.keys || function (obj) {\n        var ks = [];\n        var key;\n\n        for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n                ks.push(key);\n            }\n        }\n\n        return ks;\n    };\n\n    /**\n     * @param start {Date|number} the system time\n     * @param loopLimit {number}  maximum number of timers that will be run when calling runAll()\n     */\n    function createClock(start, loopLimit) {\n        start = start || 0;\n        loopLimit = loopLimit || 1000;\n\n        if (NativeDate === undefined) {\n            throw new Error(\"The global scope doesn't have a `Date` object\"\n                + \" (see https://github.com/sinonjs/sinon/issues/1852#issuecomment-419622780)\");\n        }\n\n        var clock = {\n            now: getEpoch(start),\n            hrNow: 0,\n            timeouts: {},\n            Date: createDate(),\n            loopLimit: loopLimit\n        };\n\n        clock.Date.clock = clock;\n\n        function getTimeToNextFrame() {\n            return 16 - ((clock.now - start) % 16);\n        }\n\n        clock.setTimeout = function setTimeout(func, timeout) {\n            return addTimer(clock, {\n                func: func,\n                args: Array.prototype.slice.call(arguments, 2),\n                delay: timeout\n            });\n        };\n\n        clock.clearTimeout = function clearTimeout(timerId) {\n            return clearTimer(clock, timerId, \"Timeout\");\n        };\n        clock.nextTick = function nextTick(func) {\n            return enqueueJob(clock, {\n                func: func,\n                args: Array.prototype.slice.call(arguments, 1)\n            });\n        };\n        clock.setInterval = function setInterval(func, timeout) {\n            timeout = parseInt(timeout, 10);\n            return addTimer(clock, {\n                func: func,\n                args: Array.prototype.slice.call(arguments, 2),\n                delay: timeout,\n                interval: timeout\n            });\n        };\n\n        clock.clearInterval = function clearInterval(timerId) {\n            return clearTimer(clock, timerId, \"Interval\");\n        };\n\n        clock.setImmediate = function setImmediate(func) {\n            return addTimer(clock, {\n                func: func,\n                args: Array.prototype.slice.call(arguments, 1),\n                immediate: true\n            });\n        };\n\n        clock.clearImmediate = function clearImmediate(timerId) {\n            return clearTimer(clock, timerId, \"Immediate\");\n        };\n\n        clock.requestAnimationFrame = function requestAnimationFrame(func) {\n            var result = addTimer(clock, {\n                func: func,\n                delay: getTimeToNextFrame(),\n                args: [clock.now + getTimeToNextFrame()],\n                animation: true\n            });\n\n            return result.id || result;\n        };\n\n        clock.cancelAnimationFrame = function cancelAnimationFrame(timerId) {\n            return clearTimer(clock, timerId, \"AnimationFrame\");\n        };\n\n        function updateHrTime(newNow) {\n            clock.hrNow += (newNow - clock.now);\n        }\n\n        clock.runMicrotasks = function runMicrotasks() {\n            runJobs(clock);\n        };\n\n        clock.tick = function tick(ms) {\n            ms = typeof ms === \"number\" ? ms : parseTime(ms);\n            var tickFrom = clock.now;\n            var tickTo = clock.now + ms;\n            var previous = clock.now;\n            var timer, firstException, oldNow;\n\n            clock.duringTick = true;\n\n            // perform process.nextTick()s\n            oldNow = clock.now;\n            runJobs(clock);\n            if (oldNow !== clock.now) {\n                // compensate for any setSystemTime() call during process.nextTick() callback\n                tickFrom += clock.now - oldNow;\n                tickTo += clock.now - oldNow;\n            }\n\n            // perform each timer in the requested range\n            timer = firstTimerInRange(clock, tickFrom, tickTo);\n            while (timer && tickFrom <= tickTo) {\n                if (clock.timers[timer.id]) {\n                    updateHrTime(timer.callAt);\n                    tickFrom = timer.callAt;\n                    clock.now = timer.callAt;\n                    oldNow = clock.now;\n                    try {\n                        runJobs(clock);\n                        callTimer(clock, timer);\n                    } catch (e) {\n                        firstException = firstException || e;\n                    }\n\n                    // compensate for any setSystemTime() call during timer callback\n                    if (oldNow !== clock.now) {\n                        tickFrom += clock.now - oldNow;\n                        tickTo += clock.now - oldNow;\n                        previous += clock.now - oldNow;\n                    }\n                }\n\n                timer = firstTimerInRange(clock, previous, tickTo);\n                previous = tickFrom;\n            }\n\n            // perform process.nextTick()s again\n            oldNow = clock.now;\n            runJobs(clock);\n            if (oldNow !== clock.now) {\n                // compensate for any setSystemTime() call during process.nextTick() callback\n                tickFrom += clock.now - oldNow;\n                tickTo += clock.now - oldNow;\n            }\n            clock.duringTick = false;\n\n            // corner case: during runJobs, new timers were scheduled which could be in the range [clock.now, tickTo]\n            timer = firstTimerInRange(clock, tickFrom, tickTo);\n            if (timer) {\n                try {\n                    clock.tick(tickTo - clock.now); // do it all again - for the remainder of the requested range\n                } catch (e) {\n                    firstException = firstException || e;\n                }\n            } else {\n                // no timers remaining in the requested range: move the clock all the way to the end\n                updateHrTime(tickTo);\n                clock.now = tickTo;\n            }\n            if (firstException) {\n                throw firstException;\n            }\n            return clock.now;\n        };\n\n        clock.next = function next() {\n            runJobs(clock);\n            var timer = firstTimer(clock);\n            if (!timer) {\n                return clock.now;\n            }\n\n            clock.duringTick = true;\n            try {\n                updateHrTime(timer.callAt);\n                clock.now = timer.callAt;\n                callTimer(clock, timer);\n                runJobs(clock);\n                return clock.now;\n            } finally {\n                clock.duringTick = false;\n            }\n        };\n\n        clock.runAll = function runAll() {\n            var numTimers, i;\n            runJobs(clock);\n            for (i = 0; i < clock.loopLimit; i++) {\n                if (!clock.timers) {\n                    return clock.now;\n                }\n\n                numTimers = keys(clock.timers).length;\n                if (numTimers === 0) {\n                    return clock.now;\n                }\n\n                clock.next();\n            }\n\n            throw new Error(\"Aborting after running \" + clock.loopLimit + \" timers, assuming an infinite loop!\");\n        };\n\n        clock.runToFrame = function runToFrame() {\n            return clock.tick(getTimeToNextFrame());\n        };\n\n        clock.runToLast = function runToLast() {\n            var timer = lastTimer(clock);\n            if (!timer) {\n                runJobs(clock);\n                return clock.now;\n            }\n\n            return clock.tick(timer.callAt - clock.now);\n        };\n\n        clock.reset = function reset() {\n            clock.timers = {};\n            clock.jobs = [];\n            clock.now = getEpoch(start);\n            clock.hrNow = 0;\n        };\n\n        clock.setSystemTime = function setSystemTime(systemTime) {\n            // determine time difference\n            var newNow = getEpoch(systemTime);\n            var difference = newNow - clock.now;\n            var id, timer;\n\n            // update 'system clock'\n            clock.now = newNow;\n\n            // update timers and intervals to keep them stable\n            for (id in clock.timers) {\n                if (clock.timers.hasOwnProperty(id)) {\n                    timer = clock.timers[id];\n                    timer.createdAt += difference;\n                    timer.callAt += difference;\n                }\n            }\n        };\n\n        if (performancePresent) {\n            clock.performance = Object.create(null);\n\n            if (hasPerformancePrototype) {\n                var proto = _global.Performance.prototype;\n\n                Object\n                    .getOwnPropertyNames(proto)\n                    .forEach(function (name) {\n                        clock.performance[name] = NOOP;\n                    });\n            }\n\n            clock.performance.now = function lolexNow() {\n                return clock.hrNow;\n            };\n        }\n\n        if (hrtimePresent) {\n            clock.hrtime = function (prev) {\n                if (Array.isArray(prev)) {\n                    var oldSecs = (prev[0] + prev[1] / 1e9);\n                    var newSecs = (clock.hrNow / 1000);\n                    var difference = (newSecs - oldSecs);\n                    var secs = fixedFloor(difference);\n                    var nanosecs = fixedModulo(difference * 1e9, 1e9);\n                    return [\n                        secs,\n                        nanosecs\n                    ];\n                }\n                return [\n                    fixedFloor(clock.hrNow / 1000),\n                    fixedModulo(clock.hrNow * 1e6, 1e9)\n                ];\n            };\n        }\n\n        return clock;\n    }\n\n    /**\n     * @param config {Object} optional config\n     * @param config.target {Object} the target to install timers in (default `window`)\n     * @param config.now {number|Date}  a number (in milliseconds) or a Date object (default epoch)\n     * @param config.toFake {string[]} names of the methods that should be faked.\n     * @param config.loopLimit {number} the maximum number of timers that will be run when calling runAll()\n     * @param config.shouldAdvanceTime {Boolean} tells lolex to increment mocked time automatically (default false)\n     * @param config.advanceTimeDelta {Number} increment mocked time every <<advanceTimeDelta>> ms (default: 20ms)\n     */\n    function install(config) {\n        if ( arguments.length > 1 || config instanceof Date || Array.isArray(config) || typeof config === \"number\") {\n            throw new TypeError(\"lolex.install called with \" + String(config) +\n                \" lolex 2.0+ requires an object parameter - see https://github.com/sinonjs/lolex\");\n        }\n        config = typeof config !== \"undefined\" ? config : {};\n        config.shouldAdvanceTime = config.shouldAdvanceTime || false;\n        config.advanceTimeDelta = config.advanceTimeDelta || 20;\n\n        var i, l;\n        var target = config.target || _global;\n        var clock = createClock(config.now, config.loopLimit);\n\n        clock.uninstall = function () {\n            return uninstall(clock, target, config);\n        };\n\n        clock.methods = config.toFake || [];\n\n        if (clock.methods.length === 0) {\n            // do not fake nextTick by default - GitHub#126\n            clock.methods = keys(timers).filter(function (key) {return key !== \"nextTick\";});\n        }\n\n        for (i = 0, l = clock.methods.length; i < l; i++) {\n            if (clock.methods[i] === \"hrtime\") {\n                if (target.process && typeof target.process.hrtime === \"function\") {\n                    hijackMethod(target.process, clock.methods[i], clock);\n                }\n            } else if (clock.methods[i] === \"nextTick\") {\n                if (target.process && typeof target.process.nextTick === \"function\") {\n                    hijackMethod(target.process, clock.methods[i], clock);\n                }\n            } else {\n                if (clock.methods[i] === \"setInterval\" && config.shouldAdvanceTime === true) {\n                    var intervalTick = doIntervalTick.bind(null, clock, config.advanceTimeDelta);\n                    var intervalId = target[clock.methods[i]](\n                        intervalTick,\n                        config.advanceTimeDelta);\n                    clock.attachedInterval = intervalId;\n                }\n                hijackMethod(target, clock.methods[i], clock);\n            }\n        }\n\n        return clock;\n    }\n\n    return {\n        timers: timers,\n        createClock: createClock,\n        install: install,\n        withGlobal: withGlobal\n    };\n}\n\nvar defaultImplementation = withGlobal(global || window);\n\nexports.timers = defaultImplementation.timers;\nexports.createClock = defaultImplementation.createClock;\nexports.install = defaultImplementation.install;\nexports.withGlobal = withGlobal;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n},{}]},{},[1])(1)\n});\n","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\n/*global define: false Mustache: true*/\n\n(function defineMustache (global, factory) {\n  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {\n    factory(exports); // CommonJS\n  } else if (typeof define === 'function' && define.amd) {\n    define(['exports'], factory); // AMD\n  } else {\n    global.Mustache = {};\n    factory(global.Mustache); // script, wsh, asp\n  }\n}(this, function mustacheFactory (mustache) {\n\n  var objectToString = Object.prototype.toString;\n  var isArray = Array.isArray || function isArrayPolyfill (object) {\n    return objectToString.call(object) === '[object Array]';\n  };\n\n  function isFunction (object) {\n    return typeof object === 'function';\n  }\n\n  /**\n   * More correct typeof string handling array\n   * which normally returns typeof 'object'\n   */\n  function typeStr (obj) {\n    return isArray(obj) ? 'array' : typeof obj;\n  }\n\n  function escapeRegExp (string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n  }\n\n  /**\n   * Null safe way of checking whether or not an object,\n   * including its prototype, has a given property\n   */\n  function hasProperty (obj, propName) {\n    return obj != null && typeof obj === 'object' && (propName in obj);\n  }\n\n  /**\n   * Safe way of detecting whether or not the given thing is a primitive and\n   * whether it has the given property\n   */\n  function primitiveHasOwnProperty (primitive, propName) {  \n    return (\n      primitive != null\n      && typeof primitive !== 'object'\n      && primitive.hasOwnProperty\n      && primitive.hasOwnProperty(propName)\n    );\n  }\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var regExpTest = RegExp.prototype.test;\n  function testRegExp (re, string) {\n    return regExpTest.call(re, string);\n  }\n\n  var nonSpaceRe = /\\S/;\n  function isWhitespace (string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  };\n\n  function escapeHtml (string) {\n    return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n      return entityMap[s];\n    });\n  }\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var equalsRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  /**\n   * Breaks up the given `template` string into a tree of tokens. If the `tags`\n   * argument is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n   * course, the default is to use mustaches (i.e. mustache.tags).\n   *\n   * A token is an array with at least 4 elements. The first element is the\n   * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n   * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n   * all text that appears outside a symbol this element is \"text\".\n   *\n   * The second element of a token is its \"value\". For mustache tags this is\n   * whatever else was inside the tag besides the opening symbol. For text tokens\n   * this is the text itself.\n   *\n   * The third and fourth elements of the token are the start and end indices,\n   * respectively, of the token in the original template.\n   *\n   * Tokens that are the root node of a subtree contain two more elements: 1) an\n   * array of tokens in the subtree and 2) the index in the original template at\n   * which the closing tag for that section begins.\n   */\n  function parseTemplate (template, tags) {\n    if (!template)\n      return [];\n\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace () {\n      if (hasTag && !nonSpace) {\n        while (spaces.length)\n          delete tokens[spaces.pop()];\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var openingTagRe, closingTagRe, closingCurlyRe;\n    function compileTags (tagsToCompile) {\n      if (typeof tagsToCompile === 'string')\n        tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n        throw new Error('Invalid tags: ' + tagsToCompile);\n\n      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n      closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n      closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n    }\n\n    compileTags(tags || mustache.tags);\n\n    var scanner = new Scanner(template);\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(openingTagRe);\n\n      if (value) {\n        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n          } else {\n            nonSpace = true;\n          }\n\n          tokens.push([ 'text', chr, start, start + 1 ]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr === '\\n')\n            stripSpace();\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(openingTagRe))\n        break;\n\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(equalsRe);\n        scanner.scan(equalsRe);\n        scanner.scanUntil(closingTagRe);\n      } else if (type === '{') {\n        value = scanner.scanUntil(closingCurlyRe);\n        scanner.scan(curlyRe);\n        scanner.scanUntil(closingTagRe);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(closingTagRe);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(closingTagRe))\n        throw new Error('Unclosed tag at ' + scanner.pos);\n\n      token = [ type, value, start, scanner.pos ];\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n\n        if (!openSection)\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n        if (openSection[1] !== value)\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        compileTags(value);\n      }\n    }\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n\n    if (openSection)\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens (tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          squashedTokens.push(token);\n          lastToken = token;\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens (tokens) {\n    var nestedTokens = [];\n    var collector = nestedTokens;\n    var sections = [];\n\n    var token, section;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      switch (token[0]) {\n        case '#':\n        case '^':\n          collector.push(token);\n          sections.push(token);\n          collector = token[4] = [];\n          break;\n        case '/':\n          section = sections.pop();\n          section[5] = token[2];\n          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n          break;\n        default:\n          collector.push(token);\n      }\n    }\n\n    return nestedTokens;\n  }\n\n  /**\n   * A simple string scanner that is used by the template parser to find\n   * tokens in template strings.\n   */\n  function Scanner (string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function eos () {\n    return this.tail === '';\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function scan (re) {\n    var match = this.tail.match(re);\n\n    if (!match || match.index !== 0)\n      return '';\n\n    var string = match[0];\n\n    this.tail = this.tail.substring(string.length);\n    this.pos += string.length;\n\n    return string;\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function scanUntil (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n      case -1:\n        match = this.tail;\n        this.tail = '';\n        break;\n      case 0:\n        match = '';\n        break;\n      default:\n        match = this.tail.substring(0, index);\n        this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  /**\n   * Represents a rendering context by wrapping a view object and\n   * maintaining a reference to the parent context.\n   */\n  function Context (view, parentContext) {\n    this.view = view;\n    this.cache = { '.': this.view };\n    this.parent = parentContext;\n  }\n\n  /**\n   * Creates a new context using the given view with this context\n   * as the parent.\n   */\n  Context.prototype.push = function push (view) {\n    return new Context(view, this);\n  };\n\n  /**\n   * Returns the value of the given name in this context, traversing\n   * up the context hierarchy if the value is absent in this context's view.\n   */\n  Context.prototype.lookup = function lookup (name) {\n    var cache = this.cache;\n\n    var value;\n    if (cache.hasOwnProperty(name)) {\n      value = cache[name];\n    } else {\n      var context = this, intermediateValue, names, index, lookupHit = false;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          intermediateValue = context.view;\n          names = name.split('.');\n          index = 0;\n\n          /**\n           * Using the dot notion path in `name`, we descend through the\n           * nested objects.\n           *\n           * To be certain that the lookup has been successful, we have to\n           * check if the last object in the path actually has the property\n           * we are looking for. We store the result in `lookupHit`.\n           *\n           * This is specially necessary for when the value has been set to\n           * `undefined` and we want to avoid looking up parent contexts.\n           *\n           * In the case where dot notation is used, we consider the lookup\n           * to be successful even if the last \"object\" in the path is\n           * not actually an object but a primitive (e.g., a string, or an\n           * integer), because it is sometimes useful to access a property\n           * of an autoboxed primitive, such as the length of a string.\n           **/\n          while (intermediateValue != null && index < names.length) {\n            if (index === names.length - 1)\n              lookupHit = (\n                hasProperty(intermediateValue, names[index]) \n                || primitiveHasOwnProperty(intermediateValue, names[index])\n              );\n\n            intermediateValue = intermediateValue[names[index++]];\n          }\n        } else {\n          intermediateValue = context.view[name];\n\n          /**\n           * Only checking against `hasProperty`, which always returns `false` if\n           * `context.view` is not an object. Deliberately omitting the check\n           * against `primitiveHasOwnProperty` if dot notation is not used.\n           *\n           * Consider this example:\n           * ```\n           * Mustache.render(\"The length of a football field is {{#length}}{{length}}{{/length}}.\", {length: \"100 yards\"})\n           * ```\n           *\n           * If we were to check also against `primitiveHasOwnProperty`, as we do\n           * in the dot notation case, then render call would return:\n           *\n           * \"The length of a football field is 9.\"\n           *\n           * rather than the expected:\n           *\n           * \"The length of a football field is 100 yards.\"\n           **/\n          lookupHit = hasProperty(context.view, name);\n        }\n\n        if (lookupHit) {\n          value = intermediateValue;\n          break;\n        }\n\n        context = context.parent;\n      }\n\n      cache[name] = value;\n    }\n\n    if (isFunction(value))\n      value = value.call(this.view);\n\n    return value;\n  };\n\n  /**\n   * A Writer knows how to take a stream of tokens and render them to a\n   * string, given a context. It also maintains a cache of templates to\n   * avoid the need to parse the same template twice.\n   */\n  function Writer () {\n    this.cache = {};\n  }\n\n  /**\n   * Clears all cached templates in this writer.\n   */\n  Writer.prototype.clearCache = function clearCache () {\n    this.cache = {};\n  };\n\n  /**\n   * Parses and caches the given `template` according to the given `tags` or\n   * `mustache.tags` if `tags` is omitted,  and returns the array of tokens\n   * that is generated from the parse.\n   */\n  Writer.prototype.parse = function parse (template, tags) {\n    var cache = this.cache;\n    var cacheKey = template + ':' + (tags || mustache.tags).join(':');\n    var tokens = cache[cacheKey];\n\n    if (tokens == null)\n      tokens = cache[cacheKey] = parseTemplate(template, tags);\n\n    return tokens;\n  };\n\n  /**\n   * High-level method that is used to render the given `template` with\n   * the given `view`.\n   *\n   * The optional `partials` argument may be an object that contains the\n   * names and templates of partials that are used in the template. It may\n   * also be a function that is used to load partial templates on the fly\n   * that takes a single argument: the name of the partial.\n   *\n   * If the optional `tags` argument is given here it must be an array with two\n   * string values: the opening and closing tags used in the template (e.g.\n   * [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n   */\n  Writer.prototype.render = function render (template, view, partials, tags) {\n    var tokens = this.parse(template, tags);\n    var context = (view instanceof Context) ? view : new Context(view);\n    return this.renderTokens(tokens, context, partials, template, tags);\n  };\n\n  /**\n   * Low-level method that renders the given array of `tokens` using\n   * the given `context` and `partials`.\n   *\n   * Note: The `originalTemplate` is only ever used to extract the portion\n   * of the original template that was contained in a higher-order section.\n   * If the template doesn't use higher-order sections, this argument may\n   * be omitted.\n   */\n  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate, tags) {\n    var buffer = '';\n\n    var token, symbol, value;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      value = undefined;\n      token = tokens[i];\n      symbol = token[0];\n\n      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);\n      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);\n      else if (symbol === '>') value = this.renderPartial(token, context, partials, tags);\n      else if (symbol === '&') value = this.unescapedValue(token, context);\n      else if (symbol === 'name') value = this.escapedValue(token, context);\n      else if (symbol === 'text') value = this.rawValue(token);\n\n      if (value !== undefined)\n        buffer += value;\n    }\n\n    return buffer;\n  };\n\n  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {\n    var self = this;\n    var buffer = '';\n    var value = context.lookup(token[1]);\n\n    // This function is used to render an arbitrary template\n    // in the current context by higher-order sections.\n    function subRender (template) {\n      return self.render(template, context, partials);\n    }\n\n    if (!value) return;\n\n    if (isArray(value)) {\n      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);\n      }\n    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);\n    } else if (isFunction(value)) {\n      if (typeof originalTemplate !== 'string')\n        throw new Error('Cannot use higher-order sections without the original template');\n\n      // Extract the portion of the original template that the section contains.\n      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n      if (value != null)\n        buffer += value;\n    } else {\n      buffer += this.renderTokens(token[4], context, partials, originalTemplate);\n    }\n    return buffer;\n  };\n\n  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {\n    var value = context.lookup(token[1]);\n\n    // Use JavaScript's definition of falsy. Include empty arrays.\n    // See https://github.com/janl/mustache.js/issues/186\n    if (!value || (isArray(value) && value.length === 0))\n      return this.renderTokens(token[4], context, partials, originalTemplate);\n  };\n\n  Writer.prototype.renderPartial = function renderPartial (token, context, partials, tags) {\n    if (!partials) return;\n\n    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n    if (value != null)\n      return this.renderTokens(this.parse(value, tags), context, partials, value);\n  };\n\n  Writer.prototype.unescapedValue = function unescapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return value;\n  };\n\n  Writer.prototype.escapedValue = function escapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return mustache.escape(value);\n  };\n\n  Writer.prototype.rawValue = function rawValue (token) {\n    return token[1];\n  };\n\n  mustache.name = 'mustache.js';\n  mustache.version = '3.0.1';\n  mustache.tags = [ '{{', '}}' ];\n\n  // All high-level mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates in the default writer.\n   */\n  mustache.clearCache = function clearCache () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Parses and caches the given template in the default writer and returns the\n   * array of tokens it contains. Doing this ahead of time avoids the need to\n   * parse templates on the fly as they are rendered.\n   */\n  mustache.parse = function parse (template, tags) {\n    return defaultWriter.parse(template, tags);\n  };\n\n  /**\n   * Renders the `template` with the given `view` and `partials` using the\n   * default writer. If the optional `tags` argument is given here it must be an\n   * array with two string values: the opening and closing tags used in the\n   * template (e.g. [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n   */\n  mustache.render = function render (template, view, partials, tags) {\n    if (typeof template !== 'string') {\n      throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                          'but \"' + typeStr(template) + '\" was given as the first ' +\n                          'argument for mustache#render(template, view, partials)');\n    }\n\n    return defaultWriter.render(template, view, partials, tags);\n  };\n\n  // This is here for backwards compatibility with 0.4.x.,\n  /*eslint-disable */ // eslint wants camel cased function name\n  mustache.to_html = function to_html (template, view, partials, send) {\n    /*eslint-enable*/\n\n    var result = mustache.render(template, view, partials);\n\n    if (isFunction(send)) {\n      send(result);\n    } else {\n      return result;\n    }\n  };\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // Export these mainly for testing, but also for advanced usage.\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n  return mustache;\n}));\n","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.nise = f()}})(function(){var define,module,exports;return (function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){\n\"use strict\";\n\n// cache a reference to setTimeout, so that our reference won't be stubbed out\n// when using fake timers and errors will still get logged\n// https://github.com/cjohansen/Sinon.JS/issues/381\nvar realSetTimeout = setTimeout;\n\nfunction configureLogger(config) {\n    config = config || {};\n    // Function which prints errors.\n    if (!config.hasOwnProperty(\"logger\")) {\n        config.logger = function () { };\n    }\n    // When set to true, any errors logged will be thrown immediately;\n    // If set to false, the errors will be thrown in separate execution frame.\n    if (!config.hasOwnProperty(\"useImmediateExceptions\")) {\n        config.useImmediateExceptions = true;\n    }\n    // wrap realSetTimeout with something we can stub in tests\n    if (!config.hasOwnProperty(\"setTimeout\")) {\n        config.setTimeout = realSetTimeout;\n    }\n\n    return function logError(label, e) {\n        var msg = label + \" threw exception: \";\n        var err = { name: e.name || label, message: e.message || e.toString(), stack: e.stack };\n\n        function throwLoggedError() {\n            err.message = msg + err.message;\n            throw err;\n        }\n\n        config.logger(msg + \"[\" + err.name + \"] \" + err.message);\n\n        if (err.stack) {\n            config.logger(err.stack);\n        }\n\n        if (config.useImmediateExceptions) {\n            throwLoggedError();\n        } else {\n            config.setTimeout(throwLoggedError, 0);\n        }\n    };\n}\n\nmodule.exports = configureLogger;\n\n},{}],2:[function(require,module,exports){\n\"use strict\";\n\nvar Event = require(\"./event\");\n\nfunction CustomEvent(type, customData, target) {\n    this.initEvent(type, false, false, target);\n    this.detail = customData.detail || null;\n}\n\nCustomEvent.prototype = new Event();\n\nCustomEvent.prototype.constructor = CustomEvent;\n\nmodule.exports = CustomEvent;\n\n},{\"./event\":4}],3:[function(require,module,exports){\n\"use strict\";\n\nfunction flattenOptions(options) {\n    if (options !== Object(options)) {\n        return {\n            capture: Boolean(options),\n            once: false,\n            passive: false\n        };\n    }\n    return {\n        capture: Boolean(options.capture),\n        once: Boolean(options.once),\n        passive: Boolean(options.passive)\n    };\n}\nfunction not(fn) {\n    return function () {\n        return !fn.apply(this, arguments);\n    };\n}\nfunction hasListenerFilter(listener, capture) {\n    return function (listenerSpec) {\n        return listenerSpec.capture === capture\n            && listenerSpec.listener === listener;\n    };\n}\n\nvar EventTarget = {\n    // https://dom.spec.whatwg.org/#dom-eventtarget-addeventlistener\n    addEventListener: function addEventListener(event, listener, providedOptions) {\n        // 3. Let capture, passive, and once be the result of flattening more options.\n        // Flatten property before executing step 2,\n        // feture detection is usually based on registering handler with options object,\n        // that has getter defined\n        // addEventListener(\"load\", () => {}, {\n        //    get once() { supportsOnce = true; }\n        // });\n        var options = flattenOptions(providedOptions);\n\n        // 2. If callback is null, then return.\n        if (listener == null) {\n            return;\n        }\n\n        this.eventListeners = this.eventListeners || {};\n        this.eventListeners[event] = this.eventListeners[event] || [];\n\n        // 4. If context objects associated list of event listener\n        //    does not contain an event listener whose type is type,\n        //    callback is callback, and capture is capture, then append\n        //    a new event listener to it, whose type is type, callback is\n        //    callback, capture is capture, passive is passive, and once is once.\n        if (!this.eventListeners[event].some(hasListenerFilter(listener, options.capture))) {\n            this.eventListeners[event].push({\n                listener: listener,\n                capture: options.capture,\n                once: options.once\n            });\n        }\n    },\n\n    // https://dom.spec.whatwg.org/#dom-eventtarget-removeeventlistener\n    removeEventListener: function removeEventListener(event, listener, providedOptions) {\n        if (!this.eventListeners || !this.eventListeners[event]) {\n            return;\n        }\n\n        // 2. Let capture be the result of flattening options.\n        var options = flattenOptions(providedOptions);\n\n        // 3. If there is an event listener in the associated list of\n        //    event listeners whose type is type, callback is callback,\n        //    and capture is capture, then set that event listeners\n        //    removed to true and remove it from the associated list of event listeners.\n        this.eventListeners[event] = this.eventListeners[event]\n            .filter(not(hasListenerFilter(listener, options.capture)));\n    },\n\n    dispatchEvent: function dispatchEvent(event) {\n        if (!this.eventListeners || !this.eventListeners[event.type]) {\n            return Boolean(event.defaultPrevented);\n        }\n\n        var self = this;\n        var type = event.type;\n        var listeners = self.eventListeners[type];\n\n        // Remove listeners, that should be dispatched once\n        // before running dispatch loop to avoid nested dispatch issues\n        self.eventListeners[type] = listeners.filter(function (listenerSpec) {\n            return !listenerSpec.once;\n        });\n        listeners.forEach(function (listenerSpec) {\n            var listener = listenerSpec.listener;\n            if (typeof listener === \"function\") {\n                listener.call(self, event);\n            } else {\n                listener.handleEvent(event);\n            }\n        });\n\n        return Boolean(event.defaultPrevented);\n    }\n};\n\nmodule.exports = EventTarget;\n\n},{}],4:[function(require,module,exports){\n\"use strict\";\n\nfunction Event(type, bubbles, cancelable, target) {\n    this.initEvent(type, bubbles, cancelable, target);\n}\n\nEvent.prototype = {\n    initEvent: function (type, bubbles, cancelable, target) {\n        this.type = type;\n        this.bubbles = bubbles;\n        this.cancelable = cancelable;\n        this.target = target;\n        this.currentTarget = target;\n    },\n\n    stopPropagation: function () {},\n\n    preventDefault: function () {\n        this.defaultPrevented = true;\n    }\n};\n\nmodule.exports = Event;\n\n},{}],5:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n    Event: require(\"./event\"),\n    ProgressEvent: require(\"./progress-event\"),\n    CustomEvent: require(\"./custom-event\"),\n    EventTarget: require(\"./event-target\")\n};\n\n},{\"./custom-event\":2,\"./event\":4,\"./event-target\":3,\"./progress-event\":6}],6:[function(require,module,exports){\n\"use strict\";\n\nvar Event = require(\"./event\");\n\nfunction ProgressEvent(type, progressEventRaw, target) {\n    this.initEvent(type, false, false, target);\n    this.loaded = typeof progressEventRaw.loaded === \"number\" ? progressEventRaw.loaded : null;\n    this.total = typeof progressEventRaw.total === \"number\" ? progressEventRaw.total : null;\n    this.lengthComputable = !!progressEventRaw.total;\n}\n\nProgressEvent.prototype = new Event();\n\nProgressEvent.prototype.constructor = ProgressEvent;\n\nmodule.exports = ProgressEvent;\n\n},{\"./event\":4}],7:[function(require,module,exports){\n\"use strict\";\n\nvar lolex = require(\"lolex\");\nvar fakeServer = require(\"./index\");\n\nfunction Server() {}\nServer.prototype = fakeServer;\n\nvar fakeServerWithClock = new Server();\n\nfakeServerWithClock.addRequest = function addRequest(xhr) {\n    if (xhr.async) {\n        if (typeof setTimeout.clock === \"object\") {\n            this.clock = setTimeout.clock;\n        } else {\n            this.clock = lolex.install();\n            this.resetClock = true;\n        }\n\n        if (!this.longestTimeout) {\n            var clockSetTimeout = this.clock.setTimeout;\n            var clockSetInterval = this.clock.setInterval;\n            var server = this;\n\n            this.clock.setTimeout = function (fn, timeout) {\n                server.longestTimeout = Math.max(timeout, server.longestTimeout || 0);\n\n                return clockSetTimeout.apply(this, arguments);\n            };\n\n            this.clock.setInterval = function (fn, timeout) {\n                server.longestTimeout = Math.max(timeout, server.longestTimeout || 0);\n\n                return clockSetInterval.apply(this, arguments);\n            };\n        }\n    }\n\n    return fakeServer.addRequest.call(this, xhr);\n};\n\nfakeServerWithClock.respond = function respond() {\n    var returnVal = fakeServer.respond.apply(this, arguments);\n\n    if (this.clock) {\n        this.clock.tick(this.longestTimeout || 0);\n        this.longestTimeout = 0;\n\n        if (this.resetClock) {\n            this.clock.uninstall();\n            this.resetClock = false;\n        }\n    }\n\n    return returnVal;\n};\n\nfakeServerWithClock.restore = function restore() {\n    if (this.clock) {\n        this.clock.uninstall();\n    }\n\n    return fakeServer.restore.apply(this, arguments);\n};\n\nmodule.exports = fakeServerWithClock;\n\n},{\"./index\":9,\"lolex\":45}],8:[function(require,module,exports){\n\"use strict\";\n\nvar formatio = require(\"@sinonjs/formatio\");\n\nvar formatter = formatio.configure({\n    quoteStrings: false,\n    limitChildrenCount: 250\n});\n\nmodule.exports = function format() {\n    return formatter.ascii.apply(formatter, arguments);\n};\n\n},{\"@sinonjs/formatio\":24}],9:[function(require,module,exports){\n\"use strict\";\n\nvar fakeXhr = require(\"../fake-xhr\");\nvar push = [].push;\nvar format = require(\"./format\");\nvar configureLogError = require(\"../configure-logger\");\nvar pathToRegexp = require(\"path-to-regexp\");\n\nvar supportsArrayBuffer = typeof ArrayBuffer !== \"undefined\";\n\nfunction responseArray(handler) {\n    var response = handler;\n\n    if (Object.prototype.toString.call(handler) !== \"[object Array]\") {\n        response = [200, {}, handler];\n    }\n\n    if (typeof response[2] !== \"string\") {\n        if (!supportsArrayBuffer) {\n            throw new TypeError(\"Fake server response body should be a string, but was \" +\n                                typeof response[2]);\n        }\n        else if (!(response[2] instanceof ArrayBuffer)) {\n            throw new TypeError(\"Fake server response body should be a string or ArrayBuffer, but was \" +\n                                typeof response[2]);\n        }\n    }\n\n    return response;\n}\n\nfunction getDefaultWindowLocation() {\n    return { \"host\": \"localhost\", \"protocol\": \"http\" };\n}\n\nfunction getWindowLocation() {\n    if (typeof window === \"undefined\") {\n        // Fallback\n        return getDefaultWindowLocation();\n    }\n\n    if (typeof window.location !== \"undefined\") {\n        // Browsers place location on window\n        return window.location;\n    }\n\n    if ((typeof window.window !== \"undefined\") && (typeof window.window.location !== \"undefined\")) {\n        // React Native on Android places location on window.window\n        return window.window.location;\n    }\n\n    return getDefaultWindowLocation();\n}\n\nfunction matchOne(response, reqMethod, reqUrl) {\n    var rmeth = response.method;\n    var matchMethod = !rmeth || rmeth.toLowerCase() === reqMethod.toLowerCase();\n    var url = response.url;\n    var matchUrl = !url || url === reqUrl || (typeof url.test === \"function\" && url.test(reqUrl));\n\n    return matchMethod && matchUrl;\n}\n\nfunction match(response, request) {\n    var wloc = getWindowLocation();\n\n    var rCurrLoc = new RegExp(\"^\" + wloc.protocol + \"//\" + wloc.host);\n\n    var requestUrl = request.url;\n\n    if (!/^https?:\\/\\//.test(requestUrl) || rCurrLoc.test(requestUrl)) {\n        requestUrl = requestUrl.replace(rCurrLoc, \"\");\n    }\n\n    if (matchOne(response, this.getHTTPMethod(request), requestUrl)) {\n        if (typeof response.response === \"function\") {\n            var ru = response.url;\n            var args = [request].concat(ru && typeof ru.exec === \"function\" ? ru.exec(requestUrl).slice(1) : []);\n            return response.response.apply(response, args);\n        }\n\n        return true;\n    }\n\n    return false;\n}\n\nfunction incrementRequestCount() {\n    var count = ++this.requestCount;\n\n    this.requested = true;\n\n    this.requestedOnce = count === 1;\n    this.requestedTwice = count === 2;\n    this.requestedThrice = count === 3;\n\n    this.firstRequest = this.getRequest(0);\n    this.secondRequest = this.getRequest(1);\n    this.thirdRequest = this.getRequest(2);\n\n    this.lastRequest = this.getRequest(count - 1);\n}\n\nvar fakeServer = {\n    create: function (config) {\n        var server = Object.create(this);\n        server.configure(config);\n        this.xhr = fakeXhr.useFakeXMLHttpRequest();\n        server.requests = [];\n        server.requestCount = 0;\n        server.queue = [];\n        server.responses = [];\n\n\n        this.xhr.onCreate = function (xhrObj) {\n            xhrObj.unsafeHeadersEnabled = function () {\n                return !(server.unsafeHeadersEnabled === false);\n            };\n            server.addRequest(xhrObj);\n        };\n\n        return server;\n    },\n\n    configure: function (config) {\n        var self = this;\n        var whitelist = {\n            \"autoRespond\": true,\n            \"autoRespondAfter\": true,\n            \"respondImmediately\": true,\n            \"fakeHTTPMethods\": true,\n            \"logger\": true,\n            \"unsafeHeadersEnabled\": true\n        };\n\n        config = config || {};\n\n        Object.keys(config).forEach(function (setting) {\n            if (setting in whitelist) {\n                self[setting] = config[setting];\n            }\n        });\n\n        self.logError = configureLogError(config);\n    },\n\n    addRequest: function addRequest(xhrObj) {\n        var server = this;\n        push.call(this.requests, xhrObj);\n\n        incrementRequestCount.call(this);\n\n        xhrObj.onSend = function () {\n            server.handleRequest(this);\n\n            if (server.respondImmediately) {\n                server.respond();\n            } else if (server.autoRespond && !server.responding) {\n                setTimeout(function () {\n                    server.responding = false;\n                    server.respond();\n                }, server.autoRespondAfter || 10);\n\n                server.responding = true;\n            }\n        };\n    },\n\n    getHTTPMethod: function getHTTPMethod(request) {\n        if (this.fakeHTTPMethods && /post/i.test(request.method)) {\n            var matches = (request.requestBody || \"\").match(/_method=([^\\b;]+)/);\n            return matches ? matches[1] : request.method;\n        }\n\n        return request.method;\n    },\n\n    handleRequest: function handleRequest(xhr) {\n        if (xhr.async) {\n            push.call(this.queue, xhr);\n        } else {\n            this.processRequest(xhr);\n        }\n    },\n\n    logger: function () {\n        // no-op; override via configure()\n    },\n\n    logError: configureLogError({}),\n\n    log: function log(response, request) {\n        var str;\n\n        str = \"Request:\\n\" + format(request) + \"\\n\\n\";\n        str += \"Response:\\n\" + format(response) + \"\\n\\n\";\n\n        if (typeof this.logger === \"function\") {\n            this.logger(str);\n        }\n    },\n\n    respondWith: function respondWith(method, url, body) {\n        if (arguments.length === 1 && typeof method !== \"function\") {\n            this.response = responseArray(method);\n            return;\n        }\n\n        if (arguments.length === 1) {\n            body = method;\n            url = method = null;\n        }\n\n        if (arguments.length === 2) {\n            body = url;\n            url = method;\n            method = null;\n        }\n\n        push.call(this.responses, {\n            method: method,\n            url: typeof url === \"string\" && url !== \"\" ? pathToRegexp(url) : url,\n            response: typeof body === \"function\" ? body : responseArray(body)\n        });\n    },\n\n    respond: function respond() {\n        if (arguments.length > 0) {\n            this.respondWith.apply(this, arguments);\n        }\n\n        var queue = this.queue || [];\n        var requests = queue.splice(0, queue.length);\n        var self = this;\n\n        requests.forEach(function (request) {\n            self.processRequest(request);\n        });\n    },\n\n    respondAll: function respondAll() {\n        if (this.respondImmediately) {\n            return;\n        }\n\n        this.queue = this.requests.slice(0);\n\n        var request;\n        while ((request = this.queue.shift())) {\n            this.processRequest(request);\n        }\n    },\n\n    processRequest: function processRequest(request) {\n        try {\n            if (request.aborted) {\n                return;\n            }\n\n            var response = this.response || [404, {}, \"\"];\n\n            if (this.responses) {\n                for (var l = this.responses.length, i = l - 1; i >= 0; i--) {\n                    if (match.call(this, this.responses[i], request)) {\n                        response = this.responses[i].response;\n                        break;\n                    }\n                }\n            }\n\n            if (request.readyState !== 4) {\n                this.log(response, request);\n\n                request.respond(response[0], response[1], response[2]);\n            }\n        } catch (e) {\n            this.logError(\"Fake server request processing\", e);\n        }\n    },\n\n    restore: function restore() {\n        return this.xhr.restore && this.xhr.restore.apply(this.xhr, arguments);\n    },\n\n    getRequest: function getRequest(index) {\n        return this.requests[index] || null;\n    },\n\n    reset: function reset() {\n        this.resetBehavior();\n        this.resetHistory();\n    },\n\n    resetBehavior: function resetBehavior() {\n        this.responses.length = this.queue.length = 0;\n    },\n\n    resetHistory: function resetHistory() {\n        this.requests.length = this.requestCount = 0;\n\n        this.requestedOnce = this.requestedTwice = this.requestedThrice = this.requested = false;\n\n        this.firstRequest = this.secondRequest = this.thirdRequest = this.lastRequest = null;\n    }\n};\n\nmodule.exports = fakeServer;\n\n},{\"../configure-logger\":1,\"../fake-xhr\":11,\"./format\":8,\"path-to-regexp\":46}],10:[function(require,module,exports){\n\"use strict\";\n\nexports.isSupported = (function () {\n    try {\n        return !!new Blob();\n    } catch (e) {\n        return false;\n    }\n}());\n\n},{}],11:[function(require,module,exports){\n\"use strict\";\n\nvar GlobalTextEncoder = typeof TextEncoder !== \"undefined\"\n    ? TextEncoder\n    : require(\"@sinonjs/text-encoding\").TextEncoder;\n\nvar configureLogError = require(\"../configure-logger\");\nvar sinonEvent = require(\"../event\");\nvar extend = require(\"just-extend\");\n\nvar supportsProgress = typeof ProgressEvent !== \"undefined\";\nvar supportsCustomEvent = typeof CustomEvent !== \"undefined\";\nvar supportsFormData = typeof FormData !== \"undefined\";\nvar supportsArrayBuffer = typeof ArrayBuffer !== \"undefined\";\nvar supportsBlob = require(\"./blob\").isSupported;\n\nfunction getWorkingXHR(globalScope) {\n    var supportsXHR = typeof globalScope.XMLHttpRequest !== \"undefined\";\n    if (supportsXHR) {\n        return globalScope.XMLHttpRequest;\n    }\n\n    var supportsActiveX = typeof globalScope.ActiveXObject !== \"undefined\";\n    if (supportsActiveX) {\n        return function () {\n            return new globalScope.ActiveXObject(\"MSXML2.XMLHTTP.3.0\");\n        };\n    }\n\n    return false;\n}\n\n// Ref: https://fetch.spec.whatwg.org/#forbidden-header-name\nvar unsafeHeaders = {\n    \"Accept-Charset\": true,\n    \"Access-Control-Request-Headers\": true,\n    \"Access-Control-Request-Method\": true,\n    \"Accept-Encoding\": true,\n    \"Connection\": true,\n    \"Content-Length\": true,\n    \"Cookie\": true,\n    \"Cookie2\": true,\n    \"Content-Transfer-Encoding\": true,\n    \"Date\": true,\n    \"DNT\": true,\n    \"Expect\": true,\n    \"Host\": true,\n    \"Keep-Alive\": true,\n    \"Origin\": true,\n    \"Referer\": true,\n    \"TE\": true,\n    \"Trailer\": true,\n    \"Transfer-Encoding\": true,\n    \"Upgrade\": true,\n    \"User-Agent\": true,\n    \"Via\": true\n};\n\nfunction EventTargetHandler() {\n    var self = this;\n    var events = [\"loadstart\", \"progress\", \"abort\", \"error\", \"load\", \"timeout\", \"loadend\"];\n\n    function addEventListener(eventName) {\n        self.addEventListener(eventName, function (event) {\n            var listener = self[\"on\" + eventName];\n\n            if (listener && typeof listener === \"function\") {\n                listener.call(this, event);\n            }\n        });\n    }\n\n    events.forEach(addEventListener);\n}\n\nEventTargetHandler.prototype = sinonEvent.EventTarget;\n\nfunction normalizeHeaderValue(value) {\n    // Ref: https://fetch.spec.whatwg.org/#http-whitespace-bytes\n    /*eslint no-control-regex: \"off\"*/\n    return value.replace(/^[\\x09\\x0A\\x0D\\x20]+|[\\x09\\x0A\\x0D\\x20]+$/g, \"\");\n}\n\nfunction getHeader(headers, header) {\n    var foundHeader = Object.keys(headers).filter(function (h) {\n        return h.toLowerCase() === header.toLowerCase();\n    });\n\n    return foundHeader[0] || null;\n}\n\nfunction excludeSetCookie2Header(header) {\n    return !/^Set-Cookie2?$/i.test(header);\n}\n\nfunction verifyResponseBodyType(body, responseType) {\n    var error = null;\n    var isString = typeof body === \"string\";\n\n    if (responseType === \"arraybuffer\") {\n\n        if (!isString && !(body instanceof ArrayBuffer)) {\n            error = new Error(\"Attempted to respond to fake XMLHttpRequest with \" +\n                            body + \", which is not a string or ArrayBuffer.\");\n            error.name = \"InvalidBodyException\";\n        }\n    }\n    else if (!isString) {\n        error = new Error(\"Attempted to respond to fake XMLHttpRequest with \" +\n                        body + \", which is not a string.\");\n        error.name = \"InvalidBodyException\";\n    }\n\n    if (error) {\n        throw error;\n    }\n}\n\nfunction convertToArrayBuffer(body, encoding) {\n    if (body instanceof ArrayBuffer) {\n        return body;\n    }\n\n    return new GlobalTextEncoder(encoding || \"utf-8\").encode(body).buffer;\n}\n\nfunction isXmlContentType(contentType) {\n    return !contentType || /(text\\/xml)|(application\\/xml)|(\\+xml)/.test(contentType);\n}\n\nfunction clearResponse(xhr) {\n    if (xhr.responseType === \"\" || xhr.responseType === \"text\") {\n        xhr.response = xhr.responseText = \"\";\n    } else {\n        xhr.response = xhr.responseText = null;\n    }\n    xhr.responseXML = null;\n}\n\nfunction fakeXMLHttpRequestFor(globalScope) {\n    var isReactNative = globalScope.navigator && globalScope.navigator.product === \"ReactNative\";\n    var sinonXhr = { XMLHttpRequest: globalScope.XMLHttpRequest };\n    sinonXhr.GlobalXMLHttpRequest = globalScope.XMLHttpRequest;\n    sinonXhr.GlobalActiveXObject = globalScope.ActiveXObject;\n    sinonXhr.supportsActiveX = typeof sinonXhr.GlobalActiveXObject !== \"undefined\";\n    sinonXhr.supportsXHR = typeof sinonXhr.GlobalXMLHttpRequest !== \"undefined\";\n    sinonXhr.workingXHR = getWorkingXHR(globalScope);\n    sinonXhr.supportsTimeout =\n        (sinonXhr.supportsXHR && \"timeout\" in (new sinonXhr.GlobalXMLHttpRequest()));\n    sinonXhr.supportsCORS = isReactNative ||\n        (sinonXhr.supportsXHR && \"withCredentials\" in (new sinonXhr.GlobalXMLHttpRequest()));\n\n    // Note that for FakeXMLHttpRequest to work pre ES5\n    // we lose some of the alignment with the spec.\n    // To ensure as close a match as possible,\n    // set responseType before calling open, send or respond;\n    function FakeXMLHttpRequest(config) {\n        EventTargetHandler.call(this);\n        this.readyState = FakeXMLHttpRequest.UNSENT;\n        this.requestHeaders = {};\n        this.requestBody = null;\n        this.status = 0;\n        this.statusText = \"\";\n        this.upload = new EventTargetHandler();\n        this.responseType = \"\";\n        this.response = \"\";\n        this.logError = configureLogError(config);\n\n        if (sinonXhr.supportsTimeout) {\n            this.timeout = 0;\n        }\n\n        if (sinonXhr.supportsCORS) {\n            this.withCredentials = false;\n        }\n\n        if (typeof FakeXMLHttpRequest.onCreate === \"function\") {\n            FakeXMLHttpRequest.onCreate(this);\n        }\n    }\n\n    function verifyState(xhr) {\n        if (xhr.readyState !== FakeXMLHttpRequest.OPENED) {\n            throw new Error(\"INVALID_STATE_ERR\");\n        }\n\n        if (xhr.sendFlag) {\n            throw new Error(\"INVALID_STATE_ERR\");\n        }\n    }\n\n    // largest arity in XHR is 5 - XHR#open\n    var apply = function (obj, method, args) {\n        switch (args.length) {\n            case 0: return obj[method]();\n            case 1: return obj[method](args[0]);\n            case 2: return obj[method](args[0], args[1]);\n            case 3: return obj[method](args[0], args[1], args[2]);\n            case 4: return obj[method](args[0], args[1], args[2], args[3]);\n            case 5: return obj[method](args[0], args[1], args[2], args[3], args[4]);\n            default: throw new Error(\"Unhandled case\");\n        }\n    };\n\n    FakeXMLHttpRequest.filters = [];\n    FakeXMLHttpRequest.addFilter = function addFilter(fn) {\n        this.filters.push(fn);\n    };\n    FakeXMLHttpRequest.defake = function defake(fakeXhr, xhrArgs) {\n        var xhr = new sinonXhr.workingXHR(); // eslint-disable-line new-cap\n\n        [\n            \"open\",\n            \"setRequestHeader\",\n            \"abort\",\n            \"getResponseHeader\",\n            \"getAllResponseHeaders\",\n            \"addEventListener\",\n            \"overrideMimeType\",\n            \"removeEventListener\"\n        ].forEach(function (method) {\n            fakeXhr[method] = function () {\n                return apply(xhr, method, arguments);\n            };\n        });\n\n        fakeXhr.send = function () {\n            // Ref: https://xhr.spec.whatwg.org/#the-responsetype-attribute\n            if (xhr.responseType !== fakeXhr.responseType) {\n                xhr.responseType = fakeXhr.responseType;\n            }\n            return apply(xhr, \"send\", arguments);\n        };\n\n        var copyAttrs = function (args) {\n            args.forEach(function (attr) {\n                fakeXhr[attr] = xhr[attr];\n            });\n        };\n\n        var stateChangeStart = function () {\n            fakeXhr.readyState = xhr.readyState;\n            if (xhr.readyState >= FakeXMLHttpRequest.HEADERS_RECEIVED) {\n                copyAttrs([\"status\", \"statusText\"]);\n            }\n            if (xhr.readyState >= FakeXMLHttpRequest.LOADING) {\n                copyAttrs([\"response\"]);\n                if (xhr.responseType === \"\" || xhr.responseType === \"text\") {\n                    copyAttrs([\"responseText\"]);\n                }\n            }\n            if (\n                xhr.readyState === FakeXMLHttpRequest.DONE &&\n                (xhr.responseType === \"\" || xhr.responseType === \"document\")\n            ) {\n                copyAttrs([\"responseXML\"]);\n            }\n        };\n\n        var stateChangeEnd = function () {\n            if (fakeXhr.onreadystatechange) {\n                fakeXhr.onreadystatechange.call(fakeXhr, { target: fakeXhr, currentTarget: fakeXhr });\n            }\n        };\n\n        var stateChange = function stateChange() {\n            stateChangeStart();\n            stateChangeEnd();\n        };\n\n        if (xhr.addEventListener) {\n            xhr.addEventListener(\"readystatechange\", stateChangeStart);\n\n            Object.keys(fakeXhr.eventListeners).forEach(function (event) {\n                /*eslint-disable no-loop-func*/\n                fakeXhr.eventListeners[event].forEach(function (handler) {\n                    xhr.addEventListener(event, handler.listener, {\n                        capture: handler.capture,\n                        once: handler.once\n                    });\n                });\n                /*eslint-enable no-loop-func*/\n            });\n\n            xhr.addEventListener(\"readystatechange\", stateChangeEnd);\n        } else {\n            xhr.onreadystatechange = stateChange;\n        }\n        apply(xhr, \"open\", xhrArgs);\n    };\n    FakeXMLHttpRequest.useFilters = false;\n\n    function verifyRequestOpened(xhr) {\n        if (xhr.readyState !== FakeXMLHttpRequest.OPENED) {\n            throw new Error(\"INVALID_STATE_ERR - \" + xhr.readyState);\n        }\n    }\n\n    function verifyRequestSent(xhr) {\n        if (xhr.readyState === FakeXMLHttpRequest.DONE) {\n            throw new Error(\"Request done\");\n        }\n    }\n\n    function verifyHeadersReceived(xhr) {\n        if (xhr.async && xhr.readyState !== FakeXMLHttpRequest.HEADERS_RECEIVED) {\n            throw new Error(\"No headers received\");\n        }\n    }\n\n    function convertResponseBody(responseType, contentType, body) {\n        if (responseType === \"\" || responseType === \"text\") {\n            return body;\n        } else if (supportsArrayBuffer && responseType === \"arraybuffer\") {\n            return convertToArrayBuffer(body);\n        } else if (responseType === \"json\") {\n            try {\n                return JSON.parse(body);\n            } catch (e) {\n                // Return parsing failure as null\n                return null;\n            }\n        } else if (supportsBlob && responseType === \"blob\") {\n            var blobOptions = {};\n            if (contentType) {\n                blobOptions.type = contentType;\n            }\n            return new Blob([convertToArrayBuffer(body)], blobOptions);\n        } else if (responseType === \"document\") {\n            if (isXmlContentType(contentType)) {\n                return FakeXMLHttpRequest.parseXML(body);\n            }\n            return null;\n        }\n        throw new Error(\"Invalid responseType \" + responseType);\n    }\n\n    /**\n     * Steps to follow when there is an error, according to:\n     * https://xhr.spec.whatwg.org/#request-error-steps\n     */\n    function requestErrorSteps(xhr) {\n        clearResponse(xhr);\n        xhr.errorFlag = true;\n        xhr.requestHeaders = {};\n        xhr.responseHeaders = {};\n\n        if (xhr.readyState !== FakeXMLHttpRequest.UNSENT && xhr.sendFlag\n            && xhr.readyState !== FakeXMLHttpRequest.DONE) {\n            xhr.readyStateChange(FakeXMLHttpRequest.DONE);\n            xhr.sendFlag = false;\n        }\n    }\n\n    FakeXMLHttpRequest.parseXML = function parseXML(text) {\n        // Treat empty string as parsing failure\n        if (text !== \"\") {\n            try {\n                if (typeof DOMParser !== \"undefined\") {\n                    var parser = new DOMParser();\n                    var parsererrorNS = \"\";\n\n                    try {\n                        var parsererrors = parser\n                            .parseFromString(\"INVALID\", \"text/xml\")\n                            .getElementsByTagName(\"parsererror\");\n                        if (parsererrors.length) {\n                            parsererrorNS = parsererrors[0].namespaceURI;\n                        }\n                    } catch (e) {\n                        // passing invalid XML makes IE11 throw\n                        // so no namespace needs to be determined\n                    }\n\n                    var result;\n                    try {\n                        result = parser.parseFromString(text, \"text/xml\");\n                    } catch (err) {\n                        return null;\n                    }\n\n                    return result.getElementsByTagNameNS(parsererrorNS, \"parsererror\").length\n                        ? null : result;\n                }\n                var xmlDoc = new window.ActiveXObject(\"Microsoft.XMLDOM\");\n                xmlDoc.async = \"false\";\n                xmlDoc.loadXML(text);\n                return xmlDoc.parseError.errorCode !== 0\n                    ? null : xmlDoc;\n            } catch (e) {\n                // Unable to parse XML - no biggie\n            }\n        }\n\n        return null;\n    };\n\n    FakeXMLHttpRequest.statusCodes = {\n        100: \"Continue\",\n        101: \"Switching Protocols\",\n        200: \"OK\",\n        201: \"Created\",\n        202: \"Accepted\",\n        203: \"Non-Authoritative Information\",\n        204: \"No Content\",\n        205: \"Reset Content\",\n        206: \"Partial Content\",\n        207: \"Multi-Status\",\n        300: \"Multiple Choice\",\n        301: \"Moved Permanently\",\n        302: \"Found\",\n        303: \"See Other\",\n        304: \"Not Modified\",\n        305: \"Use Proxy\",\n        307: \"Temporary Redirect\",\n        400: \"Bad Request\",\n        401: \"Unauthorized\",\n        402: \"Payment Required\",\n        403: \"Forbidden\",\n        404: \"Not Found\",\n        405: \"Method Not Allowed\",\n        406: \"Not Acceptable\",\n        407: \"Proxy Authentication Required\",\n        408: \"Request Timeout\",\n        409: \"Conflict\",\n        410: \"Gone\",\n        411: \"Length Required\",\n        412: \"Precondition Failed\",\n        413: \"Request Entity Too Large\",\n        414: \"Request-URI Too Long\",\n        415: \"Unsupported Media Type\",\n        416: \"Requested Range Not Satisfiable\",\n        417: \"Expectation Failed\",\n        422: \"Unprocessable Entity\",\n        500: \"Internal Server Error\",\n        501: \"Not Implemented\",\n        502: \"Bad Gateway\",\n        503: \"Service Unavailable\",\n        504: \"Gateway Timeout\",\n        505: \"HTTP Version Not Supported\"\n    };\n\n    extend(FakeXMLHttpRequest.prototype, sinonEvent.EventTarget, {\n        async: true,\n\n        open: function open(method, url, async, username, password) {\n            this.method = method;\n            this.url = url;\n            this.async = typeof async === \"boolean\" ? async : true;\n            this.username = username;\n            this.password = password;\n            clearResponse(this);\n            this.requestHeaders = {};\n            this.sendFlag = false;\n\n            if (FakeXMLHttpRequest.useFilters === true) {\n                var xhrArgs = arguments;\n                var defake = FakeXMLHttpRequest.filters.some(function (filter) {\n                    return filter.apply(this, xhrArgs);\n                });\n                if (defake) {\n                    FakeXMLHttpRequest.defake(this, arguments);\n                    return;\n                }\n            }\n            this.readyStateChange(FakeXMLHttpRequest.OPENED);\n        },\n\n        readyStateChange: function readyStateChange(state) {\n            this.readyState = state;\n\n            var readyStateChangeEvent = new sinonEvent.Event(\"readystatechange\", false, false, this);\n            var event, progress;\n\n            if (typeof this.onreadystatechange === \"function\") {\n                try {\n                    this.onreadystatechange(readyStateChangeEvent);\n                } catch (e) {\n                    this.logError(\"Fake XHR onreadystatechange handler\", e);\n                }\n            }\n\n            if (this.readyState === FakeXMLHttpRequest.DONE) {\n                if (this.timedOut || this.aborted || this.status === 0) {\n                    progress = {loaded: 0, total: 0};\n                    event = (this.timedOut && \"timeout\") || (this.aborted && \"abort\") || \"error\";\n                } else {\n                    progress = {loaded: 100, total: 100};\n                    event = \"load\";\n                }\n\n                if (supportsProgress) {\n                    this.upload.dispatchEvent(new sinonEvent.ProgressEvent(\"progress\", progress, this));\n                    this.upload.dispatchEvent(new sinonEvent.ProgressEvent(event, progress, this));\n                    this.upload.dispatchEvent(new sinonEvent.ProgressEvent(\"loadend\", progress, this));\n                }\n\n                this.dispatchEvent(new sinonEvent.ProgressEvent(\"progress\", progress, this));\n                this.dispatchEvent(new sinonEvent.ProgressEvent(event, progress, this));\n                this.dispatchEvent(new sinonEvent.ProgressEvent(\"loadend\", progress, this));\n            }\n\n            this.dispatchEvent(readyStateChangeEvent);\n        },\n\n        // Ref https://xhr.spec.whatwg.org/#the-setrequestheader()-method\n        setRequestHeader: function setRequestHeader(header, value) {\n            if (typeof value !== \"string\") {\n                throw new TypeError(\"By RFC7230, section 3.2.4, header values should be strings. Got \" + typeof value);\n            }\n            verifyState(this);\n\n            var checkUnsafeHeaders = true;\n            if (typeof this.unsafeHeadersEnabled === \"function\") {\n                checkUnsafeHeaders = this.unsafeHeadersEnabled();\n            }\n\n            if (checkUnsafeHeaders && (getHeader(unsafeHeaders, header) !== null || /^(Sec-|Proxy-)/i.test(header))) {\n                throw new Error(\"Refused to set unsafe header \\\"\" + header + \"\\\"\");\n            }\n\n            value = normalizeHeaderValue(value);\n\n            var existingHeader = getHeader(this.requestHeaders, header);\n            if (existingHeader) {\n                this.requestHeaders[existingHeader] += \", \" + value;\n            } else {\n                this.requestHeaders[header] = value;\n            }\n        },\n\n        setStatus: function setStatus(status) {\n            var sanitizedStatus = typeof status === \"number\" ? status : 200;\n\n            verifyRequestOpened(this);\n            this.status = sanitizedStatus;\n            this.statusText = FakeXMLHttpRequest.statusCodes[sanitizedStatus];\n        },\n\n        // Helps testing\n        setResponseHeaders: function setResponseHeaders(headers) {\n            verifyRequestOpened(this);\n\n            var responseHeaders = this.responseHeaders = {};\n\n            Object.keys(headers).forEach(function (header) {\n                responseHeaders[header] = headers[header];\n            });\n\n            if (this.async) {\n                this.readyStateChange(FakeXMLHttpRequest.HEADERS_RECEIVED);\n            } else {\n                this.readyState = FakeXMLHttpRequest.HEADERS_RECEIVED;\n            }\n        },\n\n        // Currently treats ALL data as a DOMString (i.e. no Document)\n        send: function send(data) {\n            verifyState(this);\n\n            if (!/^(head)$/i.test(this.method)) {\n                var contentType = getHeader(this.requestHeaders, \"Content-Type\");\n                if (this.requestHeaders[contentType]) {\n                    var value = this.requestHeaders[contentType].split(\";\");\n                    this.requestHeaders[contentType] = value[0] + \";charset=utf-8\";\n                } else if (supportsFormData && !(data instanceof FormData)) {\n                    this.requestHeaders[\"Content-Type\"] = \"text/plain;charset=utf-8\";\n                }\n\n                this.requestBody = data;\n            }\n\n            this.errorFlag = false;\n            this.sendFlag = this.async;\n            clearResponse(this);\n\n            if (typeof this.onSend === \"function\") {\n                this.onSend(this);\n            }\n\n            // Only listen if setInterval and Date are a stubbed.\n            if (sinonXhr.supportsTimeout && typeof setInterval.clock === \"object\" && typeof Date.clock === \"object\") {\n                var initiatedTime = Date.now();\n                var self = this;\n\n                // Listen to any possible tick by fake timers and check to see if timeout has\n                // been exceeded. It's important to note that timeout can be changed while a request\n                // is in flight, so we must check anytime the end user forces a clock tick to make\n                // sure timeout hasn't changed.\n                // https://xhr.spec.whatwg.org/#dfnReturnLink-2\n                var clearIntervalId = setInterval(function () {\n                    // Check if the readyState has been reset or is done. If this is the case, there\n                    // should be no timeout. This will also prevent aborted requests and\n                    // fakeServerWithClock from triggering unnecessary responses.\n                    if (self.readyState === FakeXMLHttpRequest.UNSENT\n                    || self.readyState === FakeXMLHttpRequest.DONE) {\n                        clearInterval(clearIntervalId);\n                    } else if (typeof self.timeout === \"number\" && self.timeout > 0) {\n                        if (Date.now() >= (initiatedTime + self.timeout)) {\n                            self.triggerTimeout();\n                            clearInterval(clearIntervalId);\n                        }\n                    }\n                }, 1);\n            }\n\n            this.dispatchEvent(new sinonEvent.Event(\"loadstart\", false, false, this));\n        },\n\n        abort: function abort() {\n            this.aborted = true;\n            requestErrorSteps(this);\n            this.readyState = FakeXMLHttpRequest.UNSENT;\n        },\n\n        error: function () {\n            clearResponse(this);\n            this.errorFlag = true;\n            this.requestHeaders = {};\n            this.responseHeaders = {};\n\n            this.readyStateChange(FakeXMLHttpRequest.DONE);\n        },\n\n        triggerTimeout: function triggerTimeout() {\n            if (sinonXhr.supportsTimeout) {\n                this.timedOut = true;\n                requestErrorSteps(this);\n            }\n        },\n\n        getResponseHeader: function getResponseHeader(header) {\n            if (this.readyState < FakeXMLHttpRequest.HEADERS_RECEIVED) {\n                return null;\n            }\n\n            if (/^Set-Cookie2?$/i.test(header)) {\n                return null;\n            }\n\n            header = getHeader(this.responseHeaders, header);\n\n            return this.responseHeaders[header] || null;\n        },\n\n        getAllResponseHeaders: function getAllResponseHeaders() {\n            if (this.readyState < FakeXMLHttpRequest.HEADERS_RECEIVED) {\n                return \"\";\n            }\n\n            var responseHeaders = this.responseHeaders;\n            var headers = Object.keys(responseHeaders)\n                .filter(excludeSetCookie2Header)\n                .reduce(function (prev, header) {\n                    var value = responseHeaders[header];\n\n                    return prev + (header + \": \" + value + \"\\r\\n\");\n                }, \"\");\n\n            return headers;\n        },\n\n        setResponseBody: function setResponseBody(body) {\n            verifyRequestSent(this);\n            verifyHeadersReceived(this);\n            verifyResponseBodyType(body, this.responseType);\n            var contentType = this.overriddenMimeType || this.getResponseHeader(\"Content-Type\");\n\n            var isTextResponse = this.responseType === \"\" || this.responseType === \"text\";\n            clearResponse(this);\n            if (this.async) {\n                var chunkSize = this.chunkSize || 10;\n                var index = 0;\n\n                do {\n                    this.readyStateChange(FakeXMLHttpRequest.LOADING);\n\n                    if (isTextResponse) {\n                        this.responseText = this.response += body.substring(index, index + chunkSize);\n                    }\n                    index += chunkSize;\n                } while (index < body.length);\n            }\n\n            this.response = convertResponseBody(this.responseType, contentType, body);\n            if (isTextResponse) {\n                this.responseText = this.response;\n            }\n\n            if (this.responseType === \"document\") {\n                this.responseXML = this.response;\n            } else if (this.responseType === \"\" && isXmlContentType(contentType)) {\n                this.responseXML = FakeXMLHttpRequest.parseXML(this.responseText);\n            }\n            this.readyStateChange(FakeXMLHttpRequest.DONE);\n        },\n\n        respond: function respond(status, headers, body) {\n            this.setStatus(status);\n            this.setResponseHeaders(headers || {});\n            this.setResponseBody(body || \"\");\n        },\n\n        uploadProgress: function uploadProgress(progressEventRaw) {\n            if (supportsProgress) {\n                this.upload.dispatchEvent(new sinonEvent.ProgressEvent(\"progress\", progressEventRaw, this.upload));\n            }\n        },\n\n        downloadProgress: function downloadProgress(progressEventRaw) {\n            if (supportsProgress) {\n                this.dispatchEvent(new sinonEvent.ProgressEvent(\"progress\", progressEventRaw, this));\n            }\n        },\n\n        uploadError: function uploadError(error) {\n            if (supportsCustomEvent) {\n                this.upload.dispatchEvent(new sinonEvent.CustomEvent(\"error\", {detail: error}));\n            }\n        },\n\n        overrideMimeType: function overrideMimeType(type) {\n            if (this.readyState >= FakeXMLHttpRequest.LOADING) {\n                throw new Error(\"INVALID_STATE_ERR\");\n            }\n            this.overriddenMimeType = type;\n        }\n    });\n\n    var states = {\n        UNSENT: 0,\n        OPENED: 1,\n        HEADERS_RECEIVED: 2,\n        LOADING: 3,\n        DONE: 4\n    };\n\n    extend(FakeXMLHttpRequest, states);\n    extend(FakeXMLHttpRequest.prototype, states);\n\n    function useFakeXMLHttpRequest() {\n        FakeXMLHttpRequest.restore = function restore(keepOnCreate) {\n            if (sinonXhr.supportsXHR) {\n                globalScope.XMLHttpRequest = sinonXhr.GlobalXMLHttpRequest;\n            }\n\n            if (sinonXhr.supportsActiveX) {\n                globalScope.ActiveXObject = sinonXhr.GlobalActiveXObject;\n            }\n\n            delete FakeXMLHttpRequest.restore;\n\n            if (keepOnCreate !== true) {\n                delete FakeXMLHttpRequest.onCreate;\n            }\n        };\n        if (sinonXhr.supportsXHR) {\n            globalScope.XMLHttpRequest = FakeXMLHttpRequest;\n        }\n\n        if (sinonXhr.supportsActiveX) {\n            globalScope.ActiveXObject = function ActiveXObject(objId) {\n                if (objId === \"Microsoft.XMLHTTP\" || /^Msxml2\\.XMLHTTP/i.test(objId)) {\n\n                    return new FakeXMLHttpRequest();\n                }\n\n                return new sinonXhr.GlobalActiveXObject(objId);\n            };\n        }\n\n        return FakeXMLHttpRequest;\n    }\n\n    return {\n        xhr: sinonXhr,\n        FakeXMLHttpRequest: FakeXMLHttpRequest,\n        useFakeXMLHttpRequest: useFakeXMLHttpRequest\n    };\n}\n\nvar globalObject = typeof global !== \"undefined\" ? global : window;\nmodule.exports = extend(fakeXMLHttpRequestFor(globalObject), {\n    fakeXMLHttpRequestFor: fakeXMLHttpRequestFor\n});\n\n},{\"../configure-logger\":1,\"../event\":5,\"./blob\":10,\"@sinonjs/text-encoding\":41,\"just-extend\":43}],12:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n    fakeServer: require(\"./fake-server\"),\n    fakeServerWithClock: require(\"./fake-server/fake-server-with-clock\"),\n    fakeXhr: require(\"./fake-xhr\")\n};\n\n},{\"./fake-server\":9,\"./fake-server/fake-server-with-clock\":7,\"./fake-xhr\":11}],13:[function(require,module,exports){\n\"use strict\";\n\n// This is an `every` implementation that works for all iterables\nmodule.exports = function every(obj, fn) {\n    var pass = true;\n\n    try {\n        /* eslint-disable-next-line local-rules/no-prototype-methods */\n        obj.forEach(function() {\n            if (!fn.apply(this, arguments)) {\n                // Throwing an error is the only way to break `forEach`\n                throw new Error();\n            }\n        });\n    } catch (e) {\n        pass = false;\n    }\n\n    return pass;\n};\n\n},{}],14:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = function functionName(func) {\n    return (\n        func.displayName ||\n        func.name ||\n        // Use function decomposition as a last resort to get function\n        // name. Does not rely on function decomposition to work - if it\n        // doesn't debugging will be slightly less informative\n        // (i.e. toString will say 'spy' rather than 'myFunc').\n        (String(func).match(/function ([^\\s\\(]+)/) || [])[1]\n    );\n};\n\n},{}],15:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n    every: require(\"./every\"),\n    functionName: require(\"./function-name\"),\n    prototypes: require(\"./prototypes\"),\n    typeOf: require(\"./type-of\"),\n    valueToString: require(\"./value-to-string\")\n};\n\n},{\"./every\":13,\"./function-name\":14,\"./prototypes\":19,\"./type-of\":22,\"./value-to-string\":23}],16:[function(require,module,exports){\n\"use strict\";\n\nvar copyPrototype = require(\"./copy-prototype\");\n\nmodule.exports = copyPrototype(Array.prototype);\n\n},{\"./copy-prototype\":17}],17:[function(require,module,exports){\n\"use strict\";\n\nvar call = Function.call;\n\nmodule.exports = function copyPrototypeMethods(prototype) {\n    /* eslint-disable local-rules/no-prototype-methods */\n    return Object.getOwnPropertyNames(prototype).reduce(function(result, name) {\n        // ignore size because it throws from Map\n        if (\n            name !== \"size\" &&\n            name !== \"caller\" &&\n            name !== \"callee\" &&\n            name !== \"arguments\" &&\n            typeof prototype[name] === \"function\"\n        ) {\n            result[name] = call.bind(prototype[name]);\n        }\n\n        return result;\n    }, Object.create(null));\n};\n\n},{}],18:[function(require,module,exports){\n\"use strict\";\n\nvar copyPrototype = require(\"./copy-prototype\");\n\nmodule.exports = copyPrototype(Function.prototype);\n\n},{\"./copy-prototype\":17}],19:[function(require,module,exports){\n\"use strict\";\n\nmodule.exports = {\n    array: require(\"./array\"),\n    function: require(\"./function\"),\n    object: require(\"./object\"),\n    string: require(\"./string\")\n};\n\n},{\"./array\":16,\"./function\":18,\"./object\":20,\"./string\":21}],20:[function(require,module,exports){\n\"use strict\";\n\nvar copyPrototype = require(\"./copy-prototype\");\n\nmodule.exports = copyPrototype(Object.prototype);\n\n},{\"./copy-prototype\":17}],21:[function(require,module,exports){\n\"use strict\";\n\nvar copyPrototype = require(\"./copy-prototype\");\n\nmodule.exports = copyPrototype(String.prototype);\n\n},{\"./copy-prototype\":17}],22:[function(require,module,exports){\n\"use strict\";\n\nvar type = require(\"type-detect\");\n\nmodule.exports = function typeOf(value) {\n    return type(value).toLowerCase();\n};\n\n},{\"type-detect\":47}],23:[function(require,module,exports){\n\"use strict\";\n\nfunction valueToString(value) {\n    if (value && value.toString) {\n        /* eslint-disable-next-line local-rules/no-prototype-methods */\n        return value.toString();\n    }\n    return String(value);\n}\n\nmodule.exports = valueToString;\n\n},{}],24:[function(require,module,exports){\n\"use strict\";\n\nvar samsam = require(\"@sinonjs/samsam\");\nvar formatio = {\n    excludeConstructors: [\"Object\", /^.$/],\n    quoteStrings: true,\n    limitChildrenCount: 0\n};\n\nvar specialObjects = [];\nif (typeof global !== \"undefined\") {\n    specialObjects.push({ object: global, value: \"[object global]\" });\n}\nif (typeof document !== \"undefined\") {\n    specialObjects.push({\n        object: document,\n        value: \"[object HTMLDocument]\"\n    });\n}\nif (typeof window !== \"undefined\") {\n    specialObjects.push({ object: window, value: \"[object Window]\" });\n}\n\nfunction functionName(func) {\n    if (!func) { return \"\"; }\n    if (func.displayName) { return func.displayName; }\n    if (func.name) { return func.name; }\n    var matches = func.toString().match(/function\\s+([^\\(]+)/m);\n    return (matches && matches[1]) || \"\";\n}\n\nfunction constructorName(f, object) {\n    var name = functionName(object && object.constructor);\n    var excludes = f.excludeConstructors ||\n            formatio.excludeConstructors || [];\n\n    var i, l;\n    for (i = 0, l = excludes.length; i < l; ++i) {\n        if (typeof excludes[i] === \"string\" && excludes[i] === name) {\n            return \"\";\n        } else if (excludes[i].test && excludes[i].test(name)) {\n            return \"\";\n        }\n    }\n\n    return name;\n}\n\nfunction isCircular(object, objects) {\n    if (typeof object !== \"object\") { return false; }\n    var i, l;\n    for (i = 0, l = objects.length; i < l; ++i) {\n        if (objects[i] === object) { return true; }\n    }\n    return false;\n}\n\nfunction ascii(f, object, processed, indent) {\n    if (typeof object === \"string\") {\n        if (object.length === 0) { return \"(empty string)\"; }\n        var qs = f.quoteStrings;\n        var quote = typeof qs !== \"boolean\" || qs;\n        return processed || quote ? \"\\\"\" + object + \"\\\"\" : object;\n    }\n\n    if (typeof object === \"function\" && !(object instanceof RegExp)) {\n        return ascii.func(object);\n    }\n\n    processed = processed || [];\n\n    if (isCircular(object, processed)) { return \"[Circular]\"; }\n\n    if (Object.prototype.toString.call(object) === \"[object Array]\") {\n        return ascii.array.call(f, object, processed);\n    }\n\n    if (!object) { return String((1 / object) === -Infinity ? \"-0\" : object); }\n    if (samsam.isElement(object)) { return ascii.element(object); }\n\n    if (typeof object.toString === \"function\" &&\n            object.toString !== Object.prototype.toString) {\n        return object.toString();\n    }\n\n    var i, l;\n    for (i = 0, l = specialObjects.length; i < l; i++) {\n        if (object === specialObjects[i].object) {\n            return specialObjects[i].value;\n        }\n    }\n\n    if (typeof Set !== \"undefined\" && object instanceof Set) {\n        return ascii.set.call(f, object, processed);\n    }\n\n    return ascii.object.call(f, object, processed, indent);\n}\n\nascii.func = function (func) {\n    return \"function \" + functionName(func) + \"() {}\";\n};\n\nfunction delimit(str, delimiters) {\n    delimiters = delimiters || [\"[\", \"]\"];\n    return delimiters[0] + str + delimiters[1];\n}\n\nascii.array = function (array, processed, delimiters) {\n    processed = processed || [];\n    processed.push(array);\n    var pieces = [];\n    var i, l;\n    l = (this.limitChildrenCount > 0) ?\n        Math.min(this.limitChildrenCount, array.length) : array.length;\n\n    for (i = 0; i < l; ++i) {\n        pieces.push(ascii(this, array[i], processed));\n    }\n\n    if (l < array.length) {\n        pieces.push(\"[... \" + (array.length - l) + \" more elements]\");\n    }\n\n    return delimit(pieces.join(\", \"), delimiters);\n};\n\nascii.set = function (set, processed) {\n    return ascii.array.call(this, Array.from(set), processed, [\"Set {\", \"}\"]);\n};\n\nascii.object = function (object, processed, indent) {\n    processed = processed || [];\n    processed.push(object);\n    indent = indent || 0;\n    var pieces = [];\n    var properties = Object.keys(object).sort();\n    var length = 3;\n    var prop, str, obj, i, k, l;\n    l = (this.limitChildrenCount > 0) ?\n        Math.min(this.limitChildrenCount, properties.length) : properties.length;\n\n    for (i = 0; i < l; ++i) {\n        prop = properties[i];\n        obj = object[prop];\n\n        if (isCircular(obj, processed)) {\n            str = \"[Circular]\";\n        } else {\n            str = ascii(this, obj, processed, indent + 2);\n        }\n\n        str = (/\\s/.test(prop) ? \"\\\"\" + prop + \"\\\"\" : prop) + \": \" + str;\n        length += str.length;\n        pieces.push(str);\n    }\n\n    var cons = constructorName(this, object);\n    var prefix = cons ? \"[\" + cons + \"] \" : \"\";\n    var is = \"\";\n    for (i = 0, k = indent; i < k; ++i) { is += \" \"; }\n\n    if (l < properties.length)\n    {pieces.push(\"[... \" + (properties.length - l) + \" more elements]\");}\n\n    if (length + indent > 80) {\n        return prefix + \"{\\n  \" + is + pieces.join(\",\\n  \" + is) + \"\\n\" +\n            is + \"}\";\n    }\n    return prefix + \"{ \" + pieces.join(\", \") + \" }\";\n};\n\nascii.element = function (element) {\n    var tagName = element.tagName.toLowerCase();\n    var attrs = element.attributes;\n    var pairs = [];\n    var attr, attrName, i, l, val;\n\n    for (i = 0, l = attrs.length; i < l; ++i) {\n        attr = attrs.item(i);\n        attrName = attr.nodeName.toLowerCase().replace(\"html:\", \"\");\n        val = attr.nodeValue;\n        if (attrName !== \"contenteditable\" || val !== \"inherit\") {\n            if (val) { pairs.push(attrName + \"=\\\"\" + val + \"\\\"\"); }\n        }\n    }\n\n    var formatted = \"<\" + tagName + (pairs.length > 0 ? \" \" : \"\");\n    // SVG elements have undefined innerHTML\n    var content = element.innerHTML || \"\";\n\n    if (content.length > 20) {\n        content = content.substr(0, 20) + \"[...]\";\n    }\n\n    var res = formatted + pairs.join(\" \") + \">\" + content +\n            \"</\" + tagName + \">\";\n\n    return res.replace(/ contentEditable=\"inherit\"/, \"\");\n};\n\nfunction Formatio(options) {\n    // eslint-disable-next-line guard-for-in\n    for (var opt in options) {\n        this[opt] = options[opt];\n    }\n}\n\nFormatio.prototype = {\n    functionName: functionName,\n\n    configure: function (options) {\n        return new Formatio(options);\n    },\n\n    constructorName: function (object) {\n        return constructorName(this, object);\n    },\n\n    ascii: function (object, processed, indent) {\n        return ascii(this, object, processed, indent);\n    }\n};\n\nmodule.exports = Formatio.prototype;\n\n},{\"@sinonjs/samsam\":40}],25:[function(require,module,exports){\n\"use strict\";\n\nvar getClass = require(\"./get-class\");\nvar identical = require(\"./identical\");\nvar isArguments = require(\"./is-arguments\");\nvar isDate = require(\"./is-date\");\nvar isElement = require(\"./is-element\");\nvar isNaN = require(\"./is-nan\");\nvar isObject = require(\"./is-object\");\nvar isSet = require(\"./is-set\");\nvar isSubset = require(\"./is-subset\");\nvar getClassName = require(\"./get-class-name\");\n\nvar every = Array.prototype.every;\nvar getTime = Date.prototype.getTime;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar indexOf = Array.prototype.indexOf;\nvar keys = Object.keys;\n\n/**\n * @name samsam.deepEqual\n * @param Object first\n * @param Object second\n *\n * Deep equal comparison. Two values are \"deep equal\" if:\n *\n *   - They are equal, according to samsam.identical\n *   - They are both date objects representing the same time\n *   - They are both arrays containing elements that are all deepEqual\n *   - They are objects with the same set of properties, and each property\n *     in ``first`` is deepEqual to the corresponding property in ``second``\n *\n * Supports cyclic objects.\n */\nfunction deepEqualCyclic(first, second, match) {\n    // used for cyclic comparison\n    // contain already visited objects\n    var objects1 = [];\n    var objects2 = [];\n    // contain pathes (position in the object structure)\n    // of the already visited objects\n    // indexes same as in objects arrays\n    var paths1 = [];\n    var paths2 = [];\n    // contains combinations of already compared objects\n    // in the manner: { \"$1['ref']$2['ref']\": true }\n    var compared = {};\n\n    // does the recursion for the deep equal check\n    return (function deepEqual(obj1, obj2, path1, path2) {\n        // If both are matchers they must be the same instance in order to be\n        // considered equal If we didn't do that we would end up running one\n        // matcher against the other\n        if (match && match.isMatcher(obj2)) {\n            if (match.isMatcher(obj1)) {\n                return obj1 === obj2;\n            }\n            return obj2.test(obj1);\n        }\n\n        var type1 = typeof obj1;\n        var type2 = typeof obj2;\n\n        // == null also matches undefined\n        if (\n            obj1 === obj2 ||\n            isNaN(obj1) ||\n            isNaN(obj2) ||\n            obj1 == null ||\n            obj2 == null ||\n            type1 !== \"object\" ||\n            type2 !== \"object\"\n        ) {\n            return identical(obj1, obj2);\n        }\n\n        // Elements are only equal if identical(expected, actual)\n        if (isElement(obj1) || isElement(obj2)) {\n            return false;\n        }\n\n        var isDate1 = isDate(obj1);\n        var isDate2 = isDate(obj2);\n        if (isDate1 || isDate2) {\n            if (\n                !isDate1 ||\n                !isDate2 ||\n                getTime.call(obj1) !== getTime.call(obj2)\n            ) {\n                return false;\n            }\n        }\n\n        if (obj1 instanceof RegExp && obj2 instanceof RegExp) {\n            if (obj1.toString() !== obj2.toString()) {\n                return false;\n            }\n        }\n\n        if (obj1 instanceof Error && obj2 instanceof Error) {\n            if (\n                obj1.constructor !== obj2.constructor ||\n                obj1.message !== obj2.message ||\n                obj1.stack !== obj2.stack\n            ) {\n                return false;\n            }\n        }\n\n        var class1 = getClass(obj1);\n        var class2 = getClass(obj2);\n        var keys1 = keys(obj1);\n        var keys2 = keys(obj2);\n        var name1 = getClassName(obj1);\n        var name2 = getClassName(obj2);\n\n        if (isArguments(obj1) || isArguments(obj2)) {\n            if (obj1.length !== obj2.length) {\n                return false;\n            }\n        } else {\n            if (\n                type1 !== type2 ||\n                class1 !== class2 ||\n                keys1.length !== keys2.length ||\n                (name1 && name2 && name1 !== name2)\n            ) {\n                return false;\n            }\n        }\n\n        if (isSet(obj1) || isSet(obj2)) {\n            if (!isSet(obj1) || !isSet(obj2) || obj1.size !== obj2.size) {\n                return false;\n            }\n\n            return isSubset(obj1, obj2, deepEqual);\n        }\n\n        return every.call(keys1, function(key) {\n            if (!hasOwnProperty.call(obj2, key)) {\n                return false;\n            }\n\n            var value1 = obj1[key];\n            var value2 = obj2[key];\n            var isObject1 = isObject(value1);\n            var isObject2 = isObject(value2);\n            // determines, if the objects were already visited\n            // (it's faster to check for isObject first, than to\n            // get -1 from getIndex for non objects)\n            var index1 = isObject1 ? indexOf.call(objects1, value1) : -1;\n            var index2 = isObject2 ? indexOf.call(objects2, value2) : -1;\n            // determines the new paths of the objects\n            // - for non cyclic objects the current path will be extended\n            //   by current property name\n            // - for cyclic objects the stored path is taken\n            var newPath1 =\n                index1 !== -1\n                    ? paths1[index1]\n                    : path1 + \"[\" + JSON.stringify(key) + \"]\";\n            var newPath2 =\n                index2 !== -1\n                    ? paths2[index2]\n                    : path2 + \"[\" + JSON.stringify(key) + \"]\";\n            var combinedPath = newPath1 + newPath2;\n\n            // stop recursion if current objects are already compared\n            if (compared[combinedPath]) {\n                return true;\n            }\n\n            // remember the current objects and their paths\n            if (index1 === -1 && isObject1) {\n                objects1.push(value1);\n                paths1.push(newPath1);\n            }\n            if (index2 === -1 && isObject2) {\n                objects2.push(value2);\n                paths2.push(newPath2);\n            }\n\n            // remember that the current objects are already compared\n            if (isObject1 && isObject2) {\n                compared[combinedPath] = true;\n            }\n\n            // End of cyclic logic\n\n            // neither value1 nor value2 is a cycle\n            // continue with next level\n            return deepEqual(value1, value2, newPath1, newPath2);\n        });\n    })(first, second, \"$1\", \"$2\");\n}\n\ndeepEqualCyclic.use = function(match) {\n    return function(a, b) {\n        return deepEqualCyclic(a, b, match);\n    };\n};\n\nmodule.exports = deepEqualCyclic;\n\n},{\"./get-class\":27,\"./get-class-name\":26,\"./identical\":28,\"./is-arguments\":29,\"./is-date\":30,\"./is-element\":31,\"./is-nan\":32,\"./is-object\":34,\"./is-set\":35,\"./is-subset\":36}],26:[function(require,module,exports){\n\"use strict\";\n\nvar re = /function (\\w+)\\s*\\(/;\n\nfunction getClassName(value) {\n    if (value.constructor && \"name\" in value.constructor) {\n        return value.constructor.name;\n    }\n\n    if (typeof value.constructor === \"function\") {\n        var match = value.constructor.toString().match(re);\n        if (match.length > 1) {\n            return match[1];\n        }\n    }\n\n    return null;\n}\n\nmodule.exports = getClassName;\n\n},{}],27:[function(require,module,exports){\n\"use strict\";\n\nvar o = Object.prototype;\n\nfunction getClass(value) {\n    // Returns the internal [[Class]] by calling Object.prototype.toString\n    // with the provided value as this. Return value is a string, naming the\n    // internal class, e.g. \"Array\"\n    return o.toString.call(value).split(/[ \\]]/)[1];\n}\n\nmodule.exports = getClass;\n\n},{}],28:[function(require,module,exports){\n\"use strict\";\n\nvar isNaN = require(\"./is-nan\");\nvar isNegZero = require(\"./is-neg-zero\");\n\n/**\n * @name samsam.equal\n * @param Object obj1\n * @param Object obj2\n *\n * Returns ``true`` if two objects are strictly equal. Compared to\n * ``===`` there are two exceptions:\n *\n *   - NaN is considered equal to NaN\n *   - -0 and +0 are not considered equal\n */\nfunction identical(obj1, obj2) {\n    if (obj1 === obj2 || (isNaN(obj1) && isNaN(obj2))) {\n        return obj1 !== 0 || isNegZero(obj1) === isNegZero(obj2);\n    }\n\n    return false;\n}\n\nmodule.exports = identical;\n\n},{\"./is-nan\":32,\"./is-neg-zero\":33}],29:[function(require,module,exports){\n\"use strict\";\n\nvar getClass = require(\"./get-class\");\n\n/**\n * @name samsam.isArguments\n * @param Object object\n *\n * Returns ``true`` if ``object`` is an ``arguments`` object,\n * ``false`` otherwise.\n */\nfunction isArguments(object) {\n    if (getClass(object) === \"Arguments\") {\n        return true;\n    }\n    if (\n        typeof object !== \"object\" ||\n        typeof object.length !== \"number\" ||\n        getClass(object) === \"Array\"\n    ) {\n        return false;\n    }\n    if (typeof object.callee === \"function\") {\n        return true;\n    }\n    try {\n        object[object.length] = 6;\n        delete object[object.length];\n    } catch (e) {\n        return true;\n    }\n    return false;\n}\n\nmodule.exports = isArguments;\n\n},{\"./get-class\":27}],30:[function(require,module,exports){\n\"use strict\";\n\nfunction isDate(value) {\n    return value instanceof Date;\n}\n\nmodule.exports = isDate;\n\n},{}],31:[function(require,module,exports){\n\"use strict\";\n\nvar div = typeof document !== \"undefined\" && document.createElement(\"div\");\n\n/**\n * @name samsam.isElement\n * @param Object object\n *\n * Returns ``true`` if ``object`` is a DOM element node. Unlike\n * Underscore.js/lodash, this function will return ``false`` if ``object``\n * is an *element-like* object, i.e. a regular object with a ``nodeType``\n * property that holds the value ``1``.\n */\nfunction isElement(object) {\n    if (!object || object.nodeType !== 1 || !div) {\n        return false;\n    }\n    try {\n        object.appendChild(div);\n        object.removeChild(div);\n    } catch (e) {\n        return false;\n    }\n    return true;\n}\n\nmodule.exports = isElement;\n\n},{}],32:[function(require,module,exports){\n\"use strict\";\n\nfunction isNaN(value) {\n    // Unlike global isNaN, this avoids type coercion\n    // typeof check avoids IE host object issues, hat tip to\n    // lodash\n    var val = value; // JsLint thinks value !== value is \"weird\"\n    return typeof value === \"number\" && value !== val;\n}\n\nmodule.exports = isNaN;\n\n},{}],33:[function(require,module,exports){\n\"use strict\";\n\n/**\n * @name samsam.isNegZero\n * @param Object value\n *\n * Returns ``true`` if ``value`` is ``-0``.\n */\nfunction isNegZero(value) {\n    return value === 0 && 1 / value === -Infinity;\n}\n\nmodule.exports = isNegZero;\n\n},{}],34:[function(require,module,exports){\n\"use strict\";\n\n// Returns true when the value is a regular Object and not a specialized Object\n//\n// This helps speeding up deepEqual cyclic checks\n// The premise is that only Objects are stored in the visited array.\n// So if this function returns false, we don't have to do the\n// expensive operation of searching for the value in the the array of already\n// visited objects\nfunction isObject(value) {\n    return (\n        typeof value === \"object\" &&\n        value !== null &&\n        // none of these are collection objects, so we can return false\n        !(value instanceof Boolean) &&\n        !(value instanceof Date) &&\n        !(value instanceof Error) &&\n        !(value instanceof Number) &&\n        !(value instanceof RegExp) &&\n        !(value instanceof String)\n    );\n}\n\nmodule.exports = isObject;\n\n},{}],35:[function(require,module,exports){\n\"use strict\";\n\nfunction isSet(val) {\n    return (typeof Set !== \"undefined\" && val instanceof Set) || false;\n}\n\nmodule.exports = isSet;\n\n},{}],36:[function(require,module,exports){\n\"use strict\";\n\nfunction isSubset(s1, s2, compare) {\n    var allContained = true;\n    s1.forEach(function(v1) {\n        var includes = false;\n        s2.forEach(function(v2) {\n            if (compare(v2, v1)) {\n                includes = true;\n            }\n        });\n        allContained = allContained && includes;\n    });\n\n    return allContained;\n}\n\nmodule.exports = isSubset;\n\n},{}],37:[function(require,module,exports){\n\"use strict\";\n\nvar slice = require(\"@sinonjs/commons\").prototypes.string.slice;\nvar typeOf = require(\"@sinonjs/commons\").typeOf;\n\nmodule.exports = function iterableToString(obj) {\n    var representation = \"\";\n\n    function stringify(item) {\n        return typeof item === \"string\" ? \"'\" + item + \"'\" : String(item);\n    }\n\n    function mapToString(map) {\n        /* eslint-disable-next-line local-rules/no-prototype-methods */\n        map.forEach(function(value, key) {\n            representation +=\n                \"[\" + stringify(key) + \",\" + stringify(value) + \"],\";\n        });\n\n        representation = slice(representation, 0, -1);\n        return representation;\n    }\n\n    function genericIterableToString(iterable) {\n        /* eslint-disable-next-line local-rules/no-prototype-methods */\n        iterable.forEach(function(value) {\n            representation += stringify(value) + \",\";\n        });\n\n        representation = slice(representation, 0, -1);\n        return representation;\n    }\n\n    if (typeOf(obj) === \"map\") {\n        return mapToString(obj);\n    }\n\n    return genericIterableToString(obj);\n};\n\n},{\"@sinonjs/commons\":15}],38:[function(require,module,exports){\n\"use strict\";\n\nvar deepEqual = require(\"./deep-equal\").use(match); // eslint-disable-line no-use-before-define\nvar getClass = require(\"./get-class\");\nvar isDate = require(\"./is-date\");\nvar isSet = require(\"./is-set\");\nvar isSubset = require(\"./is-subset\");\nvar createMatcher = require(\"./matcher\");\n\nfunction arrayContains(array, subset, compare) {\n    if (subset.length === 0) {\n        return true;\n    }\n    var i, l, j, k;\n    for (i = 0, l = array.length; i < l; ++i) {\n        if (compare(array[i], subset[0])) {\n            for (j = 0, k = subset.length; j < k; ++j) {\n                if (i + j >= l) {\n                    return false;\n                }\n                if (!compare(array[i + j], subset[j])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    }\n    return false;\n}\n\n/**\n * @name samsam.match\n * @param Object object\n * @param Object matcher\n *\n * Compare arbitrary value ``object`` with matcher.\n */\nfunction match(object, matcher) {\n    if (matcher && typeof matcher.test === \"function\") {\n        return matcher.test(object);\n    }\n\n    if (typeof matcher === \"function\") {\n        return matcher(object) === true;\n    }\n\n    if (typeof matcher === \"string\") {\n        matcher = matcher.toLowerCase();\n        var notNull = typeof object === \"string\" || !!object;\n        return (\n            notNull &&\n            String(object)\n                .toLowerCase()\n                .indexOf(matcher) >= 0\n        );\n    }\n\n    if (typeof matcher === \"number\") {\n        return matcher === object;\n    }\n\n    if (typeof matcher === \"boolean\") {\n        return matcher === object;\n    }\n\n    if (typeof matcher === \"undefined\") {\n        return typeof object === \"undefined\";\n    }\n\n    if (matcher === null) {\n        return object === null;\n    }\n\n    if (object === null) {\n        return false;\n    }\n\n    if (isSet(object)) {\n        return isSubset(matcher, object, match);\n    }\n\n    if (getClass(object) === \"Array\" && getClass(matcher) === \"Array\") {\n        return arrayContains(object, matcher, match);\n    }\n\n    if (isDate(matcher)) {\n        return isDate(object) && object.getTime() === matcher.getTime();\n    }\n\n    if (matcher && typeof matcher === \"object\") {\n        if (matcher === object) {\n            return true;\n        }\n        if (typeof object !== \"object\") {\n            return false;\n        }\n        var prop;\n        // eslint-disable-next-line guard-for-in\n        for (prop in matcher) {\n            var value = object[prop];\n            if (\n                typeof value === \"undefined\" &&\n                typeof object.getAttribute === \"function\"\n            ) {\n                value = object.getAttribute(prop);\n            }\n            if (\n                matcher[prop] === null ||\n                typeof matcher[prop] === \"undefined\"\n            ) {\n                if (value !== matcher[prop]) {\n                    return false;\n                }\n            } else if (\n                typeof value === \"undefined\" ||\n                !deepEqual(value, matcher[prop])\n            ) {\n                return false;\n            }\n        }\n        return true;\n    }\n\n    throw new Error(\n        \"Matcher was not a string, a number, a \" +\n            \"function, a boolean or an object\"\n    );\n}\n\nObject.keys(createMatcher).forEach(function(key) {\n    match[key] = createMatcher[key];\n});\n\nmodule.exports = match;\n\n},{\"./deep-equal\":25,\"./get-class\":27,\"./is-date\":30,\"./is-set\":35,\"./is-subset\":36,\"./matcher\":39}],39:[function(require,module,exports){\n\"use strict\";\n\nvar arrayProto = require(\"@sinonjs/commons\").prototypes.array;\nvar deepEqual = require(\"./deep-equal\").use(match); // eslint-disable-line no-use-before-define\nvar every = require(\"@sinonjs/commons\").every;\nvar functionName = require(\"@sinonjs/commons\").functionName;\nvar get = require(\"lodash.get\");\nvar iterableToString = require(\"./iterable-to-string\");\nvar objectProto = require(\"@sinonjs/commons\").prototypes.object;\nvar stringProto = require(\"@sinonjs/commons\").prototypes.string;\nvar typeOf = require(\"@sinonjs/commons\").typeOf;\nvar valueToString = require(\"@sinonjs/commons\").valueToString;\n\nvar arrayIndexOf = arrayProto.indexOf;\nvar arrayEvery = arrayProto.every;\nvar join = arrayProto.join;\nvar map = arrayProto.map;\nvar some = arrayProto.some;\n\nvar hasOwnProperty = objectProto.hasOwnProperty;\nvar isPrototypeOf = objectProto.isPrototypeOf;\n\nvar stringIndexOf = stringProto.indexOf;\n\nfunction assertType(value, type, name) {\n    var actual = typeOf(value);\n    if (actual !== type) {\n        throw new TypeError(\n            \"Expected type of \" +\n                name +\n                \" to be \" +\n                type +\n                \", but was \" +\n                actual\n        );\n    }\n}\n\nfunction assertMethodExists(value, method, name, methodPath) {\n    if (value[method] == null) {\n        throw new TypeError(\n            \"Expected \" + name + \" to have method \" + methodPath\n        );\n    }\n}\n\nvar matcher = {\n    toString: function() {\n        return this.message;\n    }\n};\n\nfunction isMatcher(object) {\n    return isPrototypeOf(matcher, object);\n}\n\nfunction matchObject(actual, expectation) {\n    if (actual === null || actual === undefined) {\n        return false;\n    }\n\n    return arrayEvery(Object.keys(expectation), function(key) {\n        var exp = expectation[key];\n        var act = actual[key];\n\n        if (isMatcher(exp)) {\n            if (!exp.test(act)) {\n                return false;\n            }\n        } else if (typeOf(exp) === \"object\") {\n            if (!matchObject(act, exp)) {\n                return false;\n            }\n        } else if (!deepEqual(act, exp)) {\n            return false;\n        }\n\n        return true;\n    });\n}\n\nvar TYPE_MAP = {\n    function: function(m, expectation, message) {\n        m.test = expectation;\n        m.message = message || \"match(\" + functionName(expectation) + \")\";\n    },\n    number: function(m, expectation) {\n        m.test = function(actual) {\n            // we need type coercion here\n            return expectation == actual; // eslint-disable-line eqeqeq\n        };\n    },\n    object: function(m, expectation) {\n        var array = [];\n\n        if (typeof expectation.test === \"function\") {\n            m.test = function(actual) {\n                return expectation.test(actual) === true;\n            };\n            m.message = \"match(\" + functionName(expectation.test) + \")\";\n            return m;\n        }\n\n        array = map(Object.keys(expectation), function(key) {\n            return key + \": \" + valueToString(expectation[key]);\n        });\n\n        m.test = function(actual) {\n            return matchObject(actual, expectation);\n        };\n        m.message = \"match(\" + join(array, \", \") + \")\";\n\n        return m;\n    },\n    regexp: function(m, expectation) {\n        m.test = function(actual) {\n            return typeof actual === \"string\" && expectation.test(actual);\n        };\n    },\n    string: function(m, expectation) {\n        m.test = function(actual) {\n            return (\n                typeof actual === \"string\" &&\n                stringIndexOf(actual, expectation) !== -1\n            );\n        };\n        m.message = 'match(\"' + expectation + '\")';\n    }\n};\n\nfunction match(expectation, message) {\n    var m = Object.create(matcher);\n    var type = typeOf(expectation);\n\n    if (type in TYPE_MAP) {\n        TYPE_MAP[type](m, expectation, message);\n    } else {\n        m.test = function(actual) {\n            return deepEqual(actual, expectation);\n        };\n    }\n\n    if (!m.message) {\n        m.message = \"match(\" + valueToString(expectation) + \")\";\n    }\n\n    return m;\n}\n\nmatcher.or = function(m2) {\n    if (!arguments.length) {\n        throw new TypeError(\"Matcher expected\");\n    } else if (!isMatcher(m2)) {\n        m2 = match(m2);\n    }\n    var m1 = this;\n    var or = Object.create(matcher);\n    or.test = function(actual) {\n        return m1.test(actual) || m2.test(actual);\n    };\n    or.message = m1.message + \".or(\" + m2.message + \")\";\n    return or;\n};\n\nmatcher.and = function(m2) {\n    if (!arguments.length) {\n        throw new TypeError(\"Matcher expected\");\n    } else if (!isMatcher(m2)) {\n        m2 = match(m2);\n    }\n    var m1 = this;\n    var and = Object.create(matcher);\n    and.test = function(actual) {\n        return m1.test(actual) && m2.test(actual);\n    };\n    and.message = m1.message + \".and(\" + m2.message + \")\";\n    return and;\n};\n\nmatch.isMatcher = isMatcher;\n\nmatch.any = match(function() {\n    return true;\n}, \"any\");\n\nmatch.defined = match(function(actual) {\n    return actual !== null && actual !== undefined;\n}, \"defined\");\n\nmatch.truthy = match(function(actual) {\n    return !!actual;\n}, \"truthy\");\n\nmatch.falsy = match(function(actual) {\n    return !actual;\n}, \"falsy\");\n\nmatch.same = function(expectation) {\n    return match(function(actual) {\n        return expectation === actual;\n    }, \"same(\" + valueToString(expectation) + \")\");\n};\n\nmatch.in = function(arrayOfExpectations) {\n    if (!Array.isArray(arrayOfExpectations)) {\n        throw new TypeError(\"array expected\");\n    }\n\n    return match(function(actual) {\n        return some(arrayOfExpectations, function(expectation) {\n            return expectation === actual;\n        });\n    }, \"in(\" + valueToString(arrayOfExpectations) + \")\");\n};\n\nmatch.typeOf = function(type) {\n    assertType(type, \"string\", \"type\");\n    return match(function(actual) {\n        return typeOf(actual) === type;\n    }, 'typeOf(\"' + type + '\")');\n};\n\nmatch.instanceOf = function(type) {\n    if (\n        typeof Symbol === \"undefined\" ||\n        typeof Symbol.hasInstance === \"undefined\"\n    ) {\n        assertType(type, \"function\", \"type\");\n    } else {\n        assertMethodExists(\n            type,\n            Symbol.hasInstance,\n            \"type\",\n            \"[Symbol.hasInstance]\"\n        );\n    }\n    return match(function(actual) {\n        return actual instanceof type;\n    }, \"instanceOf(\" +\n        (functionName(type) || Object.prototype.toString.call(type)) +\n        \")\");\n};\n\nfunction createPropertyMatcher(propertyTest, messagePrefix) {\n    return function(property, value) {\n        assertType(property, \"string\", \"property\");\n        var onlyProperty = arguments.length === 1;\n        var message = messagePrefix + '(\"' + property + '\"';\n        if (!onlyProperty) {\n            message += \", \" + valueToString(value);\n        }\n        message += \")\";\n        return match(function(actual) {\n            if (\n                actual === undefined ||\n                actual === null ||\n                !propertyTest(actual, property)\n            ) {\n                return false;\n            }\n            return onlyProperty || deepEqual(actual[property], value);\n        }, message);\n    };\n}\n\nmatch.has = createPropertyMatcher(function(actual, property) {\n    if (typeof actual === \"object\") {\n        return property in actual;\n    }\n    return actual[property] !== undefined;\n}, \"has\");\n\nmatch.hasOwn = createPropertyMatcher(function(actual, property) {\n    return hasOwnProperty(actual, property);\n}, \"hasOwn\");\n\nmatch.hasNested = function(property, value) {\n    assertType(property, \"string\", \"property\");\n    var onlyProperty = arguments.length === 1;\n    var message = 'hasNested(\"' + property + '\"';\n    if (!onlyProperty) {\n        message += \", \" + valueToString(value);\n    }\n    message += \")\";\n    return match(function(actual) {\n        if (\n            actual === undefined ||\n            actual === null ||\n            get(actual, property) === undefined\n        ) {\n            return false;\n        }\n        return onlyProperty || deepEqual(get(actual, property), value);\n    }, message);\n};\n\nmatch.every = function(predicate) {\n    if (!isMatcher(predicate)) {\n        throw new TypeError(\"Matcher expected\");\n    }\n\n    return match(function(actual) {\n        if (typeOf(actual) === \"object\") {\n            return every(Object.keys(actual), function(key) {\n                return predicate.test(actual[key]);\n            });\n        }\n\n        return (\n            !!actual &&\n            typeOf(actual.forEach) === \"function\" &&\n            every(actual, function(element) {\n                return predicate.test(element);\n            })\n        );\n    }, \"every(\" + predicate.message + \")\");\n};\n\nmatch.some = function(predicate) {\n    if (!isMatcher(predicate)) {\n        throw new TypeError(\"Matcher expected\");\n    }\n\n    return match(function(actual) {\n        if (typeOf(actual) === \"object\") {\n            return !every(Object.keys(actual), function(key) {\n                return !predicate.test(actual[key]);\n            });\n        }\n\n        return (\n            !!actual &&\n            typeOf(actual.forEach) === \"function\" &&\n            !every(actual, function(element) {\n                return !predicate.test(element);\n            })\n        );\n    }, \"some(\" + predicate.message + \")\");\n};\n\nmatch.array = match.typeOf(\"array\");\n\nmatch.array.deepEquals = function(expectation) {\n    return match(function(actual) {\n        // Comparing lengths is the fastest way to spot a difference before iterating through every item\n        var sameLength = actual.length === expectation.length;\n        return (\n            typeOf(actual) === \"array\" &&\n            sameLength &&\n            every(actual, function(element, index) {\n                return expectation[index] === element;\n            })\n        );\n    }, \"deepEquals([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.array.startsWith = function(expectation) {\n    return match(function(actual) {\n        return (\n            typeOf(actual) === \"array\" &&\n            every(expectation, function(expectedElement, index) {\n                return actual[index] === expectedElement;\n            })\n        );\n    }, \"startsWith([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.array.endsWith = function(expectation) {\n    return match(function(actual) {\n        // This indicates the index in which we should start matching\n        var offset = actual.length - expectation.length;\n\n        return (\n            typeOf(actual) === \"array\" &&\n            every(expectation, function(expectedElement, index) {\n                return actual[offset + index] === expectedElement;\n            })\n        );\n    }, \"endsWith([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.array.contains = function(expectation) {\n    return match(function(actual) {\n        return (\n            typeOf(actual) === \"array\" &&\n            every(expectation, function(expectedElement) {\n                return arrayIndexOf(actual, expectedElement) !== -1;\n            })\n        );\n    }, \"contains([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.map = match.typeOf(\"map\");\n\nmatch.map.deepEquals = function mapDeepEquals(expectation) {\n    return match(function(actual) {\n        // Comparing lengths is the fastest way to spot a difference before iterating through every item\n        var sameLength = actual.size === expectation.size;\n        return (\n            typeOf(actual) === \"map\" &&\n            sameLength &&\n            every(actual, function(element, key) {\n                return expectation.has(key) && expectation.get(key) === element;\n            })\n        );\n    }, \"deepEquals(Map[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.map.contains = function mapContains(expectation) {\n    return match(function(actual) {\n        return (\n            typeOf(actual) === \"map\" &&\n            every(expectation, function(element, key) {\n                return actual.has(key) && actual.get(key) === element;\n            })\n        );\n    }, \"contains(Map[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.set = match.typeOf(\"set\");\n\nmatch.set.deepEquals = function setDeepEquals(expectation) {\n    return match(function(actual) {\n        // Comparing lengths is the fastest way to spot a difference before iterating through every item\n        var sameLength = actual.size === expectation.size;\n        return (\n            typeOf(actual) === \"set\" &&\n            sameLength &&\n            every(actual, function(element) {\n                return expectation.has(element);\n            })\n        );\n    }, \"deepEquals(Set[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.set.contains = function setContains(expectation) {\n    return match(function(actual) {\n        return (\n            typeOf(actual) === \"set\" &&\n            every(expectation, function(element) {\n                return actual.has(element);\n            })\n        );\n    }, \"contains(Set[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.bool = match.typeOf(\"boolean\");\nmatch.number = match.typeOf(\"number\");\nmatch.string = match.typeOf(\"string\");\nmatch.object = match.typeOf(\"object\");\nmatch.func = match.typeOf(\"function\");\nmatch.regexp = match.typeOf(\"regexp\");\nmatch.date = match.typeOf(\"date\");\nmatch.symbol = match.typeOf(\"symbol\");\n\nmodule.exports = match;\n\n},{\"./deep-equal\":25,\"./iterable-to-string\":37,\"@sinonjs/commons\":15,\"lodash.get\":44}],40:[function(require,module,exports){\n\"use strict\";\n\nvar identical = require(\"./identical\");\nvar isArguments = require(\"./is-arguments\");\nvar isElement = require(\"./is-element\");\nvar isNegZero = require(\"./is-neg-zero\");\nvar match = require(\"./match\");\nvar deepEqualCyclic = require(\"./deep-equal\").use(match);\nvar createMatcher = require(\"./matcher\");\n\nmodule.exports = {\n    createMatcher: createMatcher,\n    deepEqual: deepEqualCyclic,\n    isArguments: isArguments,\n    isElement: isElement,\n    isNegZero: isNegZero,\n    identical: identical,\n    match: match\n};\n\n},{\"./deep-equal\":25,\"./identical\":28,\"./is-arguments\":29,\"./is-element\":31,\"./is-neg-zero\":33,\"./match\":38,\"./matcher\":39}],41:[function(require,module,exports){\n\n},{}],42:[function(require,module,exports){\nmodule.exports = Array.isArray || function (arr) {\n  return Object.prototype.toString.call(arr) == '[object Array]';\n};\n\n},{}],43:[function(require,module,exports){\nmodule.exports = extend;\n\n/*\n  var obj = {a: 3, b: 5};\n  extend(obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 4, b: 5, c: 8}\n\n  var obj = {a: 3, b: 5};\n  extend({}, obj, {a: 4, c: 8}); // {a: 4, b: 5, c: 8}\n  obj; // {a: 3, b: 5}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3, 4]}\n\n  var arr = [1, 2, 3];\n  var obj = {a: 3, b: 5};\n  extend(true, obj, {c: arr}); // {a: 3, b: 5, c: [1, 2, 3]}\n  arr.push(4);\n  obj; // {a: 3, b: 5, c: [1, 2, 3]}\n\n  extend({a: 4, b: 5}); // {a: 4, b: 5}\n  extend({a: 4, b: 5}, 3); {a: 4, b: 5}\n  extend({a: 4, b: 5}, true); {a: 4, b: 5}\n  extend('hello', {a: 4, b: 5}); // throws\n  extend(3, {a: 4, b: 5}); // throws\n*/\n\nfunction extend(/* [deep], obj1, obj2, [objn] */) {\n  var args = [].slice.call(arguments);\n  var deep = false;\n  if (typeof args[0] == 'boolean') {\n    deep = args.shift();\n  }\n  var result = args[0];\n  if (!result || (typeof result != 'object' && typeof result != 'function')) {\n    throw new Error('extendee must be an object');\n  }\n  var extenders = args.slice(1);\n  var len = extenders.length;\n  for (var i = 0; i < len; i++) {\n    var extender = extenders[i];\n    for (var key in extender) {\n      if (extender.hasOwnProperty(key)) {\n        var value = extender[key];\n        if (deep && isCloneable(value)) {\n          var base = Array.isArray(value) ? [] : {};\n          result[key] = extend(true, result.hasOwnProperty(key) ? result[key] : base, value);\n        } else {\n          result[key] = value;\n        }\n      }\n    }\n  }\n  return result;\n}\n\nfunction isCloneable(obj) {\n  return Array.isArray(obj) || {}.toString.call(obj) == '[object Object]';\n}\n\n},{}],44:[function(require,module,exports){\n/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n\n},{}],45:[function(require,module,exports){\n\"use strict\";\n\nvar userAgent = global.navigator && global.navigator.userAgent;\nvar isRunningInIE = userAgent && userAgent.indexOf(\"MSIE \") > -1;\nvar maxTimeout = Math.pow(2, 31) - 1; //see https://heycam.github.io/webidl/#abstract-opdef-converttoint\n\n// Make properties writable in IE, as per\n// http://www.adequatelygood.com/Replacing-setTimeout-Globally.html\nif (isRunningInIE) {\n    global.setTimeout = global.setTimeout;\n    global.clearTimeout = global.clearTimeout;\n    global.setInterval = global.setInterval;\n    global.clearInterval = global.clearInterval;\n    global.Date = global.Date;\n}\n\n// setImmediate is not a standard function\n// avoid adding the prop to the window object if not present\nif (global.setImmediate !== undefined) {\n    global.setImmediate = global.setImmediate;\n    global.clearImmediate = global.clearImmediate;\n}\n\n// node expects setTimeout/setInterval to return a fn object w/ .ref()/.unref()\n// browsers, a number.\n// see https://github.com/cjohansen/Sinon.JS/pull/436\n\nvar NOOP = function () { return undefined; };\nvar timeoutResult = setTimeout(NOOP, 0);\nvar addTimerReturnsObject = typeof timeoutResult === \"object\";\nvar hrtimePresent = (global.process && typeof global.process.hrtime === \"function\");\nvar nextTickPresent = (global.process && typeof global.process.nextTick === \"function\");\nvar performancePresent = (global.performance && typeof global.performance.now === \"function\");\nvar requestAnimationFramePresent = (global.requestAnimationFrame && typeof global.requestAnimationFrame === \"function\");\nvar cancelAnimationFramePresent = (global.cancelAnimationFrame && typeof global.cancelAnimationFrame === \"function\");\n\nclearTimeout(timeoutResult);\n\nvar NativeDate = Date;\nvar uniqueTimerId = 1;\n\n/**\n * Parse strings like \"01:10:00\" (meaning 1 hour, 10 minutes, 0 seconds) into\n * number of milliseconds. This is used to support human-readable strings passed\n * to clock.tick()\n */\nfunction parseTime(str) {\n    if (!str) {\n        return 0;\n    }\n\n    var strings = str.split(\":\");\n    var l = strings.length;\n    var i = l;\n    var ms = 0;\n    var parsed;\n\n    if (l > 3 || !/^(\\d\\d:){0,2}\\d\\d?$/.test(str)) {\n        throw new Error(\"tick only understands numbers, 'm:s' and 'h:m:s'. Each part must be two digits\");\n    }\n\n    while (i--) {\n        parsed = parseInt(strings[i], 10);\n\n        if (parsed >= 60) {\n            throw new Error(\"Invalid time \" + str);\n        }\n\n        ms += parsed * Math.pow(60, (l - i - 1));\n    }\n\n    return ms * 1000;\n}\n\n/**\n * Floor function that also works for negative numbers\n */\nfunction fixedFloor(n) {\n    return (n >= 0 ? Math.floor(n) : Math.ceil(n));\n}\n\n/**\n * % operator that also works for negative numbers\n */\nfunction fixedModulo(n, m) {\n    return ((n % m) + m) % m;\n}\n\n/**\n * Used to grok the `now` parameter to createClock.\n * @param epoch {Date|number} the system time\n */\nfunction getEpoch(epoch) {\n    if (!epoch) { return 0; }\n    if (typeof epoch.getTime === \"function\") { return epoch.getTime(); }\n    if (typeof epoch === \"number\") { return epoch; }\n    throw new TypeError(\"now should be milliseconds since UNIX epoch\");\n}\n\nfunction inRange(from, to, timer) {\n    return timer && timer.callAt >= from && timer.callAt <= to;\n}\n\nfunction mirrorDateProperties(target, source) {\n    var prop;\n    for (prop in source) {\n        if (source.hasOwnProperty(prop)) {\n            target[prop] = source[prop];\n        }\n    }\n\n    // set special now implementation\n    if (source.now) {\n        target.now = function now() {\n            return target.clock.now;\n        };\n    } else {\n        delete target.now;\n    }\n\n    // set special toSource implementation\n    if (source.toSource) {\n        target.toSource = function toSource() {\n            return source.toSource();\n        };\n    } else {\n        delete target.toSource;\n    }\n\n    // set special toString implementation\n    target.toString = function toString() {\n        return source.toString();\n    };\n\n    target.prototype = source.prototype;\n    target.parse = source.parse;\n    target.UTC = source.UTC;\n    target.prototype.toUTCString = source.prototype.toUTCString;\n\n    return target;\n}\n\nfunction createDate() {\n    function ClockDate(year, month, date, hour, minute, second, ms) {\n        // Defensive and verbose to avoid potential harm in passing\n        // explicit undefined when user does not pass argument\n        switch (arguments.length) {\n            case 0:\n                return new NativeDate(ClockDate.clock.now);\n            case 1:\n                return new NativeDate(year);\n            case 2:\n                return new NativeDate(year, month);\n            case 3:\n                return new NativeDate(year, month, date);\n            case 4:\n                return new NativeDate(year, month, date, hour);\n            case 5:\n                return new NativeDate(year, month, date, hour, minute);\n            case 6:\n                return new NativeDate(year, month, date, hour, minute, second);\n            default:\n                return new NativeDate(year, month, date, hour, minute, second, ms);\n        }\n    }\n\n    return mirrorDateProperties(ClockDate, NativeDate);\n}\n\n\nfunction enqueueJob(clock, job) {\n    // enqueues a microtick-deferred task - ecma262/#sec-enqueuejob\n    if (!clock.jobs) {\n        clock.jobs = [];\n    }\n    clock.jobs.push(job);\n}\n\nfunction runJobs(clock) {\n    // runs all microtick-deferred tasks - ecma262/#sec-runjobs\n    if (!clock.jobs) {\n        return;\n    }\n    for (var i = 0; i < clock.jobs.length; i++) {\n        var job = clock.jobs[i];\n        job.func.apply(null, job.args);\n    }\n    clock.jobs = [];\n}\n\nfunction addTimer(clock, timer) {\n    if (timer.func === undefined) {\n        throw new Error(\"Callback must be provided to timer calls\");\n    }\n\n    timer.type = timer.immediate ? \"Immediate\" : \"Timeout\";\n\n    if (timer.hasOwnProperty(\"delay\")) {\n        timer.delay = timer.delay > maxTimeout ? 1 : timer.delay;\n        timer.delay = Math.max(0, timer.delay);\n    }\n\n    if (timer.hasOwnProperty(\"interval\")) {\n        timer.type = \"Interval\";\n        timer.interval = timer.interval > maxTimeout ? 1 : timer.interval;\n    }\n\n    if (timer.hasOwnProperty(\"animation\")) {\n        timer.type = \"AnimationFrame\";\n        timer.animation = true;\n    }\n\n    if (!clock.timers) {\n        clock.timers = {};\n    }\n\n    timer.id = uniqueTimerId++;\n    timer.createdAt = clock.now;\n    timer.callAt = clock.now + (parseInt(timer.delay) || (clock.duringTick ? 1 : 0));\n\n    clock.timers[timer.id] = timer;\n\n    if (addTimerReturnsObject) {\n        return {\n            id: timer.id,\n            ref: NOOP,\n            unref: NOOP\n        };\n    }\n\n    return timer.id;\n}\n\n\n/* eslint consistent-return: \"off\" */\nfunction compareTimers(a, b) {\n    // Sort first by absolute timing\n    if (a.callAt < b.callAt) {\n        return -1;\n    }\n    if (a.callAt > b.callAt) {\n        return 1;\n    }\n\n    // Sort next by immediate, immediate timers take precedence\n    if (a.immediate && !b.immediate) {\n        return -1;\n    }\n    if (!a.immediate && b.immediate) {\n        return 1;\n    }\n\n    // Sort next by creation time, earlier-created timers take precedence\n    if (a.createdAt < b.createdAt) {\n        return -1;\n    }\n    if (a.createdAt > b.createdAt) {\n        return 1;\n    }\n\n    // Sort next by id, lower-id timers take precedence\n    if (a.id < b.id) {\n        return -1;\n    }\n    if (a.id > b.id) {\n        return 1;\n    }\n\n    // As timer ids are unique, no fallback `0` is necessary\n}\n\nfunction firstTimerInRange(clock, from, to) {\n    var timers = clock.timers;\n    var timer = null;\n    var id, isInRange;\n\n    for (id in timers) {\n        if (timers.hasOwnProperty(id)) {\n            isInRange = inRange(from, to, timers[id]);\n\n            if (isInRange && (!timer || compareTimers(timer, timers[id]) === 1)) {\n                timer = timers[id];\n            }\n        }\n    }\n\n    return timer;\n}\n\nfunction firstTimer(clock) {\n    var timers = clock.timers;\n    var timer = null;\n    var id;\n\n    for (id in timers) {\n        if (timers.hasOwnProperty(id)) {\n            if (!timer || compareTimers(timer, timers[id]) === 1) {\n                timer = timers[id];\n            }\n        }\n    }\n\n    return timer;\n}\n\nfunction lastTimer(clock) {\n    var timers = clock.timers;\n    var timer = null;\n    var id;\n\n    for (id in timers) {\n        if (timers.hasOwnProperty(id)) {\n            if (!timer || compareTimers(timer, timers[id]) === -1) {\n                timer = timers[id];\n            }\n        }\n    }\n\n    return timer;\n}\n\nfunction callTimer(clock, timer) {\n    if (typeof timer.interval === \"number\") {\n        clock.timers[timer.id].callAt += timer.interval;\n    } else {\n        delete clock.timers[timer.id];\n    }\n\n    if (typeof timer.func === \"function\") {\n        timer.func.apply(null, timer.args);\n    } else {\n        /* eslint no-eval: \"off\" */\n        eval(timer.func);\n    }\n}\n\nfunction clearTimer(clock, timerId, ttype) {\n    if (!timerId) {\n        // null appears to be allowed in most browsers, and appears to be\n        // relied upon by some libraries, like Bootstrap carousel\n        return;\n    }\n\n    if (!clock.timers) {\n        clock.timers = [];\n    }\n\n    // in Node, timerId is an object with .ref()/.unref(), and\n    // its .id field is the actual timer id.\n    if (typeof timerId === \"object\") {\n        timerId = timerId.id;\n    }\n\n    if (clock.timers.hasOwnProperty(timerId)) {\n        // check that the ID matches a timer of the correct type\n        var timer = clock.timers[timerId];\n        if (timer.type === ttype) {\n            delete clock.timers[timerId];\n        } else {\n            var clear = ttype === \"AnimationFrame\" ? \"cancelAnimationFrame\" : \"clear\" + ttype;\n            var schedule = timer.type === \"AnimationFrame\" ? \"requestAnimationFrame\" : \"set\" + timer.type;\n            throw new Error(\"Cannot clear timer: timer created with \" + schedule\n                            + \"() but cleared with \" + clear + \"()\");\n        }\n    }\n}\n\nfunction uninstall(clock, target, config) {\n    var method,\n        i,\n        l;\n    var installedHrTime = \"_hrtime\";\n    var installedNextTick = \"_nextTick\";\n\n    for (i = 0, l = clock.methods.length; i < l; i++) {\n        method = clock.methods[i];\n        if (method === \"hrtime\" && target.process) {\n            target.process.hrtime = clock[installedHrTime];\n        } else if (method === \"nextTick\" && target.process) {\n            target.process.nextTick = clock[installedNextTick];\n        } else {\n            if (target[method] && target[method].hadOwnProperty) {\n                target[method] = clock[\"_\" + method];\n                if (method === \"clearInterval\" && config.shouldAdvanceTime === true) {\n                    target[method](clock.attachedInterval);\n                }\n            } else {\n                try {\n                    delete target[method];\n                } catch (ignore) { /* eslint empty-block: \"off\" */ }\n            }\n        }\n    }\n\n    // Prevent multiple executions which will completely remove these props\n    clock.methods = [];\n\n    // return pending timers, to enable checking what timers remained on uninstall\n    if (!clock.timers) {\n        return [];\n    }\n    return Object.keys(clock.timers).map(function mapper(key) {\n        return clock.timers[key];\n    });\n}\n\nfunction hijackMethod(target, method, clock) {\n    var prop;\n    clock[method].hadOwnProperty = Object.prototype.hasOwnProperty.call(target, method);\n    clock[\"_\" + method] = target[method];\n\n    if (method === \"Date\") {\n        var date = mirrorDateProperties(clock[method], target[method]);\n        target[method] = date;\n    } else {\n        target[method] = function () {\n            return clock[method].apply(clock, arguments);\n        };\n\n        for (prop in clock[method]) {\n            if (clock[method].hasOwnProperty(prop)) {\n                target[method][prop] = clock[method][prop];\n            }\n        }\n    }\n\n    target[method].clock = clock;\n}\n\nfunction doIntervalTick(clock, advanceTimeDelta) {\n    clock.tick(advanceTimeDelta);\n}\n\nvar timers = {\n    setTimeout: setTimeout,\n    clearTimeout: clearTimeout,\n    setImmediate: global.setImmediate,\n    clearImmediate: global.clearImmediate,\n    setInterval: setInterval,\n    clearInterval: clearInterval,\n    Date: Date\n};\n\nif (hrtimePresent) {\n    timers.hrtime = global.process.hrtime;\n}\n\nif (nextTickPresent) {\n    timers.nextTick = global.process.nextTick;\n}\n\nif (performancePresent) {\n    timers.performance = global.performance;\n}\n\nif (requestAnimationFramePresent) {\n    timers.requestAnimationFrame = global.requestAnimationFrame;\n}\n\nif (cancelAnimationFramePresent) {\n    timers.cancelAnimationFrame = global.cancelAnimationFrame;\n}\n\nvar keys = Object.keys || function (obj) {\n    var ks = [];\n    var key;\n\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            ks.push(key);\n        }\n    }\n\n    return ks;\n};\n\nexports.timers = timers;\n\n/**\n * @param start {Date|number} the system time\n * @param loopLimit {number}  maximum number of timers that will be run when calling runAll()\n */\nfunction createClock(start, loopLimit) {\n    start = start || 0;\n    loopLimit = loopLimit || 1000;\n\n    var clock = {\n        now: getEpoch(start),\n        hrNow: 0,\n        timeouts: {},\n        Date: createDate(),\n        loopLimit: loopLimit\n    };\n\n    clock.Date.clock = clock;\n\n    function getTimeToNextFrame() {\n        return 16 - ((clock.now - start) % 16);\n    }\n\n    clock.setTimeout = function setTimeout(func, timeout) {\n        return addTimer(clock, {\n            func: func,\n            args: Array.prototype.slice.call(arguments, 2),\n            delay: timeout\n        });\n    };\n\n    clock.clearTimeout = function clearTimeout(timerId) {\n        return clearTimer(clock, timerId, \"Timeout\");\n    };\n    clock.nextTick = function nextTick(func) {\n        return enqueueJob(clock, {\n            func: func,\n            args: Array.prototype.slice.call(arguments, 1)\n        });\n    };\n    clock.setInterval = function setInterval(func, timeout) {\n        return addTimer(clock, {\n            func: func,\n            args: Array.prototype.slice.call(arguments, 2),\n            delay: timeout,\n            interval: timeout\n        });\n    };\n\n    clock.clearInterval = function clearInterval(timerId) {\n        return clearTimer(clock, timerId, \"Interval\");\n    };\n\n    clock.setImmediate = function setImmediate(func) {\n        return addTimer(clock, {\n            func: func,\n            args: Array.prototype.slice.call(arguments, 1),\n            immediate: true\n        });\n    };\n\n    clock.clearImmediate = function clearImmediate(timerId) {\n        return clearTimer(clock, timerId, \"Immediate\");\n    };\n\n    clock.requestAnimationFrame = function requestAnimationFrame(func) {\n        var result = addTimer(clock, {\n            func: func,\n            delay: getTimeToNextFrame(),\n            args: [clock.now + getTimeToNextFrame()],\n            animation: true\n        });\n\n        return result.id || result;\n    };\n\n    clock.cancelAnimationFrame = function cancelAnimationFrame(timerId) {\n        return clearTimer(clock, timerId, \"AnimationFrame\");\n    };\n\n    function updateHrTime(newNow) {\n        clock.hrNow += (newNow - clock.now);\n    }\n\n    clock.tick = function tick(ms) {\n        ms = typeof ms === \"number\" ? ms : parseTime(ms);\n        var tickFrom = clock.now;\n        var tickTo = clock.now + ms;\n        var previous = clock.now;\n        var timer, firstException, oldNow;\n\n        clock.duringTick = true;\n\n        // perform process.nextTick()s\n        oldNow = clock.now;\n        runJobs(clock);\n        if (oldNow !== clock.now) {\n            // compensate for any setSystemTime() call during process.nextTick() callback\n            tickFrom += clock.now - oldNow;\n            tickTo += clock.now - oldNow;\n        }\n\n        // perform each timer in the requested range\n        timer = firstTimerInRange(clock, tickFrom, tickTo);\n        while (timer && tickFrom <= tickTo) {\n            if (clock.timers[timer.id]) {\n                updateHrTime(timer.callAt);\n                tickFrom = timer.callAt;\n                clock.now = timer.callAt;\n                oldNow = clock.now;\n                try {\n                    runJobs(clock);\n                    callTimer(clock, timer);\n                } catch (e) {\n                    firstException = firstException || e;\n                }\n\n                // compensate for any setSystemTime() call during timer callback\n                if (oldNow !== clock.now) {\n                    tickFrom += clock.now - oldNow;\n                    tickTo += clock.now - oldNow;\n                    previous += clock.now - oldNow;\n                }\n            }\n\n            timer = firstTimerInRange(clock, previous, tickTo);\n            previous = tickFrom;\n        }\n\n        // perform process.nextTick()s again\n        oldNow = clock.now;\n        runJobs(clock);\n        if (oldNow !== clock.now) {\n            // compensate for any setSystemTime() call during process.nextTick() callback\n            tickFrom += clock.now - oldNow;\n            tickTo += clock.now - oldNow;\n        }\n        clock.duringTick = false;\n\n        // corner case: during runJobs, new timers were scheduled which could be in the range [clock.now, tickTo]\n        timer = firstTimerInRange(clock, tickFrom, tickTo);\n        if (timer) {\n            try {\n                clock.tick(tickTo - clock.now); // do it all again - for the remainder of the requested range\n            } catch (e) {\n                firstException = firstException || e;\n            }\n        } else {\n            // no timers remaining in the requested range: move the clock all the way to the end\n            updateHrTime(tickTo);\n            clock.now = tickTo;\n        }\n        if (firstException) {\n            throw firstException;\n        }\n        return clock.now;\n    };\n\n    clock.next = function next() {\n        runJobs(clock);\n        var timer = firstTimer(clock);\n        if (!timer) {\n            return clock.now;\n        }\n\n        clock.duringTick = true;\n        try {\n            updateHrTime(timer.callAt);\n            clock.now = timer.callAt;\n            callTimer(clock, timer);\n            runJobs(clock);\n            return clock.now;\n        } finally {\n            clock.duringTick = false;\n        }\n    };\n\n    clock.runAll = function runAll() {\n        var numTimers, i;\n        runJobs(clock);\n        for (i = 0; i < clock.loopLimit; i++) {\n            if (!clock.timers) {\n                return clock.now;\n            }\n\n            numTimers = keys(clock.timers).length;\n            if (numTimers === 0) {\n                return clock.now;\n            }\n\n            clock.next();\n        }\n\n        throw new Error(\"Aborting after running \" + clock.loopLimit + \" timers, assuming an infinite loop!\");\n    };\n\n    clock.runToFrame = function runToFrame() {\n        return clock.tick(getTimeToNextFrame());\n    };\n\n    clock.runToLast = function runToLast() {\n        var timer = lastTimer(clock);\n        if (!timer) {\n            runJobs(clock);\n            return clock.now;\n        }\n\n        return clock.tick(timer.callAt);\n    };\n\n    clock.reset = function reset() {\n        clock.timers = {};\n    };\n\n    clock.setSystemTime = function setSystemTime(systemTime) {\n        // determine time difference\n        var newNow = getEpoch(systemTime);\n        var difference = newNow - clock.now;\n        var id, timer;\n\n        // update 'system clock'\n        clock.now = newNow;\n\n        // update timers and intervals to keep them stable\n        for (id in clock.timers) {\n            if (clock.timers.hasOwnProperty(id)) {\n                timer = clock.timers[id];\n                timer.createdAt += difference;\n                timer.callAt += difference;\n            }\n        }\n    };\n\n    if (performancePresent) {\n        clock.performance = Object.create(global.performance);\n        clock.performance.now = function lolexNow() {\n            return clock.hrNow;\n        };\n    }\n    if (hrtimePresent) {\n        clock.hrtime = function (prev) {\n            if (Array.isArray(prev)) {\n                var oldSecs = (prev[0] + prev[1] / 1e9);\n                var newSecs = (clock.hrNow / 1000);\n                var difference = (newSecs - oldSecs);\n                var secs = fixedFloor(difference);\n                var nanosecs = fixedModulo(difference * 1e9, 1e9);\n                return [\n                    secs,\n                    nanosecs\n                ];\n            }\n            return [\n                fixedFloor(clock.hrNow / 1000),\n                fixedModulo(clock.hrNow * 1e6, 1e9)\n            ];\n        };\n    }\n\n    return clock;\n}\nexports.createClock = createClock;\n\n/**\n * @param config {Object} optional config\n * @param config.target {Object} the target to install timers in (default `window`)\n * @param config.now {number|Date}  a number (in milliseconds) or a Date object (default epoch)\n * @param config.toFake {string[]} names of the methods that should be faked.\n * @param config.loopLimit {number} the maximum number of timers that will be run when calling runAll()\n * @param config.shouldAdvanceTime {Boolean} tells lolex to increment mocked time automatically (default false)\n * @param config.advanceTimeDelta {Number} increment mocked time every <<advanceTimeDelta>> ms (default: 20ms)\n */\nexports.install = function install(config) {\n    if ( arguments.length > 1 || config instanceof Date || Array.isArray(config) || typeof config === \"number\") {\n        throw new TypeError(\"lolex.install called with \" + String(config) +\n            \" lolex 2.0+ requires an object parameter - see https://github.com/sinonjs/lolex\");\n    }\n    config = typeof config !== \"undefined\" ? config : {};\n    config.shouldAdvanceTime = config.shouldAdvanceTime || false;\n    config.advanceTimeDelta = config.advanceTimeDelta || 20;\n\n    var i, l;\n    var target = config.target || global;\n    var clock = createClock(config.now, config.loopLimit);\n\n    clock.uninstall = function () {\n        return uninstall(clock, target, config);\n    };\n\n    clock.methods = config.toFake || [];\n\n    if (clock.methods.length === 0) {\n        // do not fake nextTick by default - GitHub#126\n        clock.methods = keys(timers).filter(function (key) {return key !== \"nextTick\";});\n    }\n\n    for (i = 0, l = clock.methods.length; i < l; i++) {\n        if (clock.methods[i] === \"hrtime\") {\n            if (target.process && typeof target.process.hrtime === \"function\") {\n                hijackMethod(target.process, clock.methods[i], clock);\n            }\n        } else if (clock.methods[i] === \"nextTick\") {\n            if (target.process && typeof target.process.nextTick === \"function\") {\n                hijackMethod(target.process, clock.methods[i], clock);\n            }\n        } else {\n            if (clock.methods[i] === \"setInterval\" && config.shouldAdvanceTime === true) {\n                var intervalTick = doIntervalTick.bind(null, clock, config.advanceTimeDelta);\n                var intervalId = target[clock.methods[i]](\n                    intervalTick,\n                    config.advanceTimeDelta);\n                clock.attachedInterval = intervalId;\n            }\n            hijackMethod(target, clock.methods[i], clock);\n        }\n    }\n\n    return clock;\n};\n\n},{}],46:[function(require,module,exports){\nvar isarray = require('isarray')\n\n/**\n * Expose `pathToRegexp`.\n */\nmodule.exports = pathToRegexp\nmodule.exports.parse = parse\nmodule.exports.compile = compile\nmodule.exports.tokensToFunction = tokensToFunction\nmodule.exports.tokensToRegExp = tokensToRegExp\n\n/**\n * The main path matching regexp utility.\n *\n * @type {RegExp}\n */\nvar PATH_REGEXP = new RegExp([\n  // Match escaped characters that would otherwise appear in future matches.\n  // This allows the user to escape special characters that won't transform.\n  '(\\\\\\\\.)',\n  // Match Express-style parameters and un-named parameters with a prefix\n  // and optional suffixes. Matches appear as:\n  //\n  // \"/:test(\\\\d+)?\" => [\"/\", \"test\", \"\\d+\", undefined, \"?\", undefined]\n  // \"/route(\\\\d+)\"  => [undefined, undefined, undefined, \"\\d+\", undefined, undefined]\n  // \"/*\"            => [\"/\", undefined, undefined, undefined, undefined, \"*\"]\n  '([\\\\/.])?(?:(?:\\\\:(\\\\w+)(?:\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))?|\\\\(((?:\\\\\\\\.|[^\\\\\\\\()])+)\\\\))([+*?])?|(\\\\*))'\n].join('|'), 'g')\n\n/**\n * Parse a string for the raw tokens.\n *\n * @param  {string}  str\n * @param  {Object=} options\n * @return {!Array}\n */\nfunction parse (str, options) {\n  var tokens = []\n  var key = 0\n  var index = 0\n  var path = ''\n  var defaultDelimiter = options && options.delimiter || '/'\n  var res\n\n  while ((res = PATH_REGEXP.exec(str)) != null) {\n    var m = res[0]\n    var escaped = res[1]\n    var offset = res.index\n    path += str.slice(index, offset)\n    index = offset + m.length\n\n    // Ignore already escaped sequences.\n    if (escaped) {\n      path += escaped[1]\n      continue\n    }\n\n    var next = str[index]\n    var prefix = res[2]\n    var name = res[3]\n    var capture = res[4]\n    var group = res[5]\n    var modifier = res[6]\n    var asterisk = res[7]\n\n    // Push the current path onto the tokens.\n    if (path) {\n      tokens.push(path)\n      path = ''\n    }\n\n    var partial = prefix != null && next != null && next !== prefix\n    var repeat = modifier === '+' || modifier === '*'\n    var optional = modifier === '?' || modifier === '*'\n    var delimiter = res[2] || defaultDelimiter\n    var pattern = capture || group\n\n    tokens.push({\n      name: name || key++,\n      prefix: prefix || '',\n      delimiter: delimiter,\n      optional: optional,\n      repeat: repeat,\n      partial: partial,\n      asterisk: !!asterisk,\n      pattern: pattern ? escapeGroup(pattern) : (asterisk ? '.*' : '[^' + escapeString(delimiter) + ']+?')\n    })\n  }\n\n  // Match any characters still remaining.\n  if (index < str.length) {\n    path += str.substr(index)\n  }\n\n  // If the path exists, push it onto the end.\n  if (path) {\n    tokens.push(path)\n  }\n\n  return tokens\n}\n\n/**\n * Compile a string to a template function for the path.\n *\n * @param  {string}             str\n * @param  {Object=}            options\n * @return {!function(Object=, Object=)}\n */\nfunction compile (str, options) {\n  return tokensToFunction(parse(str, options))\n}\n\n/**\n * Prettier encoding of URI path segments.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeURIComponentPretty (str) {\n  return encodeURI(str).replace(/[\\/?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Encode the asterisk parameter. Similar to `pretty`, but allows slashes.\n *\n * @param  {string}\n * @return {string}\n */\nfunction encodeAsterisk (str) {\n  return encodeURI(str).replace(/[?#]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16).toUpperCase()\n  })\n}\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nfunction tokensToFunction (tokens) {\n  // Compile all the tokens into regexps.\n  var matches = new Array(tokens.length)\n\n  // Compile all the patterns before compilation.\n  for (var i = 0; i < tokens.length; i++) {\n    if (typeof tokens[i] === 'object') {\n      matches[i] = new RegExp('^(?:' + tokens[i].pattern + ')$')\n    }\n  }\n\n  return function (obj, opts) {\n    var path = ''\n    var data = obj || {}\n    var options = opts || {}\n    var encode = options.pretty ? encodeURIComponentPretty : encodeURIComponent\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i]\n\n      if (typeof token === 'string') {\n        path += token\n\n        continue\n      }\n\n      var value = data[token.name]\n      var segment\n\n      if (value == null) {\n        if (token.optional) {\n          // Prepend partial segment prefixes.\n          if (token.partial) {\n            path += token.prefix\n          }\n\n          continue\n        } else {\n          throw new TypeError('Expected \"' + token.name + '\" to be defined')\n        }\n      }\n\n      if (isarray(value)) {\n        if (!token.repeat) {\n          throw new TypeError('Expected \"' + token.name + '\" to not repeat, but received `' + JSON.stringify(value) + '`')\n        }\n\n        if (value.length === 0) {\n          if (token.optional) {\n            continue\n          } else {\n            throw new TypeError('Expected \"' + token.name + '\" to not be empty')\n          }\n        }\n\n        for (var j = 0; j < value.length; j++) {\n          segment = encode(value[j])\n\n          if (!matches[i].test(segment)) {\n            throw new TypeError('Expected all \"' + token.name + '\" to match \"' + token.pattern + '\", but received `' + JSON.stringify(segment) + '`')\n          }\n\n          path += (j === 0 ? token.prefix : token.delimiter) + segment\n        }\n\n        continue\n      }\n\n      segment = token.asterisk ? encodeAsterisk(value) : encode(value)\n\n      if (!matches[i].test(segment)) {\n        throw new TypeError('Expected \"' + token.name + '\" to match \"' + token.pattern + '\", but received \"' + segment + '\"')\n      }\n\n      path += token.prefix + segment\n    }\n\n    return path\n  }\n}\n\n/**\n * Escape a regular expression string.\n *\n * @param  {string} str\n * @return {string}\n */\nfunction escapeString (str) {\n  return str.replace(/([.+*?=^!:${}()[\\]|\\/\\\\])/g, '\\\\$1')\n}\n\n/**\n * Escape the capturing group by escaping special characters and meaning.\n *\n * @param  {string} group\n * @return {string}\n */\nfunction escapeGroup (group) {\n  return group.replace(/([=!:$\\/()])/g, '\\\\$1')\n}\n\n/**\n * Attach the keys as a property of the regexp.\n *\n * @param  {!RegExp} re\n * @param  {Array}   keys\n * @return {!RegExp}\n */\nfunction attachKeys (re, keys) {\n  re.keys = keys\n  return re\n}\n\n/**\n * Get the flags for a regexp from the options.\n *\n * @param  {Object} options\n * @return {string}\n */\nfunction flags (options) {\n  return options.sensitive ? '' : 'i'\n}\n\n/**\n * Pull out keys from a regexp.\n *\n * @param  {!RegExp} path\n * @param  {!Array}  keys\n * @return {!RegExp}\n */\nfunction regexpToRegexp (path, keys) {\n  // Use a negative lookahead to match only capturing groups.\n  var groups = path.source.match(/\\((?!\\?)/g)\n\n  if (groups) {\n    for (var i = 0; i < groups.length; i++) {\n      keys.push({\n        name: i,\n        prefix: null,\n        delimiter: null,\n        optional: false,\n        repeat: false,\n        partial: false,\n        asterisk: false,\n        pattern: null\n      })\n    }\n  }\n\n  return attachKeys(path, keys)\n}\n\n/**\n * Transform an array into a regexp.\n *\n * @param  {!Array}  path\n * @param  {Array}   keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction arrayToRegexp (path, keys, options) {\n  var parts = []\n\n  for (var i = 0; i < path.length; i++) {\n    parts.push(pathToRegexp(path[i], keys, options).source)\n  }\n\n  var regexp = new RegExp('(?:' + parts.join('|') + ')', flags(options))\n\n  return attachKeys(regexp, keys)\n}\n\n/**\n * Create a path regexp from string input.\n *\n * @param  {string}  path\n * @param  {!Array}  keys\n * @param  {!Object} options\n * @return {!RegExp}\n */\nfunction stringToRegexp (path, keys, options) {\n  return tokensToRegExp(parse(path, options), keys, options)\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n *\n * @param  {!Array}          tokens\n * @param  {(Array|Object)=} keys\n * @param  {Object=}         options\n * @return {!RegExp}\n */\nfunction tokensToRegExp (tokens, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  var strict = options.strict\n  var end = options.end !== false\n  var route = ''\n\n  // Iterate over the tokens and create our regexp string.\n  for (var i = 0; i < tokens.length; i++) {\n    var token = tokens[i]\n\n    if (typeof token === 'string') {\n      route += escapeString(token)\n    } else {\n      var prefix = escapeString(token.prefix)\n      var capture = '(?:' + token.pattern + ')'\n\n      keys.push(token)\n\n      if (token.repeat) {\n        capture += '(?:' + prefix + capture + ')*'\n      }\n\n      if (token.optional) {\n        if (!token.partial) {\n          capture = '(?:' + prefix + '(' + capture + '))?'\n        } else {\n          capture = prefix + '(' + capture + ')?'\n        }\n      } else {\n        capture = prefix + '(' + capture + ')'\n      }\n\n      route += capture\n    }\n  }\n\n  var delimiter = escapeString(options.delimiter || '/')\n  var endsWithDelimiter = route.slice(-delimiter.length) === delimiter\n\n  // In non-strict mode we allow a slash at the end of match. If the path to\n  // match already ends with a slash, we remove it for consistency. The slash\n  // is valid at the end of a path match, not in the middle. This is important\n  // in non-ending mode, where \"/test/\" shouldn't match \"/test//route\".\n  if (!strict) {\n    route = (endsWithDelimiter ? route.slice(0, -delimiter.length) : route) + '(?:' + delimiter + '(?=$))?'\n  }\n\n  if (end) {\n    route += '$'\n  } else {\n    // In non-ending mode, we need the capturing groups to match as much as\n    // possible by using a positive lookahead to the end or next path segment.\n    route += strict && endsWithDelimiter ? '' : '(?=' + delimiter + '|$)'\n  }\n\n  return attachKeys(new RegExp('^' + route, flags(options)), keys)\n}\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n *\n * @param  {(string|RegExp|Array)} path\n * @param  {(Array|Object)=}       keys\n * @param  {Object=}               options\n * @return {!RegExp}\n */\nfunction pathToRegexp (path, keys, options) {\n  if (!isarray(keys)) {\n    options = /** @type {!Object} */ (keys || options)\n    keys = []\n  }\n\n  options = options || {}\n\n  if (path instanceof RegExp) {\n    return regexpToRegexp(path, /** @type {!Array} */ (keys))\n  }\n\n  if (isarray(path)) {\n    return arrayToRegexp(/** @type {!Array} */ (path), /** @type {!Array} */ (keys), options)\n  }\n\n  return stringToRegexp(/** @type {string} */ (path), /** @type {!Array} */ (keys), options)\n}\n\n},{\"isarray\":42}],47:[function(require,module,exports){\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.typeDetect = factory());\n}(this, (function () { 'use strict';\n\n/* !\n * type-detect\n * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\nvar promiseExists = typeof Promise === 'function';\n\n/* eslint-disable no-undef */\nvar globalObject = typeof self === 'object' ? self : global; // eslint-disable-line id-blacklist\n\nvar symbolExists = typeof Symbol !== 'undefined';\nvar mapExists = typeof Map !== 'undefined';\nvar setExists = typeof Set !== 'undefined';\nvar weakMapExists = typeof WeakMap !== 'undefined';\nvar weakSetExists = typeof WeakSet !== 'undefined';\nvar dataViewExists = typeof DataView !== 'undefined';\nvar symbolIteratorExists = symbolExists && typeof Symbol.iterator !== 'undefined';\nvar symbolToStringTagExists = symbolExists && typeof Symbol.toStringTag !== 'undefined';\nvar setEntriesExists = setExists && typeof Set.prototype.entries === 'function';\nvar mapEntriesExists = mapExists && typeof Map.prototype.entries === 'function';\nvar setIteratorPrototype = setEntriesExists && Object.getPrototypeOf(new Set().entries());\nvar mapIteratorPrototype = mapEntriesExists && Object.getPrototypeOf(new Map().entries());\nvar arrayIteratorExists = symbolIteratorExists && typeof Array.prototype[Symbol.iterator] === 'function';\nvar arrayIteratorPrototype = arrayIteratorExists && Object.getPrototypeOf([][Symbol.iterator]());\nvar stringIteratorExists = symbolIteratorExists && typeof String.prototype[Symbol.iterator] === 'function';\nvar stringIteratorPrototype = stringIteratorExists && Object.getPrototypeOf(''[Symbol.iterator]());\nvar toStringLeftSliceLength = 8;\nvar toStringRightSliceLength = -1;\n/**\n * ### typeOf (obj)\n *\n * Uses `Object.prototype.toString` to determine the type of an object,\n * normalising behaviour across engine versions & well optimised.\n *\n * @param {Mixed} object\n * @return {String} object type\n * @api public\n */\nfunction typeDetect(obj) {\n  /* ! Speed optimisation\n   * Pre:\n   *   string literal     x 3,039,035 ops/sec 1.62% (78 runs sampled)\n   *   boolean literal    x 1,424,138 ops/sec 4.54% (75 runs sampled)\n   *   number literal     x 1,653,153 ops/sec 1.91% (82 runs sampled)\n   *   undefined          x 9,978,660 ops/sec 1.92% (75 runs sampled)\n   *   function           x 2,556,769 ops/sec 1.73% (77 runs sampled)\n   * Post:\n   *   string literal     x 38,564,796 ops/sec 1.15% (79 runs sampled)\n   *   boolean literal    x 31,148,940 ops/sec 1.10% (79 runs sampled)\n   *   number literal     x 32,679,330 ops/sec 1.90% (78 runs sampled)\n   *   undefined          x 32,363,368 ops/sec 1.07% (82 runs sampled)\n   *   function           x 31,296,870 ops/sec 0.96% (83 runs sampled)\n   */\n  var typeofObj = typeof obj;\n  if (typeofObj !== 'object') {\n    return typeofObj;\n  }\n\n  /* ! Speed optimisation\n   * Pre:\n   *   null               x 28,645,765 ops/sec 1.17% (82 runs sampled)\n   * Post:\n   *   null               x 36,428,962 ops/sec 1.37% (84 runs sampled)\n   */\n  if (obj === null) {\n    return 'null';\n  }\n\n  /* ! Spec Conformance\n   * Test: `Object.prototype.toString.call(window)``\n   *  - Node === \"[object global]\"\n   *  - Chrome === \"[object global]\"\n   *  - Firefox === \"[object Window]\"\n   *  - PhantomJS === \"[object Window]\"\n   *  - Safari === \"[object Window]\"\n   *  - IE 11 === \"[object Window]\"\n   *  - IE Edge === \"[object Window]\"\n   * Test: `Object.prototype.toString.call(this)``\n   *  - Chrome Worker === \"[object global]\"\n   *  - Firefox Worker === \"[object DedicatedWorkerGlobalScope]\"\n   *  - Safari Worker === \"[object DedicatedWorkerGlobalScope]\"\n   *  - IE 11 Worker === \"[object WorkerGlobalScope]\"\n   *  - IE Edge Worker === \"[object WorkerGlobalScope]\"\n   */\n  if (obj === globalObject) {\n    return 'global';\n  }\n\n  /* ! Speed optimisation\n   * Pre:\n   *   array literal      x 2,888,352 ops/sec 0.67% (82 runs sampled)\n   * Post:\n   *   array literal      x 22,479,650 ops/sec 0.96% (81 runs sampled)\n   */\n  if (\n    Array.isArray(obj) &&\n    (symbolToStringTagExists === false || !(Symbol.toStringTag in obj))\n  ) {\n    return 'Array';\n  }\n\n  // Not caching existence of `window` and related properties due to potential\n  // for `window` to be unset before tests in quasi-browser environments.\n  if (typeof window === 'object' && window !== null) {\n    /* ! Spec Conformance\n     * (https://html.spec.whatwg.org/multipage/browsers.html#location)\n     * WhatWG HTML$7.7.3 - The `Location` interface\n     * Test: `Object.prototype.toString.call(window.location)``\n     *  - IE <=11 === \"[object Object]\"\n     *  - IE Edge <=13 === \"[object Object]\"\n     */\n    if (typeof window.location === 'object' && obj === window.location) {\n      return 'Location';\n    }\n\n    /* ! Spec Conformance\n     * (https://html.spec.whatwg.org/#document)\n     * WhatWG HTML$3.1.1 - The `Document` object\n     * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n     *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-26809268)\n     *       which suggests that browsers should use HTMLTableCellElement for\n     *       both TD and TH elements. WhatWG separates these.\n     *       WhatWG HTML states:\n     *         > For historical reasons, Window objects must also have a\n     *         > writable, configurable, non-enumerable property named\n     *         > HTMLDocument whose value is the Document interface object.\n     * Test: `Object.prototype.toString.call(document)``\n     *  - Chrome === \"[object HTMLDocument]\"\n     *  - Firefox === \"[object HTMLDocument]\"\n     *  - Safari === \"[object HTMLDocument]\"\n     *  - IE <=10 === \"[object Document]\"\n     *  - IE 11 === \"[object HTMLDocument]\"\n     *  - IE Edge <=13 === \"[object HTMLDocument]\"\n     */\n    if (typeof window.document === 'object' && obj === window.document) {\n      return 'Document';\n    }\n\n    if (typeof window.navigator === 'object') {\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/multipage/webappapis.html#mimetypearray)\n       * WhatWG HTML$8.6.1.5 - Plugins - Interface MimeTypeArray\n       * Test: `Object.prototype.toString.call(navigator.mimeTypes)``\n       *  - IE <=10 === \"[object MSMimeTypesCollection]\"\n       */\n      if (typeof window.navigator.mimeTypes === 'object' &&\n          obj === window.navigator.mimeTypes) {\n        return 'MimeTypeArray';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/multipage/webappapis.html#pluginarray)\n       * WhatWG HTML$8.6.1.5 - Plugins - Interface PluginArray\n       * Test: `Object.prototype.toString.call(navigator.plugins)``\n       *  - IE <=10 === \"[object MSPluginsCollection]\"\n       */\n      if (typeof window.navigator.plugins === 'object' &&\n          obj === window.navigator.plugins) {\n        return 'PluginArray';\n      }\n    }\n\n    if ((typeof window.HTMLElement === 'function' ||\n        typeof window.HTMLElement === 'object') &&\n        obj instanceof window.HTMLElement) {\n      /* ! Spec Conformance\n      * (https://html.spec.whatwg.org/multipage/webappapis.html#pluginarray)\n      * WhatWG HTML$4.4.4 - The `blockquote` element - Interface `HTMLQuoteElement`\n      * Test: `Object.prototype.toString.call(document.createElement('blockquote'))``\n      *  - IE <=10 === \"[object HTMLBlockElement]\"\n      */\n      if (obj.tagName === 'BLOCKQUOTE') {\n        return 'HTMLQuoteElement';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/#htmltabledatacellelement)\n       * WhatWG HTML$4.9.9 - The `td` element - Interface `HTMLTableDataCellElement`\n       * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n       *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-82915075)\n       *       which suggests that browsers should use HTMLTableCellElement for\n       *       both TD and TH elements. WhatWG separates these.\n       * Test: Object.prototype.toString.call(document.createElement('td'))\n       *  - Chrome === \"[object HTMLTableCellElement]\"\n       *  - Firefox === \"[object HTMLTableCellElement]\"\n       *  - Safari === \"[object HTMLTableCellElement]\"\n       */\n      if (obj.tagName === 'TD') {\n        return 'HTMLTableDataCellElement';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/#htmltableheadercellelement)\n       * WhatWG HTML$4.9.9 - The `td` element - Interface `HTMLTableHeaderCellElement`\n       * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n       *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-82915075)\n       *       which suggests that browsers should use HTMLTableCellElement for\n       *       both TD and TH elements. WhatWG separates these.\n       * Test: Object.prototype.toString.call(document.createElement('th'))\n       *  - Chrome === \"[object HTMLTableCellElement]\"\n       *  - Firefox === \"[object HTMLTableCellElement]\"\n       *  - Safari === \"[object HTMLTableCellElement]\"\n       */\n      if (obj.tagName === 'TH') {\n        return 'HTMLTableHeaderCellElement';\n      }\n    }\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   Float64Array       x 625,644 ops/sec 1.58% (80 runs sampled)\n  *   Float32Array       x 1,279,852 ops/sec 2.91% (77 runs sampled)\n  *   Uint32Array        x 1,178,185 ops/sec 1.95% (83 runs sampled)\n  *   Uint16Array        x 1,008,380 ops/sec 2.25% (80 runs sampled)\n  *   Uint8Array         x 1,128,040 ops/sec 2.11% (81 runs sampled)\n  *   Int32Array         x 1,170,119 ops/sec 2.88% (80 runs sampled)\n  *   Int16Array         x 1,176,348 ops/sec 5.79% (86 runs sampled)\n  *   Int8Array          x 1,058,707 ops/sec 4.94% (77 runs sampled)\n  *   Uint8ClampedArray  x 1,110,633 ops/sec 4.20% (80 runs sampled)\n  * Post:\n  *   Float64Array       x 7,105,671 ops/sec 13.47% (64 runs sampled)\n  *   Float32Array       x 5,887,912 ops/sec 1.46% (82 runs sampled)\n  *   Uint32Array        x 6,491,661 ops/sec 1.76% (79 runs sampled)\n  *   Uint16Array        x 6,559,795 ops/sec 1.67% (82 runs sampled)\n  *   Uint8Array         x 6,463,966 ops/sec 1.43% (85 runs sampled)\n  *   Int32Array         x 5,641,841 ops/sec 3.49% (81 runs sampled)\n  *   Int16Array         x 6,583,511 ops/sec 1.98% (80 runs sampled)\n  *   Int8Array          x 6,606,078 ops/sec 1.74% (81 runs sampled)\n  *   Uint8ClampedArray  x 6,602,224 ops/sec 1.77% (83 runs sampled)\n  */\n  var stringTag = (symbolToStringTagExists && obj[Symbol.toStringTag]);\n  if (typeof stringTag === 'string') {\n    return stringTag;\n  }\n\n  var objPrototype = Object.getPrototypeOf(obj);\n  /* ! Speed optimisation\n  * Pre:\n  *   regex literal      x 1,772,385 ops/sec 1.85% (77 runs sampled)\n  *   regex constructor  x 2,143,634 ops/sec 2.46% (78 runs sampled)\n  * Post:\n  *   regex literal      x 3,928,009 ops/sec 0.65% (78 runs sampled)\n  *   regex constructor  x 3,931,108 ops/sec 0.58% (84 runs sampled)\n  */\n  if (objPrototype === RegExp.prototype) {\n    return 'RegExp';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   date               x 2,130,074 ops/sec 4.42% (68 runs sampled)\n  * Post:\n  *   date               x 3,953,779 ops/sec 1.35% (77 runs sampled)\n  */\n  if (objPrototype === Date.prototype) {\n    return 'Date';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise.prototype-@@tostringtag)\n   * ES6$25.4.5.4 - Promise.prototype[@@toStringTag] should be \"Promise\":\n   * Test: `Object.prototype.toString.call(Promise.resolve())``\n   *  - Chrome <=47 === \"[object Object]\"\n   *  - Edge <=20 === \"[object Object]\"\n   *  - Firefox 29-Latest === \"[object Promise]\"\n   *  - Safari 7.1-Latest === \"[object Promise]\"\n   */\n  if (promiseExists && objPrototype === Promise.prototype) {\n    return 'Promise';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   set                x 2,222,186 ops/sec 1.31% (82 runs sampled)\n  * Post:\n  *   set                x 4,545,879 ops/sec 1.13% (83 runs sampled)\n  */\n  if (setExists && objPrototype === Set.prototype) {\n    return 'Set';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   map                x 2,396,842 ops/sec 1.59% (81 runs sampled)\n  * Post:\n  *   map                x 4,183,945 ops/sec 6.59% (82 runs sampled)\n  */\n  if (mapExists && objPrototype === Map.prototype) {\n    return 'Map';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   weakset            x 1,323,220 ops/sec 2.17% (76 runs sampled)\n  * Post:\n  *   weakset            x 4,237,510 ops/sec 2.01% (77 runs sampled)\n  */\n  if (weakSetExists && objPrototype === WeakSet.prototype) {\n    return 'WeakSet';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   weakmap            x 1,500,260 ops/sec 2.02% (78 runs sampled)\n  * Post:\n  *   weakmap            x 3,881,384 ops/sec 1.45% (82 runs sampled)\n  */\n  if (weakMapExists && objPrototype === WeakMap.prototype) {\n    return 'WeakMap';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-dataview.prototype-@@tostringtag)\n   * ES6$24.2.4.21 - DataView.prototype[@@toStringTag] should be \"DataView\":\n   * Test: `Object.prototype.toString.call(new DataView(new ArrayBuffer(1)))``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (dataViewExists && objPrototype === DataView.prototype) {\n    return 'DataView';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%mapiteratorprototype%-@@tostringtag)\n   * ES6$23.1.5.2.2 - %MapIteratorPrototype%[@@toStringTag] should be \"Map Iterator\":\n   * Test: `Object.prototype.toString.call(new Map().entries())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (mapExists && objPrototype === mapIteratorPrototype) {\n    return 'Map Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%setiteratorprototype%-@@tostringtag)\n   * ES6$23.2.5.2.2 - %SetIteratorPrototype%[@@toStringTag] should be \"Set Iterator\":\n   * Test: `Object.prototype.toString.call(new Set().entries())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (setExists && objPrototype === setIteratorPrototype) {\n    return 'Set Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%arrayiteratorprototype%-@@tostringtag)\n   * ES6$22.1.5.2.2 - %ArrayIteratorPrototype%[@@toStringTag] should be \"Array Iterator\":\n   * Test: `Object.prototype.toString.call([][Symbol.iterator]())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (arrayIteratorExists && objPrototype === arrayIteratorPrototype) {\n    return 'Array Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%stringiteratorprototype%-@@tostringtag)\n   * ES6$21.1.5.2.2 - %StringIteratorPrototype%[@@toStringTag] should be \"String Iterator\":\n   * Test: `Object.prototype.toString.call(''[Symbol.iterator]())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (stringIteratorExists && objPrototype === stringIteratorPrototype) {\n    return 'String Iterator';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   object from null   x 2,424,320 ops/sec 1.67% (76 runs sampled)\n  * Post:\n  *   object from null   x 5,838,000 ops/sec 0.99% (84 runs sampled)\n  */\n  if (objPrototype === null) {\n    return 'Object';\n  }\n\n  return Object\n    .prototype\n    .toString\n    .call(obj)\n    .slice(toStringLeftSliceLength, toStringRightSliceLength);\n}\n\nreturn typeDetect;\n\n})));\n\n},{}]},{},[12])(12)\n});","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","((typeof define === \"function\" && define.amd && function (m) { define(\"samsam\", m); }) ||\n (typeof module === \"object\" &&\n      function (m) { module.exports = m(); }) || // Node\n function (m) { this.samsam = m(); } // Browser globals\n)(function () {\n    var o = Object.prototype;\n    var div = typeof document !== \"undefined\" && document.createElement(\"div\");\n\n    function isNaN(value) {\n        // Unlike global isNaN, this avoids type coercion\n        // typeof check avoids IE host object issues, hat tip to\n        // lodash\n        var val = value; // JsLint thinks value !== value is \"weird\"\n        return typeof value === \"number\" && value !== val;\n    }\n\n    function getClass(value) {\n        // Returns the internal [[Class]] by calling Object.prototype.toString\n        // with the provided value as this. Return value is a string, naming the\n        // internal class, e.g. \"Array\"\n        return o.toString.call(value).split(/[ \\]]/)[1];\n    }\n\n    /**\n     * @name samsam.isArguments\n     * @param Object object\n     *\n     * Returns ``true`` if ``object`` is an ``arguments`` object,\n     * ``false`` otherwise.\n     */\n    function isArguments(object) {\n        if (getClass(object) === 'Arguments') { return true; }\n        if (typeof object !== \"object\" || typeof object.length !== \"number\" ||\n                getClass(object) === \"Array\") {\n            return false;\n        }\n        if (typeof object.callee == \"function\") { return true; }\n        try {\n            object[object.length] = 6;\n            delete object[object.length];\n        } catch (e) {\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * @name samsam.isElement\n     * @param Object object\n     *\n     * Returns ``true`` if ``object`` is a DOM element node. Unlike\n     * Underscore.js/lodash, this function will return ``false`` if ``object``\n     * is an *element-like* object, i.e. a regular object with a ``nodeType``\n     * property that holds the value ``1``.\n     */\n    function isElement(object) {\n        if (!object || object.nodeType !== 1 || !div) { return false; }\n        try {\n            object.appendChild(div);\n            object.removeChild(div);\n        } catch (e) {\n            return false;\n        }\n        return true;\n    }\n\n    /**\n     * @name samsam.keys\n     * @param Object object\n     *\n     * Return an array of own property names.\n     */\n    function keys(object) {\n        var ks = [], prop;\n        for (prop in object) {\n            if (o.hasOwnProperty.call(object, prop)) { ks.push(prop); }\n        }\n        return ks;\n    }\n\n    /**\n     * @name samsam.isDate\n     * @param Object value\n     *\n     * Returns true if the object is a ``Date``, or *date-like*. Duck typing\n     * of date objects work by checking that the object has a ``getTime``\n     * function whose return value equals the return value from the object's\n     * ``valueOf``.\n     */\n    function isDate(value) {\n        return typeof value.getTime == \"function\" &&\n            value.getTime() == value.valueOf();\n    }\n\n    /**\n     * @name samsam.isNegZero\n     * @param Object value\n     *\n     * Returns ``true`` if ``value`` is ``-0``.\n     */\n    function isNegZero(value) {\n        return value === 0 && 1 / value === -Infinity;\n    }\n\n    /**\n     * @name samsam.equal\n     * @param Object obj1\n     * @param Object obj2\n     *\n     * Returns ``true`` if two objects are strictly equal. Compared to\n     * ``===`` there are two exceptions:\n     *\n     *   - NaN is considered equal to NaN\n     *   - -0 and +0 are not considered equal\n     */\n    function identical(obj1, obj2) {\n        if (obj1 === obj2 || (isNaN(obj1) && isNaN(obj2))) {\n            return obj1 !== 0 || isNegZero(obj1) === isNegZero(obj2);\n        }\n    }\n\n    function isSet(val) {\n        if (typeof Set !== 'undefined' && val instanceof Set) {\n            return true;\n        }\n    }\n\n    function isSubset(s1, s2, compare) {\n        var values1 = Array.from(s1);\n        var values2 = Array.from(s2);\n\n        for (var i = 0; i < values1.length; i++) {\n            var includes = false;\n\n            for (var j = 0; j < values2.length; j++) {\n                if (compare(values2[j], values1[i])) {\n                    includes = true;\n                    break;\n                }\n            }\n\n            if (!includes) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    /**\n     * @name samsam.deepEqual\n     * @param Object obj1\n     * @param Object obj2\n     *\n     * Deep equal comparison. Two values are \"deep equal\" if:\n     *\n     *   - They are equal, according to samsam.identical\n     *   - They are both date objects representing the same time\n     *   - They are both arrays containing elements that are all deepEqual\n     *   - They are objects with the same set of properties, and each property\n     *     in ``obj1`` is deepEqual to the corresponding property in ``obj2``\n     *\n     * Supports cyclic objects.\n     */\n    function deepEqualCyclic(obj1, obj2) {\n\n        // used for cyclic comparison\n        // contain already visited objects\n        var objects1 = [],\n            objects2 = [],\n        // contain pathes (position in the object structure)\n        // of the already visited objects\n        // indexes same as in objects arrays\n            paths1 = [],\n            paths2 = [],\n        // contains combinations of already compared objects\n        // in the manner: { \"$1['ref']$2['ref']\": true }\n            compared = {};\n\n        /**\n         * used to check, if the value of a property is an object\n         * (cyclic logic is only needed for objects)\n         * only needed for cyclic logic\n         */\n        function isObject(value) {\n\n            if (typeof value === 'object' && value !== null &&\n                    !(value instanceof Boolean) &&\n                    !(value instanceof Date)    &&\n                    !(value instanceof Number)  &&\n                    !(value instanceof RegExp)  &&\n                    !(value instanceof String)) {\n\n                return true;\n            }\n\n            return false;\n        }\n\n        /**\n         * returns the index of the given object in the\n         * given objects array, -1 if not contained\n         * only needed for cyclic logic\n         */\n        function getIndex(objects, obj) {\n\n            var i;\n            for (i = 0; i < objects.length; i++) {\n                if (objects[i] === obj) {\n                    return i;\n                }\n            }\n\n            return -1;\n        }\n\n        // does the recursion for the deep equal check\n        return (function deepEqual(obj1, obj2, path1, path2) {\n            var type1 = typeof obj1;\n            var type2 = typeof obj2;\n\n            // == null also matches undefined\n            if (obj1 === obj2 ||\n                    isNaN(obj1) || isNaN(obj2) ||\n                    obj1 == null || obj2 == null ||\n                    type1 !== \"object\" || type2 !== \"object\") {\n\n                return identical(obj1, obj2);\n            }\n\n            // Elements are only equal if identical(expected, actual)\n            if (isElement(obj1) || isElement(obj2)) { return false; }\n\n            var isDate1 = isDate(obj1), isDate2 = isDate(obj2);\n            if (isDate1 || isDate2) {\n                if (!isDate1 || !isDate2 || obj1.getTime() !== obj2.getTime()) {\n                    return false;\n                }\n            }\n\n            if (obj1 instanceof RegExp && obj2 instanceof RegExp) {\n                if (obj1.toString() !== obj2.toString()) { return false; }\n            }\n\n            var class1 = getClass(obj1);\n            var class2 = getClass(obj2);\n            var keys1 = keys(obj1);\n            var keys2 = keys(obj2);\n\n            if (isArguments(obj1) || isArguments(obj2)) {\n                if (obj1.length !== obj2.length) { return false; }\n            } else {\n                if (type1 !== type2 || class1 !== class2 ||\n                        keys1.length !== keys2.length) {\n                    return false;\n                }\n            }\n\n            if (isSet(obj1) || isSet(obj2)) {\n                if (!isSet(obj1) || !isSet(obj2) || obj1.size !== obj2.size) {\n                    return false;\n                }\n\n                return isSubset(obj1, obj2, deepEqual);\n            }\n\n            var key, i, l,\n                // following vars are used for the cyclic logic\n                value1, value2,\n                isObject1, isObject2,\n                index1, index2,\n                newPath1, newPath2;\n\n            for (i = 0, l = keys1.length; i < l; i++) {\n                key = keys1[i];\n                if (!o.hasOwnProperty.call(obj2, key)) {\n                    return false;\n                }\n\n                // Start of the cyclic logic\n\n                value1 = obj1[key];\n                value2 = obj2[key];\n\n                isObject1 = isObject(value1);\n                isObject2 = isObject(value2);\n\n                // determine, if the objects were already visited\n                // (it's faster to check for isObject first, than to\n                // get -1 from getIndex for non objects)\n                index1 = isObject1 ? getIndex(objects1, value1) : -1;\n                index2 = isObject2 ? getIndex(objects2, value2) : -1;\n\n                // determine the new pathes of the objects\n                // - for non cyclic objects the current path will be extended\n                //   by current property name\n                // - for cyclic objects the stored path is taken\n                newPath1 = index1 !== -1\n                    ? paths1[index1]\n                    : path1 + '[' + JSON.stringify(key) + ']';\n                newPath2 = index2 !== -1\n                    ? paths2[index2]\n                    : path2 + '[' + JSON.stringify(key) + ']';\n\n                // stop recursion if current objects are already compared\n                if (compared[newPath1 + newPath2]) {\n                    return true;\n                }\n\n                // remember the current objects and their pathes\n                if (index1 === -1 && isObject1) {\n                    objects1.push(value1);\n                    paths1.push(newPath1);\n                }\n                if (index2 === -1 && isObject2) {\n                    objects2.push(value2);\n                    paths2.push(newPath2);\n                }\n\n                // remember that the current objects are already compared\n                if (isObject1 && isObject2) {\n                    compared[newPath1 + newPath2] = true;\n                }\n\n                // End of cyclic logic\n\n                // neither value1 nor value2 is a cycle\n                // continue with next level\n                if (!deepEqual(value1, value2, newPath1, newPath2)) {\n                    return false;\n                }\n            }\n\n            return true;\n\n        }(obj1, obj2, '$1', '$2'));\n    }\n\n    function arrayContains(array, subset, compare) {\n        if (subset.length === 0) { return true; }\n        var i, l, j, k;\n        for (i = 0, l = array.length; i < l; ++i) {\n            if (compare(array[i], subset[0])) {\n                for (j = 0, k = subset.length; j < k; ++j) {\n                    if ((i + j) >= l) { return false; }\n                    if (!compare(array[i + j], subset[j])) { return false; }\n                }\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * @name samsam.match\n     * @param Object object\n     * @param Object matcher\n     *\n     * Compare arbitrary value ``object`` with matcher.\n     */\n    function match(object, matcher) {\n        if (matcher && typeof matcher.test === \"function\") {\n            return matcher.test(object);\n        }\n\n        if (typeof matcher === \"function\") {\n            return matcher(object) === true;\n        }\n\n        if (typeof matcher === \"string\") {\n            matcher = matcher.toLowerCase();\n            var notNull = typeof object === \"string\" || !!object;\n            return notNull &&\n                (String(object)).toLowerCase().indexOf(matcher) >= 0;\n        }\n\n        if (typeof matcher === \"number\") {\n            return matcher === object;\n        }\n\n        if (typeof matcher === \"boolean\") {\n            return matcher === object;\n        }\n\n        if (typeof(matcher) === \"undefined\") {\n            return typeof(object) === \"undefined\";\n        }\n\n        if (matcher === null) {\n            return object === null;\n        }\n\n        if (isSet(object)) {\n            return isSubset(matcher, object, match);\n        }\n\n        if (getClass(object) === \"Array\" && getClass(matcher) === \"Array\") {\n            return arrayContains(object, matcher, match);\n        }\n\n        if (isDate(matcher)) {\n            return isDate(object) && object.getTime() === matcher.getTime();\n        }\n\n        if (matcher && typeof matcher === \"object\") {\n            if (matcher === object) {\n                return true;\n            }\n            var prop;\n            for (prop in matcher) {\n                var value = object[prop];\n                if (typeof value === \"undefined\" &&\n                        typeof object.getAttribute === \"function\") {\n                    value = object.getAttribute(prop);\n                }\n                if (matcher[prop] === null || typeof matcher[prop] === 'undefined') {\n                    if (value !== matcher[prop]) {\n                        return false;\n                    }\n                } else if (typeof  value === \"undefined\" || !match(value, matcher[prop])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        throw new Error(\"Matcher was not a string, a number, a \" +\n                        \"function, a boolean or an object\");\n    }\n\n    return {\n        isArguments: isArguments,\n        isElement: isElement,\n        isDate: isDate,\n        isNegZero: isNegZero,\n        identical: identical,\n        deepEqual: deepEqualCyclic,\n        match: match,\n        keys: keys\n    };\n});\n","(function (global, undefined) {\n    \"use strict\";\n\n    if (global.setImmediate) {\n        return;\n    }\n\n    var nextHandle = 1; // Spec says greater than zero\n    var tasksByHandle = {};\n    var currentlyRunningATask = false;\n    var doc = global.document;\n    var registerImmediate;\n\n    function setImmediate(callback) {\n      // Callback can either be a function or a string\n      if (typeof callback !== \"function\") {\n        callback = new Function(\"\" + callback);\n      }\n      // Copy function arguments\n      var args = new Array(arguments.length - 1);\n      for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i + 1];\n      }\n      // Store and register the task\n      var task = { callback: callback, args: args };\n      tasksByHandle[nextHandle] = task;\n      registerImmediate(nextHandle);\n      return nextHandle++;\n    }\n\n    function clearImmediate(handle) {\n        delete tasksByHandle[handle];\n    }\n\n    function run(task) {\n        var callback = task.callback;\n        var args = task.args;\n        switch (args.length) {\n        case 0:\n            callback();\n            break;\n        case 1:\n            callback(args[0]);\n            break;\n        case 2:\n            callback(args[0], args[1]);\n            break;\n        case 3:\n            callback(args[0], args[1], args[2]);\n            break;\n        default:\n            callback.apply(undefined, args);\n            break;\n        }\n    }\n\n    function runIfPresent(handle) {\n        // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n        // So if we're currently running a task, we'll need to delay this invocation.\n        if (currentlyRunningATask) {\n            // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n            // \"too much recursion\" error.\n            setTimeout(runIfPresent, 0, handle);\n        } else {\n            var task = tasksByHandle[handle];\n            if (task) {\n                currentlyRunningATask = true;\n                try {\n                    run(task);\n                } finally {\n                    clearImmediate(handle);\n                    currentlyRunningATask = false;\n                }\n            }\n        }\n    }\n\n    function installNextTickImplementation() {\n        registerImmediate = function(handle) {\n            process.nextTick(function () { runIfPresent(handle); });\n        };\n    }\n\n    function canUsePostMessage() {\n        // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n        // where `global.postMessage` means something completely different and can't be used for this purpose.\n        if (global.postMessage && !global.importScripts) {\n            var postMessageIsAsynchronous = true;\n            var oldOnMessage = global.onmessage;\n            global.onmessage = function() {\n                postMessageIsAsynchronous = false;\n            };\n            global.postMessage(\"\", \"*\");\n            global.onmessage = oldOnMessage;\n            return postMessageIsAsynchronous;\n        }\n    }\n\n    function installPostMessageImplementation() {\n        // Installs an event handler on `global` for the `message` event: see\n        // * https://developer.mozilla.org/en/DOM/window.postMessage\n        // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n\n        var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n        var onGlobalMessage = function(event) {\n            if (event.source === global &&\n                typeof event.data === \"string\" &&\n                event.data.indexOf(messagePrefix) === 0) {\n                runIfPresent(+event.data.slice(messagePrefix.length));\n            }\n        };\n\n        if (global.addEventListener) {\n            global.addEventListener(\"message\", onGlobalMessage, false);\n        } else {\n            global.attachEvent(\"onmessage\", onGlobalMessage);\n        }\n\n        registerImmediate = function(handle) {\n            global.postMessage(messagePrefix + handle, \"*\");\n        };\n    }\n\n    function installMessageChannelImplementation() {\n        var channel = new MessageChannel();\n        channel.port1.onmessage = function(event) {\n            var handle = event.data;\n            runIfPresent(handle);\n        };\n\n        registerImmediate = function(handle) {\n            channel.port2.postMessage(handle);\n        };\n    }\n\n    function installReadyStateChangeImplementation() {\n        var html = doc.documentElement;\n        registerImmediate = function(handle) {\n            // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n            // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n            var script = doc.createElement(\"script\");\n            script.onreadystatechange = function () {\n                runIfPresent(handle);\n                script.onreadystatechange = null;\n                html.removeChild(script);\n                script = null;\n            };\n            html.appendChild(script);\n        };\n    }\n\n    function installSetTimeoutImplementation() {\n        registerImmediate = function(handle) {\n            setTimeout(runIfPresent, 0, handle);\n        };\n    }\n\n    // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n    var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n    attachTo = attachTo && attachTo.setTimeout ? attachTo : global;\n\n    // Don't get fooled by e.g. browserify environments.\n    if ({}.toString.call(global.process) === \"[object process]\") {\n        // For Node.js before 0.9\n        installNextTickImplementation();\n\n    } else if (canUsePostMessage()) {\n        // For non-IE10 modern browsers\n        installPostMessageImplementation();\n\n    } else if (global.MessageChannel) {\n        // For web workers, where supported\n        installMessageChannelImplementation();\n\n    } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n        // For IE 68\n        installReadyStateChangeImplementation();\n\n    } else {\n        // For older browsers\n        installSetTimeoutImplementation();\n    }\n\n    attachTo.setImmediate = setImmediate;\n    attachTo.clearImmediate = clearImmediate;\n}(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self));\n","\"use strict\";\n\nexports.assert = require(\"./sinon/assert\");\nexports.collection = require(\"./sinon/collection\");\nexports.match = require(\"./sinon/match\");\nexports.spy = require(\"./sinon/spy\");\nexports.spyCall = require(\"./sinon/call\");\nexports.stub = require(\"./sinon/stub\");\nexports.mock = require(\"./sinon/mock\");\n\nvar sandbox = require(\"./sinon/sandbox\");\nexports.sandbox = sandbox;\nexports.expectation = require(\"./sinon/mock-expectation\");\nexports.createStubInstance = require(\"./sinon/stub\").createStubInstance;\n\nexports.defaultConfig = require(\"./sinon/util/core/default-config\");\n\nvar fakeTimers = require(\"./sinon/util/fake_timers\");\nexports.useFakeTimers = fakeTimers.useFakeTimers;\nexports.clock = fakeTimers.clock;\nexports.timers = fakeTimers.timers;\n\nvar nise = require(\"nise\");\nexports.xhr = nise.fakeXhr.xhr;\nexports.FakeXMLHttpRequest = nise.fakeXhr.FakeXMLHttpRequest;\nexports.useFakeXMLHttpRequest = nise.fakeXhr.useFakeXMLHttpRequest;\n\nexports.fakeServer = nise.fakeServer;\nexports.fakeServerWithClock = nise.fakeServerWithClock;\n\nexports.createSandbox = sandbox.create;\nexports.createFakeServer = nise.fakeServer.create.bind(nise.fakeServer);\nexports.createFakeServerWithClock = nise.fakeServerWithClock.create.bind(nise.fakeServerWithClock);\n\nvar behavior = require(\"./sinon/behavior\");\n\nexports.addBehavior = function (name, fn) {\n    behavior.addBehavior(exports.stub, name, fn);\n};\n\nvar format = require(\"./sinon/util/core/format\");\nexports.setFormatter = format.setFormatter;\n","\"use strict\";\n\nvar calledInOrder = require(\"./util/core/called-in-order\");\nvar orderByFirstCall = require(\"./util/core/order-by-first-call\");\nvar timesInWords = require(\"./util/core/times-in-words\");\nvar format = require(\"./util/core/format\");\nvar sinonMatch = require(\"./match\");\n\nvar slice = Array.prototype.slice;\n\nvar assert;\n\nfunction verifyIsStub() {\n    var args = Array.prototype.slice.call(arguments);\n\n    args.forEach(function (method) {\n        if (!method) {\n            assert.fail(\"fake is not a spy\");\n        }\n\n        if (method.proxy && method.proxy.isSinonProxy) {\n            verifyIsStub(method.proxy);\n        } else {\n            if (typeof method !== \"function\") {\n                assert.fail(method + \" is not a function\");\n            }\n\n            if (typeof method.getCall !== \"function\") {\n                assert.fail(method + \" is not stubbed\");\n            }\n        }\n    });\n}\n\nfunction verifyIsValidAssertion(assertionMethod, assertionArgs) {\n    switch (assertionMethod) {\n        case \"notCalled\":\n        case \"called\":\n        case \"calledOnce\":\n        case \"calledTwice\":\n        case \"calledThrice\":\n            if (assertionArgs.length !== 0) {\n                assert.fail(assertionMethod +\n                            \" takes 1 argument but was called with \" + (assertionArgs.length + 1) + \" arguments\");\n            }\n            break;\n        default:\n            break;\n    }\n}\n\nfunction failAssertion(object, msg) {\n    object = object || global;\n    var failMethod = object.fail || assert.fail;\n    failMethod.call(object, msg);\n}\n\nfunction mirrorPropAsAssertion(name, method, message) {\n    if (arguments.length === 2) {\n        message = method;\n        method = name;\n    }\n\n    assert[name] = function (fake) {\n        verifyIsStub(fake);\n\n        var args = slice.call(arguments, 1);\n        var failed = false;\n\n        verifyIsValidAssertion(name, args);\n\n        if (typeof method === \"function\") {\n            failed = !method(fake);\n        } else {\n            failed = typeof fake[method] === \"function\" ?\n                !fake[method].apply(fake, args) : !fake[method];\n        }\n\n        if (failed) {\n            failAssertion(this, (fake.printf || fake.proxy.printf).apply(fake, [message].concat(args)));\n        } else {\n            assert.pass(name);\n        }\n    };\n}\n\nfunction exposedName(prefix, prop) {\n    return !prefix || /^fail/.test(prop) ? prop :\n        prefix + prop.slice(0, 1).toUpperCase() + prop.slice(1);\n}\n\nassert = {\n    failException: \"AssertError\",\n\n    fail: function fail(message) {\n        var error = new Error(message);\n        error.name = this.failException || assert.failException;\n\n        throw error;\n    },\n\n    pass: function pass() {},\n\n    callOrder: function assertCallOrder() {\n        verifyIsStub.apply(null, arguments);\n        var expected = \"\";\n        var actual = \"\";\n\n        if (!calledInOrder(arguments)) {\n            try {\n                expected = [].join.call(arguments, \", \");\n                var calls = slice.call(arguments);\n                var i = calls.length;\n                while (i) {\n                    if (!calls[--i].called) {\n                        calls.splice(i, 1);\n                    }\n                }\n                actual = orderByFirstCall(calls).join(\", \");\n            } catch (e) {\n                // If this fails, we'll just fall back to the blank string\n            }\n\n            failAssertion(this, \"expected \" + expected + \" to be \" +\n                        \"called in order but were called as \" + actual);\n        } else {\n            assert.pass(\"callOrder\");\n        }\n    },\n\n    callCount: function assertCallCount(method, count) {\n        verifyIsStub(method);\n\n        if (method.callCount !== count) {\n            var msg = \"expected %n to be called \" + timesInWords(count) +\n                \" but was called %c%C\";\n            failAssertion(this, method.printf(msg));\n        } else {\n            assert.pass(\"callCount\");\n        }\n    },\n\n    expose: function expose(target, options) {\n        if (!target) {\n            throw new TypeError(\"target is null or undefined\");\n        }\n\n        var o = options || {};\n        var prefix = typeof o.prefix === \"undefined\" && \"assert\" || o.prefix;\n        var includeFail = typeof o.includeFail === \"undefined\" || !!o.includeFail;\n        var instance = this;\n\n        Object.keys(instance).forEach(function (method) {\n            if (method !== \"expose\" && (includeFail || !/^(fail)/.test(method))) {\n                target[exposedName(prefix, method)] = instance[method];\n            }\n        });\n\n        return target;\n    },\n\n    match: function match(actual, expectation) {\n        var matcher = sinonMatch(expectation);\n        if (matcher.test(actual)) {\n            assert.pass(\"match\");\n        } else {\n            var formatted = [\n                \"expected value to match\",\n                \"    expected = \" + format(expectation),\n                \"    actual = \" + format(actual)\n            ];\n\n            failAssertion(this, formatted.join(\"\\n\"));\n        }\n    }\n};\n\nmirrorPropAsAssertion(\"called\", \"expected %n to have been called at least once but was never called\");\nmirrorPropAsAssertion(\"notCalled\", function (spy) {\n    return !spy.called;\n}, \"expected %n to not have been called but was called %c%C\");\nmirrorPropAsAssertion(\"calledOnce\", \"expected %n to be called once but was called %c%C\");\nmirrorPropAsAssertion(\"calledTwice\", \"expected %n to be called twice but was called %c%C\");\nmirrorPropAsAssertion(\"calledThrice\", \"expected %n to be called thrice but was called %c%C\");\nmirrorPropAsAssertion(\"calledOn\", \"expected %n to be called with %1 as this but was called with %t\");\nmirrorPropAsAssertion(\n    \"alwaysCalledOn\",\n    \"expected %n to always be called with %1 as this but was called with %t\"\n);\nmirrorPropAsAssertion(\"calledWithNew\", \"expected %n to be called with new\");\nmirrorPropAsAssertion(\"alwaysCalledWithNew\", \"expected %n to always be called with new\");\nmirrorPropAsAssertion(\"calledWith\", \"expected %n to be called with arguments %D\");\nmirrorPropAsAssertion(\"calledWithMatch\", \"expected %n to be called with match %D\");\nmirrorPropAsAssertion(\"alwaysCalledWith\", \"expected %n to always be called with arguments %D\");\nmirrorPropAsAssertion(\"alwaysCalledWithMatch\", \"expected %n to always be called with match %D\");\nmirrorPropAsAssertion(\"calledWithExactly\", \"expected %n to be called with exact arguments %D\");\nmirrorPropAsAssertion(\"alwaysCalledWithExactly\", \"expected %n to always be called with exact arguments %D\");\nmirrorPropAsAssertion(\"neverCalledWith\", \"expected %n to never be called with arguments %*%C\");\nmirrorPropAsAssertion(\"neverCalledWithMatch\", \"expected %n to never be called with match %*%C\");\nmirrorPropAsAssertion(\"threw\", \"%n did not throw exception%C\");\nmirrorPropAsAssertion(\"alwaysThrew\", \"%n did not always throw exception%C\");\n\nmodule.exports = assert;\n","\"use strict\";\n\nvar extend = require(\"./util/core/extend\");\nvar functionName = require(\"./util/core/function-name\");\nvar valueToString = require(\"./util/core/value-to-string\");\n\nvar slice = Array.prototype.slice;\nvar join = Array.prototype.join;\nvar useLeftMostCallback = -1;\nvar useRightMostCallback = -2;\n\nvar nextTick = (function () {\n    if (typeof process === \"object\" && typeof process.nextTick === \"function\") {\n        return process.nextTick;\n    }\n\n    if (typeof setImmediate === \"function\") {\n        return setImmediate;\n    }\n\n    return function (callback) {\n        setTimeout(callback, 0);\n    };\n})();\n\nfunction getCallback(behavior, args) {\n    var callArgAt = behavior.callArgAt;\n\n    if (callArgAt >= 0) {\n        return args[callArgAt];\n    }\n\n    var argumentList;\n\n    if (callArgAt === useLeftMostCallback) {\n        argumentList = args;\n    }\n\n    if (callArgAt === useRightMostCallback) {\n        argumentList = slice.call(args).reverse();\n    }\n\n    var callArgProp = behavior.callArgProp;\n\n    for (var i = 0, l = argumentList.length; i < l; ++i) {\n        if (!callArgProp && typeof argumentList[i] === \"function\") {\n            return argumentList[i];\n        }\n\n        if (callArgProp && argumentList[i] &&\n            typeof argumentList[i][callArgProp] === \"function\") {\n            return argumentList[i][callArgProp];\n        }\n    }\n\n    return null;\n}\n\nfunction getCallbackError(behavior, func, args) {\n    if (behavior.callArgAt < 0) {\n        var msg;\n\n        if (behavior.callArgProp) {\n            msg = functionName(behavior.stub) +\n                \" expected to yield to '\" + valueToString(behavior.callArgProp) +\n                \"', but no object with such a property was passed.\";\n        } else {\n            msg = functionName(behavior.stub) +\n                \" expected to yield, but no callback was passed.\";\n        }\n\n        if (args.length > 0) {\n            msg += \" Received [\" + join.call(args, \", \") + \"]\";\n        }\n\n        return msg;\n    }\n\n    return \"argument at index \" + behavior.callArgAt + \" is not a function: \" + func;\n}\n\nfunction callCallback(behavior, args) {\n    if (typeof behavior.callArgAt === \"number\") {\n        var func = getCallback(behavior, args);\n\n        if (typeof func !== \"function\") {\n            throw new TypeError(getCallbackError(behavior, func, args));\n        }\n\n        if (behavior.callbackAsync) {\n            nextTick(function () {\n                func.apply(behavior.callbackContext, behavior.callbackArguments);\n            });\n        } else {\n            return func.apply(behavior.callbackContext, behavior.callbackArguments);\n        }\n    }\n\n    return undefined;\n}\n\nvar proto = {\n    create: function create(stub) {\n        var behavior = extend({}, proto);\n        delete behavior.create;\n        delete behavior.addBehavior;\n        delete behavior.createBehavior;\n        behavior.stub = stub;\n\n        if (stub.defaultBehavior && stub.defaultBehavior.promiseLibrary) {\n            behavior.promiseLibrary = stub.defaultBehavior.promiseLibrary;\n        }\n\n        return behavior;\n    },\n\n    isPresent: function isPresent() {\n        return (typeof this.callArgAt === \"number\" ||\n                this.exception ||\n                this.exceptionCreator ||\n                typeof this.returnArgAt === \"number\" ||\n                this.returnThis ||\n                this.resolveThis ||\n                typeof this.throwArgAt === \"number\" ||\n                this.fakeFn ||\n                this.returnValueDefined);\n    },\n\n    invoke: function invoke(context, args) {\n        var returnValue = callCallback(this, args);\n\n        if (this.exception) {\n            throw this.exception;\n        } else if (this.exceptionCreator) {\n            this.exception = this.exceptionCreator();\n            this.exceptionCreator = undefined;\n            throw this.exception;\n        } else if (typeof this.returnArgAt === \"number\") {\n            return args[this.returnArgAt];\n        } else if (this.returnThis) {\n            return context;\n        } else if (typeof this.throwArgAt === \"number\") {\n            if (args.length < this.throwArgAt) {\n                throw new TypeError(\n                    \"throwArgs failed: \" + this.throwArgAt\n                    + \" arguments required but only \" + args.length\n                    + \" present\"\n                );\n            }\n            throw args[this.throwArgAt];\n        } else if (this.fakeFn) {\n            return this.fakeFn.apply(context, args);\n        } else if (this.resolveThis) {\n            return (this.promiseLibrary || Promise).resolve(context);\n        } else if (this.resolve) {\n            return (this.promiseLibrary || Promise).resolve(this.returnValue);\n        } else if (this.reject) {\n            return (this.promiseLibrary || Promise).reject(this.returnValue);\n        } else if (this.callsThrough) {\n            return this.stub.wrappedMethod.apply(context, args);\n        } else if (typeof this.returnValue !== \"undefined\") {\n            return this.returnValue;\n        } else if (typeof this.callArgAt === \"number\") {\n            return returnValue;\n        }\n\n        return this.returnValue;\n    },\n\n    onCall: function onCall(index) {\n        return this.stub.onCall(index);\n    },\n\n    onFirstCall: function onFirstCall() {\n        return this.stub.onFirstCall();\n    },\n\n    onSecondCall: function onSecondCall() {\n        return this.stub.onSecondCall();\n    },\n\n    onThirdCall: function onThirdCall() {\n        return this.stub.onThirdCall();\n    },\n\n    withArgs: function withArgs(/* arguments */) {\n        throw new Error(\n            \"Defining a stub by invoking \\\"stub.onCall(...).withArgs(...)\\\" \" +\n            \"is not supported. Use \\\"stub.withArgs(...).onCall(...)\\\" \" +\n            \"to define sequential behavior for calls with certain arguments.\"\n        );\n    }\n};\n\nfunction createAsyncVersion(syncFnName) {\n    return function () {\n        var result = this[syncFnName].apply(this, arguments);\n        this.callbackAsync = true;\n        return result;\n    };\n}\n\n// create asynchronous versions of callsArg* and yields* methods\nObject.keys(proto).forEach(function (method) {\n    // need to avoid creating anotherasync versions of the newly added async methods\n    if (method.match(/^(callsArg|yields)/) && !method.match(/Async/)) {\n        proto[method + \"Async\"] = createAsyncVersion(method);\n    }\n});\n\nfunction createBehavior(behaviorMethod) {\n    return function () {\n        this.defaultBehavior = this.defaultBehavior || proto.create(this);\n        this.defaultBehavior[behaviorMethod].apply(this.defaultBehavior, arguments);\n        return this;\n    };\n}\n\nfunction addBehavior(stub, name, fn) {\n    proto[name] = function () {\n        fn.apply(this, [this].concat([].slice.call(arguments)));\n        return this.stub || this;\n    };\n\n    stub[name] = createBehavior(name);\n}\n\nproto.addBehavior = addBehavior;\nproto.createBehavior = createBehavior;\nmodule.exports = proto;\n","\"use strict\";\n\nvar sinonMatch = require(\"./match\");\nvar deepEqual = require(\"./util/core/deep-equal\").use(sinonMatch);\nvar functionName = require(\"./util/core/function-name\");\nvar sinonFormat = require(\"./util/core/format\");\nvar valueToString = require(\"./util/core/value-to-string\");\nvar slice = Array.prototype.slice;\nvar filter = Array.prototype.filter;\n\nfunction throwYieldError(proxy, text, args) {\n    var msg = functionName(proxy) + text;\n    if (args.length) {\n        msg += \" Received [\" + slice.call(args).join(\", \") + \"]\";\n    }\n    throw new Error(msg);\n}\n\nvar callProto = {\n    calledOn: function calledOn(thisValue) {\n        if (sinonMatch && sinonMatch.isMatcher(thisValue)) {\n            return thisValue.test(this.thisValue);\n        }\n        return this.thisValue === thisValue;\n    },\n\n    calledWith: function calledWith() {\n        var self = this;\n        var calledWithArgs = slice.call(arguments);\n\n        if (calledWithArgs.length > self.args.length) {\n            return false;\n        }\n\n        return calledWithArgs.reduce(function (prev, arg, i) {\n            return prev && deepEqual(arg, self.args[i]);\n        }, true);\n    },\n\n    calledWithMatch: function calledWithMatch() {\n        var self = this;\n        var calledWithMatchArgs = slice.call(arguments);\n\n        if (calledWithMatchArgs.length > self.args.length) {\n            return false;\n        }\n\n        return calledWithMatchArgs.reduce(function (prev, expectation, i) {\n            var actual = self.args[i];\n\n            return prev && (sinonMatch && sinonMatch(expectation).test(actual));\n        }, true);\n    },\n\n    calledWithExactly: function calledWithExactly() {\n        return arguments.length === this.args.length &&\n            this.calledWith.apply(this, arguments);\n    },\n\n    notCalledWith: function notCalledWith() {\n        return !this.calledWith.apply(this, arguments);\n    },\n\n    notCalledWithMatch: function notCalledWithMatch() {\n        return !this.calledWithMatch.apply(this, arguments);\n    },\n\n    returned: function returned(value) {\n        return deepEqual(value, this.returnValue);\n    },\n\n    threw: function threw(error) {\n        if (typeof error === \"undefined\" || !this.exception) {\n            return !!this.exception;\n        }\n\n        return this.exception === error || this.exception.name === error;\n    },\n\n    calledWithNew: function calledWithNew() {\n        return this.proxy.prototype && this.thisValue instanceof this.proxy;\n    },\n\n    calledBefore: function (other) {\n        return this.callId < other.callId;\n    },\n\n    calledAfter: function (other) {\n        return this.callId > other.callId;\n    },\n\n    calledImmediatelyBefore: function (other) {\n        return this.callId === other.callId - 1;\n    },\n\n    calledImmediatelyAfter: function (other) {\n        return this.callId === other.callId + 1;\n    },\n\n    callArg: function (pos) {\n        this.ensureArgIsAFunction(pos);\n        return this.args[pos]();\n    },\n\n    callArgOn: function (pos, thisValue) {\n        this.ensureArgIsAFunction(pos);\n        return this.args[pos].apply(thisValue);\n    },\n\n    callArgWith: function (pos) {\n        return this.callArgOnWith.apply(this, [pos, null].concat(slice.call(arguments, 1)));\n    },\n\n    callArgOnWith: function (pos, thisValue) {\n        this.ensureArgIsAFunction(pos);\n        var args = slice.call(arguments, 2);\n        return this.args[pos].apply(thisValue, args);\n    },\n\n    throwArg: function (pos) {\n        if (pos > this.args.length) {\n            throw new TypeError(\n                \"Not enough arguments: \" + pos\n                + \" required but only \" + this.args.length\n                + \" present\"\n            );\n        }\n\n        throw this.args[pos];\n    },\n\n    yield: function () {\n        return this.yieldOn.apply(this, [null].concat(slice.call(arguments, 0)));\n    },\n\n    yieldOn: function (thisValue) {\n        var args = slice.call(this.args);\n        var yieldFn = filter.call(args, function (arg) {\n            return typeof arg === \"function\";\n        })[0];\n\n        if (!yieldFn) {\n            throwYieldError(this.proxy, \" cannot yield since no callback was passed.\", args);\n        }\n\n        return yieldFn.apply(thisValue, slice.call(arguments, 1));\n    },\n\n    yieldTo: function (prop) {\n        return this.yieldToOn.apply(this, [prop, null].concat(slice.call(arguments, 1)));\n    },\n\n    yieldToOn: function (prop, thisValue) {\n        var args = slice.call(this.args);\n        var yieldArg = filter.call(args, function (arg) {\n            return arg && typeof arg[prop] === \"function\";\n        })[0];\n        var yieldFn = yieldArg && yieldArg[prop];\n\n        if (!yieldFn) {\n            throwYieldError(this.proxy, \" cannot yield to '\" + valueToString(prop) +\n                \"' since no callback was passed.\", args);\n        }\n\n        return yieldFn.apply(thisValue, slice.call(arguments, 2));\n    },\n\n    toString: function () {\n        var callStr = this.proxy ? this.proxy.toString() + \"(\" : \"\";\n        var formattedArgs;\n\n        if (!this.args) {\n            return \":(\";\n        }\n\n        formattedArgs = slice.call(this.args).map(function (arg) {\n            return sinonFormat(arg);\n        });\n\n        callStr = callStr + formattedArgs.join(\", \") + \")\";\n\n        if (typeof this.returnValue !== \"undefined\") {\n            callStr += \" => \" + sinonFormat(this.returnValue);\n        }\n\n        if (this.exception) {\n            callStr += \" !\" + this.exception.name;\n\n            if (this.exception.message) {\n                callStr += \"(\" + this.exception.message + \")\";\n            }\n        }\n        if (this.stack) {\n            // Omit the error message and the two top stack frames in sinon itself:\n            callStr += ( this.stack.split(\"\\n\")[3] || \"unknown\" ).replace(/^\\s*(?:at\\s+|@)?/, \" at \");\n        }\n\n        return callStr;\n    },\n\n    ensureArgIsAFunction: function (pos) {\n        if (typeof this.args[pos] !== \"function\") {\n            throw new TypeError(\n                \"Expected argument at position \" + pos\n                + \" to be a Function, but was \"\n                + typeof this.args[pos]\n            );\n        }\n    }\n};\nObject.defineProperty(callProto, \"stack\", {\n    enumerable: true,\n    configurable: true,\n    get: function () {\n        return this.errorWithCallStack && this.errorWithCallStack.stack || \"\";\n    }\n});\n\ncallProto.invokeCallback = callProto.yield;\n\nfunction createSpyCall(spy, thisValue, args, returnValue, exception, id, errorWithCallStack) {\n    if (typeof id !== \"number\") {\n        throw new TypeError(\"Call id is not a number\");\n    }\n\n    var proxyCall = Object.create(callProto);\n    var lastArg = args.length > 0 && args[args.length - 1] || undefined;\n    var callback = lastArg && typeof lastArg === \"function\" ? lastArg : undefined;\n\n    proxyCall.proxy = spy;\n    proxyCall.thisValue = thisValue;\n    proxyCall.args = args;\n    proxyCall.lastArg = lastArg;\n    proxyCall.callback = callback;\n    proxyCall.returnValue = returnValue;\n    proxyCall.exception = exception;\n    proxyCall.callId = id;\n    proxyCall.errorWithCallStack = errorWithCallStack;\n\n    return proxyCall;\n}\ncreateSpyCall.toString = callProto.toString; // used by mocks\n\nmodule.exports = createSpyCall;\n","\"use strict\";\n\nvar walk = require(\"./util/core/walk\");\nvar getPropertyDescriptor = require(\"./util/core/get-property-descriptor\");\n\nfunction collectMethod(methods, object, prop, propOwner) {\n    if (\n        typeof getPropertyDescriptor(propOwner, prop).value === \"function\" &&\n        object.hasOwnProperty(prop)\n    ) {\n        methods.push(object[prop]);\n    }\n}\n\n// This function returns an array of all the own methods on the passed object\nfunction collectOwnMethods(object) {\n    var methods = [];\n\n    walk(object, collectMethod.bind(null, methods, object));\n\n    return methods;\n}\n\nmodule.exports = collectOwnMethods;\n","\"use strict\";\n\nvar sinonSpy = require(\"./spy\");\nvar sinonStub = require(\"./stub\");\nvar sinonMock = require(\"./mock\");\nvar collectOwnMethods = require(\"./collect-own-methods\");\nvar valueToString = require(\"./util/core/value-to-string\");\n\nvar push = Array.prototype.push;\nvar filter = Array.prototype.filter;\n\nfunction getFakes(fakeCollection) {\n    if (!fakeCollection.fakes) {\n        fakeCollection.fakes = [];\n    }\n\n    return fakeCollection.fakes;\n}\n\nfunction each(fakeCollection, method) {\n    var fakes = getFakes(fakeCollection);\n    var matchingFakes = filter.call(fakes, function (fake) {\n        return typeof fake[method] === \"function\";\n    });\n\n    matchingFakes.forEach(function (fake) {\n        fake[method]();\n    });\n}\n\nvar collection = {\n    verify: function verify() {\n        each(this, \"verify\");\n    },\n\n    restore: function restore() {\n        each(this, \"restore\");\n        this.fakes = [];\n    },\n\n    reset: function reset() {\n        each(this, \"reset\");\n    },\n\n    resetBehavior: function resetBehavior() {\n        each(this, \"resetBehavior\");\n    },\n\n    resetHistory: function resetHistory() {\n        function privateResetHistory(f) {\n            var method = f.resetHistory || f.reset;\n            if (method) {\n                method.call(f);\n            }\n        }\n\n        getFakes(this).forEach(function (fake) {\n            if (typeof fake === \"function\") {\n                privateResetHistory(fake);\n                return;\n            }\n\n            var methods = [];\n            if (fake.get) {\n                methods.push(fake.get);\n            }\n\n            if (fake.set) {\n                methods.push(fake.set);\n            }\n\n            methods.forEach(privateResetHistory);\n        });\n    },\n\n    verifyAndRestore: function verifyAndRestore() {\n        var exception;\n\n        try {\n            this.verify();\n        } catch (e) {\n            exception = e;\n        }\n\n        this.restore();\n\n        if (exception) {\n            throw exception;\n        }\n    },\n\n    add: function add(fake) {\n        push.call(getFakes(this), fake);\n        return fake;\n    },\n\n    addUsingPromise: function (fake) {\n        fake.usingPromise(this.promiseLibrary);\n        return fake;\n    },\n\n    spy: function spy() {\n        return this.add(sinonSpy.apply(sinonSpy, arguments));\n    },\n\n    createStubInstance: function createStubInstance(constructor) {\n        if (typeof constructor !== \"function\") {\n            throw new TypeError(\"The constructor should be a function.\");\n        }\n        return this.stub.call(this, Object.create(constructor.prototype));\n    },\n\n    stub: function stub(object, property) {\n        if (object && typeof property !== \"undefined\"\n            && !(property in object)) {\n            throw new TypeError(\"Cannot stub non-existent own property \" + valueToString(property));\n        }\n\n        var stubbed = sinonStub.apply(null, arguments);\n        var isStubbingEntireObject = typeof property === \"undefined\" && typeof object === \"object\";\n\n        if (isStubbingEntireObject) {\n            var ownMethods = collectOwnMethods(stubbed);\n            ownMethods.forEach(this.add.bind(this));\n            if (this.promiseLibrary) {\n                ownMethods.forEach(this.addUsingPromise.bind(this));\n            }\n        } else {\n            this.add(stubbed);\n            if (this.promiseLibrary) {\n                stubbed.usingPromise(this.promiseLibrary);\n            }\n        }\n\n        return stubbed;\n    },\n\n    mock: function mock() {\n        return this.add(sinonMock.apply(null, arguments));\n    },\n\n    inject: function inject(obj) {\n        var col = this;\n\n        obj.spy = function () {\n            return col.spy.apply(col, arguments);\n        };\n\n        obj.stub = function () {\n            return col.stub.apply(col, arguments);\n        };\n\n        obj.mock = function () {\n            return col.mock.apply(col, arguments);\n        };\n\n        return obj;\n    }\n};\n\nmodule.exports = collection;\n","\"use strict\";\n\nvar supportsColor = require(\"supports-color\");\n\nfunction colorize(str, color) {\n    if (supportsColor.stdout === false) {\n        return str;\n    }\n\n    return \"\\x1b[\" + color + \"m\" + str + \"\\x1b[0m\";\n}\n\nexports.red = function (str) {\n    return colorize(str, 31);\n};\n\nexports.green = function (str) {\n    return colorize(str, 32);\n};\n\nexports.cyan = function (str) {\n    return colorize(str, 96);\n};\n\nexports.white = function (str) {\n    return colorize(str, 39);\n};\n\nexports.bold = function (str) {\n    return colorize(str, 1);\n};\n","\"use strict\";\n\nvar getPropertyDescriptor = require(\"./util/core/get-property-descriptor\");\n\nvar slice = [].slice;\nvar useLeftMostCallback = -1;\nvar useRightMostCallback = -2;\n\nfunction throwsException(fake, error, message) {\n    if (typeof error === \"function\") {\n        fake.exceptionCreator = error;\n    } else if (typeof error === \"string\") {\n        fake.exceptionCreator = function () {\n            var newException = new Error(message || \"\");\n            newException.name = error;\n            return newException;\n        };\n    } else if (!error) {\n        fake.exceptionCreator = function () {\n            return new Error(\"Error\");\n        };\n    } else {\n        fake.exception = error;\n    }\n}\n\nfunction isPropertyConfigurable(obj, propName) {\n    var propertyDescriptor = getPropertyDescriptor(obj, propName);\n\n    return propertyDescriptor ? propertyDescriptor.configurable : true;\n}\n\nmodule.exports = {\n    callsFake: function callsFake(fake, fn) {\n        fake.fakeFn = fn;\n    },\n\n    callsArg: function callsArg(fake, index) {\n        if (typeof index !== \"number\") {\n            throw new TypeError(\"argument index is not number\");\n        }\n\n        fake.callArgAt = index;\n        fake.callbackArguments = [];\n        fake.callbackContext = undefined;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    callsArgOn: function callsArgOn(fake, index, context) {\n        if (typeof index !== \"number\") {\n            throw new TypeError(\"argument index is not number\");\n        }\n\n        fake.callArgAt = index;\n        fake.callbackArguments = [];\n        fake.callbackContext = context;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    callsArgWith: function callsArgWith(fake, index) {\n        if (typeof index !== \"number\") {\n            throw new TypeError(\"argument index is not number\");\n        }\n\n        fake.callArgAt = index;\n        fake.callbackArguments = slice.call(arguments, 2);\n        fake.callbackContext = undefined;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    callsArgOnWith: function callsArgWith(fake, index, context) {\n        if (typeof index !== \"number\") {\n            throw new TypeError(\"argument index is not number\");\n        }\n\n        fake.callArgAt = index;\n        fake.callbackArguments = slice.call(arguments, 3);\n        fake.callbackContext = context;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    usingPromise: function usingPromise(fake, promiseLibrary) {\n        fake.promiseLibrary = promiseLibrary;\n    },\n\n    yields: function (fake) {\n        fake.callArgAt = useLeftMostCallback;\n        fake.callbackArguments = slice.call(arguments, 1);\n        fake.callbackContext = undefined;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    yieldsRight: function (fake) {\n        fake.callArgAt = useRightMostCallback;\n        fake.callbackArguments = slice.call(arguments, 1);\n        fake.callbackContext = undefined;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    yieldsOn: function (fake, context) {\n        fake.callArgAt = useLeftMostCallback;\n        fake.callbackArguments = slice.call(arguments, 2);\n        fake.callbackContext = context;\n        fake.callArgProp = undefined;\n        fake.callbackAsync = false;\n    },\n\n    yieldsTo: function (fake, prop) {\n        fake.callArgAt = useLeftMostCallback;\n        fake.callbackArguments = slice.call(arguments, 2);\n        fake.callbackContext = undefined;\n        fake.callArgProp = prop;\n        fake.callbackAsync = false;\n    },\n\n    yieldsToOn: function (fake, prop, context) {\n        fake.callArgAt = useLeftMostCallback;\n        fake.callbackArguments = slice.call(arguments, 3);\n        fake.callbackContext = context;\n        fake.callArgProp = prop;\n        fake.callbackAsync = false;\n    },\n\n    throws: throwsException,\n    throwsException: throwsException,\n\n    returns: function returns(fake, value) {\n        fake.returnValue = value;\n        fake.resolve = false;\n        fake.reject = false;\n        fake.returnValueDefined = true;\n        fake.exception = undefined;\n        fake.exceptionCreator = undefined;\n        fake.fakeFn = undefined;\n    },\n\n    returnsArg: function returnsArg(fake, index) {\n        if (typeof index !== \"number\") {\n            throw new TypeError(\"argument index is not number\");\n        }\n\n        fake.returnArgAt = index;\n    },\n\n    throwsArg: function throwsArg(fake, index) {\n        if (typeof index !== \"number\") {\n            throw new TypeError(\"argument index is not number\");\n        }\n\n        fake.throwArgAt = index;\n    },\n\n    returnsThis: function returnsThis(fake) {\n        fake.returnThis = true;\n    },\n\n    resolves: function resolves(fake, value) {\n        fake.returnValue = value;\n        fake.resolve = true;\n        fake.resolveThis = false;\n        fake.reject = false;\n        fake.returnValueDefined = true;\n        fake.exception = undefined;\n        fake.exceptionCreator = undefined;\n        fake.fakeFn = undefined;\n    },\n\n    rejects: function rejects(fake, error, message) {\n        var reason;\n        if (typeof error === \"string\") {\n            reason = new Error(message || \"\");\n            reason.name = error;\n        } else if (!error) {\n            reason = new Error(\"Error\");\n        } else {\n            reason = error;\n        }\n        fake.returnValue = reason;\n        fake.resolve = false;\n        fake.resolveThis = false;\n        fake.reject = true;\n        fake.returnValueDefined = true;\n        fake.exception = undefined;\n        fake.exceptionCreator = undefined;\n        fake.fakeFn = undefined;\n\n        return fake;\n    },\n\n    resolvesThis: function resolvesThis(fake) {\n        fake.returnValue = undefined;\n        fake.resolve = false;\n        fake.resolveThis = true;\n        fake.reject = false;\n        fake.returnValueDefined = false;\n        fake.exception = undefined;\n        fake.exceptionCreator = undefined;\n        fake.fakeFn = undefined;\n    },\n\n    callThrough: function callThrough(fake) {\n        fake.callsThrough = true;\n    },\n\n    get: function get(fake, getterFunction) {\n        var rootStub = fake.stub || fake;\n\n        Object.defineProperty(rootStub.rootObj, rootStub.propName, {\n            get: getterFunction,\n            configurable: isPropertyConfigurable(rootStub.rootObj, rootStub.propName)\n        });\n\n        return fake;\n    },\n\n    set: function set(fake, setterFunction) {\n        var rootStub = fake.stub || fake;\n\n        Object.defineProperty(rootStub.rootObj, rootStub.propName, { // eslint-disable-line accessor-pairs\n            set: setterFunction,\n            configurable: isPropertyConfigurable(rootStub.rootObj, rootStub.propName)\n        });\n\n        return fake;\n    },\n\n    value: function value(fake, newVal) {\n        var rootStub = fake.stub || fake;\n\n        Object.defineProperty(rootStub.rootObj, rootStub.propName, {\n            value: newVal,\n            enumerable: true,\n            configurable: isPropertyConfigurable(rootStub.rootObj, rootStub.propName)\n        });\n\n        return fake;\n    }\n};\n\nfunction createAsyncVersion(syncFnName) {\n    return function () {\n        var result = module.exports[syncFnName].apply(this, arguments);\n        this.callbackAsync = true;\n        return result;\n    };\n}\n\n// create asynchronous versions of callsArg* and yields* methods\nObject.keys(module.exports).forEach(function (method) {\n    // need to avoid creating anotherasync versions of the newly added async methods\n    if (method.match(/^(callsArg|yields)/) && !method.match(/Async/)) {\n        module.exports[method + \"Async\"] = createAsyncVersion(method);\n    }\n});\n","\"use strict\";\n\nvar deepEqual = require(\"./util/core/deep-equal\").use(match); // eslint-disable-line no-use-before-define\nvar every = require(\"./util/core/every\");\nvar functionName = require(\"./util/core/function-name\");\nvar get = require(\"lodash.get\");\nvar iterableToString = require(\"./util/core/iterable-to-string\");\nvar typeOf = require(\"./util/core/typeOf\");\nvar valueToString = require(\"./util/core/value-to-string\");\n\nvar indexOf = Array.prototype.indexOf;\n\nfunction assertType(value, type, name) {\n    var actual = typeOf(value);\n    if (actual !== type) {\n        throw new TypeError(\"Expected type of \" + name + \" to be \" +\n            type + \", but was \" + actual);\n    }\n}\n\nfunction assertMethodExists(value, method, name, methodPath) {\n    if (value[method] == null) {\n        throw new TypeError(\"Expected \" + name + \" to have method \" + methodPath);\n    }\n}\n\nvar matcher = {\n    toString: function () {\n        return this.message;\n    }\n};\n\nfunction isMatcher(object) {\n    return matcher.isPrototypeOf(object);\n}\n\nfunction matchObject(expectation, actual) {\n    if (actual === null || actual === undefined) {\n        return false;\n    }\n\n    return Object.keys(expectation).every(function (key) {\n        var exp = expectation[key];\n        var act = actual[key];\n\n        if (isMatcher(exp)) {\n            if (!exp.test(act)) {\n                return false;\n            }\n        } else if (typeOf(exp) === \"object\") {\n            if (!matchObject(exp, act)) {\n                return false;\n            }\n        } else if (!deepEqual(exp, act)) {\n            return false;\n        }\n\n        return true;\n    });\n}\n\nvar TYPE_MAP = {\n    function: function (m, expectation, message) {\n        m.test = expectation;\n        m.message = message || \"match(\" + functionName(expectation) + \")\";\n    },\n    number: function (m, expectation) {\n        m.test = function (actual) {\n            // we need type coercion here\n            return expectation == actual; // eslint-disable-line eqeqeq\n        };\n    },\n    object: function (m, expectation) {\n        var array = [];\n\n        if (typeof expectation.test === \"function\") {\n            m.test = function (actual) {\n                return expectation.test(actual) === true;\n            };\n            m.message = \"match(\" + functionName(expectation.test) + \")\";\n            return m;\n        }\n\n        array = Object.keys(expectation).map(function (key) {\n            return key + \": \" + valueToString(expectation[key]);\n        });\n\n        m.test = function (actual) {\n            return matchObject(expectation, actual);\n        };\n        m.message = \"match(\" + array.join(\", \") + \")\";\n\n        return m;\n    },\n    regexp: function (m, expectation) {\n        m.test = function (actual) {\n            return typeof actual === \"string\" && expectation.test(actual);\n        };\n    },\n    string: function (m, expectation) {\n        m.test = function (actual) {\n            return typeof actual === \"string\" && actual.indexOf(expectation) !== -1;\n        };\n        m.message = \"match(\\\"\" + expectation + \"\\\")\";\n    }\n};\n\nfunction match(expectation, message) {\n    var m = Object.create(matcher);\n    var type = typeOf(expectation);\n\n    if (type in TYPE_MAP) {\n        TYPE_MAP[type](m, expectation, message);\n    } else {\n        m.test = function (actual) {\n            return deepEqual(expectation, actual);\n        };\n    }\n\n    if (!m.message) {\n        m.message = \"match(\" + valueToString(expectation) + \")\";\n    }\n\n    return m;\n}\n\nmatcher.or = function (m2) {\n    if (!arguments.length) {\n        throw new TypeError(\"Matcher expected\");\n    } else if (!isMatcher(m2)) {\n        m2 = match(m2);\n    }\n    var m1 = this;\n    var or = Object.create(matcher);\n    or.test = function (actual) {\n        return m1.test(actual) || m2.test(actual);\n    };\n    or.message = m1.message + \".or(\" + m2.message + \")\";\n    return or;\n};\n\nmatcher.and = function (m2) {\n    if (!arguments.length) {\n        throw new TypeError(\"Matcher expected\");\n    } else if (!isMatcher(m2)) {\n        m2 = match(m2);\n    }\n    var m1 = this;\n    var and = Object.create(matcher);\n    and.test = function (actual) {\n        return m1.test(actual) && m2.test(actual);\n    };\n    and.message = m1.message + \".and(\" + m2.message + \")\";\n    return and;\n};\n\nmatch.isMatcher = isMatcher;\n\nmatch.any = match(function () {\n    return true;\n}, \"any\");\n\nmatch.defined = match(function (actual) {\n    return actual !== null && actual !== undefined;\n}, \"defined\");\n\nmatch.truthy = match(function (actual) {\n    return !!actual;\n}, \"truthy\");\n\nmatch.falsy = match(function (actual) {\n    return !actual;\n}, \"falsy\");\n\nmatch.same = function (expectation) {\n    return match(function (actual) {\n        return expectation === actual;\n    }, \"same(\" + valueToString(expectation) + \")\");\n};\n\nmatch.typeOf = function (type) {\n    assertType(type, \"string\", \"type\");\n    return match(function (actual) {\n        return typeOf(actual) === type;\n    }, \"typeOf(\\\"\" + type + \"\\\")\");\n};\n\nmatch.instanceOf = function (type) {\n    if (typeof Symbol === \"undefined\" || typeof Symbol.hasInstance === \"undefined\") {\n        assertType(type, \"function\", \"type\");\n    } else {\n        assertMethodExists(type, Symbol.hasInstance, \"type\", \"[Symbol.hasInstance]\");\n    }\n    return match(function (actual) {\n        return actual instanceof type;\n    }, \"instanceOf(\" + (functionName(type) || Object.prototype.toString.call(type)) + \")\");\n};\n\nfunction createPropertyMatcher(propertyTest, messagePrefix) {\n    return function (property, value) {\n        assertType(property, \"string\", \"property\");\n        var onlyProperty = arguments.length === 1;\n        var message = messagePrefix + \"(\\\"\" + property + \"\\\"\";\n        if (!onlyProperty) {\n            message += \", \" + valueToString(value);\n        }\n        message += \")\";\n        return match(function (actual) {\n            if (actual === undefined || actual === null ||\n                    !propertyTest(actual, property)) {\n                return false;\n            }\n            return onlyProperty || deepEqual(value, actual[property]);\n        }, message);\n    };\n}\n\nmatch.has = createPropertyMatcher(function (actual, property) {\n    if (typeof actual === \"object\") {\n        return property in actual;\n    }\n    return actual[property] !== undefined;\n}, \"has\");\n\nmatch.hasOwn = createPropertyMatcher(function (actual, property) {\n    return actual.hasOwnProperty(property);\n}, \"hasOwn\");\n\nmatch.hasNested = function (property, value) {\n    assertType(property, \"string\", \"property\");\n    var onlyProperty = arguments.length === 1;\n    var message = \"hasNested(\\\"\" + property + \"\\\"\";\n    if (!onlyProperty) {\n        message += \", \" + valueToString(value);\n    }\n    message += \")\";\n    return match(function (actual) {\n        if (actual === undefined || actual === null ||\n                get(actual, property) === undefined) {\n            return false;\n        }\n        return onlyProperty || deepEqual(value, get(actual, property));\n    }, message);\n};\n\nmatch.every = function (predicate) {\n    if (!isMatcher(predicate)) {\n        throw new TypeError(\"Matcher expected\");\n    }\n\n    return match(function (actual) {\n        if (typeOf(actual) === \"object\") {\n            return every(Object.keys(actual), function (key) {\n                return predicate.test(actual[key]);\n            });\n        }\n\n        return !!actual && typeOf(actual.forEach) === \"function\" && every(actual, function (element) {\n            return predicate.test(element);\n        });\n    }, \"every(\" + predicate.message + \")\");\n};\n\nmatch.some = function (predicate) {\n    if (!isMatcher(predicate)) {\n        throw new TypeError(\"Matcher expected\");\n    }\n\n    return match(function (actual) {\n        if (typeOf(actual) === \"object\") {\n            return !every(Object.keys(actual), function (key) {\n                return !predicate.test(actual[key]);\n            });\n        }\n\n        return !!actual && typeOf(actual.forEach) === \"function\" && !every(actual, function (element) {\n            return !predicate.test(element);\n        });\n    }, \"some(\" + predicate.message + \")\");\n};\n\nmatch.array = match.typeOf(\"array\");\n\nmatch.array.deepEquals = function (expectation) {\n    return match(function (actual) {\n        // Comparing lengths is the fastest way to spot a difference before iterating through every item\n        var sameLength = actual.length === expectation.length;\n        return typeOf(actual) === \"array\" && sameLength && every(actual, function (element, index) {\n            return expectation[index] === element;\n        });\n    }, \"deepEquals([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.array.startsWith = function (expectation) {\n    return match(function (actual) {\n        return typeOf(actual) === \"array\" && every(expectation, function (expectedElement, index) {\n            return actual[index] === expectedElement;\n        });\n    }, \"startsWith([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.array.endsWith = function (expectation) {\n    return match(function (actual) {\n        // This indicates the index in which we should start matching\n        var offset = actual.length - expectation.length;\n\n        return typeOf(actual) === \"array\" && every(expectation, function (expectedElement, index) {\n            return actual[offset + index] === expectedElement;\n        });\n    }, \"endsWith([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.array.contains = function (expectation) {\n    return match(function (actual) {\n        return typeOf(actual) === \"array\" && every(expectation, function (expectedElement) {\n            return indexOf.call(actual, expectedElement) !== -1;\n        });\n    }, \"contains([\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.map = match.typeOf(\"map\");\n\nmatch.map.deepEquals = function mapDeepEquals(expectation) {\n    return match(function (actual) {\n        // Comparing lengths is the fastest way to spot a difference before iterating through every item\n        var sameLength = actual.size === expectation.size;\n        return typeOf(actual) === \"map\" && sameLength && every(actual, function (element, key) {\n            return expectation.has(key) && expectation.get(key) === element;\n        });\n    }, \"deepEquals(Map[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.map.contains = function mapContains(expectation) {\n    return match(function (actual) {\n        return typeOf(actual) === \"map\" && every(expectation, function (element, key) {\n            return actual.has(key) && actual.get(key) === element;\n        });\n    }, \"contains(Map[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.set = match.typeOf(\"set\");\n\nmatch.set.deepEquals = function setDeepEquals(expectation) {\n    return match(function (actual) {\n        // Comparing lengths is the fastest way to spot a difference before iterating through every item\n        var sameLength = actual.size === expectation.size;\n        return typeOf(actual) === \"set\" && sameLength && every(actual, function (element) {\n            return expectation.has(element);\n        });\n    }, \"deepEquals(Set[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.set.contains = function setContains(expectation) {\n    return match(function (actual) {\n        return typeOf(actual) === \"set\" && every(expectation, function (element) {\n            return actual.has(element);\n        });\n    }, \"contains(Set[\" + iterableToString(expectation) + \"])\");\n};\n\nmatch.bool = match.typeOf(\"boolean\");\nmatch.number = match.typeOf(\"number\");\nmatch.string = match.typeOf(\"string\");\nmatch.object = match.typeOf(\"object\");\nmatch.func = match.typeOf(\"function\");\nmatch.regexp = match.typeOf(\"regexp\");\nmatch.date = match.typeOf(\"date\");\nmatch.symbol = match.typeOf(\"symbol\");\n\nmodule.exports = match;\n","\"use strict\";\n\nvar spyInvoke = require(\"./spy\").invoke;\nvar spyCallToString = require(\"./call\").toString;\nvar timesInWords = require(\"./util/core/times-in-words\");\nvar extend = require(\"./util/core/extend\");\nvar match = require(\"./match\");\nvar stub = require(\"./stub\");\nvar assert = require(\"./assert\");\nvar deepEqual = require(\"./util/core/deep-equal\").use(match);\nvar format = require(\"./util/core/format\");\nvar valueToString = require(\"./util/core/value-to-string\");\n\nvar slice = Array.prototype.slice;\nvar push = Array.prototype.push;\n\nfunction callCountInWords(callCount) {\n    if (callCount === 0) {\n        return \"never called\";\n    }\n\n    return \"called \" + timesInWords(callCount);\n}\n\nfunction expectedCallCountInWords(expectation) {\n    var min = expectation.minCalls;\n    var max = expectation.maxCalls;\n\n    if (typeof min === \"number\" && typeof max === \"number\") {\n        var str = timesInWords(min);\n\n        if (min !== max) {\n            str = \"at least \" + str + \" and at most \" + timesInWords(max);\n        }\n\n        return str;\n    }\n\n    if (typeof min === \"number\") {\n        return \"at least \" + timesInWords(min);\n    }\n\n    return \"at most \" + timesInWords(max);\n}\n\nfunction receivedMinCalls(expectation) {\n    var hasMinLimit = typeof expectation.minCalls === \"number\";\n    return !hasMinLimit || expectation.callCount >= expectation.minCalls;\n}\n\nfunction receivedMaxCalls(expectation) {\n    if (typeof expectation.maxCalls !== \"number\") {\n        return false;\n    }\n\n    return expectation.callCount === expectation.maxCalls;\n}\n\nfunction verifyMatcher(possibleMatcher, arg) {\n    var isMatcher = match && match.isMatcher(possibleMatcher);\n\n    return isMatcher && possibleMatcher.test(arg) || true;\n}\n\nvar mockExpectation = {\n    minCalls: 1,\n    maxCalls: 1,\n\n    create: function create(methodName) {\n        var expectation = extend(stub.create(), mockExpectation);\n        delete expectation.create;\n        expectation.method = methodName;\n\n        return expectation;\n    },\n\n    invoke: function invoke(func, thisValue, args) {\n        this.verifyCallAllowed(thisValue, args);\n\n        return spyInvoke.apply(this, arguments);\n    },\n\n    atLeast: function atLeast(num) {\n        if (typeof num !== \"number\") {\n            throw new TypeError(\"'\" + valueToString(num) + \"' is not number\");\n        }\n\n        if (!this.limitsSet) {\n            this.maxCalls = null;\n            this.limitsSet = true;\n        }\n\n        this.minCalls = num;\n\n        return this;\n    },\n\n    atMost: function atMost(num) {\n        if (typeof num !== \"number\") {\n            throw new TypeError(\"'\" + valueToString(num) + \"' is not number\");\n        }\n\n        if (!this.limitsSet) {\n            this.minCalls = null;\n            this.limitsSet = true;\n        }\n\n        this.maxCalls = num;\n\n        return this;\n    },\n\n    never: function never() {\n        return this.exactly(0);\n    },\n\n    once: function once() {\n        return this.exactly(1);\n    },\n\n    twice: function twice() {\n        return this.exactly(2);\n    },\n\n    thrice: function thrice() {\n        return this.exactly(3);\n    },\n\n    exactly: function exactly(num) {\n        if (typeof num !== \"number\") {\n            throw new TypeError(\"'\" + valueToString(num) + \"' is not a number\");\n        }\n\n        this.atLeast(num);\n        return this.atMost(num);\n    },\n\n    met: function met() {\n        return !this.failed && receivedMinCalls(this);\n    },\n\n    verifyCallAllowed: function verifyCallAllowed(thisValue, args) {\n        var expectedArguments = this.expectedArguments;\n\n        if (receivedMaxCalls(this)) {\n            this.failed = true;\n            mockExpectation.fail(this.method + \" already called \" + timesInWords(this.maxCalls));\n        }\n\n        if (\"expectedThis\" in this && this.expectedThis !== thisValue) {\n            mockExpectation.fail(this.method + \" called with \" + valueToString(thisValue) +\n                \" as thisValue, expected \" + valueToString(this.expectedThis));\n        }\n\n        if (!(\"expectedArguments\" in this)) {\n            return;\n        }\n\n        if (!args) {\n            mockExpectation.fail(this.method + \" received no arguments, expected \" +\n                format(expectedArguments));\n        }\n\n        if (args.length < expectedArguments.length) {\n            mockExpectation.fail(this.method + \" received too few arguments (\" + format(args) +\n                \"), expected \" + format(expectedArguments));\n        }\n\n        if (this.expectsExactArgCount &&\n            args.length !== expectedArguments.length) {\n            mockExpectation.fail(this.method + \" received too many arguments (\" + format(args) +\n                \"), expected \" + format(expectedArguments));\n        }\n\n        expectedArguments.forEach(function (expectedArgument, i) {\n            if (!verifyMatcher(expectedArgument, args[i])) {\n                mockExpectation.fail(this.method + \" received wrong arguments \" + format(args) +\n                    \", didn't match \" + expectedArguments.toString());\n            }\n\n            if (!deepEqual(expectedArgument, args[i])) {\n                mockExpectation.fail(this.method + \" received wrong arguments \" + format(args) +\n                    \", expected \" + format(expectedArguments));\n            }\n        }, this);\n    },\n\n    allowsCall: function allowsCall(thisValue, args) {\n        var expectedArguments = this.expectedArguments;\n\n        if (this.met() && receivedMaxCalls(this)) {\n            return false;\n        }\n\n        if (\"expectedThis\" in this && this.expectedThis !== thisValue) {\n            return false;\n        }\n\n        if (!(\"expectedArguments\" in this)) {\n            return true;\n        }\n\n        args = args || [];\n\n        if (args.length < expectedArguments.length) {\n            return false;\n        }\n\n        if (this.expectsExactArgCount &&\n            args.length !== expectedArguments.length) {\n            return false;\n        }\n\n        return expectedArguments.every(function (expectedArgument, i) {\n            if (!verifyMatcher(expectedArgument, args[i])) {\n                return false;\n            }\n\n            if (!deepEqual(expectedArgument, args[i])) {\n                return false;\n            }\n\n            return true;\n        });\n    },\n\n    withArgs: function withArgs() {\n        this.expectedArguments = slice.call(arguments);\n        return this;\n    },\n\n    withExactArgs: function withExactArgs() {\n        this.withArgs.apply(this, arguments);\n        this.expectsExactArgCount = true;\n        return this;\n    },\n\n    on: function on(thisValue) {\n        this.expectedThis = thisValue;\n        return this;\n    },\n\n    toString: function () {\n        var args = (this.expectedArguments || []).slice();\n\n        if (!this.expectsExactArgCount) {\n            push.call(args, \"[...]\");\n        }\n\n        var callStr = spyCallToString.call({\n            proxy: this.method || \"anonymous mock expectation\",\n            args: args\n        });\n\n        var message = callStr.replace(\", [...\", \"[, ...\") + \" \" +\n            expectedCallCountInWords(this);\n\n        if (this.met()) {\n            return \"Expectation met: \" + message;\n        }\n\n        return \"Expected \" + message + \" (\" +\n            callCountInWords(this.callCount) + \")\";\n    },\n\n    verify: function verify() {\n        if (!this.met()) {\n            mockExpectation.fail(this.toString());\n        } else {\n            mockExpectation.pass(this.toString());\n        }\n\n        return true;\n    },\n\n    pass: function pass(message) {\n        assert.pass(message);\n    },\n\n    fail: function fail(message) {\n        var exception = new Error(message);\n        exception.name = \"ExpectationError\";\n\n        throw exception;\n    }\n};\n\nmodule.exports = mockExpectation;\n","\"use strict\";\n\nvar mockExpectation = require(\"./mock-expectation\");\nvar spyCallToString = require(\"./call\").toString;\nvar extend = require(\"./util/core/extend\");\nvar match = require(\"./match\");\nvar deepEqual = require(\"./util/core/deep-equal\").use(match);\nvar wrapMethod = require(\"./util/core/wrap-method\");\n\nvar push = Array.prototype.push;\nvar filter = Array.prototype.filter;\n\nfunction mock(object) {\n    if (!object || typeof object === \"string\") {\n        return mockExpectation.create(object ? object : \"Anonymous mock\");\n    }\n\n    return mock.create(object);\n}\n\nfunction each(collection, callback) {\n    var col = collection || [];\n\n    col.forEach(callback);\n}\n\nfunction arrayEquals(arr1, arr2, compareLength) {\n    if (compareLength && (arr1.length !== arr2.length)) {\n        return false;\n    }\n\n    return arr1.every(function (element, i) {\n        return deepEqual(element, arr2[i]);\n\n    });\n}\n\nextend(mock, {\n    create: function create(object) {\n        if (!object) {\n            throw new TypeError(\"object is null\");\n        }\n\n        var mockObject = extend({}, mock);\n        mockObject.object = object;\n        delete mockObject.create;\n\n        return mockObject;\n    },\n\n    expects: function expects(method) {\n        if (!method) {\n            throw new TypeError(\"method is falsy\");\n        }\n\n        if (!this.expectations) {\n            this.expectations = {};\n            this.proxies = [];\n            this.failures = [];\n        }\n\n        if (!this.expectations[method]) {\n            this.expectations[method] = [];\n            var mockObject = this;\n\n            wrapMethod(this.object, method, function () {\n                return mockObject.invokeMethod(method, this, arguments);\n            });\n\n            push.call(this.proxies, method);\n        }\n\n        var expectation = mockExpectation.create(method);\n        extend(expectation, this.object[method]);\n        push.call(this.expectations[method], expectation);\n\n        return expectation;\n    },\n\n    restore: function restore() {\n        var object = this.object;\n\n        each(this.proxies, function (proxy) {\n            if (typeof object[proxy].restore === \"function\") {\n                object[proxy].restore();\n            }\n        });\n    },\n\n    verify: function verify() {\n        var expectations = this.expectations || {};\n        var messages = this.failures ? this.failures.slice() : [];\n        var met = [];\n\n        each(this.proxies, function (proxy) {\n            each(expectations[proxy], function (expectation) {\n                if (!expectation.met()) {\n                    push.call(messages, expectation.toString());\n                } else {\n                    push.call(met, expectation.toString());\n                }\n            });\n        });\n\n        this.restore();\n\n        if (messages.length > 0) {\n            mockExpectation.fail(messages.concat(met).join(\"\\n\"));\n        } else if (met.length > 0) {\n            mockExpectation.pass(messages.concat(met).join(\"\\n\"));\n        }\n\n        return true;\n    },\n\n    invokeMethod: function invokeMethod(method, thisValue, args) {\n        /* if we cannot find any matching files we will explicitly call mockExpection#fail with error messages */\n        /* eslint consistent-return: \"off\" */\n        var expectations = this.expectations && this.expectations[method] ? this.expectations[method] : [];\n        var currentArgs = args || [];\n        var available;\n\n        var expectationsWithMatchingArgs = filter.call(expectations, function (expectation) {\n            var expectedArgs = expectation.expectedArguments || [];\n\n            return arrayEquals(expectedArgs, currentArgs, expectation.expectsExactArgCount);\n        });\n\n        var expectationsToApply = filter.call(expectationsWithMatchingArgs, function (expectation) {\n            return !expectation.met() && expectation.allowsCall(thisValue, args);\n        });\n\n        if (expectationsToApply.length > 0) {\n            return expectationsToApply[0].apply(thisValue, args);\n        }\n\n        var messages = [];\n        var exhausted = 0;\n\n        expectationsWithMatchingArgs.forEach(function (expectation) {\n            if (expectation.allowsCall(thisValue, args)) {\n                available = available || expectation;\n            } else {\n                exhausted += 1;\n            }\n        });\n\n        if (available && exhausted === 0) {\n            return available.apply(thisValue, args);\n        }\n\n        expectations.forEach(function (expectation) {\n            push.call(messages, \"    \" + expectation.toString());\n        });\n\n        messages.unshift(\"Unexpected call: \" + spyCallToString.call({\n            proxy: method,\n            args: args\n        }));\n\n        var err = new Error();\n        if (!err.stack) {\n            // PhantomJS does not serialize the stack trace until the error has been thrown\n            try {\n                throw err;\n            } catch (e) {/* empty */}\n        }\n        this.failures.push(\"Unexpected call: \" + spyCallToString.call({\n            proxy: method,\n            args: args,\n            stack: err.stack\n        }));\n\n        mockExpectation.fail(messages.join(\"\\n\"));\n    }\n});\n\nmodule.exports = mock;\n","\"use strict\";\n\nvar extend = require(\"./util/core/extend\");\nvar sinonCollection = require(\"./collection\");\nvar sinonMatch = require(\"./match\");\nvar sinonAssert = require(\"./assert\");\nvar sinonClock = require(\"./util/fake_timers\");\nvar fakeServer = require(\"nise\").fakeServer;\nvar fakeXhr = require(\"nise\").fakeXhr;\n\nvar push = [].push;\n\nvar sinonSandbox = Object.create(sinonCollection);\n\nfunction exposeValue(sandbox, config, key, value) {\n    if (!value) {\n        return;\n    }\n\n    if (config.injectInto && !(key in config.injectInto)) {\n        config.injectInto[key] = value;\n        sandbox.injectedKeys.push(key);\n    } else {\n        push.call(sandbox.args, value);\n    }\n}\n\nfunction prepareSandboxFromConfig(config) {\n    var sandbox = Object.create(sinonSandbox);\n\n    if (config.useFakeServer) {\n        if (typeof config.useFakeServer === \"object\") {\n            sandbox.serverPrototype = config.useFakeServer;\n        }\n\n        sandbox.useFakeServer();\n    }\n\n    if (config.useFakeTimers) {\n        if (typeof config.useFakeTimers === \"object\") {\n            sandbox.useFakeTimers.call(sandbox, config.useFakeTimers);\n        } else {\n            sandbox.useFakeTimers();\n        }\n    }\n\n    return sandbox;\n}\n\nextend(sinonSandbox, {\n    useFakeTimers: function (args) {\n        this.clock = sinonClock.useFakeTimers.call(null, args);\n\n        return this.add(this.clock);\n    },\n\n    serverPrototype: fakeServer,\n\n    useFakeServer: function useFakeServer() {\n        var proto = this.serverPrototype || fakeServer;\n\n        if (!proto || !proto.create) {\n            return null;\n        }\n\n        this.server = proto.create();\n        return this.add(this.server);\n    },\n\n    useFakeXMLHttpRequest: function useFakeXMLHttpRequest() {\n        var xhr = fakeXhr.useFakeXMLHttpRequest();\n        return this.add(xhr);\n    },\n\n    inject: function (obj) {\n        sinonCollection.inject.call(this, obj);\n\n        if (this.clock) {\n            obj.clock = this.clock;\n        }\n\n        if (this.server) {\n            obj.server = this.server;\n            obj.requests = this.server.requests;\n        }\n\n        obj.match = sinonMatch;\n\n        return obj;\n    },\n\n    usingPromise: function (promiseLibrary) {\n\n        this.promiseLibrary = promiseLibrary;\n\n        return this;\n    },\n\n    restore: function () {\n        if (arguments.length) {\n            throw new Error(\"sandbox.restore() does not take any parameters. Perhaps you meant stub.restore()\");\n        }\n\n        sinonCollection.restore.apply(this, arguments);\n        this.restoreContext();\n    },\n\n    restoreContext: function () {\n        var injectedKeys = this.injectedKeys;\n        var injectInto = this.injectInto;\n\n        if (!injectedKeys) {\n            return;\n        }\n\n        injectedKeys.forEach(function (injectedKey) {\n            delete injectInto[injectedKey];\n        });\n\n        injectedKeys = [];\n    },\n\n    create: function (config) {\n        if (!config) {\n            return Object.create(sinonSandbox);\n        }\n\n        var sandbox = prepareSandboxFromConfig(config);\n        sandbox.args = sandbox.args || [];\n        sandbox.injectedKeys = [];\n        sandbox.injectInto = config.injectInto;\n        var exposed = sandbox.inject({});\n\n        if (config.properties) {\n            config.properties.forEach(function (prop) {\n                var value = exposed[prop] || prop === \"sandbox\" && sandbox;\n                exposeValue(sandbox, config, prop, value);\n            });\n        } else {\n            exposeValue(sandbox, config, \"sandbox\");\n        }\n\n        return sandbox;\n    },\n\n    match: sinonMatch,\n\n    assert: sinonAssert\n});\n\nmodule.exports = sinonSandbox;\n","\"use strict\";\n\nvar color = require(\"./color\");\nvar timesInWords = require(\"./util/core/times-in-words\");\nvar sinonFormat = require(\"./util/core/format\");\nvar sinonMatch = require(\"./match\");\nvar jsDiff = require(\"diff\");\nvar push = Array.prototype.push;\n\nfunction colorSinonMatchText(matcher, calledArg, calledArgMessage) {\n    if (!matcher.test(calledArg)) {\n        matcher.message = color.red(matcher.message);\n        if (calledArgMessage) {\n            calledArgMessage = color.green(calledArgMessage);\n        }\n    }\n    return calledArgMessage + \" \" + matcher.message;\n}\n\nfunction colorDiffText(diff) {\n    var objects = diff.map(function (part) {\n        var text = part.value;\n        if (part.added) {\n            text = color.green(text);\n        } else if (part.removed) {\n            text = color.red(text);\n        }\n        if (diff.length === 2) {\n            text += \" \"; // format simple diffs\n        }\n        return text;\n    });\n    return objects.join(\"\");\n}\n\nmodule.exports = {\n    c: function (spyInstance) {\n        return timesInWords(spyInstance.callCount);\n    },\n\n    n: function (spyInstance) {\n        return spyInstance.toString();\n    },\n\n    D: function (spyInstance, args) {\n        var message = \"\";\n\n        for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n            // describe multiple calls\n            if (l > 1) {\n                message += \"\\nCall \" + (i + 1) + \":\";\n            }\n            var calledArgs = spyInstance.getCall(i).args;\n            for (var j = 0; j < calledArgs.length || j < args.length; ++j) {\n                message += \"\\n\";\n                var calledArgMessage = j < calledArgs.length ? sinonFormat(calledArgs[j]) : \"\";\n                if (sinonMatch.isMatcher(args[j])) {\n                    message += colorSinonMatchText(args[j], calledArgs[j], calledArgMessage);\n                } else {\n                    var expectedArgMessage = j < args.length ? sinonFormat(args[j]) : \"\";\n                    var diff = jsDiff.diffJson(calledArgMessage, expectedArgMessage);\n                    message += colorDiffText(diff);\n                }\n            }\n        }\n\n        return message;\n    },\n\n    C: function (spyInstance) {\n        var calls = [];\n\n        for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n            var stringifiedCall = \"    \" + spyInstance.getCall(i).toString();\n            if (/\\n/.test(calls[i - 1])) {\n                stringifiedCall = \"\\n\" + stringifiedCall;\n            }\n            push.call(calls, stringifiedCall);\n        }\n\n        return calls.length > 0 ? \"\\n\" + calls.join(\"\\n\") : \"\";\n    },\n\n    t: function (spyInstance) {\n        var objects = [];\n\n        for (var i = 0, l = spyInstance.callCount; i < l; ++i) {\n            push.call(objects, sinonFormat(spyInstance.thisValues[i]));\n        }\n\n        return objects.join(\", \");\n    },\n\n    \"*\": function (spyInstance, args) {\n        return args.map(function (arg) { return sinonFormat(arg); }).join(\", \");\n    }\n};\n","\"use strict\";\n\nvar createBehavior = require(\"./behavior\").create;\nvar extend = require(\"./util/core/extend\");\nvar deprecated = require(\"./util/core/deprecated\");\nvar functionName = require(\"./util/core/function-name\");\nvar functionToString = require(\"./util/core/function-to-string\");\nvar getPropertyDescriptor = require(\"./util/core/get-property-descriptor\");\nvar sinonMatch = require(\"./match\");\nvar deepEqual = require(\"./util/core/deep-equal\").use(sinonMatch);\nvar isEsModule = require(\"./util/core/is-es-module\");\nvar spyCall = require(\"./call\");\nvar wrapMethod = require(\"./util/core/wrap-method\");\nvar sinonFormat = require(\"./util/core/format\");\nvar valueToString = require(\"./util/core/value-to-string\");\n\n/* cache references to library methods so that they also can be stubbed without problems */\nvar push = Array.prototype.push;\nvar slice = Array.prototype.slice;\nvar filter = Array.prototype.filter;\nvar ErrorConstructor = Error.prototype.constructor;\nvar bind = Function.prototype.bind;\n\nvar callId = 0;\n\nfunction spy(object, property, types) {\n    var descriptor, methodDesc;\n\n    if (isEsModule(object)) {\n        throw new TypeError(\"ES Modules cannot be spied\");\n    }\n\n    if (!property && typeof object === \"function\") {\n        return spy.create(object);\n    }\n\n    if (!object && !property) {\n        return spy.create(function () {});\n    }\n\n    if (!types) {\n        return wrapMethod(object, property, spy.create(object[property]));\n    }\n\n    descriptor = {};\n    methodDesc = getPropertyDescriptor(object, property);\n\n    types.forEach(function (type) {\n        descriptor[type] = spy.create(methodDesc[type]);\n    });\n\n    return wrapMethod(object, property, descriptor);\n}\n\nfunction incrementCallCount() {\n    this.called = true;\n    this.callCount += 1;\n    this.notCalled = false;\n    this.calledOnce = this.callCount === 1;\n    this.calledTwice = this.callCount === 2;\n    this.calledThrice = this.callCount === 3;\n}\n\nfunction createCallProperties() {\n    this.firstCall = this.getCall(0);\n    this.secondCall = this.getCall(1);\n    this.thirdCall = this.getCall(2);\n    this.lastCall = this.getCall(this.callCount - 1);\n}\n\nfunction createProxy(func, proxyLength) {\n    // Retain the function length:\n    var p;\n    if (proxyLength) {\n        // Do not change this to use an eval. Projects that depend on sinon block the use of eval.\n        // ref: https://github.com/sinonjs/sinon/issues/710\n        switch (proxyLength) {\n            /*eslint-disable no-unused-vars, max-len*/\n            case 1: p = function proxy(a) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 2: p = function proxy(a, b) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 3: p = function proxy(a, b, c) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 4: p = function proxy(a, b, c, d) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 5: p = function proxy(a, b, c, d, e) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 6: p = function proxy(a, b, c, d, e, f) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 7: p = function proxy(a, b, c, d, e, f, g) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 8: p = function proxy(a, b, c, d, e, f, g, h) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 9: p = function proxy(a, b, c, d, e, f, g, h, i) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 10: p = function proxy(a, b, c, d, e, f, g, h, i, j) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 11: p = function proxy(a, b, c, d, e, f, g, h, i, j, k) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            case 12: p = function proxy(a, b, c, d, e, f, g, h, i, j, k, l) { return p.invoke(func, this, slice.call(arguments)); }; break;\n            default: p = function proxy() { return p.invoke(func, this, slice.call(arguments)); }; break;\n            /*eslint-enable*/\n        }\n    } else {\n        p = function proxy() {\n            return p.invoke(func, this, slice.call(arguments));\n        };\n    }\n    p.isSinonProxy = true;\n    return p;\n}\n\nvar uuid = 0;\n\n// Public API\nvar spyApi = {\n    formatters: require(\"./spy-formatters\"),\n\n    resetHistory: function () {\n        if (this.invoking) {\n            var err = new Error(\"Cannot reset Sinon function while invoking it. \" +\n                                \"Move the call to .reset outside of the callback.\");\n            err.name = \"InvalidResetException\";\n            throw err;\n        }\n\n        this.called = false;\n        this.notCalled = true;\n        this.calledOnce = false;\n        this.calledTwice = false;\n        this.calledThrice = false;\n        this.callCount = 0;\n        this.firstCall = null;\n        this.secondCall = null;\n        this.thirdCall = null;\n        this.lastCall = null;\n        this.args = [];\n        this.returnValues = [];\n        this.thisValues = [];\n        this.exceptions = [];\n        this.callIds = [];\n        this.errorsWithCallStack = [];\n        if (this.fakes) {\n            this.fakes.forEach(function (fake) {\n                if (fake.resetHistory) {\n                    fake.resetHistory();\n                } else {\n                    fake.reset();\n                }\n            });\n        }\n\n        return this;\n    },\n\n    create: function create(func, spyLength) {\n        var name;\n\n        if (typeof func !== \"function\") {\n            func = function () { };\n        } else {\n            name = functionName(func);\n        }\n\n        if (!spyLength) {\n            spyLength = func.length;\n        }\n\n        var proxy = createProxy(func, spyLength);\n\n        extend(proxy, spy);\n        delete proxy.create;\n        extend(proxy, func);\n\n        proxy.resetHistory();\n        proxy.prototype = func.prototype;\n        proxy.displayName = name || \"spy\";\n        proxy.toString = functionToString;\n        proxy.instantiateFake = spy.create;\n        proxy.id = \"spy#\" + uuid++;\n\n        return proxy;\n    },\n\n    invoke: function invoke(func, thisValue, args) {\n        var matchings = this.matchingFakes(args);\n        var currentCallId = callId++;\n        var exception, returnValue;\n\n        incrementCallCount.call(this);\n        push.call(this.thisValues, thisValue);\n        push.call(this.args, args);\n        push.call(this.callIds, currentCallId);\n        matchings.forEach(function (matching) {\n            incrementCallCount.call(matching);\n            push.call(matching.thisValues, thisValue);\n            push.call(matching.args, args);\n            push.call(matching.callIds, currentCallId);\n        });\n\n        // Make call properties available from within the spied function:\n        createCallProperties.call(this);\n        matchings.forEach(function (matching) {\n            createCallProperties.call(matching);\n        });\n\n        try {\n            this.invoking = true;\n\n            var thisCall = this.getCall(this.callCount - 1);\n\n            if (thisCall.calledWithNew()) {\n                // Call through with `new`\n                returnValue = new (bind.apply(this.func || func, [thisValue].concat(args)))();\n\n                if (typeof returnValue !== \"object\") {\n                    returnValue = thisValue;\n                }\n            } else {\n                returnValue = (this.func || func).apply(thisValue, args);\n            }\n        } catch (e) {\n            exception = e;\n        } finally {\n            delete this.invoking;\n        }\n\n        push.call(this.exceptions, exception);\n        push.call(this.returnValues, returnValue);\n        matchings.forEach(function (matching) {\n            push.call(matching.exceptions, exception);\n            push.call(matching.returnValues, returnValue);\n        });\n\n        var err = new ErrorConstructor();\n        // 1. Please do not get stack at this point. It may be so very slow, and not actually used\n        // 2. PhantomJS does not serialize the stack trace until the error has been thrown:\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error/Stack\n        try {\n            throw err;\n        } catch (e) {/* empty */}\n        push.call(this.errorsWithCallStack, err);\n        matchings.forEach(function (matching) {\n            push.call(matching.errorsWithCallStack, err);\n        });\n\n        // Make return value and exception available in the calls:\n        createCallProperties.call(this);\n        matchings.forEach(function (matching) {\n            createCallProperties.call(matching);\n        });\n\n        if (exception !== undefined) {\n            throw exception;\n        }\n\n        return returnValue;\n    },\n\n    named: function named(name) {\n        this.displayName = name;\n        return this;\n    },\n\n    getCall: function getCall(i) {\n        if (i < 0 || i >= this.callCount) {\n            return null;\n        }\n\n        return spyCall(this, this.thisValues[i], this.args[i],\n            this.returnValues[i], this.exceptions[i],\n            this.callIds[i], this.errorsWithCallStack[i]);\n    },\n\n    getCalls: function () {\n        var calls = [];\n        var i;\n\n        for (i = 0; i < this.callCount; i++) {\n            calls.push(this.getCall(i));\n        }\n\n        return calls;\n    },\n\n    calledBefore: function calledBefore(spyFn) {\n        if (!this.called) {\n            return false;\n        }\n\n        if (!spyFn.called) {\n            return true;\n        }\n\n        return this.callIds[0] < spyFn.callIds[spyFn.callIds.length - 1];\n    },\n\n    calledAfter: function calledAfter(spyFn) {\n        if (!this.called || !spyFn.called) {\n            return false;\n        }\n\n        return this.callIds[this.callCount - 1] > spyFn.callIds[0];\n    },\n\n    calledImmediatelyBefore: function calledImmediatelyBefore(spyFn) {\n        if (!this.called || !spyFn.called) {\n            return false;\n        }\n\n        return this.callIds[this.callCount - 1] === spyFn.callIds[spyFn.callCount - 1] - 1;\n    },\n\n    calledImmediatelyAfter: function calledImmediatelyAfter(spyFn) {\n        if (!this.called || !spyFn.called) {\n            return false;\n        }\n\n        return this.callIds[this.callCount - 1] === spyFn.callIds[spyFn.callCount - 1] + 1;\n    },\n\n    withArgs: function () {\n        var args = slice.call(arguments);\n\n        if (this.fakes) {\n            var matching = this.matchingFakes(args, true).pop();\n\n            if (matching) {\n                return matching;\n            }\n        } else {\n            this.fakes = [];\n        }\n\n        var original = this;\n        var fake = this.instantiateFake();\n        fake.matchingArguments = args;\n        fake.parent = this;\n        push.call(this.fakes, fake);\n\n        if (original.defaultBehavior && original.defaultBehavior.promiseLibrary) {\n            fake.defaultBehavior = fake.defaultBehavior || createBehavior(fake);\n            fake.defaultBehavior.promiseLibrary = original.defaultBehavior.promiseLibrary;\n        }\n\n        fake.withArgs = function () {\n            return original.withArgs.apply(original, arguments);\n        };\n\n        original.args.forEach(function (arg, i) {\n            if (!fake.matches(arg)) {\n                return;\n            }\n\n            incrementCallCount.call(fake);\n            push.call(fake.thisValues, original.thisValues[i]);\n            push.call(fake.args, arg);\n            push.call(fake.returnValues, original.returnValues[i]);\n            push.call(fake.exceptions, original.exceptions[i]);\n            push.call(fake.callIds, original.callIds[i]);\n        });\n\n        createCallProperties.call(fake);\n\n        return fake;\n    },\n\n    matchingFakes: function (args, strict) {\n        return filter.call(this.fakes || [], function (fake) {\n            return fake.matches(args, strict);\n        });\n    },\n\n    matches: function (args, strict) {\n        var margs = this.matchingArguments;\n\n        if (margs.length <= args.length &&\n            deepEqual(margs, args.slice(0, margs.length))) {\n            return !strict || margs.length === args.length;\n        }\n\n        return undefined;\n    },\n\n    printf: function (format) {\n        var spyInstance = this;\n        var args = slice.call(arguments, 1);\n        var formatter;\n\n        return (format || \"\").replace(/%(.)/g, function (match, specifyer) {\n            formatter = spyApi.formatters[specifyer];\n\n            if (typeof formatter === \"function\") {\n                return String(formatter.call(null, spyInstance, args));\n            } else if (!isNaN(parseInt(specifyer, 10))) {\n                return sinonFormat(args[specifyer - 1]);\n            }\n\n            return \"%\" + specifyer;\n        });\n    }\n};\n\nfunction delegateToCalls(method, matchAny, actual, returnsValues, notCalled, totalCallCount) {\n    spyApi[method] = function () {\n        if (!this.called) {\n            if (notCalled) {\n                return notCalled.apply(this, arguments);\n            }\n            return false;\n        }\n\n        if (totalCallCount !== undefined && this.callCount !== totalCallCount) {\n            return false;\n        }\n\n        var currentCall;\n        var matches = 0;\n        var returnValues = [];\n\n        for (var i = 0, l = this.callCount; i < l; i += 1) {\n            currentCall = this.getCall(i);\n            var returnValue = currentCall[actual || method].apply(currentCall, arguments);\n            returnValues.push(returnValue);\n            if (returnValue) {\n                matches += 1;\n\n                if (matchAny) {\n                    return true;\n                }\n            }\n        }\n\n        if (returnsValues) {\n            return returnValues;\n        }\n        return matches === this.callCount;\n    };\n}\n\nspyApi.reset = deprecated.wrap(spyApi.resetHistory, deprecated.defaultMsg(\"reset\"));\n\ndelegateToCalls(\"calledOn\", true);\ndelegateToCalls(\"alwaysCalledOn\", false, \"calledOn\");\ndelegateToCalls(\"calledWith\", true);\ndelegateToCalls(\"calledOnceWith\", true, \"calledWith\", false, undefined, 1);\ndelegateToCalls(\"calledWithMatch\", true);\ndelegateToCalls(\"alwaysCalledWith\", false, \"calledWith\");\ndelegateToCalls(\"alwaysCalledWithMatch\", false, \"calledWithMatch\");\ndelegateToCalls(\"calledWithExactly\", true);\ndelegateToCalls(\"calledOnceWithExactly\", true, \"calledWithExactly\", false, undefined, 1);\ndelegateToCalls(\"alwaysCalledWithExactly\", false, \"calledWithExactly\");\ndelegateToCalls(\"neverCalledWith\", false, \"notCalledWith\", false, function () {\n    return true;\n});\ndelegateToCalls(\"neverCalledWithMatch\", false, \"notCalledWithMatch\", false, function () {\n    return true;\n});\ndelegateToCalls(\"threw\", true);\ndelegateToCalls(\"alwaysThrew\", false, \"threw\");\ndelegateToCalls(\"returned\", true);\ndelegateToCalls(\"alwaysReturned\", false, \"returned\");\ndelegateToCalls(\"calledWithNew\", true);\ndelegateToCalls(\"alwaysCalledWithNew\", false, \"calledWithNew\");\ndelegateToCalls(\"callArg\", false, \"callArgWith\", true, function () {\n    throw new Error(this.toString() + \" cannot call arg since it was not yet invoked.\");\n});\nspyApi.callArgWith = spyApi.callArg;\ndelegateToCalls(\"callArgOn\", false, \"callArgOnWith\", true, function () {\n    throw new Error(this.toString() + \" cannot call arg since it was not yet invoked.\");\n});\nspyApi.callArgOnWith = spyApi.callArgOn;\ndelegateToCalls(\"throwArg\", false, \"throwArg\", false, function () {\n    throw new Error(this.toString() + \" cannot throw arg since it was not yet invoked.\");\n});\ndelegateToCalls(\"yield\", false, \"yield\", true, function () {\n    throw new Error(this.toString() + \" cannot yield since it was not yet invoked.\");\n});\n// \"invokeCallback\" is an alias for \"yield\" since \"yield\" is invalid in strict mode.\nspyApi.invokeCallback = spyApi.yield;\ndelegateToCalls(\"yieldOn\", false, \"yieldOn\", true, function () {\n    throw new Error(this.toString() + \" cannot yield since it was not yet invoked.\");\n});\ndelegateToCalls(\"yieldTo\", false, \"yieldTo\", true, function (property) {\n    throw new Error(this.toString() + \" cannot yield to '\" + valueToString(property) +\n        \"' since it was not yet invoked.\");\n});\ndelegateToCalls(\"yieldToOn\", false, \"yieldToOn\", true, function (property) {\n    throw new Error(this.toString() + \" cannot yield to '\" + valueToString(property) +\n        \"' since it was not yet invoked.\");\n});\n\nextend(spy, spyApi);\nspy.spyCall = spyCall;\nmodule.exports = spy;\n","\"use strict\";\n\nvar getPropertyDescriptor = require(\"./util/core/get-property-descriptor\");\nvar walk = require(\"./util/core/walk\");\n\nfunction stubEntireObject(stub, object) {\n    walk(object || {}, function (prop, propOwner) {\n        // we don't want to stub things like toString(), valueOf(), etc. so we only stub if the object\n        // is not Object.prototype\n        if (\n            propOwner !== Object.prototype &&\n            prop !== \"constructor\" &&\n            typeof getPropertyDescriptor(propOwner, prop).value === \"function\"\n        ) {\n            stub(object, prop);\n        }\n    });\n\n    return object;\n}\n\nmodule.exports = stubEntireObject;\n","\"use strict\";\n\nvar behavior = require(\"./behavior\");\nvar behaviors = require(\"./default-behaviors\");\nvar spy = require(\"./spy\");\nvar extend = require(\"./util/core/extend\");\nvar functionToString = require(\"./util/core/function-to-string\");\nvar getPropertyDescriptor = require(\"./util/core/get-property-descriptor\");\nvar isEsModule = require(\"./util/core/is-es-module\");\nvar wrapMethod = require(\"./util/core/wrap-method\");\nvar stubEntireObject = require(\"./stub-entire-object\");\nvar throwOnFalsyObject = require(\"./throw-on-falsy-object\");\nvar valueToString = require(\"./util/core/value-to-string\");\n\nvar slice = Array.prototype.slice;\n\nfunction stub(object, property) {\n    if (arguments.length > 2) {\n        throw new TypeError(\"stub(obj, 'meth', fn) has been removed, see documentation\");\n    }\n\n    if (isEsModule(object)) {\n        throw new TypeError(\"ES Modules cannot be stubbed\");\n    }\n\n    throwOnFalsyObject.apply(null, arguments);\n\n    if (object && typeof property !== \"undefined\" && !(property in object)) {\n        throw new TypeError(\"Cannot stub non-existent own property \" + valueToString(property));\n    }\n\n    var actualDescriptor = getPropertyDescriptor(object, property);\n    var isStubbingEntireObject = typeof property === \"undefined\" && typeof object === \"object\";\n    var isCreatingNewStub = !object && typeof property === \"undefined\";\n    var isStubbingNonFuncProperty = (typeof object === \"object\" || typeof object === \"function\")\n                                    && typeof property !== \"undefined\"\n                                    && (typeof actualDescriptor === \"undefined\"\n                                    || typeof actualDescriptor.value !== \"function\")\n                                    && typeof descriptor === \"undefined\";\n    var isStubbingExistingMethod = typeof object === \"object\"\n                                    && typeof actualDescriptor !== \"undefined\"\n                                    && typeof actualDescriptor.value === \"function\";\n    var arity = isStubbingExistingMethod ? object[property].length : 0;\n\n    if (isStubbingEntireObject) {\n        return stubEntireObject(stub, object);\n    }\n\n    if (isCreatingNewStub) {\n        return stub.create();\n    }\n\n    var s = stub.create(arity);\n    s.rootObj = object;\n    s.propName = property;\n    s.restore = function restore() {\n        if (actualDescriptor !== undefined) {\n            Object.defineProperty(object, property, actualDescriptor);\n            return;\n        }\n\n        delete object[property];\n    };\n\n    return isStubbingNonFuncProperty ? s : wrapMethod(object, property, s);\n}\n\nstub.createStubInstance = function (constructor) {\n    if (typeof constructor !== \"function\") {\n        throw new TypeError(\"The constructor should be a function.\");\n    }\n    return stub(Object.create(constructor.prototype));\n};\n\n/*eslint-disable no-use-before-define*/\nfunction getParentBehaviour(stubInstance) {\n    return (stubInstance.parent && getCurrentBehavior(stubInstance.parent));\n}\n\nfunction getDefaultBehavior(stubInstance) {\n    return stubInstance.defaultBehavior ||\n            getParentBehaviour(stubInstance) ||\n            behavior.create(stubInstance);\n}\n\nfunction getCurrentBehavior(stubInstance) {\n    var currentBehavior = stubInstance.behaviors[stubInstance.callCount - 1];\n    return currentBehavior && currentBehavior.isPresent() ? currentBehavior : getDefaultBehavior(stubInstance);\n}\n/*eslint-enable no-use-before-define*/\n\nvar uuid = 0;\n\nvar proto = {\n    create: function create(stubLength) {\n        var functionStub = function () {\n            var args = slice.call(arguments);\n            var matchings = functionStub.matchingFakes(args);\n\n            var fnStub = matchings.sort(function (a, b) {\n                return a.matchingArguments.length - b.matchingArguments.length;\n            }).pop() || functionStub;\n            return getCurrentBehavior(fnStub).invoke(this, arguments);\n        };\n\n        functionStub.id = \"stub#\" + uuid++;\n        var orig = functionStub;\n        functionStub = spy.create(functionStub, stubLength);\n        functionStub.func = orig;\n\n        extend(functionStub, stub);\n        functionStub.instantiateFake = stub.create;\n        functionStub.displayName = \"stub\";\n        functionStub.toString = functionToString;\n\n        functionStub.defaultBehavior = null;\n        functionStub.behaviors = [];\n\n        return functionStub;\n    },\n\n    resetBehavior: function () {\n        var fakes = this.fakes || [];\n\n        this.defaultBehavior = null;\n        this.behaviors = [];\n\n        delete this.returnValue;\n        delete this.returnArgAt;\n        delete this.throwArgAt;\n        delete this.fakeFn;\n        this.returnThis = false;\n        this.resolveThis = false;\n\n        fakes.forEach(function (fake) {\n            fake.resetBehavior();\n        });\n    },\n\n    resetHistory: spy.resetHistory,\n\n    reset: function () {\n        this.resetHistory();\n        this.resetBehavior();\n    },\n\n    onCall: function onCall(index) {\n        if (!this.behaviors[index]) {\n            this.behaviors[index] = behavior.create(this);\n        }\n\n        return this.behaviors[index];\n    },\n\n    onFirstCall: function onFirstCall() {\n        return this.onCall(0);\n    },\n\n    onSecondCall: function onSecondCall() {\n        return this.onCall(1);\n    },\n\n    onThirdCall: function onThirdCall() {\n        return this.onCall(2);\n    }\n};\n\nObject.keys(behavior).forEach(function (method) {\n    if (behavior.hasOwnProperty(method) &&\n        !proto.hasOwnProperty(method) &&\n        method !== \"create\" &&\n        method !== \"withArgs\" &&\n        method !== \"invoke\") {\n        proto[method] = behavior.createBehavior(method);\n    }\n});\n\nObject.keys(behaviors).forEach(function (method) {\n    if (behaviors.hasOwnProperty(method) && !proto.hasOwnProperty(method)) {\n        behavior.addBehavior(stub, method, behaviors[method]);\n    }\n});\n\nextend(stub, proto);\nmodule.exports = stub;\n","\"use strict\";\nvar valueToString = require(\"./util/core/value-to-string\");\n\nfunction throwOnFalsyObject(object, property) {\n    if (property && !object) {\n        var type = object === null ? \"null\" : \"undefined\";\n        throw new Error(\"Trying to stub property '\" + valueToString(property) + \"' of \" + type);\n    }\n}\n\nmodule.exports = throwOnFalsyObject;\n","\"use strict\";\n\nvar every = Array.prototype.every;\n\nmodule.exports = function calledInOrder(spies) {\n    var callMap = {};\n\n    function hasCallsLeft(spy) {\n        if (callMap[spy.id] === undefined) {\n            callMap[spy.id] = 0;\n        }\n\n        return callMap[spy.id] < spy.callCount;\n    }\n\n    if (arguments.length > 1) {\n        spies = arguments;\n    }\n\n    return every.call(spies, function checkAdjacentCalls(spy, i) {\n        var calledBeforeNext = true;\n\n        if (i !== spies.length - 1) {\n            calledBeforeNext = spy.calledBefore(spies[i + 1]);\n        }\n\n        if (hasCallsLeft(spy) && calledBeforeNext) {\n            callMap[spy.id] += 1;\n            return true;\n        }\n\n        return false;\n    });\n};\n","\"use strict\";\n\nvar div = typeof document !== \"undefined\" && document.createElement(\"div\");\n\nfunction isReallyNaN(val) {\n    return val !== val;\n}\n\nfunction isDOMNode(obj) {\n    var success = false;\n\n    try {\n        obj.appendChild(div);\n        success = div.parentNode === obj;\n    } catch (e) {\n        return false;\n    } finally {\n        try {\n            obj.removeChild(div);\n        } catch (e) {\n            // Remove failed, not much we can do about that\n        }\n    }\n\n    return success;\n}\n\nfunction isElement(obj) {\n    return div && obj && obj.nodeType === 1 && isDOMNode(obj);\n}\n\nvar deepEqual = module.exports = function deepEqual(a, b) {\n    if (typeof a !== \"object\" || typeof b !== \"object\") {\n        return isReallyNaN(a) && isReallyNaN(b) || a === b;\n    }\n\n    if (isElement(a) || isElement(b)) {\n        return a === b;\n    }\n\n    if (a === b) {\n        return true;\n    }\n\n    if ((a === null && b !== null) || (a !== null && b === null)) {\n        return false;\n    }\n\n    if (a instanceof RegExp && b instanceof RegExp) {\n        return (a.source === b.source) && (a.global === b.global) &&\n            (a.ignoreCase === b.ignoreCase) && (a.multiline === b.multiline);\n    }\n\n    if (a instanceof Error && b instanceof Error) {\n        return a === b;\n    }\n\n    var aString = Object.prototype.toString.call(a);\n    if (aString !== Object.prototype.toString.call(b)) {\n        return false;\n    }\n\n    if (aString === \"[object Date]\") {\n        return a.valueOf() === b.valueOf();\n    }\n\n    var prop;\n    var aLength = 0;\n    var bLength = 0;\n\n    if (aString === \"[object Array]\" && a.length !== b.length) {\n        return false;\n    }\n\n    for (prop in a) {\n        if (Object.prototype.hasOwnProperty.call(a, prop)) {\n            aLength += 1;\n\n            if (!(prop in b)) {\n                return false;\n            }\n\n            // allow alternative function for recursion\n            if (!(arguments[2] || deepEqual)(a[prop], b[prop])) {\n                return false;\n            }\n        }\n    }\n\n    for (prop in b) {\n        if (Object.prototype.hasOwnProperty.call(b, prop)) {\n            bLength += 1;\n        }\n    }\n\n    return aLength === bLength;\n};\n\ndeepEqual.use = function (match) {\n    return function deepEqual$matcher(a, b) {\n        // If both are matchers they must be the same instance in order to be considered equal\n        // If we didn't do that we would end up running one matcher against the other\n        if (match.isMatcher(a)) {\n            if (match.isMatcher(b)) {\n                return a === b;\n            }\n\n            return a.test(b);\n        }\n\n        return deepEqual(a, b, deepEqual$matcher);\n    };\n};\n","\"use strict\";\n\nmodule.exports = {\n    injectIntoThis: true,\n    injectInto: null,\n    properties: [\"spy\", \"stub\", \"mock\", \"clock\", \"server\", \"requests\"],\n    useFakeTimers: true,\n    useFakeServer: true\n};\n","/*eslint no-console: 0 */\n\"use strict\";\n\n// wrap returns a function that will invoke the supplied function and print a deprecation warning to the console each\n// time it is called.\nexports.wrap = function (func, msg) {\n    var wrapped = function () {\n        exports.printWarning(msg);\n        return func.apply(this, arguments);\n    };\n    if (func.prototype) {\n        wrapped.prototype = func.prototype;\n    }\n    return wrapped;\n};\n\n// defaultMsg returns a string which can be supplied to `wrap()` to notify the user that a particular part of the\n// sinon API has been deprecated.\nexports.defaultMsg = function (funcName) {\n    return \"sinon.\" + funcName + \" is deprecated and will be removed from the public API in a future version of sinon.\";\n};\n\nexports.printWarning = function (msg) {\n    // Watch out for IE7 and below! :(\n    if (typeof console !== \"undefined\") {\n        if (console.info) {\n            console.info(msg);\n        } else {\n            console.log(msg);\n        }\n    }\n};\n","\"use strict\";\n\n// This is an `every` implementation that works for all iterables\nmodule.exports = function every(obj, fn) {\n    var pass = true;\n\n    try {\n        obj.forEach(function () {\n            if (!fn.apply(this, arguments)) {\n                // Throwing an error is the only way to break `forEach`\n                throw new Error();\n            }\n        });\n    } catch (e) {\n        pass = false;\n    }\n\n    return pass;\n};\n","\"use strict\";\n\n// Adapted from https://developer.mozilla.org/en/docs/ECMAScript_DontEnum_attribute#JScript_DontEnum_Bug\nvar hasDontEnumBug = (function () {\n    var obj = {\n        constructor: function () {\n            return \"0\";\n        },\n        toString: function () {\n            return \"1\";\n        },\n        valueOf: function () {\n            return \"2\";\n        },\n        toLocaleString: function () {\n            return \"3\";\n        },\n        prototype: function () {\n            return \"4\";\n        },\n        isPrototypeOf: function () {\n            return \"5\";\n        },\n        propertyIsEnumerable: function () {\n            return \"6\";\n        },\n        hasOwnProperty: function () {\n            return \"7\";\n        },\n        length: function () {\n            return \"8\";\n        },\n        unique: function () {\n            return \"9\";\n        }\n    };\n\n    var result = [];\n    for (var prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n            result.push(obj[prop]());\n        }\n    }\n    return result.join(\"\") !== \"0123456789\";\n})();\n\n/* Public: Extend target in place with all (own) properties from sources in-order. Thus, last source will\n *         override properties in previous sources.\n *\n * target - The Object to extend\n * sources - Objects to copy properties from.\n *\n * Returns the extended target\n */\nmodule.exports = function extend(target /*, sources */) {\n    var sources = Array.prototype.slice.call(arguments, 1);\n    var source, i, prop;\n\n    for (i = 0; i < sources.length; i++) {\n        source = sources[i];\n\n        for (prop in source) {\n            if (source.hasOwnProperty(prop)) {\n                target[prop] = source[prop];\n            }\n        }\n\n        // Make sure we copy (own) toString method even when in JScript with DontEnum bug\n        // See https://developer.mozilla.org/en/docs/ECMAScript_DontEnum_attribute#JScript_DontEnum_Bug\n        if (hasDontEnumBug && source.hasOwnProperty(\"toString\") && source.toString !== target.toString) {\n            target.toString = source.toString;\n        }\n    }\n\n    return target;\n};\n","\"use strict\";\n\nvar formatio = require(\"@sinonjs/formatio\");\n\nvar formatter = formatio.configure({\n    quoteStrings: false,\n    limitChildrenCount: 250\n});\n\nvar customFormatter;\n\nfunction format() {\n    if (customFormatter) {\n        return customFormatter.apply(null, arguments);\n    }\n\n    return formatter.ascii.apply(formatter, arguments);\n}\n\nformat.setFormatter = function (aCustomFormatter) {\n    if (typeof aCustomFormatter !== \"function\") {\n        throw new Error(\"format.setFormatter must be called with a function\");\n    }\n\n    customFormatter = aCustomFormatter;\n};\n\nmodule.exports = format;\n","\"use strict\";\n\nmodule.exports = function functionName(func) {\n    var name = func.displayName || func.name;\n    var matches;\n\n    // Use function decomposition as a last resort to get function\n    // name. Does not rely on function decomposition to work - if it\n    // doesn't debugging will be slightly less informative\n    // (i.e. toString will say 'spy' rather than 'myFunc').\n    if (!name && (matches = func.toString().match(/function ([^\\s\\(]+)/))) {\n        name = matches[1];\n    }\n\n    return name;\n};\n\n","\"use strict\";\n\nmodule.exports = function toString() {\n    var i, prop, thisValue;\n    if (this.getCall && this.callCount) {\n        i = this.callCount;\n\n        while (i--) {\n            thisValue = this.getCall(i).thisValue;\n\n            for (prop in thisValue) {\n                if (thisValue[prop] === this) {\n                    return prop;\n                }\n            }\n        }\n    }\n\n    return this.displayName || \"sinon fake\";\n};\n","\"use strict\";\n\nmodule.exports = function getPropertyDescriptor(object, property) {\n    var proto = object;\n    var descriptor;\n\n    while (proto && !(descriptor = Object.getOwnPropertyDescriptor(proto, property))) {\n        proto = Object.getPrototypeOf(proto);\n    }\n    return descriptor;\n};\n","\"use strict\";\n\n/**\n * Verify if an object is a ECMAScript Module\n *\n * As the exports from a module is immutable we cannot alter the exports\n * using spies or stubs. Let the consumer know this to avoid bug reports\n * on weird error messages.\n */\nmodule.exports = function (object) {\n    return (\n        object &&\n        typeof Symbol !== \"undefined\" &&\n        object[Symbol.toStringTag] === \"Module\"\n    );\n};\n","\"use strict\";\nvar typeOf = require(\"./typeOf\");\n\nmodule.exports = function iterableToString(obj) {\n    var representation = \"\";\n\n    function stringify(item) {\n        return typeof item === \"string\" ? \"'\" + item + \"'\" : String(item);\n    }\n\n    function mapToString(map) {\n        map.forEach(function (value, key) {\n            representation += \"[\" + stringify(key) + \",\" + stringify(value) + \"],\";\n        });\n\n        representation = representation.slice(0, -1);\n        return representation;\n    }\n\n    function genericIterableToString(iterable) {\n        iterable.forEach(function (value) {\n            representation += stringify(value) + \",\";\n        });\n\n        representation = representation.slice(0, -1);\n        return representation;\n    }\n\n    if (typeOf(obj) === \"map\") {\n        return mapToString(obj);\n    }\n\n    return genericIterableToString(obj);\n};\n","\"use strict\";\n\nmodule.exports = function orderByFirstCall(spies) {\n    return spies.sort(function (a, b) {\n        // uuid, won't ever be equal\n        var aCall = a.getCall(0);\n        var bCall = b.getCall(0);\n        var aId = aCall && aCall.callId || -1;\n        var bId = bCall && bCall.callId || -1;\n\n        return aId < bId ? -1 : 1;\n    });\n};\n","\"use strict\";\n\nvar array = [null, \"once\", \"twice\", \"thrice\"];\n\nmodule.exports = function timesInWords(count) {\n    return array[count] || (count || 0) + \" times\";\n};\n","\"use strict\";\n\nvar type = require(\"type-detect\");\n\nmodule.exports = function typeOf(value) {\n    return type(value).toLowerCase();\n};\n","\"use strict\";\n\nmodule.exports = function (value) {\n    if (value && value.toString) {\n        return value.toString();\n    }\n    return String(value);\n};\n","\"use strict\";\n\nfunction walkInternal(obj, iterator, context, originalObj, seen) {\n    var proto, prop;\n\n    if (typeof Object.getOwnPropertyNames !== \"function\") {\n        // We explicitly want to enumerate through all of the prototype's properties\n        // in this case, therefore we deliberately leave out an own property check.\n        /* eslint-disable guard-for-in */\n        for (prop in obj) {\n            iterator.call(context, obj[prop], prop, obj);\n        }\n        /* eslint-enable guard-for-in */\n\n        return;\n    }\n\n    Object.getOwnPropertyNames(obj).forEach(function (k) {\n        if (seen[k] !== true) {\n            seen[k] = true;\n            var target = typeof Object.getOwnPropertyDescriptor(obj, k).get === \"function\" ?\n                originalObj : obj;\n            iterator.call(context, k, target);\n        }\n    });\n\n    proto = Object.getPrototypeOf(obj);\n    if (proto) {\n        walkInternal(proto, iterator, context, originalObj, seen);\n    }\n}\n\n/* Walks the prototype chain of an object and iterates over every own property\n * name encountered. The iterator is called in the same fashion that Array.prototype.forEach\n * works, where it is passed the value, key, and own object as the 1st, 2nd, and 3rd positional\n * argument, respectively. In cases where Object.getOwnPropertyNames is not available, walk will\n * default to using a simple for..in loop.\n *\n * obj - The object to walk the prototype chain for.\n * iterator - The function to be called on each pass of the walk.\n * context - (Optional) When given, the iterator will be called with this object as the receiver.\n */\nmodule.exports = function walk(obj, iterator, context) {\n    return walkInternal(obj, iterator, context, obj, {});\n};\n","\"use strict\";\n\nvar getPropertyDescriptor = require(\"./get-property-descriptor\");\nvar valueToString = require(\"./value-to-string\");\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n\nfunction isFunction(obj) {\n    return typeof obj === \"function\" || !!(obj && obj.constructor && obj.call && obj.apply);\n}\n\nfunction mirrorProperties(target, source) {\n    for (var prop in source) {\n        if (!hasOwn.call(target, prop)) {\n            target[prop] = source[prop];\n        }\n    }\n}\n\n// Cheap way to detect if we have ES5 support.\nvar hasES5Support = \"keys\" in Object;\n\nmodule.exports = function wrapMethod(object, property, method) {\n    if (!object) {\n        throw new TypeError(\"Should wrap property of object\");\n    }\n\n    if (typeof method !== \"function\" && typeof method !== \"object\") {\n        throw new TypeError(\"Method wrapper should be a function or a property descriptor\");\n    }\n\n    function checkWrappedMethod(wrappedMethod) {\n        var error;\n\n        if (!isFunction(wrappedMethod)) {\n            error = new TypeError(\"Attempted to wrap \" + (typeof wrappedMethod) + \" property \" +\n                                valueToString(property) + \" as function\");\n        } else if (wrappedMethod.restore && wrappedMethod.restore.sinon) {\n            error = new TypeError(\"Attempted to wrap \" + valueToString(property) + \" which is already wrapped\");\n        } else if (wrappedMethod.calledBefore) {\n            var verb = wrappedMethod.returns ? \"stubbed\" : \"spied on\";\n            error = new TypeError(\"Attempted to wrap \" + valueToString(property) + \" which is already \" + verb);\n        }\n\n        if (error) {\n            if (wrappedMethod && wrappedMethod.stackTraceError) {\n                error.stack += \"\\n--------------\\n\" + wrappedMethod.stackTraceError.stack;\n            }\n            throw error;\n        }\n    }\n\n    var error, wrappedMethod, i;\n\n    function simplePropertyAssignment() {\n        wrappedMethod = object[property];\n        checkWrappedMethod(wrappedMethod);\n        object[property] = method;\n        method.displayName = property;\n    }\n\n    // Firefox has a problem when using hasOwn.call on objects from other frames.\n    var owned = object.hasOwnProperty ? object.hasOwnProperty(property) : hasOwn.call(object, property);\n\n    if (hasES5Support) {\n        var methodDesc = (typeof method === \"function\") ? {value: method} : method;\n        var wrappedMethodDesc = getPropertyDescriptor(object, property);\n\n        if (!wrappedMethodDesc) {\n            error = new TypeError(\"Attempted to wrap \" + (typeof wrappedMethod) + \" property \" +\n                                property + \" as function\");\n        } else if (wrappedMethodDesc.restore && wrappedMethodDesc.restore.sinon) {\n            error = new TypeError(\"Attempted to wrap \" + property + \" which is already wrapped\");\n        }\n        if (error) {\n            if (wrappedMethodDesc && wrappedMethodDesc.stackTraceError) {\n                error.stack += \"\\n--------------\\n\" + wrappedMethodDesc.stackTraceError.stack;\n            }\n            throw error;\n        }\n\n        var types = Object.keys(methodDesc);\n        for (i = 0; i < types.length; i++) {\n            wrappedMethod = wrappedMethodDesc[types[i]];\n            checkWrappedMethod(wrappedMethod);\n        }\n\n        mirrorProperties(methodDesc, wrappedMethodDesc);\n        for (i = 0; i < types.length; i++) {\n            mirrorProperties(methodDesc[types[i]], wrappedMethodDesc[types[i]]);\n        }\n        Object.defineProperty(object, property, methodDesc);\n\n        // catch failing assignment\n        // this is the converse of the check in `.restore` below\n        if ( typeof method === \"function\" && object[property] !== method ) {\n            // correct any wrongdoings caused by the defineProperty call above,\n            // such as adding new items (if object was a Storage object)\n            delete object[property];\n            simplePropertyAssignment();\n        }\n    } else {\n        simplePropertyAssignment();\n    }\n\n    method.displayName = property;\n\n    // Set up an Error object for a stack trace which can be used later to find what line of\n    // code the original method was created on.\n    method.stackTraceError = (new Error(\"Stack Trace for original\"));\n\n    method.restore = function () {\n        // For prototype properties try to reset by delete first.\n        // If this fails (ex: localStorage on mobile safari) then force a reset\n        // via direct assignment.\n        if (!owned) {\n            // In some cases `delete` may throw an error\n            try {\n                delete object[property];\n            } catch (e) {} // eslint-disable-line no-empty\n            // For native code functions `delete` fails without throwing an error\n            // on Chrome < 43, PhantomJS, etc.\n        } else if (hasES5Support) {\n            Object.defineProperty(object, property, wrappedMethodDesc);\n        }\n\n        if (hasES5Support) {\n            var descriptor = getPropertyDescriptor(object, property);\n            if (descriptor && descriptor.value === method) {\n                object[property] = wrappedMethod;\n            }\n        }\n        else {\n        // Use strict equality comparison to check failures then force a reset\n        // via direct assignment.\n            if (object[property] === method) {\n                object[property] = wrappedMethod;\n            }\n        }\n    };\n\n    method.wrappedMethod = wrappedMethod;\n\n    method.restore.sinon = true;\n\n    if (!hasES5Support) {\n        mirrorProperties(method, wrappedMethod);\n    }\n\n    return method;\n};\n","\"use strict\";\n\nvar llx = require(\"lolex\");\n\n/**\n * @param config {number|Date|Object} the unix epoch value to install with (default 0) or\n */\nexports.useFakeTimers = function (args) {\n    var config = {};\n\n    if (typeof args === \"undefined\" || args === null) {\n        config.now = 0;\n    } else if ((typeof args === \"number\" || args instanceof Date) && arguments.length === 1) {\n        config.now = args;\n    } else if (args !== null && typeof args === \"object\" && arguments.length === 1) {\n        var keys = Object.keys(args);\n        for (var i = 0; i < keys.length; i++) {\n            if (args.hasOwnProperty(keys[i])) {\n                config[keys[i]] = args[keys[i]];\n            }\n        }\n    } else {\n        throw new TypeError(\"useFakeTimers expected epoch or config object. See https://github.com/sinonjs/sinon\");\n    }\n\n    var clock = llx.install(config);\n    clock.restore = clock.uninstall;\n    return clock;\n};\n\nexports.clock = {\n    create: function (now) {\n        return llx.createClock(now);\n    }\n};\n\nexports.timers = {\n    setTimeout: setTimeout,\n    clearTimeout: clearTimeout,\n    setImmediate: (typeof setImmediate !== \"undefined\" ? setImmediate : undefined),\n    clearImmediate: (typeof clearImmediate !== \"undefined\" ? clearImmediate : undefined),\n    setInterval: setInterval,\n    clearInterval: clearInterval,\n    Date: Date\n};\n","/*!\n\n diff v3.5.0\n\nSoftware License Agreement (BSD License)\n\nCopyright (c) 2009-2015, Kevin Decker <kpdecker@gmail.com>\n\nAll rights reserved.\n\nRedistribution and use of this software in source and binary forms, with or without modification,\nare permitted provided that the following conditions are met:\n\n* Redistributions of source code must retain the above\n  copyright notice, this list of conditions and the\n  following disclaimer.\n\n* Redistributions in binary form must reproduce the above\n  copyright notice, this list of conditions and the\n  following disclaimer in the documentation and/or other\n  materials provided with the distribution.\n\n* Neither the name of Kevin Decker nor the names of its\n  contributors may be used to endorse or promote products\n  derived from this software without specific prior\n  written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR\nIMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND\nFITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\nCONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER\nIN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n@license\n*/\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JsDiff\"] = factory();\n\telse\n\t\troot[\"JsDiff\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n\n\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.canonicalize = exports.convertChangesToXML = exports.convertChangesToDMP = exports.merge = exports.parsePatch = exports.applyPatches = exports.applyPatch = exports.createPatch = exports.createTwoFilesPatch = exports.structuredPatch = exports.diffArrays = exports.diffJson = exports.diffCss = exports.diffSentences = exports.diffTrimmedLines = exports.diffLines = exports.diffWordsWithSpace = exports.diffWords = exports.diffChars = exports.Diff = undefined;\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_character = __webpack_require__(2) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_word = __webpack_require__(3) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_sentence = __webpack_require__(6) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_css = __webpack_require__(7) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_json = __webpack_require__(8) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_array = __webpack_require__(9) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_apply = __webpack_require__(10) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_merge = __webpack_require__(13) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_create = __webpack_require__(14) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_dmp = __webpack_require__(16) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_xml = __webpack_require__(17) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/* See LICENSE file for terms of use */\n\n\t/*\n\t * Text diff implementation.\n\t *\n\t * This library supports the following APIS:\n\t * JsDiff.diffChars: Character by character diff\n\t * JsDiff.diffWords: Word (as defined by \\b regex) diff which ignores whitespace\n\t * JsDiff.diffLines: Line based diff\n\t *\n\t * JsDiff.diffCss: Diff targeted at CSS content\n\t *\n\t * These methods are based on the implementation proposed in\n\t * \"An O(ND) Difference Algorithm and its Variations\" (Myers, 1986).\n\t * http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.4.6927\n\t */\n\texports. /*istanbul ignore end*/Diff = _base2['default'];\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffChars = _character.diffChars;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWords = _word.diffWords;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWordsWithSpace = _word.diffWordsWithSpace;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffLines = _line.diffLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffTrimmedLines = _line.diffTrimmedLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffSentences = _sentence.diffSentences;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffCss = _css.diffCss;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffJson = _json.diffJson;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffArrays = _array.diffArrays;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/structuredPatch = _create.structuredPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createTwoFilesPatch = _create.createTwoFilesPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createPatch = _create.createPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatch = _apply.applyPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatches = _apply.applyPatches;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/parsePatch = _parse.parsePatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/merge = _merge.merge;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/convertChangesToDMP = _dmp.convertChangesToDMP;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/convertChangesToXML = _xml.convertChangesToXML;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/canonicalize = _json.canonicalize;\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJEaWZmIiwiZGlmZkNoYXJzIiwiZGlmZldvcmRzIiwiZGlmZldvcmRzV2l0aFNwYWNlIiwiZGlmZkxpbmVzIiwiZGlmZlRyaW1tZWRMaW5lcyIsImRpZmZTZW50ZW5jZXMiLCJkaWZmQ3NzIiwiZGlmZkpzb24iLCJkaWZmQXJyYXlzIiwic3RydWN0dXJlZFBhdGNoIiwiY3JlYXRlVHdvRmlsZXNQYXRjaCIsImNyZWF0ZVBhdGNoIiwiYXBwbHlQYXRjaCIsImFwcGx5UGF0Y2hlcyIsInBhcnNlUGF0Y2giLCJtZXJnZSIsImNvbnZlcnRDaGFuZ2VzVG9ETVAiLCJjb252ZXJ0Q2hhbmdlc1RvWE1MIiwiY2Fub25pY2FsaXplIl0sIm1hcHBpbmdzIjoiOzs7Ozt1QkFnQkE7Ozs7dUJBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBRUE7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7Ozs7QUFqQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7O2dDQWtDRUEsSTt5REFFQUMsUzt5REFDQUMsUzt5REFDQUMsa0I7eURBQ0FDLFM7eURBQ0FDLGdCO3lEQUNBQyxhO3lEQUVBQyxPO3lEQUNBQyxRO3lEQUVBQyxVO3lEQUVBQyxlO3lEQUNBQyxtQjt5REFDQUMsVzt5REFDQUMsVTt5REFDQUMsWTt5REFDQUMsVTt5REFDQUMsSzt5REFDQUMsbUI7eURBQ0FDLG1CO3lEQUNBQyxZIiwiZmlsZSI6ImluZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogU2VlIExJQ0VOU0UgZmlsZSBmb3IgdGVybXMgb2YgdXNlICovXG5cbi8qXG4gKiBUZXh0IGRpZmYgaW1wbGVtZW50YXRpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IHN1cHBvcnRzIHRoZSBmb2xsb3dpbmcgQVBJUzpcbiAqIEpzRGlmZi5kaWZmQ2hhcnM6IENoYXJhY3RlciBieSBjaGFyYWN0ZXIgZGlmZlxuICogSnNEaWZmLmRpZmZXb3JkczogV29yZCAoYXMgZGVmaW5lZCBieSBcXGIgcmVnZXgpIGRpZmYgd2hpY2ggaWdub3JlcyB3aGl0ZXNwYWNlXG4gKiBKc0RpZmYuZGlmZkxpbmVzOiBMaW5lIGJhc2VkIGRpZmZcbiAqXG4gKiBKc0RpZmYuZGlmZkNzczogRGlmZiB0YXJnZXRlZCBhdCBDU1MgY29udGVudFxuICpcbiAqIFRoZXNlIG1ldGhvZHMgYXJlIGJhc2VkIG9uIHRoZSBpbXBsZW1lbnRhdGlvbiBwcm9wb3NlZCBpblxuICogXCJBbiBPKE5EKSBEaWZmZXJlbmNlIEFsZ29yaXRobSBhbmQgaXRzIFZhcmlhdGlvbnNcIiAoTXllcnMsIDE5ODYpLlxuICogaHR0cDovL2NpdGVzZWVyeC5pc3QucHN1LmVkdS92aWV3ZG9jL3N1bW1hcnk/ZG9pPTEwLjEuMS40LjY5MjdcbiAqL1xuaW1wb3J0IERpZmYgZnJvbSAnLi9kaWZmL2Jhc2UnO1xuaW1wb3J0IHtkaWZmQ2hhcnN9IGZyb20gJy4vZGlmZi9jaGFyYWN0ZXInO1xuaW1wb3J0IHtkaWZmV29yZHMsIGRpZmZXb3Jkc1dpdGhTcGFjZX0gZnJvbSAnLi9kaWZmL3dvcmQnO1xuaW1wb3J0IHtkaWZmTGluZXMsIGRpZmZUcmltbWVkTGluZXN9IGZyb20gJy4vZGlmZi9saW5lJztcbmltcG9ydCB7ZGlmZlNlbnRlbmNlc30gZnJvbSAnLi9kaWZmL3NlbnRlbmNlJztcblxuaW1wb3J0IHtkaWZmQ3NzfSBmcm9tICcuL2RpZmYvY3NzJztcbmltcG9ydCB7ZGlmZkpzb24sIGNhbm9uaWNhbGl6ZX0gZnJvbSAnLi9kaWZmL2pzb24nO1xuXG5pbXBvcnQge2RpZmZBcnJheXN9IGZyb20gJy4vZGlmZi9hcnJheSc7XG5cbmltcG9ydCB7YXBwbHlQYXRjaCwgYXBwbHlQYXRjaGVzfSBmcm9tICcuL3BhdGNoL2FwcGx5JztcbmltcG9ydCB7cGFyc2VQYXRjaH0gZnJvbSAnLi9wYXRjaC9wYXJzZSc7XG5pbXBvcnQge21lcmdlfSBmcm9tICcuL3BhdGNoL21lcmdlJztcbmltcG9ydCB7c3RydWN0dXJlZFBhdGNoLCBjcmVhdGVUd29GaWxlc1BhdGNoLCBjcmVhdGVQYXRjaH0gZnJvbSAnLi9wYXRjaC9jcmVhdGUnO1xuXG5pbXBvcnQge2NvbnZlcnRDaGFuZ2VzVG9ETVB9IGZyb20gJy4vY29udmVydC9kbXAnO1xuaW1wb3J0IHtjb252ZXJ0Q2hhbmdlc1RvWE1MfSBmcm9tICcuL2NvbnZlcnQveG1sJztcblxuZXhwb3J0IHtcbiAgRGlmZixcblxuICBkaWZmQ2hhcnMsXG4gIGRpZmZXb3JkcyxcbiAgZGlmZldvcmRzV2l0aFNwYWNlLFxuICBkaWZmTGluZXMsXG4gIGRpZmZUcmltbWVkTGluZXMsXG4gIGRpZmZTZW50ZW5jZXMsXG5cbiAgZGlmZkNzcyxcbiAgZGlmZkpzb24sXG5cbiAgZGlmZkFycmF5cyxcblxuICBzdHJ1Y3R1cmVkUGF0Y2gsXG4gIGNyZWF0ZVR3b0ZpbGVzUGF0Y2gsXG4gIGNyZWF0ZVBhdGNoLFxuICBhcHBseVBhdGNoLFxuICBhcHBseVBhdGNoZXMsXG4gIHBhcnNlUGF0Y2gsXG4gIG1lcmdlLFxuICBjb252ZXJ0Q2hhbmdlc1RvRE1QLFxuICBjb252ZXJ0Q2hhbmdlc1RvWE1MLFxuICBjYW5vbmljYWxpemVcbn07XG4iXX0=\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports['default'] = /*istanbul ignore end*/Diff;\n\tfunction Diff() {}\n\n\tDiff.prototype = {\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/diff: function diff(oldString, newString) {\n\t    /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t    var callback = options.callback;\n\t    if (typeof options === 'function') {\n\t      callback = options;\n\t      options = {};\n\t    }\n\t    this.options = options;\n\n\t    var self = this;\n\n\t    function done(value) {\n\t      if (callback) {\n\t        setTimeout(function () {\n\t          callback(undefined, value);\n\t        }, 0);\n\t        return true;\n\t      } else {\n\t        return value;\n\t      }\n\t    }\n\n\t    // Allow subclasses to massage the input prior to running\n\t    oldString = this.castInput(oldString);\n\t    newString = this.castInput(newString);\n\n\t    oldString = this.removeEmpty(this.tokenize(oldString));\n\t    newString = this.removeEmpty(this.tokenize(newString));\n\n\t    var newLen = newString.length,\n\t        oldLen = oldString.length;\n\t    var editLength = 1;\n\t    var maxEditLength = newLen + oldLen;\n\t    var bestPath = [{ newPos: -1, components: [] }];\n\n\t    // Seed editLength = 0, i.e. the content starts with the same values\n\t    var oldPos = this.extractCommon(bestPath[0], newString, oldString, 0);\n\t    if (bestPath[0].newPos + 1 >= newLen && oldPos + 1 >= oldLen) {\n\t      // Identity per the equality and tokenizer\n\t      return done([{ value: this.join(newString), count: newString.length }]);\n\t    }\n\n\t    // Main worker method. checks all permutations of a given edit length for acceptance.\n\t    function execEditLength() {\n\t      for (var diagonalPath = -1 * editLength; diagonalPath <= editLength; diagonalPath += 2) {\n\t        var basePath = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t        var addPath = bestPath[diagonalPath - 1],\n\t            removePath = bestPath[diagonalPath + 1],\n\t            _oldPos = (removePath ? removePath.newPos : 0) - diagonalPath;\n\t        if (addPath) {\n\t          // No one else is going to attempt to use this value, clear it\n\t          bestPath[diagonalPath - 1] = undefined;\n\t        }\n\n\t        var canAdd = addPath && addPath.newPos + 1 < newLen,\n\t            canRemove = removePath && 0 <= _oldPos && _oldPos < oldLen;\n\t        if (!canAdd && !canRemove) {\n\t          // If this path is a terminal then prune\n\t          bestPath[diagonalPath] = undefined;\n\t          continue;\n\t        }\n\n\t        // Select the diagonal that we want to branch from. We select the prior\n\t        // path whose position in the new string is the farthest from the origin\n\t        // and does not pass the bounds of the diff graph\n\t        if (!canAdd || canRemove && addPath.newPos < removePath.newPos) {\n\t          basePath = clonePath(removePath);\n\t          self.pushComponent(basePath.components, undefined, true);\n\t        } else {\n\t          basePath = addPath; // No need to clone, we've pulled it from the list\n\t          basePath.newPos++;\n\t          self.pushComponent(basePath.components, true, undefined);\n\t        }\n\n\t        _oldPos = self.extractCommon(basePath, newString, oldString, diagonalPath);\n\n\t        // If we have hit the end of both strings, then we are done\n\t        if (basePath.newPos + 1 >= newLen && _oldPos + 1 >= oldLen) {\n\t          return done(buildValues(self, basePath.components, newString, oldString, self.useLongestToken));\n\t        } else {\n\t          // Otherwise track this path as a potential candidate and continue.\n\t          bestPath[diagonalPath] = basePath;\n\t        }\n\t      }\n\n\t      editLength++;\n\t    }\n\n\t    // Performs the length of edit iteration. Is a bit fugly as this has to support the\n\t    // sync and async mode which is never fun. Loops over execEditLength until a value\n\t    // is produced.\n\t    if (callback) {\n\t      (function exec() {\n\t        setTimeout(function () {\n\t          // This should not happen, but we want to be safe.\n\t          /* istanbul ignore next */\n\t          if (editLength > maxEditLength) {\n\t            return callback();\n\t          }\n\n\t          if (!execEditLength()) {\n\t            exec();\n\t          }\n\t        }, 0);\n\t      })();\n\t    } else {\n\t      while (editLength <= maxEditLength) {\n\t        var ret = execEditLength();\n\t        if (ret) {\n\t          return ret;\n\t        }\n\t      }\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/pushComponent: function pushComponent(components, added, removed) {\n\t    var last = components[components.length - 1];\n\t    if (last && last.added === added && last.removed === removed) {\n\t      // We need to clone here as the component clone operation is just\n\t      // as shallow array clone\n\t      components[components.length - 1] = { count: last.count + 1, added: added, removed: removed };\n\t    } else {\n\t      components.push({ count: 1, added: added, removed: removed });\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/extractCommon: function extractCommon(basePath, newString, oldString, diagonalPath) {\n\t    var newLen = newString.length,\n\t        oldLen = oldString.length,\n\t        newPos = basePath.newPos,\n\t        oldPos = newPos - diagonalPath,\n\t        commonCount = 0;\n\t    while (newPos + 1 < newLen && oldPos + 1 < oldLen && this.equals(newString[newPos + 1], oldString[oldPos + 1])) {\n\t      newPos++;\n\t      oldPos++;\n\t      commonCount++;\n\t    }\n\n\t    if (commonCount) {\n\t      basePath.components.push({ count: commonCount });\n\t    }\n\n\t    basePath.newPos = newPos;\n\t    return oldPos;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/equals: function equals(left, right) {\n\t    if (this.options.comparator) {\n\t      return this.options.comparator(left, right);\n\t    } else {\n\t      return left === right || this.options.ignoreCase && left.toLowerCase() === right.toLowerCase();\n\t    }\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/removeEmpty: function removeEmpty(array) {\n\t    var ret = [];\n\t    for (var i = 0; i < array.length; i++) {\n\t      if (array[i]) {\n\t        ret.push(array[i]);\n\t      }\n\t    }\n\t    return ret;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/castInput: function castInput(value) {\n\t    return value;\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/tokenize: function tokenize(value) {\n\t    return value.split('');\n\t  },\n\t  /*istanbul ignore start*/ /*istanbul ignore end*/join: function join(chars) {\n\t    return chars.join('');\n\t  }\n\t};\n\n\tfunction buildValues(diff, components, newString, oldString, useLongestToken) {\n\t  var componentPos = 0,\n\t      componentLen = components.length,\n\t      newPos = 0,\n\t      oldPos = 0;\n\n\t  for (; componentPos < componentLen; componentPos++) {\n\t    var component = components[componentPos];\n\t    if (!component.removed) {\n\t      if (!component.added && useLongestToken) {\n\t        var value = newString.slice(newPos, newPos + component.count);\n\t        value = value.map(function (value, i) {\n\t          var oldValue = oldString[oldPos + i];\n\t          return oldValue.length > value.length ? oldValue : value;\n\t        });\n\n\t        component.value = diff.join(value);\n\t      } else {\n\t        component.value = diff.join(newString.slice(newPos, newPos + component.count));\n\t      }\n\t      newPos += component.count;\n\n\t      // Common case\n\t      if (!component.added) {\n\t        oldPos += component.count;\n\t      }\n\t    } else {\n\t      component.value = diff.join(oldString.slice(oldPos, oldPos + component.count));\n\t      oldPos += component.count;\n\n\t      // Reverse add and remove so removes are output first to match common convention\n\t      // The diffing algorithm is tied to add then remove output and this is the simplest\n\t      // route to get the desired output with minimal overhead.\n\t      if (componentPos && components[componentPos - 1].added) {\n\t        var tmp = components[componentPos - 1];\n\t        components[componentPos - 1] = components[componentPos];\n\t        components[componentPos] = tmp;\n\t      }\n\t    }\n\t  }\n\n\t  // Special case handle for when one terminal is ignored (i.e. whitespace).\n\t  // For this case we merge the terminal into the prior string and drop the change.\n\t  // This is only available for string mode.\n\t  var lastComponent = components[componentLen - 1];\n\t  if (componentLen > 1 && typeof lastComponent.value === 'string' && (lastComponent.added || lastComponent.removed) && diff.equals('', lastComponent.value)) {\n\t    components[componentLen - 2].value += lastComponent.value;\n\t    components.pop();\n\t  }\n\n\t  return components;\n\t}\n\n\tfunction clonePath(path) {\n\t  return { newPos: path.newPos, components: path.components.slice(0) };\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2Jhc2UuanMiXSwibmFtZXMiOlsiRGlmZiIsInByb3RvdHlwZSIsImRpZmYiLCJvbGRTdHJpbmciLCJuZXdTdHJpbmciLCJvcHRpb25zIiwiY2FsbGJhY2siLCJzZWxmIiwiZG9uZSIsInZhbHVlIiwic2V0VGltZW91dCIsInVuZGVmaW5lZCIsImNhc3RJbnB1dCIsInJlbW92ZUVtcHR5IiwidG9rZW5pemUiLCJuZXdMZW4iLCJsZW5ndGgiLCJvbGRMZW4iLCJlZGl0TGVuZ3RoIiwibWF4RWRpdExlbmd0aCIsImJlc3RQYXRoIiwibmV3UG9zIiwiY29tcG9uZW50cyIsIm9sZFBvcyIsImV4dHJhY3RDb21tb24iLCJqb2luIiwiY291bnQiLCJleGVjRWRpdExlbmd0aCIsImRpYWdvbmFsUGF0aCIsImJhc2VQYXRoIiwiYWRkUGF0aCIsInJlbW92ZVBhdGgiLCJjYW5BZGQiLCJjYW5SZW1vdmUiLCJjbG9uZVBhdGgiLCJwdXNoQ29tcG9uZW50IiwiYnVpbGRWYWx1ZXMiLCJ1c2VMb25nZXN0VG9rZW4iLCJleGVjIiwicmV0IiwiYWRkZWQiLCJyZW1vdmVkIiwibGFzdCIsInB1c2giLCJjb21tb25Db3VudCIsImVxdWFscyIsImxlZnQiLCJyaWdodCIsImNvbXBhcmF0b3IiLCJpZ25vcmVDYXNlIiwidG9Mb3dlckNhc2UiLCJhcnJheSIsImkiLCJzcGxpdCIsImNoYXJzIiwiY29tcG9uZW50UG9zIiwiY29tcG9uZW50TGVuIiwiY29tcG9uZW50Iiwic2xpY2UiLCJtYXAiLCJvbGRWYWx1ZSIsInRtcCIsImxhc3RDb21wb25lbnQiLCJwb3AiLCJwYXRoIl0sIm1hcHBpbmdzIjoiOzs7NENBQXdCQSxJO0FBQVQsU0FBU0EsSUFBVCxHQUFnQixDQUFFOztBQUVqQ0EsS0FBS0MsU0FBTCxHQUFpQjtBQUFBLG1EQUNmQyxJQURlLGdCQUNWQyxTQURVLEVBQ0NDLFNBREQsRUFDMEI7QUFBQSx3REFBZEMsT0FBYyx1RUFBSixFQUFJOztBQUN2QyxRQUFJQyxXQUFXRCxRQUFRQyxRQUF2QjtBQUNBLFFBQUksT0FBT0QsT0FBUCxLQUFtQixVQUF2QixFQUFtQztBQUNqQ0MsaUJBQVdELE9BQVg7QUFDQUEsZ0JBQVUsRUFBVjtBQUNEO0FBQ0QsU0FBS0EsT0FBTCxHQUFlQSxPQUFmOztBQUVBLFFBQUlFLE9BQU8sSUFBWDs7QUFFQSxhQUFTQyxJQUFULENBQWNDLEtBQWQsRUFBcUI7QUFDbkIsVUFBSUgsUUFBSixFQUFjO0FBQ1pJLG1CQUFXLFlBQVc7QUFBRUosbUJBQVNLLFNBQVQsRUFBb0JGLEtBQXBCO0FBQTZCLFNBQXJELEVBQXVELENBQXZEO0FBQ0EsZUFBTyxJQUFQO0FBQ0QsT0FIRCxNQUdPO0FBQ0wsZUFBT0EsS0FBUDtBQUNEO0FBQ0Y7O0FBRUQ7QUFDQU4sZ0JBQVksS0FBS1MsU0FBTCxDQUFlVCxTQUFmLENBQVo7QUFDQUMsZ0JBQVksS0FBS1EsU0FBTCxDQUFlUixTQUFmLENBQVo7O0FBRUFELGdCQUFZLEtBQUtVLFdBQUwsQ0FBaUIsS0FBS0MsUUFBTCxDQUFjWCxTQUFkLENBQWpCLENBQVo7QUFDQUMsZ0JBQVksS0FBS1MsV0FBTCxDQUFpQixLQUFLQyxRQUFMLENBQWNWLFNBQWQsQ0FBakIsQ0FBWjs7QUFFQSxRQUFJVyxTQUFTWCxVQUFVWSxNQUF2QjtBQUFBLFFBQStCQyxTQUFTZCxVQUFVYSxNQUFsRDtBQUNBLFFBQUlFLGFBQWEsQ0FBakI7QUFDQSxRQUFJQyxnQkFBZ0JKLFNBQVNFLE1BQTdCO0FBQ0EsUUFBSUcsV0FBVyxDQUFDLEVBQUVDLFFBQVEsQ0FBQyxDQUFYLEVBQWNDLFlBQVksRUFBMUIsRUFBRCxDQUFmOztBQUVBO0FBQ0EsUUFBSUMsU0FBUyxLQUFLQyxhQUFMLENBQW1CSixTQUFTLENBQVQsQ0FBbkIsRUFBZ0NoQixTQUFoQyxFQUEyQ0QsU0FBM0MsRUFBc0QsQ0FBdEQsQ0FBYjtBQUNBLFFBQUlpQixTQUFTLENBQVQsRUFBWUMsTUFBWixHQUFxQixDQUFyQixJQUEwQk4sTUFBMUIsSUFBb0NRLFNBQVMsQ0FBVCxJQUFjTixNQUF0RCxFQUE4RDtBQUM1RDtBQUNBLGFBQU9ULEtBQUssQ0FBQyxFQUFDQyxPQUFPLEtBQUtnQixJQUFMLENBQVVyQixTQUFWLENBQVIsRUFBOEJzQixPQUFPdEIsVUFBVVksTUFBL0MsRUFBRCxDQUFMLENBQVA7QUFDRDs7QUFFRDtBQUNBLGFBQVNXLGNBQVQsR0FBMEI7QUFDeEIsV0FBSyxJQUFJQyxlQUFlLENBQUMsQ0FBRCxHQUFLVixVQUE3QixFQUF5Q1UsZ0JBQWdCVixVQUF6RCxFQUFxRVUsZ0JBQWdCLENBQXJGLEVBQXdGO0FBQ3RGLFlBQUlDLDBDQUFKO0FBQ0EsWUFBSUMsVUFBVVYsU0FBU1EsZUFBZSxDQUF4QixDQUFkO0FBQUEsWUFDSUcsYUFBYVgsU0FBU1EsZUFBZSxDQUF4QixDQURqQjtBQUFBLFlBRUlMLFVBQVMsQ0FBQ1EsYUFBYUEsV0FBV1YsTUFBeEIsR0FBaUMsQ0FBbEMsSUFBdUNPLFlBRnBEO0FBR0EsWUFBSUUsT0FBSixFQUFhO0FBQ1g7QUFDQVYsbUJBQVNRLGVBQWUsQ0FBeEIsSUFBNkJqQixTQUE3QjtBQUNEOztBQUVELFlBQUlxQixTQUFTRixXQUFXQSxRQUFRVCxNQUFSLEdBQWlCLENBQWpCLEdBQXFCTixNQUE3QztBQUFBLFlBQ0lrQixZQUFZRixjQUFjLEtBQUtSLE9BQW5CLElBQTZCQSxVQUFTTixNQUR0RDtBQUVBLFlBQUksQ0FBQ2UsTUFBRCxJQUFXLENBQUNDLFNBQWhCLEVBQTJCO0FBQ3pCO0FBQ0FiLG1CQUFTUSxZQUFULElBQXlCakIsU0FBekI7QUFDQTtBQUNEOztBQUVEO0FBQ0E7QUFDQTtBQUNBLFlBQUksQ0FBQ3FCLE1BQUQsSUFBWUMsYUFBYUgsUUFBUVQsTUFBUixHQUFpQlUsV0FBV1YsTUFBekQsRUFBa0U7QUFDaEVRLHFCQUFXSyxVQUFVSCxVQUFWLENBQVg7QUFDQXhCLGVBQUs0QixhQUFMLENBQW1CTixTQUFTUCxVQUE1QixFQUF3Q1gsU0FBeEMsRUFBbUQsSUFBbkQ7QUFDRCxTQUhELE1BR087QUFDTGtCLHFCQUFXQyxPQUFYLENBREssQ0FDaUI7QUFDdEJELG1CQUFTUixNQUFUO0FBQ0FkLGVBQUs0QixhQUFMLENBQW1CTixTQUFTUCxVQUE1QixFQUF3QyxJQUF4QyxFQUE4Q1gsU0FBOUM7QUFDRDs7QUFFRFksa0JBQVNoQixLQUFLaUIsYUFBTCxDQUFtQkssUUFBbkIsRUFBNkJ6QixTQUE3QixFQUF3Q0QsU0FBeEMsRUFBbUR5QixZQUFuRCxDQUFUOztBQUVBO0FBQ0EsWUFBSUMsU0FBU1IsTUFBVCxHQUFrQixDQUFsQixJQUF1Qk4sTUFBdkIsSUFBaUNRLFVBQVMsQ0FBVCxJQUFjTixNQUFuRCxFQUEyRDtBQUN6RCxpQkFBT1QsS0FBSzRCLFlBQVk3QixJQUFaLEVBQWtCc0IsU0FBU1AsVUFBM0IsRUFBdUNsQixTQUF2QyxFQUFrREQsU0FBbEQsRUFBNkRJLEtBQUs4QixlQUFsRSxDQUFMLENBQVA7QUFDRCxTQUZELE1BRU87QUFDTDtBQUNBakIsbUJBQVNRLFlBQVQsSUFBeUJDLFFBQXpCO0FBQ0Q7QUFDRjs7QUFFRFg7QUFDRDs7QUFFRDtBQUNBO0FBQ0E7QUFDQSxRQUFJWixRQUFKLEVBQWM7QUFDWCxnQkFBU2dDLElBQVQsR0FBZ0I7QUFDZjVCLG1CQUFXLFlBQVc7QUFDcEI7QUFDQTtBQUNBLGNBQUlRLGFBQWFDLGFBQWpCLEVBQWdDO0FBQzlCLG1CQUFPYixVQUFQO0FBQ0Q7O0FBRUQsY0FBSSxDQUFDcUIsZ0JBQUwsRUFBdUI7QUFDckJXO0FBQ0Q7QUFDRixTQVZELEVBVUcsQ0FWSDtBQVdELE9BWkEsR0FBRDtBQWFELEtBZEQsTUFjTztBQUNMLGFBQU9wQixjQUFjQyxhQUFyQixFQUFvQztBQUNsQyxZQUFJb0IsTUFBTVosZ0JBQVY7QUFDQSxZQUFJWSxHQUFKLEVBQVM7QUFDUCxpQkFBT0EsR0FBUDtBQUNEO0FBQ0Y7QUFDRjtBQUNGLEdBOUdjO0FBQUEsbURBZ0hmSixhQWhIZSx5QkFnSERiLFVBaEhDLEVBZ0hXa0IsS0FoSFgsRUFnSGtCQyxPQWhIbEIsRUFnSDJCO0FBQ3hDLFFBQUlDLE9BQU9wQixXQUFXQSxXQUFXTixNQUFYLEdBQW9CLENBQS9CLENBQVg7QUFDQSxRQUFJMEIsUUFBUUEsS0FBS0YsS0FBTCxLQUFlQSxLQUF2QixJQUFnQ0UsS0FBS0QsT0FBTCxLQUFpQkEsT0FBckQsRUFBOEQ7QUFDNUQ7QUFDQTtBQUNBbkIsaUJBQVdBLFdBQVdOLE1BQVgsR0FBb0IsQ0FBL0IsSUFBb0MsRUFBQ1UsT0FBT2dCLEtBQUtoQixLQUFMLEdBQWEsQ0FBckIsRUFBd0JjLE9BQU9BLEtBQS9CLEVBQXNDQyxTQUFTQSxPQUEvQyxFQUFwQztBQUNELEtBSkQsTUFJTztBQUNMbkIsaUJBQVdxQixJQUFYLENBQWdCLEVBQUNqQixPQUFPLENBQVIsRUFBV2MsT0FBT0EsS0FBbEIsRUFBeUJDLFNBQVNBLE9BQWxDLEVBQWhCO0FBQ0Q7QUFDRixHQXpIYztBQUFBLG1EQTBIZmpCLGFBMUhlLHlCQTBIREssUUExSEMsRUEwSFN6QixTQTFIVCxFQTBIb0JELFNBMUhwQixFQTBIK0J5QixZQTFIL0IsRUEwSDZDO0FBQzFELFFBQUliLFNBQVNYLFVBQVVZLE1BQXZCO0FBQUEsUUFDSUMsU0FBU2QsVUFBVWEsTUFEdkI7QUFBQSxRQUVJSyxTQUFTUSxTQUFTUixNQUZ0QjtBQUFBLFFBR0lFLFNBQVNGLFNBQVNPLFlBSHRCO0FBQUEsUUFLSWdCLGNBQWMsQ0FMbEI7QUFNQSxXQUFPdkIsU0FBUyxDQUFULEdBQWFOLE1BQWIsSUFBdUJRLFNBQVMsQ0FBVCxHQUFhTixNQUFwQyxJQUE4QyxLQUFLNEIsTUFBTCxDQUFZekMsVUFBVWlCLFNBQVMsQ0FBbkIsQ0FBWixFQUFtQ2xCLFVBQVVvQixTQUFTLENBQW5CLENBQW5DLENBQXJELEVBQWdIO0FBQzlHRjtBQUNBRTtBQUNBcUI7QUFDRDs7QUFFRCxRQUFJQSxXQUFKLEVBQWlCO0FBQ2ZmLGVBQVNQLFVBQVQsQ0FBb0JxQixJQUFwQixDQUF5QixFQUFDakIsT0FBT2tCLFdBQVIsRUFBekI7QUFDRDs7QUFFRGYsYUFBU1IsTUFBVCxHQUFrQkEsTUFBbEI7QUFDQSxXQUFPRSxNQUFQO0FBQ0QsR0E3SWM7QUFBQSxtREErSWZzQixNQS9JZSxrQkErSVJDLElBL0lRLEVBK0lGQyxLQS9JRSxFQStJSztBQUNsQixRQUFJLEtBQUsxQyxPQUFMLENBQWEyQyxVQUFqQixFQUE2QjtBQUMzQixhQUFPLEtBQUszQyxPQUFMLENBQWEyQyxVQUFiLENBQXdCRixJQUF4QixFQUE4QkMsS0FBOUIsQ0FBUDtBQUNELEtBRkQsTUFFTztBQUNMLGFBQU9ELFNBQVNDLEtBQVQsSUFDRCxLQUFLMUMsT0FBTCxDQUFhNEMsVUFBYixJQUEyQkgsS0FBS0ksV0FBTCxPQUF1QkgsTUFBTUcsV0FBTixFQUR4RDtBQUVEO0FBQ0YsR0F0SmM7QUFBQSxtREF1SmZyQyxXQXZKZSx1QkF1SkhzQyxLQXZKRyxFQXVKSTtBQUNqQixRQUFJWixNQUFNLEVBQVY7QUFDQSxTQUFLLElBQUlhLElBQUksQ0FBYixFQUFnQkEsSUFBSUQsTUFBTW5DLE1BQTFCLEVBQWtDb0MsR0FBbEMsRUFBdUM7QUFDckMsVUFBSUQsTUFBTUMsQ0FBTixDQUFKLEVBQWM7QUFDWmIsWUFBSUksSUFBSixDQUFTUSxNQUFNQyxDQUFOLENBQVQ7QUFDRDtBQUNGO0FBQ0QsV0FBT2IsR0FBUDtBQUNELEdBL0pjO0FBQUEsbURBZ0tmM0IsU0FoS2UscUJBZ0tMSCxLQWhLSyxFQWdLRTtBQUNmLFdBQU9BLEtBQVA7QUFDRCxHQWxLYztBQUFBLG1EQW1LZkssUUFuS2Usb0JBbUtOTCxLQW5LTSxFQW1LQztBQUNkLFdBQU9BLE1BQU00QyxLQUFOLENBQVksRUFBWixDQUFQO0FBQ0QsR0FyS2M7QUFBQSxtREFzS2Y1QixJQXRLZSxnQkFzS1Y2QixLQXRLVSxFQXNLSDtBQUNWLFdBQU9BLE1BQU03QixJQUFOLENBQVcsRUFBWCxDQUFQO0FBQ0Q7QUF4S2MsQ0FBakI7O0FBMktBLFNBQVNXLFdBQVQsQ0FBcUJsQyxJQUFyQixFQUEyQm9CLFVBQTNCLEVBQXVDbEIsU0FBdkMsRUFBa0RELFNBQWxELEVBQTZEa0MsZUFBN0QsRUFBOEU7QUFDNUUsTUFBSWtCLGVBQWUsQ0FBbkI7QUFBQSxNQUNJQyxlQUFlbEMsV0FBV04sTUFEOUI7QUFBQSxNQUVJSyxTQUFTLENBRmI7QUFBQSxNQUdJRSxTQUFTLENBSGI7O0FBS0EsU0FBT2dDLGVBQWVDLFlBQXRCLEVBQW9DRCxjQUFwQyxFQUFvRDtBQUNsRCxRQUFJRSxZQUFZbkMsV0FBV2lDLFlBQVgsQ0FBaEI7QUFDQSxRQUFJLENBQUNFLFVBQVVoQixPQUFmLEVBQXdCO0FBQ3RCLFVBQUksQ0FBQ2dCLFVBQVVqQixLQUFYLElBQW9CSCxlQUF4QixFQUF5QztBQUN2QyxZQUFJNUIsUUFBUUwsVUFBVXNELEtBQVYsQ0FBZ0JyQyxNQUFoQixFQUF3QkEsU0FBU29DLFVBQVUvQixLQUEzQyxDQUFaO0FBQ0FqQixnQkFBUUEsTUFBTWtELEdBQU4sQ0FBVSxVQUFTbEQsS0FBVCxFQUFnQjJDLENBQWhCLEVBQW1CO0FBQ25DLGNBQUlRLFdBQVd6RCxVQUFVb0IsU0FBUzZCLENBQW5CLENBQWY7QUFDQSxpQkFBT1EsU0FBUzVDLE1BQVQsR0FBa0JQLE1BQU1PLE1BQXhCLEdBQWlDNEMsUUFBakMsR0FBNENuRCxLQUFuRDtBQUNELFNBSE8sQ0FBUjs7QUFLQWdELGtCQUFVaEQsS0FBVixHQUFrQlAsS0FBS3VCLElBQUwsQ0FBVWhCLEtBQVYsQ0FBbEI7QUFDRCxPQVJELE1BUU87QUFDTGdELGtCQUFVaEQsS0FBVixHQUFrQlAsS0FBS3VCLElBQUwsQ0FBVXJCLFVBQVVzRCxLQUFWLENBQWdCckMsTUFBaEIsRUFBd0JBLFNBQVNvQyxVQUFVL0IsS0FBM0MsQ0FBVixDQUFsQjtBQUNEO0FBQ0RMLGdCQUFVb0MsVUFBVS9CLEtBQXBCOztBQUVBO0FBQ0EsVUFBSSxDQUFDK0IsVUFBVWpCLEtBQWYsRUFBc0I7QUFDcEJqQixrQkFBVWtDLFVBQVUvQixLQUFwQjtBQUNEO0FBQ0YsS0FsQkQsTUFrQk87QUFDTCtCLGdCQUFVaEQsS0FBVixHQUFrQlAsS0FBS3VCLElBQUwsQ0FBVXRCLFVBQVV1RCxLQUFWLENBQWdCbkMsTUFBaEIsRUFBd0JBLFNBQVNrQyxVQUFVL0IsS0FBM0MsQ0FBVixDQUFsQjtBQUNBSCxnQkFBVWtDLFVBQVUvQixLQUFwQjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxVQUFJNkIsZ0JBQWdCakMsV0FBV2lDLGVBQWUsQ0FBMUIsRUFBNkJmLEtBQWpELEVBQXdEO0FBQ3RELFlBQUlxQixNQUFNdkMsV0FBV2lDLGVBQWUsQ0FBMUIsQ0FBVjtBQUNBakMsbUJBQVdpQyxlQUFlLENBQTFCLElBQStCakMsV0FBV2lDLFlBQVgsQ0FBL0I7QUFDQWpDLG1CQUFXaUMsWUFBWCxJQUEyQk0sR0FBM0I7QUFDRDtBQUNGO0FBQ0Y7O0FBRUQ7QUFDQTtBQUNBO0FBQ0EsTUFBSUMsZ0JBQWdCeEMsV0FBV2tDLGVBQWUsQ0FBMUIsQ0FBcEI7QUFDQSxNQUFJQSxlQUFlLENBQWYsSUFDRyxPQUFPTSxjQUFjckQsS0FBckIsS0FBK0IsUUFEbEMsS0FFSXFELGNBQWN0QixLQUFkLElBQXVCc0IsY0FBY3JCLE9BRnpDLEtBR0d2QyxLQUFLMkMsTUFBTCxDQUFZLEVBQVosRUFBZ0JpQixjQUFjckQsS0FBOUIsQ0FIUCxFQUc2QztBQUMzQ2EsZUFBV2tDLGVBQWUsQ0FBMUIsRUFBNkIvQyxLQUE3QixJQUFzQ3FELGNBQWNyRCxLQUFwRDtBQUNBYSxlQUFXeUMsR0FBWDtBQUNEOztBQUVELFNBQU96QyxVQUFQO0FBQ0Q7O0FBRUQsU0FBU1ksU0FBVCxDQUFtQjhCLElBQW5CLEVBQXlCO0FBQ3ZCLFNBQU8sRUFBRTNDLFFBQVEyQyxLQUFLM0MsTUFBZixFQUF1QkMsWUFBWTBDLEtBQUsxQyxVQUFMLENBQWdCb0MsS0FBaEIsQ0FBc0IsQ0FBdEIsQ0FBbkMsRUFBUDtBQUNEIiwiZmlsZSI6ImJhc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBEaWZmKCkge31cblxuRGlmZi5wcm90b3R5cGUgPSB7XG4gIGRpZmYob2xkU3RyaW5nLCBuZXdTdHJpbmcsIG9wdGlvbnMgPSB7fSkge1xuICAgIGxldCBjYWxsYmFjayA9IG9wdGlvbnMuY2FsbGJhY2s7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7XG5cbiAgICBsZXQgc2VsZiA9IHRoaXM7XG5cbiAgICBmdW5jdGlvbiBkb25lKHZhbHVlKSB7XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgY2FsbGJhY2sodW5kZWZpbmVkLCB2YWx1ZSk7IH0sIDApO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBbGxvdyBzdWJjbGFzc2VzIHRvIG1hc3NhZ2UgdGhlIGlucHV0IHByaW9yIHRvIHJ1bm5pbmdcbiAgICBvbGRTdHJpbmcgPSB0aGlzLmNhc3RJbnB1dChvbGRTdHJpbmcpO1xuICAgIG5ld1N0cmluZyA9IHRoaXMuY2FzdElucHV0KG5ld1N0cmluZyk7XG5cbiAgICBvbGRTdHJpbmcgPSB0aGlzLnJlbW92ZUVtcHR5KHRoaXMudG9rZW5pemUob2xkU3RyaW5nKSk7XG4gICAgbmV3U3RyaW5nID0gdGhpcy5yZW1vdmVFbXB0eSh0aGlzLnRva2VuaXplKG5ld1N0cmluZykpO1xuXG4gICAgbGV0IG5ld0xlbiA9IG5ld1N0cmluZy5sZW5ndGgsIG9sZExlbiA9IG9sZFN0cmluZy5sZW5ndGg7XG4gICAgbGV0IGVkaXRMZW5ndGggPSAxO1xuICAgIGxldCBtYXhFZGl0TGVuZ3RoID0gbmV3TGVuICsgb2xkTGVuO1xuICAgIGxldCBiZXN0UGF0aCA9IFt7IG5ld1BvczogLTEsIGNvbXBvbmVudHM6IFtdIH1dO1xuXG4gICAgLy8gU2VlZCBlZGl0TGVuZ3RoID0gMCwgaS5lLiB0aGUgY29udGVudCBzdGFydHMgd2l0aCB0aGUgc2FtZSB2YWx1ZXNcbiAgICBsZXQgb2xkUG9zID0gdGhpcy5leHRyYWN0Q29tbW9uKGJlc3RQYXRoWzBdLCBuZXdTdHJpbmcsIG9sZFN0cmluZywgMCk7XG4gICAgaWYgKGJlc3RQYXRoWzBdLm5ld1BvcyArIDEgPj0gbmV3TGVuICYmIG9sZFBvcyArIDEgPj0gb2xkTGVuKSB7XG4gICAgICAvLyBJZGVudGl0eSBwZXIgdGhlIGVxdWFsaXR5IGFuZCB0b2tlbml6ZXJcbiAgICAgIHJldHVybiBkb25lKFt7dmFsdWU6IHRoaXMuam9pbihuZXdTdHJpbmcpLCBjb3VudDogbmV3U3RyaW5nLmxlbmd0aH1dKTtcbiAgICB9XG5cbiAgICAvLyBNYWluIHdvcmtlciBtZXRob2QuIGNoZWNrcyBhbGwgcGVybXV0YXRpb25zIG9mIGEgZ2l2ZW4gZWRpdCBsZW5ndGggZm9yIGFjY2VwdGFuY2UuXG4gICAgZnVuY3Rpb24gZXhlY0VkaXRMZW5ndGgoKSB7XG4gICAgICBmb3IgKGxldCBkaWFnb25hbFBhdGggPSAtMSAqIGVkaXRMZW5ndGg7IGRpYWdvbmFsUGF0aCA8PSBlZGl0TGVuZ3RoOyBkaWFnb25hbFBhdGggKz0gMikge1xuICAgICAgICBsZXQgYmFzZVBhdGg7XG4gICAgICAgIGxldCBhZGRQYXRoID0gYmVzdFBhdGhbZGlhZ29uYWxQYXRoIC0gMV0sXG4gICAgICAgICAgICByZW1vdmVQYXRoID0gYmVzdFBhdGhbZGlhZ29uYWxQYXRoICsgMV0sXG4gICAgICAgICAgICBvbGRQb3MgPSAocmVtb3ZlUGF0aCA/IHJlbW92ZVBhdGgubmV3UG9zIDogMCkgLSBkaWFnb25hbFBhdGg7XG4gICAgICAgIGlmIChhZGRQYXRoKSB7XG4gICAgICAgICAgLy8gTm8gb25lIGVsc2UgaXMgZ29pbmcgdG8gYXR0ZW1wdCB0byB1c2UgdGhpcyB2YWx1ZSwgY2xlYXIgaXRcbiAgICAgICAgICBiZXN0UGF0aFtkaWFnb25hbFBhdGggLSAxXSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjYW5BZGQgPSBhZGRQYXRoICYmIGFkZFBhdGgubmV3UG9zICsgMSA8IG5ld0xlbixcbiAgICAgICAgICAgIGNhblJlbW92ZSA9IHJlbW92ZVBhdGggJiYgMCA8PSBvbGRQb3MgJiYgb2xkUG9zIDwgb2xkTGVuO1xuICAgICAgICBpZiAoIWNhbkFkZCAmJiAhY2FuUmVtb3ZlKSB7XG4gICAgICAgICAgLy8gSWYgdGhpcyBwYXRoIGlzIGEgdGVybWluYWwgdGhlbiBwcnVuZVxuICAgICAgICAgIGJlc3RQYXRoW2RpYWdvbmFsUGF0aF0gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTZWxlY3QgdGhlIGRpYWdvbmFsIHRoYXQgd2Ugd2FudCB0byBicmFuY2ggZnJvbS4gV2Ugc2VsZWN0IHRoZSBwcmlvclxuICAgICAgICAvLyBwYXRoIHdob3NlIHBvc2l0aW9uIGluIHRoZSBuZXcgc3RyaW5nIGlzIHRoZSBmYXJ0aGVzdCBmcm9tIHRoZSBvcmlnaW5cbiAgICAgICAgLy8gYW5kIGRvZXMgbm90IHBhc3MgdGhlIGJvdW5kcyBvZiB0aGUgZGlmZiBncmFwaFxuICAgICAgICBpZiAoIWNhbkFkZCB8fCAoY2FuUmVtb3ZlICYmIGFkZFBhdGgubmV3UG9zIDwgcmVtb3ZlUGF0aC5uZXdQb3MpKSB7XG4gICAgICAgICAgYmFzZVBhdGggPSBjbG9uZVBhdGgocmVtb3ZlUGF0aCk7XG4gICAgICAgICAgc2VsZi5wdXNoQ29tcG9uZW50KGJhc2VQYXRoLmNvbXBvbmVudHMsIHVuZGVmaW5lZCwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmFzZVBhdGggPSBhZGRQYXRoOyAgIC8vIE5vIG5lZWQgdG8gY2xvbmUsIHdlJ3ZlIHB1bGxlZCBpdCBmcm9tIHRoZSBsaXN0XG4gICAgICAgICAgYmFzZVBhdGgubmV3UG9zKys7XG4gICAgICAgICAgc2VsZi5wdXNoQ29tcG9uZW50KGJhc2VQYXRoLmNvbXBvbmVudHMsIHRydWUsIHVuZGVmaW5lZCk7XG4gICAgICAgIH1cblxuICAgICAgICBvbGRQb3MgPSBzZWxmLmV4dHJhY3RDb21tb24oYmFzZVBhdGgsIG5ld1N0cmluZywgb2xkU3RyaW5nLCBkaWFnb25hbFBhdGgpO1xuXG4gICAgICAgIC8vIElmIHdlIGhhdmUgaGl0IHRoZSBlbmQgb2YgYm90aCBzdHJpbmdzLCB0aGVuIHdlIGFyZSBkb25lXG4gICAgICAgIGlmIChiYXNlUGF0aC5uZXdQb3MgKyAxID49IG5ld0xlbiAmJiBvbGRQb3MgKyAxID49IG9sZExlbikge1xuICAgICAgICAgIHJldHVybiBkb25lKGJ1aWxkVmFsdWVzKHNlbGYsIGJhc2VQYXRoLmNvbXBvbmVudHMsIG5ld1N0cmluZywgb2xkU3RyaW5nLCBzZWxmLnVzZUxvbmdlc3RUb2tlbikpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIE90aGVyd2lzZSB0cmFjayB0aGlzIHBhdGggYXMgYSBwb3RlbnRpYWwgY2FuZGlkYXRlIGFuZCBjb250aW51ZS5cbiAgICAgICAgICBiZXN0UGF0aFtkaWFnb25hbFBhdGhdID0gYmFzZVBhdGg7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZWRpdExlbmd0aCsrO1xuICAgIH1cblxuICAgIC8vIFBlcmZvcm1zIHRoZSBsZW5ndGggb2YgZWRpdCBpdGVyYXRpb24uIElzIGEgYml0IGZ1Z2x5IGFzIHRoaXMgaGFzIHRvIHN1cHBvcnQgdGhlXG4gICAgLy8gc3luYyBhbmQgYXN5bmMgbW9kZSB3aGljaCBpcyBuZXZlciBmdW4uIExvb3BzIG92ZXIgZXhlY0VkaXRMZW5ndGggdW50aWwgYSB2YWx1ZVxuICAgIC8vIGlzIHByb2R1Y2VkLlxuICAgIGlmIChjYWxsYmFjaykge1xuICAgICAgKGZ1bmN0aW9uIGV4ZWMoKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgLy8gVGhpcyBzaG91bGQgbm90IGhhcHBlbiwgYnV0IHdlIHdhbnQgdG8gYmUgc2FmZS5cbiAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICAgICAgICAgIGlmIChlZGl0TGVuZ3RoID4gbWF4RWRpdExlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIGNhbGxiYWNrKCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKCFleGVjRWRpdExlbmd0aCgpKSB7XG4gICAgICAgICAgICBleGVjKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9LCAwKTtcbiAgICAgIH0oKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdoaWxlIChlZGl0TGVuZ3RoIDw9IG1heEVkaXRMZW5ndGgpIHtcbiAgICAgICAgbGV0IHJldCA9IGV4ZWNFZGl0TGVuZ3RoKCk7XG4gICAgICAgIGlmIChyZXQpIHtcbiAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuXG4gIHB1c2hDb21wb25lbnQoY29tcG9uZW50cywgYWRkZWQsIHJlbW92ZWQpIHtcbiAgICBsZXQgbGFzdCA9IGNvbXBvbmVudHNbY29tcG9uZW50cy5sZW5ndGggLSAxXTtcbiAgICBpZiAobGFzdCAmJiBsYXN0LmFkZGVkID09PSBhZGRlZCAmJiBsYXN0LnJlbW92ZWQgPT09IHJlbW92ZWQpIHtcbiAgICAgIC8vIFdlIG5lZWQgdG8gY2xvbmUgaGVyZSBhcyB0aGUgY29tcG9uZW50IGNsb25lIG9wZXJhdGlvbiBpcyBqdXN0XG4gICAgICAvLyBhcyBzaGFsbG93IGFycmF5IGNsb25lXG4gICAgICBjb21wb25lbnRzW2NvbXBvbmVudHMubGVuZ3RoIC0gMV0gPSB7Y291bnQ6IGxhc3QuY291bnQgKyAxLCBhZGRlZDogYWRkZWQsIHJlbW92ZWQ6IHJlbW92ZWQgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29tcG9uZW50cy5wdXNoKHtjb3VudDogMSwgYWRkZWQ6IGFkZGVkLCByZW1vdmVkOiByZW1vdmVkIH0pO1xuICAgIH1cbiAgfSxcbiAgZXh0cmFjdENvbW1vbihiYXNlUGF0aCwgbmV3U3RyaW5nLCBvbGRTdHJpbmcsIGRpYWdvbmFsUGF0aCkge1xuICAgIGxldCBuZXdMZW4gPSBuZXdTdHJpbmcubGVuZ3RoLFxuICAgICAgICBvbGRMZW4gPSBvbGRTdHJpbmcubGVuZ3RoLFxuICAgICAgICBuZXdQb3MgPSBiYXNlUGF0aC5uZXdQb3MsXG4gICAgICAgIG9sZFBvcyA9IG5ld1BvcyAtIGRpYWdvbmFsUGF0aCxcblxuICAgICAgICBjb21tb25Db3VudCA9IDA7XG4gICAgd2hpbGUgKG5ld1BvcyArIDEgPCBuZXdMZW4gJiYgb2xkUG9zICsgMSA8IG9sZExlbiAmJiB0aGlzLmVxdWFscyhuZXdTdHJpbmdbbmV3UG9zICsgMV0sIG9sZFN0cmluZ1tvbGRQb3MgKyAxXSkpIHtcbiAgICAgIG5ld1BvcysrO1xuICAgICAgb2xkUG9zKys7XG4gICAgICBjb21tb25Db3VudCsrO1xuICAgIH1cblxuICAgIGlmIChjb21tb25Db3VudCkge1xuICAgICAgYmFzZVBhdGguY29tcG9uZW50cy5wdXNoKHtjb3VudDogY29tbW9uQ291bnR9KTtcbiAgICB9XG5cbiAgICBiYXNlUGF0aC5uZXdQb3MgPSBuZXdQb3M7XG4gICAgcmV0dXJuIG9sZFBvcztcbiAgfSxcblxuICBlcXVhbHMobGVmdCwgcmlnaHQpIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLmNvbXBhcmF0b3IpIHtcbiAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY29tcGFyYXRvcihsZWZ0LCByaWdodCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBsZWZ0ID09PSByaWdodFxuICAgICAgICB8fCAodGhpcy5vcHRpb25zLmlnbm9yZUNhc2UgJiYgbGVmdC50b0xvd2VyQ2FzZSgpID09PSByaWdodC50b0xvd2VyQ2FzZSgpKTtcbiAgICB9XG4gIH0sXG4gIHJlbW92ZUVtcHR5KGFycmF5KSB7XG4gICAgbGV0IHJldCA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChhcnJheVtpXSkge1xuICAgICAgICByZXQucHVzaChhcnJheVtpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXQ7XG4gIH0sXG4gIGNhc3RJbnB1dCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZTtcbiAgfSxcbiAgdG9rZW5pemUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUuc3BsaXQoJycpO1xuICB9LFxuICBqb2luKGNoYXJzKSB7XG4gICAgcmV0dXJuIGNoYXJzLmpvaW4oJycpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBidWlsZFZhbHVlcyhkaWZmLCBjb21wb25lbnRzLCBuZXdTdHJpbmcsIG9sZFN0cmluZywgdXNlTG9uZ2VzdFRva2VuKSB7XG4gIGxldCBjb21wb25lbnRQb3MgPSAwLFxuICAgICAgY29tcG9uZW50TGVuID0gY29tcG9uZW50cy5sZW5ndGgsXG4gICAgICBuZXdQb3MgPSAwLFxuICAgICAgb2xkUG9zID0gMDtcblxuICBmb3IgKDsgY29tcG9uZW50UG9zIDwgY29tcG9uZW50TGVuOyBjb21wb25lbnRQb3MrKykge1xuICAgIGxldCBjb21wb25lbnQgPSBjb21wb25lbnRzW2NvbXBvbmVudFBvc107XG4gICAgaWYgKCFjb21wb25lbnQucmVtb3ZlZCkge1xuICAgICAgaWYgKCFjb21wb25lbnQuYWRkZWQgJiYgdXNlTG9uZ2VzdFRva2VuKSB7XG4gICAgICAgIGxldCB2YWx1ZSA9IG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCk7XG4gICAgICAgIHZhbHVlID0gdmFsdWUubWFwKGZ1bmN0aW9uKHZhbHVlLCBpKSB7XG4gICAgICAgICAgbGV0IG9sZFZhbHVlID0gb2xkU3RyaW5nW29sZFBvcyArIGldO1xuICAgICAgICAgIHJldHVybiBvbGRWYWx1ZS5sZW5ndGggPiB2YWx1ZS5sZW5ndGggPyBvbGRWYWx1ZSA6IHZhbHVlO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb21wb25lbnQudmFsdWUgPSBkaWZmLmpvaW4odmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29tcG9uZW50LnZhbHVlID0gZGlmZi5qb2luKG5ld1N0cmluZy5zbGljZShuZXdQb3MsIG5ld1BvcyArIGNvbXBvbmVudC5jb3VudCkpO1xuICAgICAgfVxuICAgICAgbmV3UG9zICs9IGNvbXBvbmVudC5jb3VudDtcblxuICAgICAgLy8gQ29tbW9uIGNhc2VcbiAgICAgIGlmICghY29tcG9uZW50LmFkZGVkKSB7XG4gICAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbXBvbmVudC52YWx1ZSA9IGRpZmYuam9pbihvbGRTdHJpbmcuc2xpY2Uob2xkUG9zLCBvbGRQb3MgKyBjb21wb25lbnQuY291bnQpKTtcbiAgICAgIG9sZFBvcyArPSBjb21wb25lbnQuY291bnQ7XG5cbiAgICAgIC8vIFJldmVyc2UgYWRkIGFuZCByZW1vdmUgc28gcmVtb3ZlcyBhcmUgb3V0cHV0IGZpcnN0IHRvIG1hdGNoIGNvbW1vbiBjb252ZW50aW9uXG4gICAgICAvLyBUaGUgZGlmZmluZyBhbGdvcml0aG0gaXMgdGllZCB0byBhZGQgdGhlbiByZW1vdmUgb3V0cHV0IGFuZCB0aGlzIGlzIHRoZSBzaW1wbGVzdFxuICAgICAgLy8gcm91dGUgdG8gZ2V0IHRoZSBkZXNpcmVkIG91dHB1dCB3aXRoIG1pbmltYWwgb3ZlcmhlYWQuXG4gICAgICBpZiAoY29tcG9uZW50UG9zICYmIGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV0uYWRkZWQpIHtcbiAgICAgICAgbGV0IHRtcCA9IGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV07XG4gICAgICAgIGNvbXBvbmVudHNbY29tcG9uZW50UG9zIC0gMV0gPSBjb21wb25lbnRzW2NvbXBvbmVudFBvc107XG4gICAgICAgIGNvbXBvbmVudHNbY29tcG9uZW50UG9zXSA9IHRtcDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBTcGVjaWFsIGNhc2UgaGFuZGxlIGZvciB3aGVuIG9uZSB0ZXJtaW5hbCBpcyBpZ25vcmVkIChpLmUuIHdoaXRlc3BhY2UpLlxuICAvLyBGb3IgdGhpcyBjYXNlIHdlIG1lcmdlIHRoZSB0ZXJtaW5hbCBpbnRvIHRoZSBwcmlvciBzdHJpbmcgYW5kIGRyb3AgdGhlIGNoYW5nZS5cbiAgLy8gVGhpcyBpcyBvbmx5IGF2YWlsYWJsZSBmb3Igc3RyaW5nIG1vZGUuXG4gIGxldCBsYXN0Q29tcG9uZW50ID0gY29tcG9uZW50c1tjb21wb25lbnRMZW4gLSAxXTtcbiAgaWYgKGNvbXBvbmVudExlbiA+IDFcbiAgICAgICYmIHR5cGVvZiBsYXN0Q29tcG9uZW50LnZhbHVlID09PSAnc3RyaW5nJ1xuICAgICAgJiYgKGxhc3RDb21wb25lbnQuYWRkZWQgfHwgbGFzdENvbXBvbmVudC5yZW1vdmVkKVxuICAgICAgJiYgZGlmZi5lcXVhbHMoJycsIGxhc3RDb21wb25lbnQudmFsdWUpKSB7XG4gICAgY29tcG9uZW50c1tjb21wb25lbnRMZW4gLSAyXS52YWx1ZSArPSBsYXN0Q29tcG9uZW50LnZhbHVlO1xuICAgIGNvbXBvbmVudHMucG9wKCk7XG4gIH1cblxuICByZXR1cm4gY29tcG9uZW50cztcbn1cblxuZnVuY3Rpb24gY2xvbmVQYXRoKHBhdGgpIHtcbiAgcmV0dXJuIHsgbmV3UG9zOiBwYXRoLm5ld1BvcywgY29tcG9uZW50czogcGF0aC5jb21wb25lbnRzLnNsaWNlKDApIH07XG59XG4iXX0=\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.characterDiff = undefined;\n\texports. /*istanbul ignore end*/diffChars = diffChars;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var characterDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/characterDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tfunction diffChars(oldStr, newStr, options) {\n\t  return characterDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2NoYXJhY3Rlci5qcyJdLCJuYW1lcyI6WyJkaWZmQ2hhcnMiLCJjaGFyYWN0ZXJEaWZmIiwib2xkU3RyIiwibmV3U3RyIiwib3B0aW9ucyIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBR2dCQSxTLEdBQUFBLFM7O0FBSGhCOzs7Ozs7dUJBRU8sSUFBTUMseUZBQWdCLHdFQUF0QjtBQUNBLFNBQVNELFNBQVQsQ0FBbUJFLE1BQW5CLEVBQTJCQyxNQUEzQixFQUFtQ0MsT0FBbkMsRUFBNEM7QUFBRSxTQUFPSCxjQUFjSSxJQUFkLENBQW1CSCxNQUFuQixFQUEyQkMsTUFBM0IsRUFBbUNDLE9BQW5DLENBQVA7QUFBcUQiLCJmaWxlIjoiY2hhcmFjdGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERpZmYgZnJvbSAnLi9iYXNlJztcblxuZXhwb3J0IGNvbnN0IGNoYXJhY3RlckRpZmYgPSBuZXcgRGlmZigpO1xuZXhwb3J0IGZ1bmN0aW9uIGRpZmZDaGFycyhvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykgeyByZXR1cm4gY2hhcmFjdGVyRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTsgfVxuIl19\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.wordDiff = undefined;\n\texports. /*istanbul ignore end*/diffWords = diffWords;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffWordsWithSpace = diffWordsWithSpace;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_params = __webpack_require__(4) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/ // Based on https://en.wikipedia.org/wiki/Latin_script_in_Unicode\n\t//\n\t// Ranges and exceptions:\n\t// Latin-1 Supplement, 008000FF\n\t//  - U+00D7   Multiplication sign\n\t//  - U+00F7   Division sign\n\t// Latin Extended-A, 0100017F\n\t// Latin Extended-B, 0180024F\n\t// IPA Extensions, 025002AF\n\t// Spacing Modifier Letters, 02B002FF\n\t//  - U+02C7   &#711;  Caron\n\t//  - U+02D8   &#728;  Breve\n\t//  - U+02D9   &#729;  Dot Above\n\t//  - U+02DA   &#730;  Ring Above\n\t//  - U+02DB   &#731;  Ogonek\n\t//  - U+02DC   &#732;  Small Tilde\n\t//  - U+02DD   &#733;  Double Acute Accent\n\t// Latin Extended Additional, 1E001EFF\n\tvar extendedWordChars = /^[A-Za-z\\xC0-\\u02C6\\u02C8-\\u02D7\\u02DE-\\u02FF\\u1E00-\\u1EFF]+$/;\n\n\tvar reWhitespace = /\\S/;\n\n\tvar wordDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/wordDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\twordDiff.equals = function (left, right) {\n\t  if (this.options.ignoreCase) {\n\t    left = left.toLowerCase();\n\t    right = right.toLowerCase();\n\t  }\n\t  return left === right || this.options.ignoreWhitespace && !reWhitespace.test(left) && !reWhitespace.test(right);\n\t};\n\twordDiff.tokenize = function (value) {\n\t  var tokens = value.split(/(\\s+|\\b)/);\n\n\t  // Join the boundary splits that we do not consider to be boundaries. This is primarily the extended Latin character set.\n\t  for (var i = 0; i < tokens.length - 1; i++) {\n\t    // If we have an empty string in the next field and we have only word chars before and after, merge\n\t    if (!tokens[i + 1] && tokens[i + 2] && extendedWordChars.test(tokens[i]) && extendedWordChars.test(tokens[i + 2])) {\n\t      tokens[i] += tokens[i + 2];\n\t      tokens.splice(i + 1, 2);\n\t      i--;\n\t    }\n\t  }\n\n\t  return tokens;\n\t};\n\n\tfunction diffWords(oldStr, newStr, options) {\n\t  options = /*istanbul ignore start*/(0, _params.generateOptions) /*istanbul ignore end*/(options, { ignoreWhitespace: true });\n\t  return wordDiff.diff(oldStr, newStr, options);\n\t}\n\n\tfunction diffWordsWithSpace(oldStr, newStr, options) {\n\t  return wordDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL3dvcmQuanMiXSwibmFtZXMiOlsiZGlmZldvcmRzIiwiZGlmZldvcmRzV2l0aFNwYWNlIiwiZXh0ZW5kZWRXb3JkQ2hhcnMiLCJyZVdoaXRlc3BhY2UiLCJ3b3JkRGlmZiIsImVxdWFscyIsImxlZnQiLCJyaWdodCIsIm9wdGlvbnMiLCJpZ25vcmVDYXNlIiwidG9Mb3dlckNhc2UiLCJpZ25vcmVXaGl0ZXNwYWNlIiwidGVzdCIsInRva2VuaXplIiwidmFsdWUiLCJ0b2tlbnMiLCJzcGxpdCIsImkiLCJsZW5ndGgiLCJzcGxpY2UiLCJvbGRTdHIiLCJuZXdTdHIiLCJkaWZmIl0sIm1hcHBpbmdzIjoiOzs7O2dDQW1EZ0JBLFMsR0FBQUEsUzt5REFLQUMsa0IsR0FBQUEsa0I7O0FBeERoQjs7Ozt1QkFDQTs7Ozt3QkFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFNQyxvQkFBb0IsK0RBQTFCOztBQUVBLElBQU1DLGVBQWUsSUFBckI7O0FBRU8sSUFBTUMsK0VBQVcsd0VBQWpCO0FBQ1BBLFNBQVNDLE1BQVQsR0FBa0IsVUFBU0MsSUFBVCxFQUFlQyxLQUFmLEVBQXNCO0FBQ3RDLE1BQUksS0FBS0MsT0FBTCxDQUFhQyxVQUFqQixFQUE2QjtBQUMzQkgsV0FBT0EsS0FBS0ksV0FBTCxFQUFQO0FBQ0FILFlBQVFBLE1BQU1HLFdBQU4sRUFBUjtBQUNEO0FBQ0QsU0FBT0osU0FBU0MsS0FBVCxJQUFtQixLQUFLQyxPQUFMLENBQWFHLGdCQUFiLElBQWlDLENBQUNSLGFBQWFTLElBQWIsQ0FBa0JOLElBQWxCLENBQWxDLElBQTZELENBQUNILGFBQWFTLElBQWIsQ0FBa0JMLEtBQWxCLENBQXhGO0FBQ0QsQ0FORDtBQU9BSCxTQUFTUyxRQUFULEdBQW9CLFVBQVNDLEtBQVQsRUFBZ0I7QUFDbEMsTUFBSUMsU0FBU0QsTUFBTUUsS0FBTixDQUFZLFVBQVosQ0FBYjs7QUFFQTtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJRixPQUFPRyxNQUFQLEdBQWdCLENBQXBDLEVBQXVDRCxHQUF2QyxFQUE0QztBQUMxQztBQUNBLFFBQUksQ0FBQ0YsT0FBT0UsSUFBSSxDQUFYLENBQUQsSUFBa0JGLE9BQU9FLElBQUksQ0FBWCxDQUFsQixJQUNLZixrQkFBa0JVLElBQWxCLENBQXVCRyxPQUFPRSxDQUFQLENBQXZCLENBREwsSUFFS2Ysa0JBQWtCVSxJQUFsQixDQUF1QkcsT0FBT0UsSUFBSSxDQUFYLENBQXZCLENBRlQsRUFFZ0Q7QUFDOUNGLGFBQU9FLENBQVAsS0FBYUYsT0FBT0UsSUFBSSxDQUFYLENBQWI7QUFDQUYsYUFBT0ksTUFBUCxDQUFjRixJQUFJLENBQWxCLEVBQXFCLENBQXJCO0FBQ0FBO0FBQ0Q7QUFDRjs7QUFFRCxTQUFPRixNQUFQO0FBQ0QsQ0FoQkQ7O0FBa0JPLFNBQVNmLFNBQVQsQ0FBbUJvQixNQUFuQixFQUEyQkMsTUFBM0IsRUFBbUNiLE9BQW5DLEVBQTRDO0FBQ2pEQSxZQUFVLDhFQUFnQkEsT0FBaEIsRUFBeUIsRUFBQ0csa0JBQWtCLElBQW5CLEVBQXpCLENBQVY7QUFDQSxTQUFPUCxTQUFTa0IsSUFBVCxDQUFjRixNQUFkLEVBQXNCQyxNQUF0QixFQUE4QmIsT0FBOUIsQ0FBUDtBQUNEOztBQUVNLFNBQVNQLGtCQUFULENBQTRCbUIsTUFBNUIsRUFBb0NDLE1BQXBDLEVBQTRDYixPQUE1QyxFQUFxRDtBQUMxRCxTQUFPSixTQUFTa0IsSUFBVCxDQUFjRixNQUFkLEVBQXNCQyxNQUF0QixFQUE4QmIsT0FBOUIsQ0FBUDtBQUNEIiwiZmlsZSI6IndvcmQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgRGlmZiBmcm9tICcuL2Jhc2UnO1xuaW1wb3J0IHtnZW5lcmF0ZU9wdGlvbnN9IGZyb20gJy4uL3V0aWwvcGFyYW1zJztcblxuLy8gQmFzZWQgb24gaHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTGF0aW5fc2NyaXB0X2luX1VuaWNvZGVcbi8vXG4vLyBSYW5nZXMgYW5kIGV4Y2VwdGlvbnM6XG4vLyBMYXRpbi0xIFN1cHBsZW1lbnQsIDAwODDigJMwMEZGXG4vLyAgLSBVKzAwRDcgIMOXIE11bHRpcGxpY2F0aW9uIHNpZ25cbi8vICAtIFUrMDBGNyAgw7cgRGl2aXNpb24gc2lnblxuLy8gTGF0aW4gRXh0ZW5kZWQtQSwgMDEwMOKAkzAxN0Zcbi8vIExhdGluIEV4dGVuZGVkLUIsIDAxODDigJMwMjRGXG4vLyBJUEEgRXh0ZW5zaW9ucywgMDI1MOKAkzAyQUZcbi8vIFNwYWNpbmcgTW9kaWZpZXIgTGV0dGVycywgMDJCMOKAkzAyRkZcbi8vICAtIFUrMDJDNyAgy4cgJiM3MTE7ICBDYXJvblxuLy8gIC0gVSswMkQ4ICDLmCAmIzcyODsgIEJyZXZlXG4vLyAgLSBVKzAyRDkgIMuZICYjNzI5OyAgRG90IEFib3ZlXG4vLyAgLSBVKzAyREEgIMuaICYjNzMwOyAgUmluZyBBYm92ZVxuLy8gIC0gVSswMkRCICDLmyAmIzczMTsgIE9nb25la1xuLy8gIC0gVSswMkRDICDLnCAmIzczMjsgIFNtYWxsIFRpbGRlXG4vLyAgLSBVKzAyREQgIMudICYjNzMzOyAgRG91YmxlIEFjdXRlIEFjY2VudFxuLy8gTGF0aW4gRXh0ZW5kZWQgQWRkaXRpb25hbCwgMUUwMOKAkzFFRkZcbmNvbnN0IGV4dGVuZGVkV29yZENoYXJzID0gL15bYS16QS1aXFx1e0MwfS1cXHV7RkZ9XFx1e0Q4fS1cXHV7RjZ9XFx1e0Y4fS1cXHV7MkM2fVxcdXsyQzh9LVxcdXsyRDd9XFx1ezJERX0tXFx1ezJGRn1cXHV7MUUwMH0tXFx1ezFFRkZ9XSskL3U7XG5cbmNvbnN0IHJlV2hpdGVzcGFjZSA9IC9cXFMvO1xuXG5leHBvcnQgY29uc3Qgd29yZERpZmYgPSBuZXcgRGlmZigpO1xud29yZERpZmYuZXF1YWxzID0gZnVuY3Rpb24obGVmdCwgcmlnaHQpIHtcbiAgaWYgKHRoaXMub3B0aW9ucy5pZ25vcmVDYXNlKSB7XG4gICAgbGVmdCA9IGxlZnQudG9Mb3dlckNhc2UoKTtcbiAgICByaWdodCA9IHJpZ2h0LnRvTG93ZXJDYXNlKCk7XG4gIH1cbiAgcmV0dXJuIGxlZnQgPT09IHJpZ2h0IHx8ICh0aGlzLm9wdGlvbnMuaWdub3JlV2hpdGVzcGFjZSAmJiAhcmVXaGl0ZXNwYWNlLnRlc3QobGVmdCkgJiYgIXJlV2hpdGVzcGFjZS50ZXN0KHJpZ2h0KSk7XG59O1xud29yZERpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBsZXQgdG9rZW5zID0gdmFsdWUuc3BsaXQoLyhcXHMrfFxcYikvKTtcblxuICAvLyBKb2luIHRoZSBib3VuZGFyeSBzcGxpdHMgdGhhdCB3ZSBkbyBub3QgY29uc2lkZXIgdG8gYmUgYm91bmRhcmllcy4gVGhpcyBpcyBwcmltYXJpbHkgdGhlIGV4dGVuZGVkIExhdGluIGNoYXJhY3RlciBzZXQuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdG9rZW5zLmxlbmd0aCAtIDE7IGkrKykge1xuICAgIC8vIElmIHdlIGhhdmUgYW4gZW1wdHkgc3RyaW5nIGluIHRoZSBuZXh0IGZpZWxkIGFuZCB3ZSBoYXZlIG9ubHkgd29yZCBjaGFycyBiZWZvcmUgYW5kIGFmdGVyLCBtZXJnZVxuICAgIGlmICghdG9rZW5zW2kgKyAxXSAmJiB0b2tlbnNbaSArIDJdXG4gICAgICAgICAgJiYgZXh0ZW5kZWRXb3JkQ2hhcnMudGVzdCh0b2tlbnNbaV0pXG4gICAgICAgICAgJiYgZXh0ZW5kZWRXb3JkQ2hhcnMudGVzdCh0b2tlbnNbaSArIDJdKSkge1xuICAgICAgdG9rZW5zW2ldICs9IHRva2Vuc1tpICsgMl07XG4gICAgICB0b2tlbnMuc3BsaWNlKGkgKyAxLCAyKTtcbiAgICAgIGktLTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG9rZW5zO1xufTtcblxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZXb3JkcyhvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykge1xuICBvcHRpb25zID0gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIHtpZ25vcmVXaGl0ZXNwYWNlOiB0cnVlfSk7XG4gIHJldHVybiB3b3JkRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpZmZXb3Jkc1dpdGhTcGFjZShvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucykge1xuICByZXR1cm4gd29yZERpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgb3B0aW9ucyk7XG59XG4iXX0=\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/generateOptions = generateOptions;\n\tfunction generateOptions(options, defaults) {\n\t  if (typeof options === 'function') {\n\t    defaults.callback = options;\n\t  } else if (options) {\n\t    for (var name in options) {\n\t      /* istanbul ignore else */\n\t      if (options.hasOwnProperty(name)) {\n\t        defaults[name] = options[name];\n\t      }\n\t    }\n\t  }\n\t  return defaults;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL3BhcmFtcy5qcyJdLCJuYW1lcyI6WyJnZW5lcmF0ZU9wdGlvbnMiLCJvcHRpb25zIiwiZGVmYXVsdHMiLCJjYWxsYmFjayIsIm5hbWUiLCJoYXNPd25Qcm9wZXJ0eSJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsZSxHQUFBQSxlO0FBQVQsU0FBU0EsZUFBVCxDQUF5QkMsT0FBekIsRUFBa0NDLFFBQWxDLEVBQTRDO0FBQ2pELE1BQUksT0FBT0QsT0FBUCxLQUFtQixVQUF2QixFQUFtQztBQUNqQ0MsYUFBU0MsUUFBVCxHQUFvQkYsT0FBcEI7QUFDRCxHQUZELE1BRU8sSUFBSUEsT0FBSixFQUFhO0FBQ2xCLFNBQUssSUFBSUcsSUFBVCxJQUFpQkgsT0FBakIsRUFBMEI7QUFDeEI7QUFDQSxVQUFJQSxRQUFRSSxjQUFSLENBQXVCRCxJQUF2QixDQUFKLEVBQWtDO0FBQ2hDRixpQkFBU0UsSUFBVCxJQUFpQkgsUUFBUUcsSUFBUixDQUFqQjtBQUNEO0FBQ0Y7QUFDRjtBQUNELFNBQU9GLFFBQVA7QUFDRCIsImZpbGUiOiJwYXJhbXMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVPcHRpb25zKG9wdGlvbnMsIGRlZmF1bHRzKSB7XG4gIGlmICh0eXBlb2Ygb3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIGRlZmF1bHRzLmNhbGxiYWNrID0gb3B0aW9ucztcbiAgfSBlbHNlIGlmIChvcHRpb25zKSB7XG4gICAgZm9yIChsZXQgbmFtZSBpbiBvcHRpb25zKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9wdGlvbnMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgZGVmYXVsdHNbbmFtZV0gPSBvcHRpb25zW25hbWVdO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICByZXR1cm4gZGVmYXVsdHM7XG59XG4iXX0=\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.lineDiff = undefined;\n\texports. /*istanbul ignore end*/diffLines = diffLines;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/diffTrimmedLines = diffTrimmedLines;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_params = __webpack_require__(4) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var lineDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/lineDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tlineDiff.tokenize = function (value) {\n\t  var retLines = [],\n\t      linesAndNewlines = value.split(/(\\n|\\r\\n)/);\n\n\t  // Ignore the final empty token that occurs if the string ends with a new line\n\t  if (!linesAndNewlines[linesAndNewlines.length - 1]) {\n\t    linesAndNewlines.pop();\n\t  }\n\n\t  // Merge the content and line separators into single tokens\n\t  for (var i = 0; i < linesAndNewlines.length; i++) {\n\t    var line = linesAndNewlines[i];\n\n\t    if (i % 2 && !this.options.newlineIsToken) {\n\t      retLines[retLines.length - 1] += line;\n\t    } else {\n\t      if (this.options.ignoreWhitespace) {\n\t        line = line.trim();\n\t      }\n\t      retLines.push(line);\n\t    }\n\t  }\n\n\t  return retLines;\n\t};\n\n\tfunction diffLines(oldStr, newStr, callback) {\n\t  return lineDiff.diff(oldStr, newStr, callback);\n\t}\n\tfunction diffTrimmedLines(oldStr, newStr, callback) {\n\t  var options = /*istanbul ignore start*/(0, _params.generateOptions) /*istanbul ignore end*/(callback, { ignoreWhitespace: true });\n\t  return lineDiff.diff(oldStr, newStr, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2xpbmUuanMiXSwibmFtZXMiOlsiZGlmZkxpbmVzIiwiZGlmZlRyaW1tZWRMaW5lcyIsImxpbmVEaWZmIiwidG9rZW5pemUiLCJ2YWx1ZSIsInJldExpbmVzIiwibGluZXNBbmROZXdsaW5lcyIsInNwbGl0IiwibGVuZ3RoIiwicG9wIiwiaSIsImxpbmUiLCJvcHRpb25zIiwibmV3bGluZUlzVG9rZW4iLCJpZ25vcmVXaGl0ZXNwYWNlIiwidHJpbSIsInB1c2giLCJvbGRTdHIiLCJuZXdTdHIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBOEJnQkEsUyxHQUFBQSxTO3lEQUNBQyxnQixHQUFBQSxnQjs7QUEvQmhCOzs7O3VCQUNBOzs7O3VCQUVPLElBQU1DLCtFQUFXLHdFQUFqQjtBQUNQQSxTQUFTQyxRQUFULEdBQW9CLFVBQVNDLEtBQVQsRUFBZ0I7QUFDbEMsTUFBSUMsV0FBVyxFQUFmO0FBQUEsTUFDSUMsbUJBQW1CRixNQUFNRyxLQUFOLENBQVksV0FBWixDQUR2Qjs7QUFHQTtBQUNBLE1BQUksQ0FBQ0QsaUJBQWlCQSxpQkFBaUJFLE1BQWpCLEdBQTBCLENBQTNDLENBQUwsRUFBb0Q7QUFDbERGLHFCQUFpQkcsR0FBakI7QUFDRDs7QUFFRDtBQUNBLE9BQUssSUFBSUMsSUFBSSxDQUFiLEVBQWdCQSxJQUFJSixpQkFBaUJFLE1BQXJDLEVBQTZDRSxHQUE3QyxFQUFrRDtBQUNoRCxRQUFJQyxPQUFPTCxpQkFBaUJJLENBQWpCLENBQVg7O0FBRUEsUUFBSUEsSUFBSSxDQUFKLElBQVMsQ0FBQyxLQUFLRSxPQUFMLENBQWFDLGNBQTNCLEVBQTJDO0FBQ3pDUixlQUFTQSxTQUFTRyxNQUFULEdBQWtCLENBQTNCLEtBQWlDRyxJQUFqQztBQUNELEtBRkQsTUFFTztBQUNMLFVBQUksS0FBS0MsT0FBTCxDQUFhRSxnQkFBakIsRUFBbUM7QUFDakNILGVBQU9BLEtBQUtJLElBQUwsRUFBUDtBQUNEO0FBQ0RWLGVBQVNXLElBQVQsQ0FBY0wsSUFBZDtBQUNEO0FBQ0Y7O0FBRUQsU0FBT04sUUFBUDtBQUNELENBeEJEOztBQTBCTyxTQUFTTCxTQUFULENBQW1CaUIsTUFBbkIsRUFBMkJDLE1BQTNCLEVBQW1DQyxRQUFuQyxFQUE2QztBQUFFLFNBQU9qQixTQUFTa0IsSUFBVCxDQUFjSCxNQUFkLEVBQXNCQyxNQUF0QixFQUE4QkMsUUFBOUIsQ0FBUDtBQUFpRDtBQUNoRyxTQUFTbEIsZ0JBQVQsQ0FBMEJnQixNQUExQixFQUFrQ0MsTUFBbEMsRUFBMENDLFFBQTFDLEVBQW9EO0FBQ3pELE1BQUlQLFVBQVUsOEVBQWdCTyxRQUFoQixFQUEwQixFQUFDTCxrQkFBa0IsSUFBbkIsRUFBMUIsQ0FBZDtBQUNBLFNBQU9aLFNBQVNrQixJQUFULENBQWNILE1BQWQsRUFBc0JDLE1BQXRCLEVBQThCTixPQUE5QixDQUFQO0FBQ0QiLCJmaWxlIjoibGluZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5pbXBvcnQge2dlbmVyYXRlT3B0aW9uc30gZnJvbSAnLi4vdXRpbC9wYXJhbXMnO1xuXG5leHBvcnQgY29uc3QgbGluZURpZmYgPSBuZXcgRGlmZigpO1xubGluZURpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICBsZXQgcmV0TGluZXMgPSBbXSxcbiAgICAgIGxpbmVzQW5kTmV3bGluZXMgPSB2YWx1ZS5zcGxpdCgvKFxcbnxcXHJcXG4pLyk7XG5cbiAgLy8gSWdub3JlIHRoZSBmaW5hbCBlbXB0eSB0b2tlbiB0aGF0IG9jY3VycyBpZiB0aGUgc3RyaW5nIGVuZHMgd2l0aCBhIG5ldyBsaW5lXG4gIGlmICghbGluZXNBbmROZXdsaW5lc1tsaW5lc0FuZE5ld2xpbmVzLmxlbmd0aCAtIDFdKSB7XG4gICAgbGluZXNBbmROZXdsaW5lcy5wb3AoKTtcbiAgfVxuXG4gIC8vIE1lcmdlIHRoZSBjb250ZW50IGFuZCBsaW5lIHNlcGFyYXRvcnMgaW50byBzaW5nbGUgdG9rZW5zXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXNBbmROZXdsaW5lcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBsaW5lID0gbGluZXNBbmROZXdsaW5lc1tpXTtcblxuICAgIGlmIChpICUgMiAmJiAhdGhpcy5vcHRpb25zLm5ld2xpbmVJc1Rva2VuKSB7XG4gICAgICByZXRMaW5lc1tyZXRMaW5lcy5sZW5ndGggLSAxXSArPSBsaW5lO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5vcHRpb25zLmlnbm9yZVdoaXRlc3BhY2UpIHtcbiAgICAgICAgbGluZSA9IGxpbmUudHJpbSgpO1xuICAgICAgfVxuICAgICAgcmV0TGluZXMucHVzaChsaW5lKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmV0TGluZXM7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjaykgeyByZXR1cm4gbGluZURpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spOyB9XG5leHBvcnQgZnVuY3Rpb24gZGlmZlRyaW1tZWRMaW5lcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHtcbiAgbGV0IG9wdGlvbnMgPSBnZW5lcmF0ZU9wdGlvbnMoY2FsbGJhY2ssIHtpZ25vcmVXaGl0ZXNwYWNlOiB0cnVlfSk7XG4gIHJldHVybiBsaW5lRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbn1cbiJdfQ==\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.sentenceDiff = undefined;\n\texports. /*istanbul ignore end*/diffSentences = diffSentences;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var sentenceDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/sentenceDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tsentenceDiff.tokenize = function (value) {\n\t  return value.split(/(\\S.+?[.!?])(?=\\s+|$)/);\n\t};\n\n\tfunction diffSentences(oldStr, newStr, callback) {\n\t  return sentenceDiff.diff(oldStr, newStr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL3NlbnRlbmNlLmpzIl0sIm5hbWVzIjpbImRpZmZTZW50ZW5jZXMiLCJzZW50ZW5jZURpZmYiLCJ0b2tlbml6ZSIsInZhbHVlIiwic3BsaXQiLCJvbGRTdHIiLCJuZXdTdHIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBUWdCQSxhLEdBQUFBLGE7O0FBUmhCOzs7Ozs7dUJBR08sSUFBTUMsdUZBQWUsd0VBQXJCO0FBQ1BBLGFBQWFDLFFBQWIsR0FBd0IsVUFBU0MsS0FBVCxFQUFnQjtBQUN0QyxTQUFPQSxNQUFNQyxLQUFOLENBQVksdUJBQVosQ0FBUDtBQUNELENBRkQ7O0FBSU8sU0FBU0osYUFBVCxDQUF1QkssTUFBdkIsRUFBK0JDLE1BQS9CLEVBQXVDQyxRQUF2QyxFQUFpRDtBQUFFLFNBQU9OLGFBQWFPLElBQWIsQ0FBa0JILE1BQWxCLEVBQTBCQyxNQUExQixFQUFrQ0MsUUFBbEMsQ0FBUDtBQUFxRCIsImZpbGUiOiJzZW50ZW5jZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cblxuZXhwb3J0IGNvbnN0IHNlbnRlbmNlRGlmZiA9IG5ldyBEaWZmKCk7XG5zZW50ZW5jZURpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhcXFMuKz9bLiE/XSkoPz1cXHMrfCQpLyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZlNlbnRlbmNlcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHsgcmV0dXJuIHNlbnRlbmNlRGlmZi5kaWZmKG9sZFN0ciwgbmV3U3RyLCBjYWxsYmFjayk7IH1cbiJdfQ==\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.cssDiff = undefined;\n\texports. /*istanbul ignore end*/diffCss = diffCss;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var cssDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/cssDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tcssDiff.tokenize = function (value) {\n\t  return value.split(/([{}:;,]|\\s+)/);\n\t};\n\n\tfunction diffCss(oldStr, newStr, callback) {\n\t  return cssDiff.diff(oldStr, newStr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2Nzcy5qcyJdLCJuYW1lcyI6WyJkaWZmQ3NzIiwiY3NzRGlmZiIsInRva2VuaXplIiwidmFsdWUiLCJzcGxpdCIsIm9sZFN0ciIsIm5ld1N0ciIsImNhbGxiYWNrIiwiZGlmZiJdLCJtYXBwaW5ncyI6Ijs7OztnQ0FPZ0JBLE8sR0FBQUEsTzs7QUFQaEI7Ozs7Ozt1QkFFTyxJQUFNQyw2RUFBVSx3RUFBaEI7QUFDUEEsUUFBUUMsUUFBUixHQUFtQixVQUFTQyxLQUFULEVBQWdCO0FBQ2pDLFNBQU9BLE1BQU1DLEtBQU4sQ0FBWSxlQUFaLENBQVA7QUFDRCxDQUZEOztBQUlPLFNBQVNKLE9BQVQsQ0FBaUJLLE1BQWpCLEVBQXlCQyxNQUF6QixFQUFpQ0MsUUFBakMsRUFBMkM7QUFBRSxTQUFPTixRQUFRTyxJQUFSLENBQWFILE1BQWIsRUFBcUJDLE1BQXJCLEVBQTZCQyxRQUE3QixDQUFQO0FBQWdEIiwiZmlsZSI6ImNzcy5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjb25zdCBjc3NEaWZmID0gbmV3IERpZmYoKTtcbmNzc0RpZmYudG9rZW5pemUgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUuc3BsaXQoLyhbe306OyxdfFxccyspLyk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkNzcyhvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spIHsgcmV0dXJuIGNzc0RpZmYuZGlmZihvbGRTdHIsIG5ld1N0ciwgY2FsbGJhY2spOyB9XG4iXX0=\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.jsonDiff = undefined;\n\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n\texports. /*istanbul ignore end*/diffJson = diffJson;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/canonicalize = canonicalize;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\t/*istanbul ignore end*/var /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var objectPrototypeToString = Object.prototype.toString;\n\n\tvar jsonDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/jsonDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\t// Discriminate between two lines of pretty-printed, serialized JSON where one of them has a\n\t// dangling comma and the other doesn't. Turns out including the dangling comma yields the nicest output:\n\tjsonDiff.useLongestToken = true;\n\n\tjsonDiff.tokenize = /*istanbul ignore start*/_line.lineDiff /*istanbul ignore end*/.tokenize;\n\tjsonDiff.castInput = function (value) {\n\t  /*istanbul ignore start*/var _options = /*istanbul ignore end*/this.options,\n\t      undefinedReplacement = _options.undefinedReplacement,\n\t      _options$stringifyRep = _options.stringifyReplacer,\n\t      stringifyReplacer = _options$stringifyRep === undefined ? function (k, v) /*istanbul ignore start*/{\n\t    return (/*istanbul ignore end*/typeof v === 'undefined' ? undefinedReplacement : v\n\t    );\n\t  } : _options$stringifyRep;\n\n\n\t  return typeof value === 'string' ? value : JSON.stringify(canonicalize(value, null, null, stringifyReplacer), stringifyReplacer, '  ');\n\t};\n\tjsonDiff.equals = function (left, right) {\n\t  return (/*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/.prototype.equals.call(jsonDiff, left.replace(/,([\\r\\n])/g, '$1'), right.replace(/,([\\r\\n])/g, '$1'))\n\t  );\n\t};\n\n\tfunction diffJson(oldObj, newObj, options) {\n\t  return jsonDiff.diff(oldObj, newObj, options);\n\t}\n\n\t// This function handles the presence of circular references by bailing out when encountering an\n\t// object that is already on the \"stack\" of items being processed. Accepts an optional replacer\n\tfunction canonicalize(obj, stack, replacementStack, replacer, key) {\n\t  stack = stack || [];\n\t  replacementStack = replacementStack || [];\n\n\t  if (replacer) {\n\t    obj = replacer(key, obj);\n\t  }\n\n\t  var i = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  for (i = 0; i < stack.length; i += 1) {\n\t    if (stack[i] === obj) {\n\t      return replacementStack[i];\n\t    }\n\t  }\n\n\t  var canonicalizedObj = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  if ('[object Array]' === objectPrototypeToString.call(obj)) {\n\t    stack.push(obj);\n\t    canonicalizedObj = new Array(obj.length);\n\t    replacementStack.push(canonicalizedObj);\n\t    for (i = 0; i < obj.length; i += 1) {\n\t      canonicalizedObj[i] = canonicalize(obj[i], stack, replacementStack, replacer, key);\n\t    }\n\t    stack.pop();\n\t    replacementStack.pop();\n\t    return canonicalizedObj;\n\t  }\n\n\t  if (obj && obj.toJSON) {\n\t    obj = obj.toJSON();\n\t  }\n\n\t  if ( /*istanbul ignore start*/(typeof /*istanbul ignore end*/obj === 'undefined' ? 'undefined' : _typeof(obj)) === 'object' && obj !== null) {\n\t    stack.push(obj);\n\t    canonicalizedObj = {};\n\t    replacementStack.push(canonicalizedObj);\n\t    var sortedKeys = [],\n\t        _key = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t    for (_key in obj) {\n\t      /* istanbul ignore else */\n\t      if (obj.hasOwnProperty(_key)) {\n\t        sortedKeys.push(_key);\n\t      }\n\t    }\n\t    sortedKeys.sort();\n\t    for (i = 0; i < sortedKeys.length; i += 1) {\n\t      _key = sortedKeys[i];\n\t      canonicalizedObj[_key] = canonicalize(obj[_key], stack, replacementStack, replacer, _key);\n\t    }\n\t    stack.pop();\n\t    replacementStack.pop();\n\t  } else {\n\t    canonicalizedObj = obj;\n\t  }\n\t  return canonicalizedObj;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2pzb24uanMiXSwibmFtZXMiOlsiZGlmZkpzb24iLCJjYW5vbmljYWxpemUiLCJvYmplY3RQcm90b3R5cGVUb1N0cmluZyIsIk9iamVjdCIsInByb3RvdHlwZSIsInRvU3RyaW5nIiwianNvbkRpZmYiLCJ1c2VMb25nZXN0VG9rZW4iLCJ0b2tlbml6ZSIsImNhc3RJbnB1dCIsInZhbHVlIiwib3B0aW9ucyIsInVuZGVmaW5lZFJlcGxhY2VtZW50Iiwic3RyaW5naWZ5UmVwbGFjZXIiLCJrIiwidiIsIkpTT04iLCJzdHJpbmdpZnkiLCJlcXVhbHMiLCJsZWZ0IiwicmlnaHQiLCJjYWxsIiwicmVwbGFjZSIsIm9sZE9iaiIsIm5ld09iaiIsImRpZmYiLCJvYmoiLCJzdGFjayIsInJlcGxhY2VtZW50U3RhY2siLCJyZXBsYWNlciIsImtleSIsImkiLCJsZW5ndGgiLCJjYW5vbmljYWxpemVkT2JqIiwicHVzaCIsIkFycmF5IiwicG9wIiwidG9KU09OIiwic29ydGVkS2V5cyIsImhhc093blByb3BlcnR5Iiwic29ydCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztnQ0FxQmdCQSxRLEdBQUFBLFE7eURBSUFDLFksR0FBQUEsWTs7QUF6QmhCOzs7O3VCQUNBOzs7O3VCQUVBLElBQU1DLDBCQUEwQkMsT0FBT0MsU0FBUCxDQUFpQkMsUUFBakQ7O0FBR08sSUFBTUMsK0VBQVcsd0VBQWpCO0FBQ1A7QUFDQTtBQUNBQSxTQUFTQyxlQUFULEdBQTJCLElBQTNCOztBQUVBRCxTQUFTRSxRQUFULEdBQW9CLGdFQUFTQSxRQUE3QjtBQUNBRixTQUFTRyxTQUFULEdBQXFCLFVBQVNDLEtBQVQsRUFBZ0I7QUFBQSxpRUFDK0UsS0FBS0MsT0FEcEY7QUFBQSxNQUM1QkMsb0JBRDRCLFlBQzVCQSxvQkFENEI7QUFBQSx1Q0FDTkMsaUJBRE07QUFBQSxNQUNOQSxpQkFETSx5Q0FDYyxVQUFDQyxDQUFELEVBQUlDLENBQUo7QUFBQSxtQ0FBVSxPQUFPQSxDQUFQ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QUFLVCxJQUFJLENBQVQsRUFBWUEsSUFBSU8sV0FBV04sTUFBM0IsRUFBbUNELEtBQUssQ0FBeEMsRUFBMkM7QUFDekNELGFBQU1RLFdBQVdQLENBQVgsQ0FBTjtBQUNBRSx1QkFBaUJILElBQWpCLElBQXdCN0IsYUFBYXlCLElBQUlJLElBQUosQ0FBYixFQUF1QkgsS0FBdkIsRUFBOEJDLGdCQUE5QixFQUFnREMsUUFBaEQsRUFBMERDLElBQTFELENBQXhCO0FBQ0Q7QUFDREgsVUFBTVMsR0FBTjtBQUNBUixxQkFBaUJRLEdBQWpCO0FBQ0QsR0FuQkQsTUFtQk87QUFDTEgsdUJBQW1CUCxHQUFuQjtBQUNEO0FBQ0QsU0FBT08sZ0JBQVA7QUFDRCIsImZpbGUiOiJqc29uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IERpZmYgZnJvbSAnLi9iYXNlJztcbmltcG9ydCB7bGluZURpZmZ9IGZyb20gJy4vbGluZSc7XG5cbmNvbnN0IG9iamVjdFByb3RvdHlwZVRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuXG5leHBvcnQgY29uc3QganNvbkRpZmYgPSBuZXcgRGlmZigpO1xuLy8gRGlzY3JpbWluYXRlIGJldHdlZW4gdHdvIGxpbmVzIG9mIHByZXR0eS1wcmludGVkLCBzZXJpYWxpemVkIEpTT04gd2hlcmUgb25lIG9mIHRoZW0gaGFzIGFcbi8vIGRhbmdsaW5nIGNvbW1hIGFuZCB0aGUgb3RoZXIgZG9lc24ndC4gVHVybnMgb3V0IGluY2x1ZGluZyB0aGUgZGFuZ2xpbmcgY29tbWEgeWllbGRzIHRoZSBuaWNlc3Qgb3V0cHV0OlxuanNvbkRpZmYudXNlTG9uZ2VzdFRva2VuID0gdHJ1ZTtcblxuanNvbkRpZmYudG9rZW5pemUgPSBsaW5lRGlmZi50b2tlbml6ZTtcbmpzb25EaWZmLmNhc3RJbnB1dCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gIGNvbnN0IHt1bmRlZmluZWRSZXBsYWNlbWVudCwgc3RyaW5naWZ5UmVwbGFjZXIgPSAoaywgdikgPT4gdHlwZW9mIHYgPT09ICd1bmRlZmluZWQnID8gdW5kZWZpbmVkUmVwbGFjZW1lbnQgOiB2fSA9IHRoaXMub3B0aW9ucztcblxuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyA/IHZhbHVlIDogSlNPTi5zdHJpbmdpZnkoY2Fub25pY2FsaXplKHZhbHVlLCBudWxsLCBudWxsLCBzdHJpbmdpZnlSZXBsYWNlciksIHN0cmluZ2lmeVJlcGxhY2VyLCAnICAnKTtcbn07XG5qc29uRGlmZi5lcXVhbHMgPSBmdW5jdGlvbihsZWZ0LCByaWdodCkge1xuICByZXR1cm4gRGlmZi5wcm90b3R5cGUuZXF1YWxzLmNhbGwoanNvbkRpZmYsIGxlZnQucmVwbGFjZSgvLChbXFxyXFxuXSkvZywgJyQxJyksIHJpZ2h0LnJlcGxhY2UoLywoW1xcclxcbl0pL2csICckMScpKTtcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBkaWZmSnNvbihvbGRPYmosIG5ld09iaiwgb3B0aW9ucykgeyByZXR1cm4ganNvbkRpZmYuZGlmZihvbGRPYmosIG5ld09iaiwgb3B0aW9ucyk7IH1cblxuLy8gVGhpcyBmdW5jdGlvbiBoYW5kbGVzIHRoZSBwcmVzZW5jZSBvZiBjaXJjdWxhciByZWZlcmVuY2VzIGJ5IGJhaWxpbmcgb3V0IHdoZW4gZW5jb3VudGVyaW5nIGFuXG4vLyBvYmplY3QgdGhhdCBpcyBhbHJlYWR5IG9uIHRoZSBcInN0YWNrXCIgb2YgaXRlbXMgYmVpbmcgcHJvY2Vzc2VkLiBBY2NlcHRzIGFuIG9wdGlvbmFsIHJlcGxhY2VyXG5leHBvcnQgZnVuY3Rpb24gY2Fub25pY2FsaXplKG9iaiwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpIHtcbiAgc3RhY2sgPSBzdGFjayB8fCBbXTtcbiAgcmVwbGFjZW1lbnRTdGFjayA9IHJlcGxhY2VtZW50U3RhY2sgfHwgW107XG5cbiAgaWYgKHJlcGxhY2VyKSB7XG4gICAgb2JqID0gcmVwbGFjZXIoa2V5LCBvYmopO1xuICB9XG5cbiAgbGV0IGk7XG5cbiAgZm9yIChpID0gMDsgaSA8IHN0YWNrLmxlbmd0aDsgaSArPSAxKSB7XG4gICAgaWYgKHN0YWNrW2ldID09PSBvYmopIHtcbiAgICAgIHJldHVybiByZXBsYWNlbWVudFN0YWNrW2ldO1xuICAgIH1cbiAgfVxuXG4gIGxldCBjYW5vbmljYWxpemVkT2JqO1xuXG4gIGlmICgnW29iamVjdCBBcnJheV0nID09PSBvYmplY3RQcm90b3R5cGVUb1N0cmluZy5jYWxsKG9iaikpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IG5ldyBBcnJheShvYmoubGVuZ3RoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnB1c2goY2Fub25pY2FsaXplZE9iaik7XG4gICAgZm9yIChpID0gMDsgaSA8IG9iai5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAgY2Fub25pY2FsaXplZE9ialtpXSA9IGNhbm9uaWNhbGl6ZShvYmpbaV0sIHN0YWNrLCByZXBsYWNlbWVudFN0YWNrLCByZXBsYWNlciwga2V5KTtcbiAgICB9XG4gICAgc3RhY2sucG9wKCk7XG4gICAgcmVwbGFjZW1lbnRTdGFjay5wb3AoKTtcbiAgICByZXR1cm4gY2Fub25pY2FsaXplZE9iajtcbiAgfVxuXG4gIGlmIChvYmogJiYgb2JqLnRvSlNPTikge1xuICAgIG9iaiA9IG9iai50b0pTT04oKTtcbiAgfVxuXG4gIGlmICh0eXBlb2Ygb2JqID09PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGwpIHtcbiAgICBzdGFjay5wdXNoKG9iaik7XG4gICAgY2Fub25pY2FsaXplZE9iaiA9IHt9O1xuICAgIHJlcGxhY2VtZW50U3RhY2sucHVzaChjYW5vbmljYWxpemVkT2JqKTtcbiAgICBsZXQgc29ydGVkS2V5cyA9IFtdLFxuICAgICAgICBrZXk7XG4gICAgZm9yIChrZXkgaW4gb2JqKSB7XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIHNvcnRlZEtleXMucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICBzb3J0ZWRLZXlzLnNvcnQoKTtcbiAgICBmb3IgKGkgPSAwOyBpIDwgc29ydGVkS2V5cy5sZW5ndGg7IGkgKz0gMSkge1xuICAgICAga2V5ID0gc29ydGVkS2V5c1tpXTtcbiAgICAgIGNhbm9uaWNhbGl6ZWRPYmpba2V5XSA9IGNhbm9uaWNhbGl6ZShvYmpba2V5XSwgc3RhY2ssIHJlcGxhY2VtZW50U3RhY2ssIHJlcGxhY2VyLCBrZXkpO1xuICAgIH1cbiAgICBzdGFjay5wb3AoKTtcbiAgICByZXBsYWNlbWVudFN0YWNrLnBvcCgpO1xuICB9IGVsc2Uge1xuICAgIGNhbm9uaWNhbGl6ZWRPYmogPSBvYmo7XG4gIH1cbiAgcmV0dXJuIGNhbm9uaWNhbGl6ZWRPYmo7XG59XG4iXX0=\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports.arrayDiff = undefined;\n\texports. /*istanbul ignore end*/diffArrays = diffArrays;\n\n\tvar /*istanbul ignore start*/_base = __webpack_require__(1) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _base2 = _interopRequireDefault(_base);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/var arrayDiff = /*istanbul ignore start*/exports. /*istanbul ignore end*/arrayDiff = new /*istanbul ignore start*/_base2['default'] /*istanbul ignore end*/();\n\tarrayDiff.tokenize = function (value) {\n\t  return value.slice();\n\t};\n\tarrayDiff.join = arrayDiff.removeEmpty = function (value) {\n\t  return value;\n\t};\n\n\tfunction diffArrays(oldArr, newArr, callback) {\n\t  return arrayDiff.diff(oldArr, newArr, callback);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9kaWZmL2FycmF5LmpzIl0sIm5hbWVzIjpbImRpZmZBcnJheXMiLCJhcnJheURpZmYiLCJ0b2tlbml6ZSIsInZhbHVlIiwic2xpY2UiLCJqb2luIiwicmVtb3ZlRW1wdHkiLCJvbGRBcnIiLCJuZXdBcnIiLCJjYWxsYmFjayIsImRpZmYiXSwibWFwcGluZ3MiOiI7Ozs7Z0NBVWdCQSxVLEdBQUFBLFU7O0FBVmhCOzs7Ozs7dUJBRU8sSUFBTUMsaUZBQVksd0VBQWxCO0FBQ1BBLFVBQVVDLFFBQVYsR0FBcUIsVUFBU0MsS0FBVCxFQUFnQjtBQUNuQyxTQUFPQSxNQUFNQyxLQUFOLEVBQVA7QUFDRCxDQUZEO0FBR0FILFVBQVVJLElBQVYsR0FBaUJKLFVBQVVLLFdBQVYsR0FBd0IsVUFBU0gsS0FBVCxFQUFnQjtBQUN2RCxTQUFPQSxLQUFQO0FBQ0QsQ0FGRDs7QUFJTyxTQUFTSCxVQUFULENBQW9CTyxNQUFwQixFQUE0QkMsTUFBNUIsRUFBb0NDLFFBQXBDLEVBQThDO0FBQUUsU0FBT1IsVUFBVVMsSUFBVixDQUFlSCxNQUFmLEVBQXVCQyxNQUF2QixFQUErQkMsUUFBL0IsQ0FBUDtBQUFrRCIsImZpbGUiOiJhcnJheS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBEaWZmIGZyb20gJy4vYmFzZSc7XG5cbmV4cG9ydCBjb25zdCBhcnJheURpZmYgPSBuZXcgRGlmZigpO1xuYXJyYXlEaWZmLnRva2VuaXplID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgcmV0dXJuIHZhbHVlLnNsaWNlKCk7XG59O1xuYXJyYXlEaWZmLmpvaW4gPSBhcnJheURpZmYucmVtb3ZlRW1wdHkgPSBmdW5jdGlvbih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGlmZkFycmF5cyhvbGRBcnIsIG5ld0FyciwgY2FsbGJhY2spIHsgcmV0dXJuIGFycmF5RGlmZi5kaWZmKG9sZEFyciwgbmV3QXJyLCBjYWxsYmFjayk7IH1cbiJdfQ==\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/applyPatch = applyPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/applyPatches = applyPatches;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_distanceIterator = __webpack_require__(12) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/var _distanceIterator2 = _interopRequireDefault(_distanceIterator);\n\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n\t/*istanbul ignore end*/function applyPatch(source, uniDiff) {\n\t  /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n\t  if (typeof uniDiff === 'string') {\n\t    uniDiff = /*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(uniDiff);\n\t  }\n\n\t  if (Array.isArray(uniDiff)) {\n\t    if (uniDiff.length > 1) {\n\t      throw new Error('applyPatch only works with a single input.');\n\t    }\n\n\t    uniDiff = uniDiff[0];\n\t  }\n\n\t  // Apply the diff to the input\n\t  var lines = source.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n\t      delimiters = source.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n\t      hunks = uniDiff.hunks,\n\t      compareLine = options.compareLine || function (lineNumber, line, operation, patchContent) /*istanbul ignore start*/{\n\t    return (/*istanbul ignore end*/line === patchContent\n\t    );\n\t  },\n\t      errorCount = 0,\n\t      fuzzFactor = options.fuzzFactor || 0,\n\t      minLine = 0,\n\t      offset = 0,\n\t      removeEOFNL = /*istanbul ignore start*/void 0 /*istanbul ignore end*/,\n\t      addEOFNL = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\n\t  /**\n\t   * Checks if the hunk exactly fits on the provided location\n\t   */\n\t  function hunkFits(hunk, toPos) {\n\t    for (var j = 0; j < hunk.lines.length; j++) {\n\t      var line = hunk.lines[j],\n\t          operation = line.length > 0 ? line[0] : ' ',\n\t          content = line.length > 0 ? line.substr(1) : line;\n\n\t      if (operation === ' ' || operation === '-') {\n\t        // Context sanity check\n\t        if (!compareLine(toPos + 1, lines[toPos], operation, content)) {\n\t          errorCount++;\n\n\t          if (errorCount > fuzzFactor) {\n\t            return false;\n\t          }\n\t        }\n\t        toPos++;\n\t      }\n\t    }\n\n\t    return true;\n\t  }\n\n\t  // Search best fit offsets for each hunk based on the previous ones\n\t  for (var i = 0; i < hunks.length; i++) {\n\t    var hunk = hunks[i],\n\t        maxLine = lines.length - hunk.oldLines,\n\t        localOffset = 0,\n\t        toPos = offset + hunk.oldStart - 1;\n\n\t    var iterator = /*istanbul ignore start*/(0, _distanceIterator2['default']) /*istanbul ignore end*/(toPos, minLine, maxLine);\n\n\t    for (; localOffset !== undefined; localOffset = iterator()) {\n\t      if (hunkFits(hunk, toPos + localOffset)) {\n\t        hunk.offset = offset += localOffset;\n\t        break;\n\t      }\n\t    }\n\n\t    if (localOffset === undefined) {\n\t      return false;\n\t    }\n\n\t    // Set lower text limit to end of the current hunk, so next ones don't try\n\t    // to fit over already patched text\n\t    minLine = hunk.offset + hunk.oldStart + hunk.oldLines;\n\t  }\n\n\t  // Apply patch hunks\n\t  var diffOffset = 0;\n\t  for (var _i = 0; _i < hunks.length; _i++) {\n\t    var _hunk = hunks[_i],\n\t        _toPos = _hunk.oldStart + _hunk.offset + diffOffset - 1;\n\t    diffOffset += _hunk.newLines - _hunk.oldLines;\n\n\t    if (_toPos < 0) {\n\t      // Creating a new file\n\t      _toPos = 0;\n\t    }\n\n\t    for (var j = 0; j < _hunk.lines.length; j++) {\n\t      var line = _hunk.lines[j],\n\t          operation = line.length > 0 ? line[0] : ' ',\n\t          content = line.length > 0 ? line.substr(1) : line,\n\t          delimiter = _hunk.linedelimiters[j];\n\n\t      if (operation === ' ') {\n\t        _toPos++;\n\t      } else if (operation === '-') {\n\t        lines.splice(_toPos, 1);\n\t        delimiters.splice(_toPos, 1);\n\t        /* istanbul ignore else */\n\t      } else if (operation === '+') {\n\t        lines.splice(_toPos, 0, content);\n\t        delimiters.splice(_toPos, 0, delimiter);\n\t        _toPos++;\n\t      } else if (operation === '\\\\') {\n\t        var previousOperation = _hunk.lines[j - 1] ? _hunk.lines[j - 1][0] : null;\n\t        if (previousOperation === '+') {\n\t          removeEOFNL = true;\n\t        } else if (previousOperation === '-') {\n\t          addEOFNL = true;\n\t        }\n\t      }\n\t    }\n\t  }\n\n\t  // Handle EOFNL insertion/removal\n\t  if (removeEOFNL) {\n\t    while (!lines[lines.length - 1]) {\n\t      lines.pop();\n\t      delimiters.pop();\n\t    }\n\t  } else if (addEOFNL) {\n\t    lines.push('');\n\t    delimiters.push('\\n');\n\t  }\n\t  for (var _k = 0; _k < lines.length - 1; _k++) {\n\t    lines[_k] = lines[_k] + delimiters[_k];\n\t  }\n\t  return lines.join('');\n\t}\n\n\t// Wrapper that supports multiple file patches via callbacks.\n\tfunction applyPatches(uniDiff, options) {\n\t  if (typeof uniDiff === 'string') {\n\t    uniDiff = /*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(uniDiff);\n\t  }\n\n\t  var currentIndex = 0;\n\t  function processIndex() {\n\t    var index = uniDiff[currentIndex++];\n\t    if (!index) {\n\t      return options.complete();\n\t    }\n\n\t    options.loadFile(index, function (err, data) {\n\t      if (err) {\n\t        return options.complete(err);\n\t      }\n\n\t      var updatedContent = applyPatch(data, index, options);\n\t      options.patched(index, updatedContent, function (err) {\n\t        if (err) {\n\t          return options.complete(err);\n\t        }\n\n\t        processIndex();\n\t      });\n\t    });\n\t  }\n\t  processIndex();\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9hcHBseS5qcyJdLCJuYW1lcyI6WyJhcHBseVBhdGNoIiwiYXBwbHlQYXRjaGVzIiwic291cmNlIiwidW5pRGlmZiIsIm9wdGlvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJFcnJvciIsImxpbmVzIiwic3BsaXQiLCJkZWxpbWl0ZXJzIiwibWF0Y2giLCJodW5rcyIsImNvbXBhcmVMaW5lIiwibGluZU51bWJlciIsImxpbmUiLCJvcGVyYXRpb24iLCJwYXRjaENvbnRlbnQiLCJlcnJvckNvdW50IiwiZnV6ekZhY3RvciIsIm1pbkxpbmUiLCJvZmZzZXQiLCJyZW1vdmVFT0ZOTCIsImFkZEVPRk5MIiwiaHVua0ZpdHMiLCJodW5rIiwidG9Qb3MiLCJqIiwiY29udGVudCIsInN1YnN0ciIsImkiLCJtYXhMaW5lIiwib2xkTGluZXMiLCJsb2NhbE9mZnNldCIsIm9sZFN0YXJ0IiwiaXRlcmF0b3IiLCJ1bmRlZmluZWQiLCJkaWZmT2Zmc2V0IiwibmV3TGluZXMiLCJkZWxpbWl0ZXIiLCJsaW5lZGVsaW1pdGVycyIsInNwbGljZSIsInByZXZpb3VzT3BlcmF0aW9uIiwicG9wIiwicHVzaCIsIl9rIiwiam9pbiIsImN1cnJlbnRJbmRleCIsInByb2Nlc3NJbmRleCIsImluZGV4IiwiY29tcGxldGUiLCJsb2FkRmlsZSIsImVyciIsImRhdGEiLCJ1cGRhdGVkQ29udGVudCIsInBhdGNoZWQiXSwibWFwcGluZ3MiOiI7OztnQ0FHZ0JBLFUsR0FBQUEsVTt5REFvSUFDLFksR0FBQUEsWTs7QUF2SWhCOztBQUNBOzs7Ozs7dUJBRU8sU0FBU0QsVUFBVCxDQUFvQkUsTUFBcEIsRUFBNEJDLE9BQTVCLEVBQW1EO0FBQUEsc0RBQWRDLE9BQWMsdUVBQUosRUFBSTs7QUFDeEQsTUFBSSxPQUFPRCxPQUFQLEtBQW1CLFFBQXZCLEVBQWlDO0FBQy9CQSxjQUFVLHdFQUFXQSxPQUFYLENBQVY7QUFDRDs7QUFFRCxNQUFJRSxNQUFNQyxP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QUFZO0FBQ1YsYUFBTzlDLFFBQVErQyxRQUFSLEVBQVA7QUFDRDs7QUFFRC9DLFlBQVFnRCxRQUFSLENBQWlCRixLQUFqQixFQUF3QixVQUFTRyxHQUFULEVBQWNDLElBQWQsRUFBb0I7QUFDMUMsVUFBSUQsR0FBSixFQUFTO0FBQ1AsZUFBT2pELFFBQVErQyxRQUFSLENBQWlCRSxHQUFqQixDQUFQO0FBQ0Q7O0FBRUQsVUFBSUUsaUJBQWlCdkQsV0FBV3NELElBQVgsRUFBaUJKLEtBQWpCLEVBQXdCOUMsT0FBeEIsQ0FBckI7QUFDQUEsY0FBUW9ELE9BQVIsQ0FBZ0JOLEtBQWhCLEVBQXVCSyxjQUF2QixFQUF1QyxVQUFTRixHQUFULEVBQWM7QUFDbkQsWUFBSUEsR0FBSixFQUFTO0FBQ1AsaUJBQU9qRCxRQUFRK0MsUUFBUixDQUFpQkUsR0FBakIsQ0FBUDtBQUNEOztBQUVESjtBQUNELE9BTkQ7QUFPRCxLQWJEO0FBY0Q7QUFDREE7QUFDRCIsImZpbGUiOiJhcHBseS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7cGFyc2VQYXRjaH0gZnJvbSAnLi9wYXJzZSc7XG5pbXBvcnQgZGlzdGFuY2VJdGVyYXRvciBmcm9tICcuLi91dGlsL2Rpc3RhbmNlLWl0ZXJhdG9yJztcblxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UGF0Y2goc291cmNlLCB1bmlEaWZmLCBvcHRpb25zID0ge30pIHtcbiAgaWYgKHR5cGVvZiB1bmlEaWZmID09PSAnc3RyaW5nJykge1xuICAgIHVuaURpZmYgPSBwYXJzZVBhdGNoKHVuaURpZmYpO1xuICB9XG5cbiAgaWYgKEFycmF5LmlzQXJyYXkodW5pRGlmZikpIHtcbiAgICBpZiAodW5pRGlmZi5sZW5ndGggPiAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FwcGx5UGF0Y2ggb25seSB3b3JrcyB3aXRoIGEgc2luZ2xlIGlucHV0LicpO1xuICAgIH1cblxuICAgIHVuaURpZmYgPSB1bmlEaWZmWzBdO1xuICB9XG5cbiAgLy8gQXBwbHkgdGhlIGRpZmYgdG8gdGhlIGlucHV0XG4gIGxldCBsaW5lcyA9IHNvdXJjZS5zcGxpdCgvXFxyXFxufFtcXG5cXHZcXGZcXHJcXHg4NV0vKSxcbiAgICAgIGRlbGltaXRlcnMgPSBzb3VyY2UubWF0Y2goL1xcclxcbnxbXFxuXFx2XFxmXFxyXFx4ODVdL2cpIHx8IFtdLFxuICAgICAgaHVua3MgPSB1bmlEaWZmLmh1bmtzLFxuXG4gICAgICBjb21wYXJlTGluZSA9IG9wdGlvbnMuY29tcGFyZUxpbmUgfHwgKChsaW5lTnVtYmVyLCBsaW5lLCBvcGVyYXRpb24sIHBhdGNoQ29udGVudCkgPT4gbGluZSA9PT0gcGF0Y2hDb250ZW50KSxcbiAgICAgIGVycm9yQ291bnQgPSAwLFxuICAgICAgZnV6ekZhY3RvciA9IG9wdGlvbnMuZnV6ekZhY3RvciB8fCAwLFxuICAgICAgbWluTGluZSA9IDAsXG4gICAgICBvZmZzZXQgPSAwLFxuXG4gICAgICByZW1vdmVFT0ZOTCxcbiAgICAgIGFkZEVPRk5MO1xuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGh1bmsgZXhhY3RseSBmaXRzIG9uIHRoZSBwcm92aWRlZCBsb2NhdGlvblxuICAgKi9cbiAgZnVuY3Rpb24gaHVua0ZpdHMoaHVuaywgdG9Qb3MpIHtcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IGh1bmsubGluZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGxldCBsaW5lID0gaHVuay5saW5lc1tqXSxcbiAgICAgICAgICBvcGVyYXRpb24gPSAobGluZS5sZW5ndGggPiAwID8gbGluZVswXSA6ICcgJyksXG4gICAgICAgICAgY29udGVudCA9IChsaW5lLmxlbmd0aCA+IDAgPyBsaW5lLnN1YnN0cigxKSA6IGxpbmUpO1xuXG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnICcgfHwgb3BlcmF0aW9uID09PSAnLScpIHtcbiAgICAgICAgLy8gQ29udGV4dCBzYW5pdHkgY2hlY2tcbiAgICAgICAgaWYgKCFjb21wYXJlTGluZSh0b1BvcyArIDEsIGxpbmVzW3RvUG9zXSwgb3BlcmF0aW9uLCBjb250ZW50KSkge1xuICAgICAgICAgIGVycm9yQ291bnQrKztcblxuICAgICAgICAgIGlmIChlcnJvckNvdW50ID4gZnV6ekZhY3Rvcikge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0b1BvcysrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgLy8gU2VhcmNoIGJlc3QgZml0IG9mZnNldHMgZm9yIGVhY2ggaHVuayBiYXNlZCBvbiB0aGUgcHJldmlvdXMgb25lc1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGh1bmtzLmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGh1bmsgPSBodW5rc1tpXSxcbiAgICAgICAgbWF4TGluZSA9IGxpbmVzLmxlbmd0aCAtIGh1bmsub2xkTGluZXMsXG4gICAgICAgIGxvY2FsT2Zmc2V0ID0gMCxcbiAgICAgICAgdG9Qb3MgPSBvZmZzZXQgKyBodW5rLm9sZFN0YXJ0IC0gMTtcblxuICAgIGxldCBpdGVyYXRvciA9IGRpc3RhbmNlSXRlcmF0b3IodG9Qb3MsIG1pbkxpbmUsIG1heExpbmUpO1xuXG4gICAgZm9yICg7IGxvY2FsT2Zmc2V0ICE9PSB1bmRlZmluZWQ7IGxvY2FsT2Zmc2V0ID0gaXRlcmF0b3IoKSkge1xuICAgICAgaWYgKGh1bmtGaXRzKGh1bmssIHRvUG9zICsgbG9jYWxPZmZzZXQpKSB7XG4gICAgICAgIGh1bmsub2Zmc2V0ID0gb2Zmc2V0ICs9IGxvY2FsT2Zmc2V0O1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobG9jYWxPZmZzZXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIFNldCBsb3dlciB0ZXh0IGxpbWl0IHRvIGVuZCBvZiB0aGUgY3VycmVudCBodW5rLCBzbyBuZXh0IG9uZXMgZG9uJ3QgdHJ5XG4gICAgLy8gdG8gZml0IG92ZXIgYWxyZWFkeSBwYXRjaGVkIHRleHRcbiAgICBtaW5MaW5lID0gaHVuay5vZmZzZXQgKyBodW5rLm9sZFN0YXJ0ICsgaHVuay5vbGRMaW5lcztcbiAgfVxuXG4gIC8vIEFwcGx5IHBhdGNoIGh1bmtzXG4gIGxldCBkaWZmT2Zmc2V0ID0gMDtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBodW5rcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBodW5rID0gaHVua3NbaV0sXG4gICAgICAgIHRvUG9zID0gaHVuay5vbGRTdGFydCArIGh1bmsub2Zmc2V0ICsgZGlmZk9mZnNldCAtIDE7XG4gICAgZGlmZk9mZnNldCArPSBodW5rLm5ld0xpbmVzIC0gaHVuay5vbGRMaW5lcztcblxuICAgIGlmICh0b1BvcyA8IDApIHsgLy8gQ3JlYXRpbmcgYSBuZXcgZmlsZVxuICAgICAgdG9Qb3MgPSAwO1xuICAgIH1cblxuICAgIGZvciAobGV0IGogPSAwOyBqIDwgaHVuay5saW5lcy5sZW5ndGg7IGorKykge1xuICAgICAgbGV0IGxpbmUgPSBodW5rLmxpbmVzW2pdLFxuICAgICAgICAgIG9wZXJhdGlvbiA9IChsaW5lLmxlbmd0aCA+IDAgPyBsaW5lWzBdIDogJyAnKSxcbiAgICAgICAgICBjb250ZW50ID0gKGxpbmUubGVuZ3RoID4gMCA/IGxpbmUuc3Vic3RyKDEpIDogbGluZSksXG4gICAgICAgICAgZGVsaW1pdGVyID0gaHVuay5saW5lZGVsaW1pdGVyc1tqXTtcblxuICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJyAnKSB7XG4gICAgICAgIHRvUG9zKys7XG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJy0nKSB7XG4gICAgICAgIGxpbmVzLnNwbGljZSh0b1BvcywgMSk7XG4gICAgICAgIGRlbGltaXRlcnMuc3BsaWNlKHRvUG9zLCAxKTtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICB9IGVsc2UgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgIGxpbmVzLnNwbGljZSh0b1BvcywgMCwgY29udGVudCk7XG4gICAgICAgIGRlbGltaXRlcnMuc3BsaWNlKHRvUG9zLCAwLCBkZWxpbWl0ZXIpO1xuICAgICAgICB0b1BvcysrO1xuICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT09ICdcXFxcJykge1xuICAgICAgICBsZXQgcHJldmlvdXNPcGVyYXRpb24gPSBodW5rLmxpbmVzW2ogLSAxXSA/IGh1bmsubGluZXNbaiAtIDFdWzBdIDogbnVsbDtcbiAgICAgICAgaWYgKHByZXZpb3VzT3BlcmF0aW9uID09PSAnKycpIHtcbiAgICAgICAgICByZW1vdmVFT0ZOTCA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAocHJldmlvdXNPcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICAgIGFkZEVPRk5MID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEhhbmRsZSBFT0ZOTCBpbnNlcnRpb24vcmVtb3ZhbFxuICBpZiAocmVtb3ZlRU9GTkwpIHtcbiAgICB3aGlsZSAoIWxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdKSB7XG4gICAgICBsaW5lcy5wb3AoKTtcbiAgICAgIGRlbGltaXRlcnMucG9wKCk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGFkZEVPRk5MKSB7XG4gICAgbGluZXMucHVzaCgnJyk7XG4gICAgZGVsaW1pdGVycy5wdXNoKCdcXG4nKTtcbiAgfVxuICBmb3IgKGxldCBfayA9IDA7IF9rIDwgbGluZXMubGVuZ3RoIC0gMTsgX2srKykge1xuICAgIGxpbmVzW19rXSA9IGxpbmVzW19rXSArIGRlbGltaXRlcnNbX2tdO1xuICB9XG4gIHJldHVybiBsaW5lcy5qb2luKCcnKTtcbn1cblxuLy8gV3JhcHBlciB0aGF0IHN1cHBvcnRzIG11bHRpcGxlIGZpbGUgcGF0Y2hlcyB2aWEgY2FsbGJhY2tzLlxuZXhwb3J0IGZ1bmN0aW9uIGFwcGx5UGF0Y2hlcyh1bmlEaWZmLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgdW5pRGlmZiA9PT0gJ3N0cmluZycpIHtcbiAgICB1bmlEaWZmID0gcGFyc2VQYXRjaCh1bmlEaWZmKTtcbiAgfVxuXG4gIGxldCBjdXJyZW50SW5kZXggPSAwO1xuICBmdW5jdGlvbiBwcm9jZXNzSW5kZXgoKSB7XG4gICAgbGV0IGluZGV4ID0gdW5pRGlmZltjdXJyZW50SW5kZXgrK107XG4gICAgaWYgKCFpbmRleCkge1xuICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBvcHRpb25zLmxvYWRGaWxlKGluZGV4LCBmdW5jdGlvbihlcnIsIGRhdGEpIHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuY29tcGxldGUoZXJyKTtcbiAgICAgIH1cblxuICAgICAgbGV0IHVwZGF0ZWRDb250ZW50ID0gYXBwbHlQYXRjaChkYXRhLCBpbmRleCwgb3B0aW9ucyk7XG4gICAgICBvcHRpb25zLnBhdGNoZWQoaW5kZXgsIHVwZGF0ZWRDb250ZW50LCBmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybiBvcHRpb25zLmNvbXBsZXRlKGVycik7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzSW5kZXgoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG4gIHByb2Nlc3NJbmRleCgpO1xufVxuIl19\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/parsePatch = parsePatch;\n\tfunction parsePatch(uniDiff) {\n\t  /*istanbul ignore start*/var /*istanbul ignore end*/options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\t  var diffstr = uniDiff.split(/\\r\\n|[\\n\\v\\f\\r\\x85]/),\n\t      delimiters = uniDiff.match(/\\r\\n|[\\n\\v\\f\\r\\x85]/g) || [],\n\t      list = [],\n\t      i = 0;\n\n\t  function parseIndex() {\n\t    var index = {};\n\t    list.push(index);\n\n\t    // Parse diff metadata\n\t    while (i < diffstr.length) {\n\t      var line = diffstr[i];\n\n\t      // File header found, end parsing diff metadata\n\t      if (/^(\\-\\-\\-|\\+\\+\\+|@@)\\s/.test(line)) {\n\t        break;\n\t      }\n\n\t      // Diff index\n\t      var header = /^(?:Index:|diff(?: -r \\w+)+)\\s+(.+?)\\s*$/.exec(line);\n\t      if (header) {\n\t        index.index = header[1];\n\t      }\n\n\t      i++;\n\t    }\n\n\t    // Parse file headers if they are defined. Unified diff requires them, but\n\t    // there's no technical issues to have an isolated hunk without file header\n\t    parseFileHeader(index);\n\t    parseFileHeader(index);\n\n\t    // Parse hunks\n\t    index.hunks = [];\n\n\t    while (i < diffstr.length) {\n\t      var _line = diffstr[i];\n\n\t      if (/^(Index:|diff|\\-\\-\\-|\\+\\+\\+)\\s/.test(_line)) {\n\t        break;\n\t      } else if (/^@@/.test(_line)) {\n\t        index.hunks.push(parseHunk());\n\t      } else if (_line && options.strict) {\n\t        // Ignore unexpected content unless in strict mode\n\t        throw new Error('Unknown line ' + (i + 1) + ' ' + JSON.stringify(_line));\n\t      } else {\n\t        i++;\n\t      }\n\t    }\n\t  }\n\n\t  // Parses the --- and +++ headers, if none are found, no lines\n\t  // are consumed.\n\t  function parseFileHeader(index) {\n\t    var fileHeader = /^(---|\\+\\+\\+)\\s+(.*)$/.exec(diffstr[i]);\n\t    if (fileHeader) {\n\t      var keyPrefix = fileHeader[1] === '---' ? 'old' : 'new';\n\t      var data = fileHeader[2].split('\\t', 2);\n\t      var fileName = data[0].replace(/\\\\\\\\/g, '\\\\');\n\t      if (/^\".*\"$/.test(fileName)) {\n\t        fileName = fileName.substr(1, fileName.length - 2);\n\t      }\n\t      index[keyPrefix + 'FileName'] = fileName;\n\t      index[keyPrefix + 'Header'] = (data[1] || '').trim();\n\n\t      i++;\n\t    }\n\t  }\n\n\t  // Parses a hunk\n\t  // This assumes that we are at the start of a hunk.\n\t  function parseHunk() {\n\t    var chunkHeaderIndex = i,\n\t        chunkHeaderLine = diffstr[i++],\n\t        chunkHeader = chunkHeaderLine.split(/@@ -(\\d+)(?:,(\\d+))? \\+(\\d+)(?:,(\\d+))? @@/);\n\n\t    var hunk = {\n\t      oldStart: +chunkHeader[1],\n\t      oldLines: +chunkHeader[2] || 1,\n\t      newStart: +chunkHeader[3],\n\t      newLines: +chunkHeader[4] || 1,\n\t      lines: [],\n\t      linedelimiters: []\n\t    };\n\n\t    var addCount = 0,\n\t        removeCount = 0;\n\t    for (; i < diffstr.length; i++) {\n\t      // Lines starting with '---' could be mistaken for the \"remove line\" operation\n\t      // But they could be the header for the next file. Therefore prune such cases out.\n\t      if (diffstr[i].indexOf('--- ') === 0 && i + 2 < diffstr.length && diffstr[i + 1].indexOf('+++ ') === 0 && diffstr[i + 2].indexOf('@@') === 0) {\n\t        break;\n\t      }\n\t      var operation = diffstr[i].length == 0 && i != diffstr.length - 1 ? ' ' : diffstr[i][0];\n\n\t      if (operation === '+' || operation === '-' || operation === ' ' || operation === '\\\\') {\n\t        hunk.lines.push(diffstr[i]);\n\t        hunk.linedelimiters.push(delimiters[i] || '\\n');\n\n\t        if (operation === '+') {\n\t          addCount++;\n\t        } else if (operation === '-') {\n\t          removeCount++;\n\t        } else if (operation === ' ') {\n\t          addCount++;\n\t          removeCount++;\n\t        }\n\t      } else {\n\t        break;\n\t      }\n\t    }\n\n\t    // Handle the empty block count case\n\t    if (!addCount && hunk.newLines === 1) {\n\t      hunk.newLines = 0;\n\t    }\n\t    if (!removeCount && hunk.oldLines === 1) {\n\t      hunk.oldLines = 0;\n\t    }\n\n\t    // Perform optional sanity checking\n\t    if (options.strict) {\n\t      if (addCount !== hunk.newLines) {\n\t        throw new Error('Added line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n\t      }\n\t      if (removeCount !== hunk.oldLines) {\n\t        throw new Error('Removed line count did not match for hunk at line ' + (chunkHeaderIndex + 1));\n\t      }\n\t    }\n\n\t    return hunk;\n\t  }\n\n\t  while (i < diffstr.length) {\n\t    parseIndex();\n\t  }\n\n\t  return list;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9wYXJzZS5qcyJdLCJuYW1lcyI6WyJwYXJzZVBhdGNoIiwidW5pRGlmZiIsIm9wdGlvbnMiLCJkaWZmc3RyIiwic3BsaXQiLCJkZWxpbWl0ZXJzIiwibWF0Y2giLCJsaXN0IiwiaSIsInBhcnNlSW5kZXgiLCJpbmRleCIsInB1c2giLCJsZW5ndGgiLCJsaW5lIiwidGVzdCIsImhlYWRlciIsImV4ZWMiLCJwYXJzZUZpbGVIZWFkZXIiLCJodW5rcyIsInBhcnNlSHVuayIsInN0cmljdCIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbGVIZWFkZXIiLCJrZXlQcmVmaXgiLCJkYXRhIiwiZmlsZU5hbWUiLCJyZXBsYWNlIiwic3Vic3RyIiwidHJpbSIsImNodW5rSGVhZGVySW5kZXgiLCJjaHVua0hlYWRlckxpbmUiLCJjaHVua0hlYWRlciIsImh1bmsiLCJvbGRTdGFydCIsIm9sZExpbmVzIiwibmV3U3RhcnQiLCJuZXdMaW5lcyIsImxpbmVzIiwibGluZWRlbGltaXRlcnMiLCJhZGRDb3VudCIsInJlbW92ZUNvdW50IiwiaW5kZXhPZiIsIm9wZXJhdGlvbiJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsVSxHQUFBQSxVO0FBQVQsU0FBU0EsVUFBVCxDQUFvQkMsT0FBcEIsRUFBMkM7QUFBQSxzREFBZEMsT0FBYyx1RUFBSixFQUFJOztBQUNoRCxNQUFJQyxVQUFVRixRQUFRRyxLQUFSLENBQWMscUJBQWQsQ0FBZDtBQUFBLE1BQ0lDLGFBQWFKLFFBQVFLLEtBQVIsQ0FBYyxzQkFBZCxLQUF5QyxFQUQxRDtBQUFBLE1BRUlDLE9BQU8sRUFGWDtBQUFBLE1BR0lDLElBQUksQ0FIUjs7QUFLQSxXQUFTQyxVQUFULEdBQXNCO0FBQ3BCLFFBQUlDLFFBQVEsRUFBWjtBQUNBSCxTQUFLSSxJQUFMLENBQVVELEtBQVY7O0FBRUE7QUFDQSxXQUFPRixJQUFJTCxRQUFRUyxNQUFuQixFQUEyQjtBQUN6QixVQUFJQyxPQUFPVixRQUFR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QW9CO0FBQ2xCLFVBQUlxQixhQUFhUCxLQUFLSSxRQUF0QixFQUFnQztBQUM5QixjQUFNLElBQUlqQixLQUFKLENBQVUsc0RBQXNEVSxtQkFBbUIsQ0FBekUsQ0FBVixDQUFOO0FBQ0Q7QUFDRCxVQUFJVyxnQkFBZ0JSLEtBQUtFLFFBQXpCLEVBQW1DO0FBQ2pDLGNBQU0sSUFBSWYsS0FBSixDQUFVLHdEQUF3RFUsbUJBQW1CLENBQTNFLENBQVYsQ0FBTjtBQUNEO0FBQ0Y7O0FBRUQsV0FBT0csSUFBUDtBQUNEOztBQUVELFNBQU8xQixJQUFJTCxRQUFRUyxNQUFuQixFQUEyQjtBQUN6Qkg7QUFDRDs7QUFFRCxTQUFPRixJQUFQO0FBQ0QiLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZnVuY3Rpb24gcGFyc2VQYXRjaCh1bmlEaWZmLCBvcHRpb25zID0ge30pIHtcbiAgbGV0IGRpZmZzdHIgPSB1bmlEaWZmLnNwbGl0KC9cXHJcXG58W1xcblxcdlxcZlxcclxceDg1XS8pLFxuICAgICAgZGVsaW1pdGVycyA9IHVuaURpZmYubWF0Y2goL1xcclxcbnxbXFxuXFx2XFxmXFxyXFx4ODVdL2cpIHx8IFtdLFxuICAgICAgbGlzdCA9IFtdLFxuICAgICAgaSA9IDA7XG5cbiAgZnVuY3Rpb24gcGFyc2VJbmRleCgpIHtcbiAgICBsZXQgaW5kZXggPSB7fTtcbiAgICBsaXN0LnB1c2goaW5kZXgpO1xuXG4gICAgLy8gUGFyc2UgZGlmZiBtZXRhZGF0YVxuICAgIHdoaWxlIChpIDwgZGlmZnN0ci5sZW5ndGgpIHtcbiAgICAgIGxldCBsaW5lID0gZGlmZnN0cltpXTtcblxuICAgICAgLy8gRmlsZSBoZWFkZXIgZm91bmQsIGVuZCBwYXJzaW5nIGRpZmYgbWV0YWRhdGFcbiAgICAgIGlmICgvXihcXC1cXC1cXC18XFwrXFwrXFwrfEBAKVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gRGlmZiBpbmRleFxuICAgICAgbGV0IGhlYWRlciA9ICgvXig/OkluZGV4OnxkaWZmKD86IC1yIFxcdyspKylcXHMrKC4rPylcXHMqJC8pLmV4ZWMobGluZSk7XG4gICAgICBpZiAoaGVhZGVyKSB7XG4gICAgICAgIGluZGV4LmluZGV4ID0gaGVhZGVyWzFdO1xuICAgICAgfVxuXG4gICAgICBpKys7XG4gICAgfVxuXG4gICAgLy8gUGFyc2UgZmlsZSBoZWFkZXJzIGlmIHRoZXkgYXJlIGRlZmluZWQuIFVuaWZpZWQgZGlmZiByZXF1aXJlcyB0aGVtLCBidXRcbiAgICAvLyB0aGVyZSdzIG5vIHRlY2huaWNhbCBpc3N1ZXMgdG8gaGF2ZSBhbiBpc29sYXRlZCBodW5rIHdpdGhvdXQgZmlsZSBoZWFkZXJcbiAgICBwYXJzZUZpbGVIZWFkZXIoaW5kZXgpO1xuICAgIHBhcnNlRmlsZUhlYWRlcihpbmRleCk7XG5cbiAgICAvLyBQYXJzZSBodW5rc1xuICAgIGluZGV4Lmh1bmtzID0gW107XG5cbiAgICB3aGlsZSAoaSA8IGRpZmZzdHIubGVuZ3RoKSB7XG4gICAgICBsZXQgbGluZSA9IGRpZmZzdHJbaV07XG5cbiAgICAgIGlmICgvXihJbmRleDp8ZGlmZnxcXC1cXC1cXC18XFwrXFwrXFwrKVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICBicmVhaztcbiAgICAgIH0gZWxzZSBpZiAoL15AQC8udGVzdChsaW5lKSkge1xuICAgICAgICBpbmRleC5odW5rcy5wdXNoKHBhcnNlSHVuaygpKTtcbiAgICAgIH0gZWxzZSBpZiAobGluZSAmJiBvcHRpb25zLnN0cmljdCkge1xuICAgICAgICAvLyBJZ25vcmUgdW5leHBlY3RlZCBjb250ZW50IHVubGVzcyBpbiBzdHJpY3QgbW9kZVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vua25vd24gbGluZSAnICsgKGkgKyAxKSArICcgJyArIEpTT04uc3RyaW5naWZ5KGxpbmUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGkrKztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBQYXJzZXMgdGhlIC0tLSBhbmQgKysrIGhlYWRlcnMsIGlmIG5vbmUgYXJlIGZvdW5kLCBubyBsaW5lc1xuICAvLyBhcmUgY29uc3VtZWQuXG4gIGZ1bmN0aW9uIHBhcnNlRmlsZUhlYWRlcihpbmRleCkge1xuICAgIGNvbnN0IGZpbGVIZWFkZXIgPSAoL14oLS0tfFxcK1xcK1xcKylcXHMrKC4qKSQvKS5leGVjKGRpZmZzdHJbaV0pO1xuICAgIGlmIChmaWxlSGVhZGVyKSB7XG4gICAgICBsZXQga2V5UHJlZml4ID0gZmlsZUhlYWRlclsxXSA9PT0gJy0tLScgPyAnb2xkJyA6ICduZXcnO1xuICAgICAgY29uc3QgZGF0YSA9IGZpbGVIZWFkZXJbMl0uc3BsaXQoJ1xcdCcsIDIpO1xuICAgICAgbGV0IGZpbGVOYW1lID0gZGF0YVswXS5yZXBsYWNlKC9cXFxcXFxcXC9nLCAnXFxcXCcpO1xuICAgICAgaWYgKC9eXCIuKlwiJC8udGVzdChmaWxlTmFtZSkpIHtcbiAgICAgICAgZmlsZU5hbWUgPSBmaWxlTmFtZS5zdWJzdHIoMSwgZmlsZU5hbWUubGVuZ3RoIC0gMik7XG4gICAgICB9XG4gICAgICBpbmRleFtrZXlQcmVmaXggKyAnRmlsZU5hbWUnXSA9IGZpbGVOYW1lO1xuICAgICAgaW5kZXhba2V5UHJlZml4ICsgJ0hlYWRlciddID0gKGRhdGFbMV0gfHwgJycpLnRyaW0oKTtcblxuICAgICAgaSsrO1xuICAgIH1cbiAgfVxuXG4gIC8vIFBhcnNlcyBhIGh1bmtcbiAgLy8gVGhpcyBhc3N1bWVzIHRoYXQgd2UgYXJlIGF0IHRoZSBzdGFydCBvZiBhIGh1bmsuXG4gIGZ1bmN0aW9uIHBhcnNlSHVuaygpIHtcbiAgICBsZXQgY2h1bmtIZWFkZXJJbmRleCA9IGksXG4gICAgICAgIGNodW5rSGVhZGVyTGluZSA9IGRpZmZzdHJbaSsrXSxcbiAgICAgICAgY2h1bmtIZWFkZXIgPSBjaHVua0hlYWRlckxpbmUuc3BsaXQoL0BAIC0oXFxkKykoPzosKFxcZCspKT8gXFwrKFxcZCspKD86LChcXGQrKSk/IEBALyk7XG5cbiAgICBsZXQgaHVuayA9IHtcbiAgICAgIG9sZFN0YXJ0OiArY2h1bmtIZWFkZXJbMV0sXG4gICAgICBvbGRMaW5lczogK2NodW5rSGVhZGVyWzJdIHx8IDEsXG4gICAgICBuZXdTdGFydDogK2NodW5rSGVhZGVyWzNdLFxuICAgICAgbmV3TGluZXM6ICtjaHVua0hlYWRlcls0XSB8fCAxLFxuICAgICAgbGluZXM6IFtdLFxuICAgICAgbGluZWRlbGltaXRlcnM6IFtdXG4gICAgfTtcblxuICAgIGxldCBhZGRDb3VudCA9IDAsXG4gICAgICAgIHJlbW92ZUNvdW50ID0gMDtcbiAgICBmb3IgKDsgaSA8IGRpZmZzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgIC8vIExpbmVzIHN0YXJ0aW5nIHdpdGggJy0tLScgY291bGQgYmUgbWlzdGFrZW4gZm9yIHRoZSBcInJlbW92ZSBsaW5lXCIgb3BlcmF0aW9uXG4gICAgICAvLyBCdXQgdGhleSBjb3VsZCBiZSB0aGUgaGVhZGVyIGZvciB0aGUgbmV4dCBmaWxlLiBUaGVyZWZvcmUgcHJ1bmUgc3VjaCBjYXNlcyBvdXQuXG4gICAgICBpZiAoZGlmZnN0cltpXS5pbmRleE9mKCctLS0gJykgPT09IDBcbiAgICAgICAgICAgICYmIChpICsgMiA8IGRpZmZzdHIubGVuZ3RoKVxuICAgICAgICAgICAgJiYgZGlmZnN0cltpICsgMV0uaW5kZXhPZignKysrICcpID09PSAwXG4gICAgICAgICAgICAmJiBkaWZmc3RyW2kgKyAyXS5pbmRleE9mKCdAQCcpID09PSAwKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBsZXQgb3BlcmF0aW9uID0gKGRpZmZzdHJbaV0ubGVuZ3RoID09IDAgJiYgaSAhPSAoZGlmZnN0ci5sZW5ndGggLSAxKSkgPyAnICcgOiBkaWZmc3RyW2ldWzBdO1xuXG4gICAgICBpZiAob3BlcmF0aW9uID09PSAnKycgfHwgb3BlcmF0aW9uID09PSAnLScgfHwgb3BlcmF0aW9uID09PSAnICcgfHwgb3BlcmF0aW9uID09PSAnXFxcXCcpIHtcbiAgICAgICAgaHVuay5saW5lcy5wdXNoKGRpZmZzdHJbaV0pO1xuICAgICAgICBodW5rLmxpbmVkZWxpbWl0ZXJzLnB1c2goZGVsaW1pdGVyc1tpXSB8fCAnXFxuJyk7XG5cbiAgICAgICAgaWYgKG9wZXJhdGlvbiA9PT0gJysnKSB7XG4gICAgICAgICAgYWRkQ291bnQrKztcbiAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRpb24gPT09ICctJykge1xuICAgICAgICAgIHJlbW92ZUNvdW50Kys7XG4gICAgICAgIH0gZWxzZSBpZiAob3BlcmF0aW9uID09PSAnICcpIHtcbiAgICAgICAgICBhZGRDb3VudCsrO1xuICAgICAgICAgIHJlbW92ZUNvdW50Kys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSB0aGUgZW1wdHkgYmxvY2sgY291bnQgY2FzZVxuICAgIGlmICghYWRkQ291bnQgJiYgaHVuay5uZXdMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5uZXdMaW5lcyA9IDA7XG4gICAgfVxuICAgIGlmICghcmVtb3ZlQ291bnQgJiYgaHVuay5vbGRMaW5lcyA9PT0gMSkge1xuICAgICAgaHVuay5vbGRMaW5lcyA9IDA7XG4gICAgfVxuXG4gICAgLy8gUGVyZm9ybSBvcHRpb25hbCBzYW5pdHkgY2hlY2tpbmdcbiAgICBpZiAob3B0aW9ucy5zdHJpY3QpIHtcbiAgICAgIGlmIChhZGRDb3VudCAhPT0gaHVuay5uZXdMaW5lcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0FkZGVkIGxpbmUgY291bnQgZGlkIG5vdCBtYXRjaCBmb3IgaHVuayBhdCBsaW5lICcgKyAoY2h1bmtIZWFkZXJJbmRleCArIDEpKTtcbiAgICAgIH1cbiAgICAgIGlmIChyZW1vdmVDb3VudCAhPT0gaHVuay5vbGRMaW5lcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1JlbW92ZWQgbGluZSBjb3VudCBkaWQgbm90IG1hdGNoIGZvciBodW5rIGF0IGxpbmUgJyArIChjaHVua0hlYWRlckluZGV4ICsgMSkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBodW5rO1xuICB9XG5cbiAgd2hpbGUgKGkgPCBkaWZmc3RyLmxlbmd0aCkge1xuICAgIHBhcnNlSW5kZXgoKTtcbiAgfVxuXG4gIHJldHVybiBsaXN0O1xufVxuIl19\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\n\texports[\"default\"] = /*istanbul ignore end*/function (start, minLine, maxLine) {\n\t  var wantForward = true,\n\t      backwardExhausted = false,\n\t      forwardExhausted = false,\n\t      localOffset = 1;\n\n\t  return function iterator() {\n\t    if (wantForward && !forwardExhausted) {\n\t      if (backwardExhausted) {\n\t        localOffset++;\n\t      } else {\n\t        wantForward = false;\n\t      }\n\n\t      // Check if trying to fit beyond text length, and if not, check it fits\n\t      // after offset location (or desired location on first iteration)\n\t      if (start + localOffset <= maxLine) {\n\t        return localOffset;\n\t      }\n\n\t      forwardExhausted = true;\n\t    }\n\n\t    if (!backwardExhausted) {\n\t      if (!forwardExhausted) {\n\t        wantForward = true;\n\t      }\n\n\t      // Check if trying to fit before text beginning, and if not, check it fits\n\t      // before offset location\n\t      if (minLine <= start - localOffset) {\n\t        return -localOffset++;\n\t      }\n\n\t      backwardExhausted = true;\n\t      return iterator();\n\t    }\n\n\t    // We tried to fit hunk before text beginning and beyond text length, then\n\t    // hunk can't fit on the text. Return undefined\n\t  };\n\t};\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2Rpc3RhbmNlLWl0ZXJhdG9yLmpzIl0sIm5hbWVzIjpbInN0YXJ0IiwibWluTGluZSIsIm1heExpbmUiLCJ3YW50Rm9yd2FyZCIsImJhY2t3YXJkRXhoYXVzdGVkIiwiZm9yd2FyZEV4aGF1c3RlZCIsImxvY2FsT2Zmc2V0IiwiaXRlcmF0b3IiXSwibWFwcGluZ3MiOiI7Ozs7NENBR2UsVUFBU0EsS0FBVCxFQUFnQkMsT0FBaEIsRUFBeUJDLE9BQXpCLEVBQWtDO0FBQy9DLE1BQUlDLGNBQWMsSUFBbEI7QUFBQSxNQUNJQyxvQkFBb0IsS0FEeEI7QUFBQSxNQUVJQyxtQkFBbUIsS0FGdkI7QUFBQSxNQUdJQyxjQUFjLENBSGxCOztBQUtBLFNBQU8sU0FBU0MsUUFBVCxHQUFvQjtBQUN6QixRQUFJSixlQUFlLENBQUNFLGdCQUFwQixFQUFzQztBQUNwQyxVQUFJRCxpQkFBSixFQUF1QjtBQUNyQkU7QUFDRCxPQUZELE1BRU87QUFDTEgsc0JBQWMsS0FBZDtBQUNEOztBQUVEO0FBQ0E7QUFDQSxVQUFJSCxRQUFRTSxXQUFSLElBQXVCSixPQUEzQixFQUFvQztBQUNsQyxlQUFPSSxXQUFQO0FBQ0Q7O0FBRURELHlCQUFtQixJQUFuQjtBQUNEOztBQUVELFFBQUksQ0FBQ0QsaUJBQUwsRUFBd0I7QUFDdEIsVUFBSSxDQUFDQyxnQkFBTCxFQUF1QjtBQUNyQkYsc0JBQWMsSUFBZDtBQUNEOztBQUVEO0FBQ0E7QUFDQSxVQUFJRixXQUFXRCxRQUFRTSxXQUF2QixFQUFvQztBQUNsQyxlQUFPLENBQUNBLGFBQVI7QUFDRDs7QUFFREYsMEJBQW9CLElBQXBCO0FBQ0EsYUFBT0csVUFBUDtBQUNEOztBQUVEO0FBQ0E7QUFDRCxHQWxDRDtBQW1DRCxDIiwiZmlsZSI6ImRpc3RhbmNlLWl0ZXJhdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSXRlcmF0b3IgdGhhdCB0cmF2ZXJzZXMgaW4gdGhlIHJhbmdlIG9mIFttaW4sIG1heF0sIHN0ZXBwaW5nXG4vLyBieSBkaXN0YW5jZSBmcm9tIGEgZ2l2ZW4gc3RhcnQgcG9zaXRpb24uIEkuZS4gZm9yIFswLCA0XSwgd2l0aFxuLy8gc3RhcnQgb2YgMiwgdGhpcyB3aWxsIGl0ZXJhdGUgMiwgMywgMSwgNCwgMC5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKHN0YXJ0LCBtaW5MaW5lLCBtYXhMaW5lKSB7XG4gIGxldCB3YW50Rm9yd2FyZCA9IHRydWUsXG4gICAgICBiYWNrd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgICAgZm9yd2FyZEV4aGF1c3RlZCA9IGZhbHNlLFxuICAgICAgbG9jYWxPZmZzZXQgPSAxO1xuXG4gIHJldHVybiBmdW5jdGlvbiBpdGVyYXRvcigpIHtcbiAgICBpZiAod2FudEZvcndhcmQgJiYgIWZvcndhcmRFeGhhdXN0ZWQpIHtcbiAgICAgIGlmIChiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgICBsb2NhbE9mZnNldCsrO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgd2FudEZvcndhcmQgPSBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZXlvbmQgdGV4dCBsZW5ndGgsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGFmdGVyIG9mZnNldCBsb2NhdGlvbiAob3IgZGVzaXJlZCBsb2NhdGlvbiBvbiBmaXJzdCBpdGVyYXRpb24pXG4gICAgICBpZiAoc3RhcnQgKyBsb2NhbE9mZnNldCA8PSBtYXhMaW5lKSB7XG4gICAgICAgIHJldHVybiBsb2NhbE9mZnNldDtcbiAgICAgIH1cblxuICAgICAgZm9yd2FyZEV4aGF1c3RlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKCFiYWNrd2FyZEV4aGF1c3RlZCkge1xuICAgICAgaWYgKCFmb3J3YXJkRXhoYXVzdGVkKSB7XG4gICAgICAgIHdhbnRGb3J3YXJkID0gdHJ1ZTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdHJ5aW5nIHRvIGZpdCBiZWZvcmUgdGV4dCBiZWdpbm5pbmcsIGFuZCBpZiBub3QsIGNoZWNrIGl0IGZpdHNcbiAgICAgIC8vIGJlZm9yZSBvZmZzZXQgbG9jYXRpb25cbiAgICAgIGlmIChtaW5MaW5lIDw9IHN0YXJ0IC0gbG9jYWxPZmZzZXQpIHtcbiAgICAgICAgcmV0dXJuIC1sb2NhbE9mZnNldCsrO1xuICAgICAgfVxuXG4gICAgICBiYWNrd2FyZEV4aGF1c3RlZCA9IHRydWU7XG4gICAgICByZXR1cm4gaXRlcmF0b3IoKTtcbiAgICB9XG5cbiAgICAvLyBXZSB0cmllZCB0byBmaXQgaHVuayBiZWZvcmUgdGV4dCBiZWdpbm5pbmcgYW5kIGJleW9uZCB0ZXh0IGxlbmd0aCwgdGhlblxuICAgIC8vIGh1bmsgY2FuJ3QgZml0IG9uIHRoZSB0ZXh0LiBSZXR1cm4gdW5kZWZpbmVkXG4gIH07XG59XG4iXX0=\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/calcLineCount = calcLineCount;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/merge = merge;\n\n\tvar /*istanbul ignore start*/_create = __webpack_require__(14) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_parse = __webpack_require__(11) /*istanbul ignore end*/;\n\n\tvar /*istanbul ignore start*/_array = __webpack_require__(15) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\t/*istanbul ignore end*/function calcLineCount(hunk) {\n\t  /*istanbul ignore start*/var _calcOldNewLineCount = /*istanbul ignore end*/calcOldNewLineCount(hunk.lines),\n\t      oldLines = _calcOldNewLineCount.oldLines,\n\t      newLines = _calcOldNewLineCount.newLines;\n\n\t  if (oldLines !== undefined) {\n\t    hunk.oldLines = oldLines;\n\t  } else {\n\t    delete hunk.oldLines;\n\t  }\n\n\t  if (newLines !== undefined) {\n\t    hunk.newLines = newLines;\n\t  } else {\n\t    delete hunk.newLines;\n\t  }\n\t}\n\n\tfunction merge(mine, theirs, base) {\n\t  mine = loadPatch(mine, base);\n\t  theirs = loadPatch(theirs, base);\n\n\t  var ret = {};\n\n\t  // For index we just let it pass through as it doesn't have any necessary meaning.\n\t  // Leaving sanity checks on this to the API consumer that may know more about the\n\t  // meaning in their own context.\n\t  if (mine.index || theirs.index) {\n\t    ret.index = mine.index || theirs.index;\n\t  }\n\n\t  if (mine.newFileName || theirs.newFileName) {\n\t    if (!fileNameChanged(mine)) {\n\t      // No header or no change in ours, use theirs (and ours if theirs does not exist)\n\t      ret.oldFileName = theirs.oldFileName || mine.oldFileName;\n\t      ret.newFileName = theirs.newFileName || mine.newFileName;\n\t      ret.oldHeader = theirs.oldHeader || mine.oldHeader;\n\t      ret.newHeader = theirs.newHeader || mine.newHeader;\n\t    } else if (!fileNameChanged(theirs)) {\n\t      // No header or no change in theirs, use ours\n\t      ret.oldFileName = mine.oldFileName;\n\t      ret.newFileName = mine.newFileName;\n\t      ret.oldHeader = mine.oldHeader;\n\t      ret.newHeader = mine.newHeader;\n\t    } else {\n\t      // Both changed... figure it out\n\t      ret.oldFileName = selectField(ret, mine.oldFileName, theirs.oldFileName);\n\t      ret.newFileName = selectField(ret, mine.newFileName, theirs.newFileName);\n\t      ret.oldHeader = selectField(ret, mine.oldHeader, theirs.oldHeader);\n\t      ret.newHeader = selectField(ret, mine.newHeader, theirs.newHeader);\n\t    }\n\t  }\n\n\t  ret.hunks = [];\n\n\t  var mineIndex = 0,\n\t      theirsIndex = 0,\n\t      mineOffset = 0,\n\t      theirsOffset = 0;\n\n\t  while (mineIndex < mine.hunks.length || theirsIndex < theirs.hunks.length) {\n\t    var mineCurrent = mine.hunks[mineIndex] || { oldStart: Infinity },\n\t        theirsCurrent = theirs.hunks[theirsIndex] || { oldStart: Infinity };\n\n\t    if (hunkBefore(mineCurrent, theirsCurrent)) {\n\t      // This patch does not overlap with any of the others, yay.\n\t      ret.hunks.push(cloneHunk(mineCurrent, mineOffset));\n\t      mineIndex++;\n\t      theirsOffset += mineCurrent.newLines - mineCurrent.oldLines;\n\t    } else if (hunkBefore(theirsCurrent, mineCurrent)) {\n\t      // This patch does not overlap with any of the others, yay.\n\t      ret.hunks.push(cloneHunk(theirsCurrent, theirsOffset));\n\t      theirsIndex++;\n\t      mineOffset += theirsCurrent.newLines - theirsCurrent.oldLines;\n\t    } else {\n\t      // Overlap, merge as best we can\n\t      var mergedHunk = {\n\t        oldStart: Math.min(mineCurrent.oldStart, theirsCurrent.oldStart),\n\t        oldLines: 0,\n\t        newStart: Math.min(mineCurrent.newStart + mineOffset, theirsCurrent.oldStart + theirsOffset),\n\t        newLines: 0,\n\t        lines: []\n\t      };\n\t      mergeLines(mergedHunk, mineCurrent.oldStart, mineCurrent.lines, theirsCurrent.oldStart, theirsCurrent.lines);\n\t      theirsIndex++;\n\t      mineIndex++;\n\n\t      ret.hunks.push(mergedHunk);\n\t    }\n\t  }\n\n\t  return ret;\n\t}\n\n\tfunction loadPatch(param, base) {\n\t  if (typeof param === 'string') {\n\t    if (/^@@/m.test(param) || /^Index:/m.test(param)) {\n\t      return (/*istanbul ignore start*/(0, _parse.parsePatch) /*istanbul ignore end*/(param)[0]\n\t      );\n\t    }\n\n\t    if (!base) {\n\t      throw new Error('Must provide a base reference or pass in a patch');\n\t    }\n\t    return (/*istanbul ignore start*/(0, _create.structuredPatch) /*istanbul ignore end*/(undefined, undefined, base, param)\n\t    );\n\t  }\n\n\t  return param;\n\t}\n\n\tfunction fileNameChanged(patch) {\n\t  return patch.newFileName && patch.newFileName !== patch.oldFileName;\n\t}\n\n\tfunction selectField(index, mine, theirs) {\n\t  if (mine === theirs) {\n\t    return mine;\n\t  } else {\n\t    index.conflict = true;\n\t    return { mine: mine, theirs: theirs };\n\t  }\n\t}\n\n\tfunction hunkBefore(test, check) {\n\t  return test.oldStart < check.oldStart && test.oldStart + test.oldLines < check.oldStart;\n\t}\n\n\tfunction cloneHunk(hunk, offset) {\n\t  return {\n\t    oldStart: hunk.oldStart, oldLines: hunk.oldLines,\n\t    newStart: hunk.newStart + offset, newLines: hunk.newLines,\n\t    lines: hunk.lines\n\t  };\n\t}\n\n\tfunction mergeLines(hunk, mineOffset, mineLines, theirOffset, theirLines) {\n\t  // This will generally result in a conflicted hunk, but there are cases where the context\n\t  // is the only overlap where we can successfully merge the content here.\n\t  var mine = { offset: mineOffset, lines: mineLines, index: 0 },\n\t      their = { offset: theirOffset, lines: theirLines, index: 0 };\n\n\t  // Handle any leading content\n\t  insertLeading(hunk, mine, their);\n\t  insertLeading(hunk, their, mine);\n\n\t  // Now in the overlap content. Scan through and select the best changes from each.\n\t  while (mine.index < mine.lines.length && their.index < their.lines.length) {\n\t    var mineCurrent = mine.lines[mine.index],\n\t        theirCurrent = their.lines[their.index];\n\n\t    if ((mineCurrent[0] === '-' || mineCurrent[0] === '+') && (theirCurrent[0] === '-' || theirCurrent[0] === '+')) {\n\t      // Both modified ...\n\t      mutualChange(hunk, mine, their);\n\t    } else if (mineCurrent[0] === '+' && theirCurrent[0] === ' ') {\n\t      /*istanbul ignore start*/var _hunk$lines;\n\n\t      /*istanbul ignore end*/ // Mine inserted\n\t      /*istanbul ignore start*/(_hunk$lines = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/collectChange(mine)));\n\t    } else if (theirCurrent[0] === '+' && mineCurrent[0] === ' ') {\n\t      /*istanbul ignore start*/var _hunk$lines2;\n\n\t      /*istanbul ignore end*/ // Theirs inserted\n\t      /*istanbul ignore start*/(_hunk$lines2 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines2 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/collectChange(their)));\n\t    } else if (mineCurrent[0] === '-' && theirCurrent[0] === ' ') {\n\t      // Mine removed or edited\n\t      removal(hunk, mine, their);\n\t    } else if (theirCurrent[0] === '-' && mineCurrent[0] === ' ') {\n\t      // Their removed or edited\n\t      removal(hunk, their, mine, true);\n\t    } else if (mineCurrent === theirCurrent) {\n\t      // Context identity\n\t      hunk.lines.push(mineCurrent);\n\t      mine.index++;\n\t      their.index++;\n\t    } else {\n\t      // Context mismatch\n\t      conflict(hunk, collectChange(mine), collectChange(their));\n\t    }\n\t  }\n\n\t  // Now push anything that may be remaining\n\t  insertTrailing(hunk, mine);\n\t  insertTrailing(hunk, their);\n\n\t  calcLineCount(hunk);\n\t}\n\n\tfunction mutualChange(hunk, mine, their) {\n\t  var myChanges = collectChange(mine),\n\t      theirChanges = collectChange(their);\n\n\t  if (allRemoves(myChanges) && allRemoves(theirChanges)) {\n\t    // Special case for remove changes that are supersets of one another\n\t    if ( /*istanbul ignore start*/(0, _array.arrayStartsWith) /*istanbul ignore end*/(myChanges, theirChanges) && skipRemoveSuperset(their, myChanges, myChanges.length - theirChanges.length)) {\n\t      /*istanbul ignore start*/var _hunk$lines3;\n\n\t      /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines3 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines3 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/myChanges));\n\t      return;\n\t    } else if ( /*istanbul ignore start*/(0, _array.arrayStartsWith) /*istanbul ignore end*/(theirChanges, myChanges) && skipRemoveSuperset(mine, theirChanges, theirChanges.length - myChanges.length)) {\n\t      /*istanbul ignore start*/var _hunk$lines4;\n\n\t      /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines4 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines4 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/theirChanges));\n\t      return;\n\t    }\n\t  } else if ( /*istanbul ignore start*/(0, _array.arrayEqual) /*istanbul ignore end*/(myChanges, theirChanges)) {\n\t    /*istanbul ignore start*/var _hunk$lines5;\n\n\t    /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines5 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines5 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/myChanges));\n\t    return;\n\t  }\n\n\t  conflict(hunk, myChanges, theirChanges);\n\t}\n\n\tfunction removal(hunk, mine, their, swap) {\n\t  var myChanges = collectChange(mine),\n\t      theirChanges = collectContext(their, myChanges);\n\t  if (theirChanges.merged) {\n\t    /*istanbul ignore start*/var _hunk$lines6;\n\n\t    /*istanbul ignore end*/ /*istanbul ignore start*/(_hunk$lines6 = /*istanbul ignore end*/hunk.lines).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_hunk$lines6 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/theirChanges.merged));\n\t  } else {\n\t    conflict(hunk, swap ? theirChanges : myChanges, swap ? myChanges : theirChanges);\n\t  }\n\t}\n\n\tfunction conflict(hunk, mine, their) {\n\t  hunk.conflict = true;\n\t  hunk.lines.push({\n\t    conflict: true,\n\t    mine: mine,\n\t    theirs: their\n\t  });\n\t}\n\n\tfunction insertLeading(hunk, insert, their) {\n\t  while (insert.offset < their.offset && insert.index < insert.lines.length) {\n\t    var line = insert.lines[insert.index++];\n\t    hunk.lines.push(line);\n\t    insert.offset++;\n\t  }\n\t}\n\tfunction insertTrailing(hunk, insert) {\n\t  while (insert.index < insert.lines.length) {\n\t    var line = insert.lines[insert.index++];\n\t    hunk.lines.push(line);\n\t  }\n\t}\n\n\tfunction collectChange(state) {\n\t  var ret = [],\n\t      operation = state.lines[state.index][0];\n\t  while (state.index < state.lines.length) {\n\t    var line = state.lines[state.index];\n\n\t    // Group additions that are immediately after subtractions and treat them as one \"atomic\" modify change.\n\t    if (operation === '-' && line[0] === '+') {\n\t      operation = '+';\n\t    }\n\n\t    if (operation === line[0]) {\n\t      ret.push(line);\n\t      state.index++;\n\t    } else {\n\t      break;\n\t    }\n\t  }\n\n\t  return ret;\n\t}\n\tfunction collectContext(state, matchChanges) {\n\t  var changes = [],\n\t      merged = [],\n\t      matchIndex = 0,\n\t      contextChanges = false,\n\t      conflicted = false;\n\t  while (matchIndex < matchChanges.length && state.index < state.lines.length) {\n\t    var change = state.lines[state.index],\n\t        match = matchChanges[matchIndex];\n\n\t    // Once we've hit our add, then we are done\n\t    if (match[0] === '+') {\n\t      break;\n\t    }\n\n\t    contextChanges = contextChanges || change[0] !== ' ';\n\n\t    merged.push(match);\n\t    matchIndex++;\n\n\t    // Consume any additions in the other block as a conflict to attempt\n\t    // to pull in the remaining context after this\n\t    if (change[0] === '+') {\n\t      conflicted = true;\n\n\t      while (change[0] === '+') {\n\t        changes.push(change);\n\t        change = state.lines[++state.index];\n\t      }\n\t    }\n\n\t    if (match.substr(1) === change.substr(1)) {\n\t      changes.push(change);\n\t      state.index++;\n\t    } else {\n\t      conflicted = true;\n\t    }\n\t  }\n\n\t  if ((matchChanges[matchIndex] || '')[0] === '+' && contextChanges) {\n\t    conflicted = true;\n\t  }\n\n\t  if (conflicted) {\n\t    return changes;\n\t  }\n\n\t  while (matchIndex < matchChanges.length) {\n\t    merged.push(matchChanges[matchIndex++]);\n\t  }\n\n\t  return {\n\t    merged: merged,\n\t    changes: changes\n\t  };\n\t}\n\n\tfunction allRemoves(changes) {\n\t  return changes.reduce(function (prev, change) {\n\t    return prev && change[0] === '-';\n\t  }, true);\n\t}\n\tfunction skipRemoveSuperset(state, removeChanges, delta) {\n\t  for (var i = 0; i < delta; i++) {\n\t    var changeContent = removeChanges[removeChanges.length - delta + i].substr(1);\n\t    if (state.lines[state.index + i] !== ' ' + changeContent) {\n\t      return false;\n\t    }\n\t  }\n\n\t  state.index += delta;\n\t  return true;\n\t}\n\n\tfunction calcOldNewLineCount(lines) {\n\t  var oldLines = 0;\n\t  var newLines = 0;\n\n\t  lines.forEach(function (line) {\n\t    if (typeof line !== 'string') {\n\t      var myCount = calcOldNewLineCount(line.mine);\n\t      var theirCount = calcOldNewLineCount(line.theirs);\n\n\t      if (oldLines !== undefined) {\n\t        if (myCount.oldLines === theirCount.oldLines) {\n\t          oldLines += myCount.oldLines;\n\t        } else {\n\t          oldLines = undefined;\n\t        }\n\t      }\n\n\t      if (newLines !== undefined) {\n\t        if (myCount.newLines === theirCount.newLines) {\n\t          newLines += myCount.newLines;\n\t        } else {\n\t          newLines = undefined;\n\t        }\n\t      }\n\t    } else {\n\t      if (newLines !== undefined && (line[0] === '+' || line[0] === ' ')) {\n\t        newLines++;\n\t      }\n\t      if (oldLines !== undefined && (line[0] === '-' || line[0] === ' ')) {\n\t        oldLines++;\n\t      }\n\t    }\n\t  });\n\n\t  return { oldLines: oldLines, newLines: newLines };\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9tZXJnZS5qcyJdLCJuYW1lcyI6WyJjYWxjTGluZUNvdW50IiwibWVyZ2UiLCJodW5rIiwiY2FsY09sZE5ld0xpbmVDb3VudCIsImxpbmVzIiwib2xkTGluZXMiLCJuZXdMaW5lcyIsInVuZGVmaW5lZCIsIm1pbmUiLCJ0aGVpcnMiLCJiYXNlIiwibG9hZFBhdGNoIiwicmV0IiwiaW5kZXgiLCJuZXdGaWxlTmFtZSIsImZpbGVOYW1lQ2hhbmdlZCIsIm9sZEZpbGVOYW1lIiwib2xkSGVhZGVyIiwibmV3SGVhZGVyIiwic2VsZWN0RmllbGQiLCJodW5rcyIsIm1pbmVJbmRleCIsInRoZWlyc0luZGV4IiwibWluZU9mZnNldCIsInRoZWlyc09mZnNldCIsImxlbmd0aCIsIm1pbmVDdXJyZW50Iiwib2xkU3RhcnQiLCJJbmZpbml0eSIsInRoZWlyc0N1cnJlbnQiLCJodW5rQmVmb3JlIiwicHVzaCIsImNsb25lSHVuayIsIm1lcmdlZEh1bmsiLCJNYXRoIiwibWluIiwibmV3U3RhcnQiLCJtZXJnZUxpbmVzIiwicGFyYW0iLCJ0ZXN0IiwiRXJyb3IiLCJwYXRjaCIsImNvbmZsaWN0IiwiY2hlY2siLCJvZmZzZXQiLCJtaW5lTGluZXMiLCJ0aGVpck9mZnNldCIsInRoZWlyTGluZXMiLCJ0aGVpciIsImluc2VydExlYWRpbmciLCJ0aGVpckN1cnJlbnQiLCJtdXR1YWxDaGFuZ2UiLCJjb2xsZWN0Q2hhbmdlIiwicmVtb3ZhbCIsImluc2VydFRyYWlsaW5nIiwibXlDaGFuZ2VzIiwidGhlaXJDaGFuZ2VzIiwiYWxsUmVtb3ZlcyIsInNraXBSZW1vdmVTdXBlcnNldCIsInN3YXAiLCJjb2xsZWN0Q29udGV4dCIsIm1lcmdlZCIsImluc2VydCIsImxpbmUiLCJzdGF0ZSIsIm9wZXJhdGlvbiIsIm1hdGNoQ2hhbmdlcyIsImNoYW5nZXMiLCJtYXRjaEluZGV4IiwiY29udGV4dENoYW5nZXMiLCJjb25mbGljdGVkIiwiY2hhbmdlIiwibWF0Y2giLCJzdWJzdHIiLCJyZWR1Y2UiLCJwcmV2IiwicmVtb3ZlQ2hhbmdlcyIsImRlbHRhIiwiaSIsImNoYW5nZUNvbnRlbnQiLCJmb3JFYWNoIiwibXlDb3VudCIsInRoZWlyQ291bnQiXSwibWFwcGluZ3MiOiI7OztnQ0FLZ0JBLGEsR0FBQUEsYTt5REFnQkFDLEssR0FBQUEsSzs7QUFyQmhCOztBQUNBOztBQUVBOzs7O3VCQUVPLFNBQVNELGFBQVQsQ0FBdUJFLElBQXZCLEVBQTZCO0FBQUEsNkVBQ0xDLG9CQUFvQkQsS0FBS0UsS0FBekIsQ0FESztBQUFBLE1BQzNCQyxRQUQyQix3QkFDM0JBLFFBRDJCO0FBQUEsTUFDakJDLFFBRGlCLHdCQUNqQkEsUUFEaUI7O0FBR2xDLE1BQUlELGFBQWFFLFNBQWpCLEVBQTRCO0FBQzFCTCxTQUFLRyxRQUFMLEdBQWdCQSxRQUFoQjtBQUNELEdBRkQsTUFFTztBQUNMLFdBQU9ILEtBQUtHLFFBQVo7QUFDRDs7QUFFRCxNQUFJQyxhQUFhQyxTQUFqQixFQUE0QjtBQUMxQkwsU0FBS0ksUUFBTCxHQUFnQkEsUUFBaEI7QUFDRCxHQUZELE1BRU87QUFDTCxXQUFPSixLQUFLSSxRQUFaO0FBQ0Q7QUFDRjs7QUFFTSxTQUFTTCxLQUFULENBQWVPLElBQWYsRUFBcUJDLE1BQXJCLEVBQTZCQyxJQUE3QixFQUFtQztBQUN4Q0YsU0FBT0csVUFBVUgsSUFBVixFQUFnQkUsSUFBaEIsQ0FBUDtBQUNBRCxXQUFTRSxVQUFVRixNQUFWLEVBQWtCQyxJQUFsQixDQUFUOztBQUVBLE1BQUlFLE1BQU0sRUFBVjs7QUFFQTtBQUNBO0FBQ0E7QUFDQSxNQUFJSixLQUFLSyxLQUFMLElBQWNKLE9BQU9JLEtBQXpCLEVBQWdDO0FBQzlCRCxRQUFJQyxLQUFKLEdBQVlMLEtBQUtLLEtBQUwsSUFBY0osT0FBT0ksS0FBakM7QUFDRDs7QUFFRCxNQUFJTCxLQUFLTSxXQUFMLElBQW9CTCxPQUFPSyxXQUEvQixFQUE0QztBQUMxQyxRQUFJLENBQUNDLGdCQUFnQlAsSUFBaEIsQ0FBTCxF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Q0Q7QUFDRjs7QUFFRCxVQUFJRCxhQUFhQyxTQUFqQixFQUE0QjtBQUMxQixZQUFJMEUsUUFBUTNFLFFBQVIsS0FBcUI0RSxXQUFXNUUsUUFBcEMsRUFBOEM7QUFDNUNBLHNCQUFZMkUsUUFBUTNFLFFBQXBCO0FBQ0QsU0FGRCxNQUVPO0FBQ0xBLHFCQUFXQyxTQUFYO0FBQ0Q7QUFDRjtBQUNGLEtBbkJELE1BbUJPO0FBQ0wsVUFBSUQsYUFBYUMsU0FBYixLQUEyQndELEtBQUssQ0FBTCxNQUFZLEdBQVosSUFBbUJBLEtBQUssQ0FBTCxNQUFZLEdBQTFELENBQUosRUFBb0U7QUFDbEV6RDtBQUNEO0FBQ0QsVUFBSUQsYUFBYUUsU0FBYixLQUEyQndELEtBQUssQ0FBTCxNQUFZLEdBQVosSUFBbUJBLEtBQUssQ0FBTCxNQUFZLEdBQTFELENBQUosRUFBb0U7QUFDbEUxRDtBQUNEO0FBQ0Y7QUFDRixHQTVCRDs7QUE4QkEsU0FBTyxFQUFDQSxrQkFBRCxFQUFXQyxrQkFBWCxFQUFQO0FBQ0QiLCJmaWxlIjoibWVyZ2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3N0cnVjdHVyZWRQYXRjaH0gZnJvbSAnLi9jcmVhdGUnO1xuaW1wb3J0IHtwYXJzZVBhdGNofSBmcm9tICcuL3BhcnNlJztcblxuaW1wb3J0IHthcnJheUVxdWFsLCBhcnJheVN0YXJ0c1dpdGh9IGZyb20gJy4uL3V0aWwvYXJyYXknO1xuXG5leHBvcnQgZnVuY3Rpb24gY2FsY0xpbmVDb3VudChodW5rKSB7XG4gIGNvbnN0IHtvbGRMaW5lcywgbmV3TGluZXN9ID0gY2FsY09sZE5ld0xpbmVDb3VudChodW5rLmxpbmVzKTtcblxuICBpZiAob2xkTGluZXMgIT09IHVuZGVmaW5lZCkge1xuICAgIGh1bmsub2xkTGluZXMgPSBvbGRMaW5lcztcbiAgfSBlbHNlIHtcbiAgICBkZWxldGUgaHVuay5vbGRMaW5lcztcbiAgfVxuXG4gIGlmIChuZXdMaW5lcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaHVuay5uZXdMaW5lcyA9IG5ld0xpbmVzO1xuICB9IGVsc2Uge1xuICAgIGRlbGV0ZSBodW5rLm5ld0xpbmVzO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZShtaW5lLCB0aGVpcnMsIGJhc2UpIHtcbiAgbWluZSA9IGxvYWRQYXRjaChtaW5lLCBiYXNlKTtcbiAgdGhlaXJzID0gbG9hZFBhdGNoKHRoZWlycywgYmFzZSk7XG5cbiAgbGV0IHJldCA9IHt9O1xuXG4gIC8vIEZvciBpbmRleCB3ZSBqdXN0IGxldCBpdCBwYXNzIHRocm91Z2ggYXMgaXQgZG9lc24ndCBoYXZlIGFueSBuZWNlc3NhcnkgbWVhbmluZy5cbiAgLy8gTGVhdmluZyBzYW5pdHkgY2hlY2tzIG9uIHRoaXMgdG8gdGhlIEFQSSBjb25zdW1lciB0aGF0IG1heSBrbm93IG1vcmUgYWJvdXQgdGhlXG4gIC8vIG1lYW5pbmcgaW4gdGhlaXIgb3duIGNvbnRleHQuXG4gIGlmIChtaW5lLmluZGV4IHx8IHRoZWlycy5pbmRleCkge1xuICAgIHJldC5pbmRleCA9IG1pbmUuaW5kZXggfHwgdGhlaXJzLmluZGV4O1xuICB9XG5cbiAgaWYgKG1pbmUubmV3RmlsZU5hbWUgfHwgdGhlaXJzLm5ld0ZpbGVOYW1lKSB7XG4gICAgaWYgKCFmaWxlTmFtZUNoYW5nZWQobWluZSkpIHtcbiAgICAgIC8vIE5vIGhlYWRlciBvciBubyBjaGFuZ2UgaW4gb3VycywgdXNlIHRoZWlycyAoYW5kIG91cnMgaWYgdGhlaXJzIGRvZXMgbm90IGV4aXN0KVxuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gdGhlaXJzLm9sZEZpbGVOYW1lIHx8IG1pbmUub2xkRmlsZU5hbWU7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSB0aGVpcnMubmV3RmlsZU5hbWUgfHwgbWluZS5uZXdGaWxlTmFtZTtcbiAgICAgIHJldC5vbGRIZWFkZXIgPSB0aGVpcnMub2xkSGVhZGVyIHx8IG1pbmUub2xkSGVhZGVyO1xuICAgICAgcmV0Lm5ld0hlYWRlciA9IHRoZWlycy5uZXdIZWFkZXIgfHwgbWluZS5uZXdIZWFkZXI7XG4gICAgfSBlbHNlIGlmICghZmlsZU5hbWVDaGFuZ2VkKHRoZWlycykpIHtcbiAgICAgIC8vIE5vIGhlYWRlciBvciBubyBjaGFuZ2UgaW4gdGhlaXJzLCB1c2Ugb3Vyc1xuICAgICAgcmV0Lm9sZEZpbGVOYW1lID0gbWluZS5vbGRGaWxlTmFtZTtcbiAgICAgIHJldC5uZXdGaWxlTmFtZSA9IG1pbmUubmV3RmlsZU5hbWU7XG4gICAgICByZXQub2xkSGVhZGVyID0gbWluZS5vbGRIZWFkZXI7XG4gICAgICByZXQubmV3SGVhZGVyID0gbWluZS5uZXdIZWFkZXI7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEJvdGggY2hhbmdlZC4uLiBmaWd1cmUgaXQgb3V0XG4gICAgICByZXQub2xkRmlsZU5hbWUgPSBzZWxlY3RGaWVsZChyZXQsIG1pbmUub2xkRmlsZU5hbWUsIHRoZWlycy5vbGRGaWxlTmFtZSk7XG4gICAgICByZXQubmV3RmlsZU5hbWUgPSBzZWxlY3RGaWVsZChyZXQsIG1pbmUubmV3RmlsZU5hbWUsIHRoZWlycy5uZXdGaWxlTmFtZSk7XG4gICAgICByZXQub2xkSGVhZGVyID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm9sZEhlYWRlciwgdGhlaXJzLm9sZEhlYWRlcik7XG4gICAgICByZXQubmV3SGVhZGVyID0gc2VsZWN0RmllbGQocmV0LCBtaW5lLm5ld0hlYWRlciwgdGhlaXJzLm5ld0hlYWRlcik7XG4gICAgfVxuICB9XG5cbiAgcmV0Lmh1bmtzID0gW107XG5cbiAgbGV0IG1pbmVJbmRleCA9IDAsXG4gICAgICB0aGVpcnNJbmRleCA9IDAsXG4gICAgICBtaW5lT2Zmc2V0ID0gMCxcbiAgICAgIHRoZWlyc09mZnNldCA9IDA7XG5cbiAgd2hpbGUgKG1pbmVJbmRleCA8IG1pbmUuaHVua3MubGVuZ3RoIHx8IHRoZWlyc0luZGV4IDwgdGhlaXJzLmh1bmtzLmxlbmd0aCkge1xuICAgIGxldCBtaW5lQ3VycmVudCA9IG1pbmUuaHVua3NbbWluZUluZGV4XSB8fCB7b2xkU3RhcnQ6IEluZmluaXR5fSxcbiAgICAgICAgdGhlaXJzQ3VycmVudCA9IHRoZWlycy5odW5rc1t0aGVpcnNJbmRleF0gfHwge29sZFN0YXJ0OiBJbmZpbml0eX07XG5cbiAgICBpZiAoaHVua0JlZm9yZShtaW5lQ3VycmVudCwgdGhlaXJzQ3VycmVudCkpIHtcbiAgICAgIC8vIFRoaXMgcGF0Y2ggZG9lcyBub3Qgb3ZlcmxhcCB3aXRoIGFueSBvZiB0aGUgb3RoZXJzLCB5YXkuXG4gICAgICByZXQuaHVua3MucHVzaChjbG9uZUh1bmsobWluZUN1cnJlbnQsIG1pbmVPZmZzZXQpKTtcbiAgICAgIG1pbmVJbmRleCsrO1xuICAgICAgdGhlaXJzT2Zmc2V0ICs9IG1pbmVDdXJyZW50Lm5ld0xpbmVzIC0gbWluZUN1cnJlbnQub2xkTGluZXM7XG4gICAgfSBlbHNlIGlmIChodW5rQmVmb3JlKHRoZWlyc0N1cnJlbnQsIG1pbmVDdXJyZW50KSkge1xuICAgICAgLy8gVGhpcyBwYXRjaCBkb2VzIG5vdCBvdmVybGFwIHdpdGggYW55IG9mIHRoZSBvdGhlcnMsIHlheS5cbiAgICAgIHJldC5odW5rcy5wdXNoKGNsb25lSHVuayh0aGVpcnNDdXJyZW50LCB0aGVpcnNPZmZzZXQpKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lT2Zmc2V0ICs9IHRoZWlyc0N1cnJlbnQubmV3TGluZXMgLSB0aGVpcnNDdXJyZW50Lm9sZExpbmVzO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPdmVybGFwLCBtZXJnZSBhcyBiZXN0IHdlIGNhblxuICAgICAgbGV0IG1lcmdlZEh1bmsgPSB7XG4gICAgICAgIG9sZFN0YXJ0OiBNYXRoLm1pbihtaW5lQ3VycmVudC5vbGRTdGFydCwgdGhlaXJzQ3VycmVudC5vbGRTdGFydCksXG4gICAgICAgIG9sZExpbmVzOiAwLFxuICAgICAgICBuZXdTdGFydDogTWF0aC5taW4obWluZUN1cnJlbnQubmV3U3RhcnQgKyBtaW5lT2Zmc2V0LCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0ICsgdGhlaXJzT2Zmc2V0KSxcbiAgICAgICAgbmV3TGluZXM6IDAsXG4gICAgICAgIGxpbmVzOiBbXVxuICAgICAgfTtcbiAgICAgIG1lcmdlTGluZXMobWVyZ2VkSHVuaywgbWluZUN1cnJlbnQub2xkU3RhcnQsIG1pbmVDdXJyZW50LmxpbmVzLCB0aGVpcnNDdXJyZW50Lm9sZFN0YXJ0LCB0aGVpcnNDdXJyZW50LmxpbmVzKTtcbiAgICAgIHRoZWlyc0luZGV4Kys7XG4gICAgICBtaW5lSW5kZXgrKztcblxuICAgICAgcmV0Lmh1bmtzLnB1c2gobWVyZ2VkSHVuayk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gbG9hZFBhdGNoKHBhcmFtLCBiYXNlKSB7XG4gIGlmICh0eXBlb2YgcGFyYW0gPT09ICdzdHJpbmcnKSB7XG4gICAgaWYgKC9eQEAvbS50ZXN0KHBhcmFtKSB8fCAoL15JbmRleDovbS50ZXN0KHBhcmFtKSkpIHtcbiAgICAgIHJldHVybiBwYXJzZVBhdGNoKHBhcmFtKVswXTtcbiAgICB9XG5cbiAgICBpZiAoIWJhc2UpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTXVzdCBwcm92aWRlIGEgYmFzZSByZWZlcmVuY2Ugb3IgcGFzcyBpbiBhIHBhdGNoJyk7XG4gICAgfVxuICAgIHJldHVybiBzdHJ1Y3R1cmVkUGF0Y2godW5kZWZpbmVkLCB1bmRlZmluZWQsIGJhc2UsIHBhcmFtKTtcbiAgfVxuXG4gIHJldHVybiBwYXJhbTtcbn1cblxuZnVuY3Rpb24gZmlsZU5hbWVDaGFuZ2VkKHBhdGNoKSB7XG4gIHJldHVybiBwYXRjaC5uZXdGaWxlTmFtZSAmJiBwYXRjaC5uZXdGaWxlTmFtZSAhPT0gcGF0Y2gub2xkRmlsZU5hbWU7XG59XG5cbmZ1bmN0aW9uIHNlbGVjdEZpZWxkKGluZGV4LCBtaW5lLCB0aGVpcnMpIHtcbiAgaWYgKG1pbmUgPT09IHRoZWlycykge1xuICAgIHJldHVybiBtaW5lO1xuICB9IGVsc2Uge1xuICAgIGluZGV4LmNvbmZsaWN0ID0gdHJ1ZTtcbiAgICByZXR1cm4ge21pbmUsIHRoZWlyc307XG4gIH1cbn1cblxuZnVuY3Rpb24gaHVua0JlZm9yZSh0ZXN0LCBjaGVjaykge1xuICByZXR1cm4gdGVzdC5vbGRTdGFydCA8IGNoZWNrLm9sZFN0YXJ0XG4gICAgJiYgKHRlc3Qub2xkU3RhcnQgKyB0ZXN0Lm9sZExpbmVzKSA8IGNoZWNrLm9sZFN0YXJ0O1xufVxuXG5mdW5jdGlvbiBjbG9uZUh1bmsoaHVuaywgb2Zmc2V0KSB7XG4gIHJldHVybiB7XG4gICAgb2xkU3RhcnQ6IGh1bmsub2xkU3RhcnQsIG9sZExpbmVzOiBodW5rLm9sZExpbmVzLFxuICAgIG5ld1N0YXJ0OiBodW5rLm5ld1N0YXJ0ICsgb2Zmc2V0LCBuZXdMaW5lczogaHVuay5uZXdMaW5lcyxcbiAgICBsaW5lczogaHVuay5saW5lc1xuICB9O1xufVxuXG5mdW5jdGlvbiBtZXJnZUxpbmVzKGh1bmssIG1pbmVPZmZzZXQsIG1pbmVMaW5lcywgdGhlaXJPZmZzZXQsIHRoZWlyTGluZXMpIHtcbiAgLy8gVGhpcyB3aWxsIGdlbmVyYWxseSByZXN1bHQgaW4gYSBjb25mbGljdGVkIGh1bmssIGJ1dCB0aGVyZSBhcmUgY2FzZXMgd2hlcmUgdGhlIGNvbnRleHRcbiAgLy8gaXMgdGhlIG9ubHkgb3ZlcmxhcCB3aGVyZSB3ZSBjYW4gc3VjY2Vzc2Z1bGx5IG1lcmdlIHRoZSBjb250ZW50IGhlcmUuXG4gIGxldCBtaW5lID0ge29mZnNldDogbWluZU9mZnNldCwgbGluZXM6IG1pbmVMaW5lcywgaW5kZXg6IDB9LFxuICAgICAgdGhlaXIgPSB7b2Zmc2V0OiB0aGVpck9mZnNldCwgbGluZXM6IHRoZWlyTGluZXMsIGluZGV4OiAwfTtcblxuICAvLyBIYW5kbGUgYW55IGxlYWRpbmcgY29udGVudFxuICBpbnNlcnRMZWFkaW5nKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgaW5zZXJ0TGVhZGluZyhodW5rLCB0aGVpciwgbWluZSk7XG5cbiAgLy8gTm93IGluIHRoZSBvdmVybGFwIGNvbnRlbnQuIFNjYW4gdGhyb3VnaCBhbmQgc2VsZWN0IHRoZSBiZXN0IGNoYW5nZXMgZnJvbSBlYWNoLlxuICB3aGlsZSAobWluZS5pbmRleCA8IG1pbmUubGluZXMubGVuZ3RoICYmIHRoZWlyLmluZGV4IDwgdGhlaXIubGluZXMubGVuZ3RoKSB7XG4gICAgbGV0IG1pbmVDdXJyZW50ID0gbWluZS5saW5lc1ttaW5lLmluZGV4XSxcbiAgICAgICAgdGhlaXJDdXJyZW50ID0gdGhlaXIubGluZXNbdGhlaXIuaW5kZXhdO1xuXG4gICAgaWYgKChtaW5lQ3VycmVudFswXSA9PT0gJy0nIHx8IG1pbmVDdXJyZW50WzBdID09PSAnKycpXG4gICAgICAgICYmICh0aGVpckN1cnJlbnRbMF0gPT09ICctJyB8fCB0aGVpckN1cnJlbnRbMF0gPT09ICcrJykpIHtcbiAgICAgIC8vIEJvdGggbW9kaWZpZWQgLi4uXG4gICAgICBtdXR1YWxDaGFuZ2UoaHVuaywgbWluZSwgdGhlaXIpO1xuICAgIH0gZWxzZSBpZiAobWluZUN1cnJlbnRbMF0gPT09ICcrJyAmJiB0aGVpckN1cnJlbnRbMF0gPT09ICcgJykge1xuICAgICAgLy8gTWluZSBpbnNlcnRlZFxuICAgICAgaHVuay5saW5lcy5wdXNoKC4uLiBjb2xsZWN0Q2hhbmdlKG1pbmUpKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJysnICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlycyBpbnNlcnRlZFxuICAgICAgaHVuay5saW5lcy5wdXNoKC4uLiBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfSBlbHNlIGlmIChtaW5lQ3VycmVudFswXSA9PT0gJy0nICYmIHRoZWlyQ3VycmVudFswXSA9PT0gJyAnKSB7XG4gICAgICAvLyBNaW5lIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIG1pbmUsIHRoZWlyKTtcbiAgICB9IGVsc2UgaWYgKHRoZWlyQ3VycmVudFswXSA9PT0gJy0nICYmIG1pbmVDdXJyZW50WzBdID09PSAnICcpIHtcbiAgICAgIC8vIFRoZWlyIHJlbW92ZWQgb3IgZWRpdGVkXG4gICAgICByZW1vdmFsKGh1bmssIHRoZWlyLCBtaW5lLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKG1pbmVDdXJyZW50ID09PSB0aGVpckN1cnJlbnQpIHtcbiAgICAgIC8vIENvbnRleHQgaWRlbnRpdHlcbiAgICAgIGh1bmsubGluZXMucHVzaChtaW5lQ3VycmVudCk7XG4gICAgICBtaW5lLmluZGV4Kys7XG4gICAgICB0aGVpci5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDb250ZXh0IG1pc21hdGNoXG4gICAgICBjb25mbGljdChodW5rLCBjb2xsZWN0Q2hhbmdlKG1pbmUpLCBjb2xsZWN0Q2hhbmdlKHRoZWlyKSk7XG4gICAgfVxuICB9XG5cbiAgLy8gTm93IHB1c2ggYW55dGhpbmcgdGhhdCBtYXkgYmUgcmVtYWluaW5nXG4gIGluc2VydFRyYWlsaW5nKGh1bmssIG1pbmUpO1xuICBpbnNlcnRUcmFpbGluZyhodW5rLCB0aGVpcik7XG5cbiAgY2FsY0xpbmVDb3VudChodW5rKTtcbn1cblxuZnVuY3Rpb24gbXV0dWFsQ2hhbmdlKGh1bmssIG1pbmUsIHRoZWlyKSB7XG4gIGxldCBteUNoYW5nZXMgPSBjb2xsZWN0Q2hhbmdlKG1pbmUpLFxuICAgICAgdGhlaXJDaGFuZ2VzID0gY29sbGVjdENoYW5nZSh0aGVpcik7XG5cbiAgaWYgKGFsbFJlbW92ZXMobXlDaGFuZ2VzKSAmJiBhbGxSZW1vdmVzKHRoZWlyQ2hhbmdlcykpIHtcbiAgICAvLyBTcGVjaWFsIGNhc2UgZm9yIHJlbW92ZSBjaGFuZ2VzIHRoYXQgYXJlIHN1cGVyc2V0cyBvZiBvbmUgYW5vdGhlclxuICAgIGlmIChhcnJheVN0YXJ0c1dpdGgobXlDaGFuZ2VzLCB0aGVpckNoYW5nZXMpXG4gICAgICAgICYmIHNraXBSZW1vdmVTdXBlcnNldCh0aGVpciwgbXlDaGFuZ2VzLCBteUNoYW5nZXMubGVuZ3RoIC0gdGhlaXJDaGFuZ2VzLmxlbmd0aCkpIHtcbiAgICAgIGh1bmsubGluZXMucHVzaCguLi4gbXlDaGFuZ2VzKTtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2UgaWYgKGFycmF5U3RhcnRzV2l0aCh0aGVpckNoYW5nZXMsIG15Q2hhbmdlcylcbiAgICAgICAgJiYgc2tpcFJlbW92ZVN1cGVyc2V0KG1pbmUsIHRoZWlyQ2hhbmdlcywgdGhlaXJDaGFuZ2VzLmxlbmd0aCAtIG15Q2hhbmdlcy5sZW5ndGgpKSB7XG4gICAgICBodW5rLmxpbmVzLnB1c2goLi4uIHRoZWlyQ2hhbmdlcyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2UgaWYgKGFycmF5RXF1YWwobXlDaGFuZ2VzLCB0aGVpckNoYW5nZXMpKSB7XG4gICAgaHVuay5saW5lcy5wdXNoKC4uLiBteUNoYW5nZXMpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbmZsaWN0KGh1bmssIG15Q2hhbmdlcywgdGhlaXJDaGFuZ2VzKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZhbChodW5rLCBtaW5lLCB0aGVpciwgc3dhcCkge1xuICBsZXQgbXlDaGFuZ2VzID0gY29sbGVjdENoYW5nZShtaW5lKSxcbiAgICAgIHRoZWlyQ2hhbmdlcyA9IGNvbGxlY3RDb250ZXh0KHRoZWlyLCBteUNoYW5nZXMpO1xuICBpZiAodGhlaXJDaGFuZ2VzLm1lcmdlZCkge1xuICAgIGh1bmsubGluZXMucHVzaCguLi4gdGhlaXJDaGFuZ2VzLm1lcmdlZCk7XG4gIH0gZWxzZSB7XG4gICAgY29uZmxpY3QoaHVuaywgc3dhcCA/IHRoZWlyQ2hhbmdlcyA6IG15Q2hhbmdlcywgc3dhcCA/IG15Q2hhbmdlcyA6IHRoZWlyQ2hhbmdlcyk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY29uZmxpY3QoaHVuaywgbWluZSwgdGhlaXIpIHtcbiAgaHVuay5jb25mbGljdCA9IHRydWU7XG4gIGh1bmsubGluZXMucHVzaCh7XG4gICAgY29uZmxpY3Q6IHRydWUsXG4gICAgbWluZTogbWluZSxcbiAgICB0aGVpcnM6IHRoZWlyXG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpbnNlcnRMZWFkaW5nKGh1bmssIGluc2VydCwgdGhlaXIpIHtcbiAgd2hpbGUgKGluc2VydC5vZmZzZXQgPCB0aGVpci5vZmZzZXQgJiYgaW5zZXJ0LmluZGV4IDwgaW5zZXJ0LmxpbmVzLmxlbmd0aCkge1xuICAgIGxldCBsaW5lID0gaW5zZXJ0LmxpbmVzW2luc2VydC5pbmRleCsrXTtcbiAgICBodW5rLmxpbmVzLnB1c2gobGluZSk7XG4gICAgaW5zZXJ0Lm9mZnNldCsrO1xuICB9XG59XG5mdW5jdGlvbiBpbnNlcnRUcmFpbGluZyhodW5rLCBpbnNlcnQpIHtcbiAgd2hpbGUgKGluc2VydC5pbmRleCA8IGluc2VydC5saW5lcy5sZW5ndGgpIHtcbiAgICBsZXQgbGluZSA9IGluc2VydC5saW5lc1tpbnNlcnQuaW5kZXgrK107XG4gICAgaHVuay5saW5lcy5wdXNoKGxpbmUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNvbGxlY3RDaGFuZ2Uoc3RhdGUpIHtcbiAgbGV0IHJldCA9IFtdLFxuICAgICAgb3BlcmF0aW9uID0gc3RhdGUubGluZXNbc3RhdGUuaW5kZXhdWzBdO1xuICB3aGlsZSAoc3RhdGUuaW5kZXggPCBzdGF0ZS5saW5lcy5sZW5ndGgpIHtcbiAgICBsZXQgbGluZSA9IHN0YXRlLmxpbmVzW3N0YXRlLmluZGV4XTtcblxuICAgIC8vIEdyb3VwIGFkZGl0aW9ucyB0aGF0IGFyZSBpbW1lZGlhdGVseSBhZnRlciBzdWJ0cmFjdGlvbnMgYW5kIHRyZWF0IHRoZW0gYXMgb25lIFwiYXRvbWljXCIgbW9kaWZ5IGNoYW5nZS5cbiAgICBpZiAob3BlcmF0aW9uID09PSAnLScgJiYgbGluZVswXSA9PT0gJysnKSB7XG4gICAgICBvcGVyYXRpb24gPSAnKyc7XG4gICAgfVxuXG4gICAgaWYgKG9wZXJhdGlvbiA9PT0gbGluZVswXSkge1xuICAgICAgcmV0LnB1c2gobGluZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmV0O1xufVxuZnVuY3Rpb24gY29sbGVjdENvbnRleHQoc3RhdGUsIG1hdGNoQ2hhbmdlcykge1xuICBsZXQgY2hhbmdlcyA9IFtdLFxuICAgICAgbWVyZ2VkID0gW10sXG4gICAgICBtYXRjaEluZGV4ID0gMCxcbiAgICAgIGNvbnRleHRDaGFuZ2VzID0gZmFsc2UsXG4gICAgICBjb25mbGljdGVkID0gZmFsc2U7XG4gIHdoaWxlIChtYXRjaEluZGV4IDwgbWF0Y2hDaGFuZ2VzLmxlbmd0aFxuICAgICAgICAmJiBzdGF0ZS5pbmRleCA8IHN0YXRlLmxpbmVzLmxlbmd0aCkge1xuICAgIGxldCBjaGFuZ2UgPSBzdGF0ZS5saW5lc1tzdGF0ZS5pbmRleF0sXG4gICAgICAgIG1hdGNoID0gbWF0Y2hDaGFuZ2VzW21hdGNoSW5kZXhdO1xuXG4gICAgLy8gT25jZSB3ZSd2ZSBoaXQgb3VyIGFkZCwgdGhlbiB3ZSBhcmUgZG9uZVxuICAgIGlmIChtYXRjaFswXSA9PT0gJysnKSB7XG4gICAgICBicmVhaztcbiAgICB9XG5cbiAgICBjb250ZXh0Q2hhbmdlcyA9IGNvbnRleHRDaGFuZ2VzIHx8IGNoYW5nZVswXSAhPT0gJyAnO1xuXG4gICAgbWVyZ2VkLnB1c2gobWF0Y2gpO1xuICAgIG1hdGNoSW5kZXgrKztcblxuICAgIC8vIENvbnN1bWUgYW55IGFkZGl0aW9ucyBpbiB0aGUgb3RoZXIgYmxvY2sgYXMgYSBjb25mbGljdCB0byBhdHRlbXB0XG4gICAgLy8gdG8gcHVsbCBpbiB0aGUgcmVtYWluaW5nIGNvbnRleHQgYWZ0ZXIgdGhpc1xuICAgIGlmIChjaGFuZ2VbMF0gPT09ICcrJykge1xuICAgICAgY29uZmxpY3RlZCA9IHRydWU7XG5cbiAgICAgIHdoaWxlIChjaGFuZ2VbMF0gPT09ICcrJykge1xuICAgICAgICBjaGFuZ2VzLnB1c2goY2hhbmdlKTtcbiAgICAgICAgY2hhbmdlID0gc3RhdGUubGluZXNbKytzdGF0ZS5pbmRleF07XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoLnN1YnN0cigxKSA9PT0gY2hhbmdlLnN1YnN0cigxKSkge1xuICAgICAgY2hhbmdlcy5wdXNoKGNoYW5nZSk7XG4gICAgICBzdGF0ZS5pbmRleCsrO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoKG1hdGNoQ2hhbmdlc1ttYXRjaEluZGV4XSB8fCAnJylbMF0gPT09ICcrJ1xuICAgICAgJiYgY29udGV4dENoYW5nZXMpIHtcbiAgICBjb25mbGljdGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChjb25mbGljdGVkKSB7XG4gICAgcmV0dXJuIGNoYW5nZXM7XG4gIH1cblxuICB3aGlsZSAobWF0Y2hJbmRleCA8IG1hdGNoQ2hhbmdlcy5sZW5ndGgpIHtcbiAgICBtZXJnZWQucHVzaChtYXRjaENoYW5nZXNbbWF0Y2hJbmRleCsrXSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG1lcmdlZCxcbiAgICBjaGFuZ2VzXG4gIH07XG59XG5cbmZ1bmN0aW9uIGFsbFJlbW92ZXMoY2hhbmdlcykge1xuICByZXR1cm4gY2hhbmdlcy5yZWR1Y2UoZnVuY3Rpb24ocHJldiwgY2hhbmdlKSB7XG4gICAgcmV0dXJuIHByZXYgJiYgY2hhbmdlWzBdID09PSAnLSc7XG4gIH0sIHRydWUpO1xufVxuZnVuY3Rpb24gc2tpcFJlbW92ZVN1cGVyc2V0KHN0YXRlLCByZW1vdmVDaGFuZ2VzLCBkZWx0YSkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGRlbHRhOyBpKyspIHtcbiAgICBsZXQgY2hhbmdlQ29udGVudCA9IHJlbW92ZUNoYW5nZXNbcmVtb3ZlQ2hhbmdlcy5sZW5ndGggLSBkZWx0YSArIGldLnN1YnN0cigxKTtcbiAgICBpZiAoc3RhdGUubGluZXNbc3RhdGUuaW5kZXggKyBpXSAhPT0gJyAnICsgY2hhbmdlQ29udGVudCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHN0YXRlLmluZGV4ICs9IGRlbHRhO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lcykge1xuICBsZXQgb2xkTGluZXMgPSAwO1xuICBsZXQgbmV3TGluZXMgPSAwO1xuXG4gIGxpbmVzLmZvckVhY2goZnVuY3Rpb24obGluZSkge1xuICAgIGlmICh0eXBlb2YgbGluZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgIGxldCBteUNvdW50ID0gY2FsY09sZE5ld0xpbmVDb3VudChsaW5lLm1pbmUpO1xuICAgICAgbGV0IHRoZWlyQ291bnQgPSBjYWxjT2xkTmV3TGluZUNvdW50KGxpbmUudGhlaXJzKTtcblxuICAgICAgaWYgKG9sZExpbmVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKG15Q291bnQub2xkTGluZXMgPT09IHRoZWlyQ291bnQub2xkTGluZXMpIHtcbiAgICAgICAgICBvbGRMaW5lcyArPSBteUNvdW50Lm9sZExpbmVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG9sZExpbmVzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChuZXdMaW5lcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmIChteUNvdW50Lm5ld0xpbmVzID09PSB0aGVpckNvdW50Lm5ld0xpbmVzKSB7XG4gICAgICAgICAgbmV3TGluZXMgKz0gbXlDb3VudC5uZXdMaW5lcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdMaW5lcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAobmV3TGluZXMgIT09IHVuZGVmaW5lZCAmJiAobGluZVswXSA9PT0gJysnIHx8IGxpbmVbMF0gPT09ICcgJykpIHtcbiAgICAgICAgbmV3TGluZXMrKztcbiAgICAgIH1cbiAgICAgIGlmIChvbGRMaW5lcyAhPT0gdW5kZWZpbmVkICYmIChsaW5lWzBdID09PSAnLScgfHwgbGluZVswXSA9PT0gJyAnKSkge1xuICAgICAgICBvbGRMaW5lcysrO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHtvbGRMaW5lcywgbmV3TGluZXN9O1xufVxuIl19\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/structuredPatch = structuredPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createTwoFilesPatch = createTwoFilesPatch;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/createPatch = createPatch;\n\n\tvar /*istanbul ignore start*/_line = __webpack_require__(5) /*istanbul ignore end*/;\n\n\t/*istanbul ignore start*/function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\t/*istanbul ignore end*/function structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  if (!options) {\n\t    options = {};\n\t  }\n\t  if (typeof options.context === 'undefined') {\n\t    options.context = 4;\n\t  }\n\n\t  var diff = /*istanbul ignore start*/(0, _line.diffLines) /*istanbul ignore end*/(oldStr, newStr, options);\n\t  diff.push({ value: '', lines: [] }); // Append an empty value to make cleanup easier\n\n\t  function contextLines(lines) {\n\t    return lines.map(function (entry) {\n\t      return ' ' + entry;\n\t    });\n\t  }\n\n\t  var hunks = [];\n\t  var oldRangeStart = 0,\n\t      newRangeStart = 0,\n\t      curRange = [],\n\t      oldLine = 1,\n\t      newLine = 1;\n\n\t  /*istanbul ignore start*/var _loop = function _loop( /*istanbul ignore end*/i) {\n\t    var current = diff[i],\n\t        lines = current.lines || current.value.replace(/\\n$/, '').split('\\n');\n\t    current.lines = lines;\n\n\t    if (current.added || current.removed) {\n\t      /*istanbul ignore start*/var _curRange;\n\n\t      /*istanbul ignore end*/ // If we have previous context, start with that\n\t      if (!oldRangeStart) {\n\t        var prev = diff[i - 1];\n\t        oldRangeStart = oldLine;\n\t        newRangeStart = newLine;\n\n\t        if (prev) {\n\t          curRange = options.context > 0 ? contextLines(prev.lines.slice(-options.context)) : [];\n\t          oldRangeStart -= curRange.length;\n\t          newRangeStart -= curRange.length;\n\t        }\n\t      }\n\n\t      // Output our changes\n\t      /*istanbul ignore start*/(_curRange = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/lines.map(function (entry) {\n\t        return (current.added ? '+' : '-') + entry;\n\t      })));\n\n\t      // Track the updated file position\n\t      if (current.added) {\n\t        newLine += lines.length;\n\t      } else {\n\t        oldLine += lines.length;\n\t      }\n\t    } else {\n\t      // Identical context lines. Track line changes\n\t      if (oldRangeStart) {\n\t        // Close out any changes that have been output (or join overlapping)\n\t        if (lines.length <= options.context * 2 && i < diff.length - 2) {\n\t          /*istanbul ignore start*/var _curRange2;\n\n\t          /*istanbul ignore end*/ // Overlapping\n\t          /*istanbul ignore start*/(_curRange2 = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange2 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/contextLines(lines)));\n\t        } else {\n\t          /*istanbul ignore start*/var _curRange3;\n\n\t          /*istanbul ignore end*/ // end the range and output\n\t          var contextSize = Math.min(lines.length, options.context);\n\t          /*istanbul ignore start*/(_curRange3 = /*istanbul ignore end*/curRange).push. /*istanbul ignore start*/apply /*istanbul ignore end*/( /*istanbul ignore start*/_curRange3 /*istanbul ignore end*/, /*istanbul ignore start*/_toConsumableArray( /*istanbul ignore end*/contextLines(lines.slice(0, contextSize))));\n\n\t          var hunk = {\n\t            oldStart: oldRangeStart,\n\t            oldLines: oldLine - oldRangeStart + contextSize,\n\t            newStart: newRangeStart,\n\t            newLines: newLine - newRangeStart + contextSize,\n\t            lines: curRange\n\t          };\n\t          if (i >= diff.length - 2 && lines.length <= options.context) {\n\t            // EOF is inside this hunk\n\t            var oldEOFNewline = /\\n$/.test(oldStr);\n\t            var newEOFNewline = /\\n$/.test(newStr);\n\t            if (lines.length == 0 && !oldEOFNewline) {\n\t              // special case: old has no eol and no trailing context; no-nl can end up before adds\n\t              curRange.splice(hunk.oldLines, 0, '\\\\ No newline at end of file');\n\t            } else if (!oldEOFNewline || !newEOFNewline) {\n\t              curRange.push('\\\\ No newline at end of file');\n\t            }\n\t          }\n\t          hunks.push(hunk);\n\n\t          oldRangeStart = 0;\n\t          newRangeStart = 0;\n\t          curRange = [];\n\t        }\n\t      }\n\t      oldLine += lines.length;\n\t      newLine += lines.length;\n\t    }\n\t  };\n\n\t  for (var i = 0; i < diff.length; i++) {\n\t    /*istanbul ignore start*/_loop( /*istanbul ignore end*/i);\n\t  }\n\n\t  return {\n\t    oldFileName: oldFileName, newFileName: newFileName,\n\t    oldHeader: oldHeader, newHeader: newHeader,\n\t    hunks: hunks\n\t  };\n\t}\n\n\tfunction createTwoFilesPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  var diff = structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options);\n\n\t  var ret = [];\n\t  if (oldFileName == newFileName) {\n\t    ret.push('Index: ' + oldFileName);\n\t  }\n\t  ret.push('===================================================================');\n\t  ret.push('--- ' + diff.oldFileName + (typeof diff.oldHeader === 'undefined' ? '' : '\\t' + diff.oldHeader));\n\t  ret.push('+++ ' + diff.newFileName + (typeof diff.newHeader === 'undefined' ? '' : '\\t' + diff.newHeader));\n\n\t  for (var i = 0; i < diff.hunks.length; i++) {\n\t    var hunk = diff.hunks[i];\n\t    ret.push('@@ -' + hunk.oldStart + ',' + hunk.oldLines + ' +' + hunk.newStart + ',' + hunk.newLines + ' @@');\n\t    ret.push.apply(ret, hunk.lines);\n\t  }\n\n\t  return ret.join('\\n') + '\\n';\n\t}\n\n\tfunction createPatch(fileName, oldStr, newStr, oldHeader, newHeader, options) {\n\t  return createTwoFilesPatch(fileName, fileName, oldStr, newStr, oldHeader, newHeader, options);\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXRjaC9jcmVhdGUuanMiXSwibmFtZXMiOlsic3RydWN0dXJlZFBhdGNoIiwiY3JlYXRlVHdvRmlsZXNQYXRjaCIsImNyZWF0ZVBhdGNoIiwib2xkRmlsZU5hbWUiLCJuZXdGaWxlTmFtZSIsIm9sZFN0ciIsIm5ld1N0ciIsIm9sZEhlYWRlciIsIm5ld0hlYWRlciIsIm9wdGlvbnMiLCJjb250ZXh0IiwiZGlmZiIsInB1c2giLCJ2YWx1ZSIsImxpbmVzIiwiY29udGV4dExpbmVzIiwibWFwIiwiZW50cnkiLCJodW5rcyIsIm9sZFJhbmdlU3RhcnQiLCJuZXdSYW5nZVN0YXJ0IiwiY3VyUmFuZ2UiLCJvbGRMaW5lIiwibmV3TGluZSIsImkiLCJjdXJyZW50IiwicmVwbGFjZSIsInNwbGl0IiwiYWRkZWQiLCJyZW1vdmVkIiwicHJldiIsInNsaWNlIiwibGVuZ3RoIiwiY29udGV4dFNpemUiLCJNYXRoIiwibWluIiwiaHVuayIsIm9sZFN0YXJ0Iiwib2xkTGluZXMiLCJuZXdTdGFydCIsIm5ld0xpbmVzIiwib2xkRU9GTmV3bGluZSIsInRlc3QiLCJuZXdFT0ZOZXdsaW5lIiwic3BsaWNlIiwicmV0IiwiYXBwbHkiLCJqb2luIiwiZmlsZU5hbWUiXSwibWFwcGluZ3MiOiI7OztnQ0FFZ0JBLGUsR0FBQUEsZTt5REFpR0FDLG1CLEdBQUFBLG1CO3lEQXdCQUMsVyxHQUFBQSxXOztBQTNIaEI7Ozs7dUJBRU8sU0FBU0YsZUFBVCxDQUF5QkcsV0FBekIsRUFBc0NDLFdBQXRDLEVBQW1EQyxNQUFuRCxFQUEyREMsTUFBM0QsRUFBbUVDLFNBQW5FLEVBQThFQyxTQUE5RSxFQUF5RkMsT0FBekYsRUFBa0c7QUFDdkcsTUFBSSxDQUFDQSxPQUFMLEVBQWM7QUFDWkEsY0FBVSxFQUFWO0FBQ0Q7QUFDRCxNQUFJLE9BQU9BLFFBQVFDLE9BQWYsS0FBMkIsV0FBL0IsRUFBNEM7QUFDMUNELFlBQVFDLE9BQVIsR0FBa0IsQ0FBbEI7QUFDRDs7QUFFRCxN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QUEvQyxFQUEwREMsU0FBMUQsRUFBcUVDLE9BQXJFLEVBQThFO0FBQ25GLFNBQU9SLG9CQUFvQitDLFFBQXBCLEVBQThCQSxRQUE5QixFQUF3QzNDLE1BQXhDLEVBQWdEQyxNQUFoRCxFQUF3REMsU0FBeEQsRUFBbUVDLFNBQW5FLEVBQThFQyxPQUE5RSxDQUFQO0FBQ0QiLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtkaWZmTGluZXN9IGZyb20gJy4uL2RpZmYvbGluZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBzdHJ1Y3R1cmVkUGF0Y2gob2xkRmlsZU5hbWUsIG5ld0ZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgaWYgKCFvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5jb250ZXh0ID09PSAndW5kZWZpbmVkJykge1xuICAgIG9wdGlvbnMuY29udGV4dCA9IDQ7XG4gIH1cblxuICBjb25zdCBkaWZmID0gZGlmZkxpbmVzKG9sZFN0ciwgbmV3U3RyLCBvcHRpb25zKTtcbiAgZGlmZi5wdXNoKHt2YWx1ZTogJycsIGxpbmVzOiBbXX0pOyAgIC8vIEFwcGVuZCBhbiBlbXB0eSB2YWx1ZSB0byBtYWtlIGNsZWFudXAgZWFzaWVyXG5cbiAgZnVuY3Rpb24gY29udGV4dExpbmVzKGxpbmVzKSB7XG4gICAgcmV0dXJuIGxpbmVzLm1hcChmdW5jdGlvbihlbnRyeSkgeyByZXR1cm4gJyAnICsgZW50cnk7IH0pO1xuICB9XG5cbiAgbGV0IGh1bmtzID0gW107XG4gIGxldCBvbGRSYW5nZVN0YXJ0ID0gMCwgbmV3UmFuZ2VTdGFydCA9IDAsIGN1clJhbmdlID0gW10sXG4gICAgICBvbGRMaW5lID0gMSwgbmV3TGluZSA9IDE7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZGlmZi5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGN1cnJlbnQgPSBkaWZmW2ldLFxuICAgICAgICAgIGxpbmVzID0gY3VycmVudC5saW5lcyB8fCBjdXJyZW50LnZhbHVlLnJlcGxhY2UoL1xcbiQvLCAnJykuc3BsaXQoJ1xcbicpO1xuICAgIGN1cnJlbnQubGluZXMgPSBsaW5lcztcblxuICAgIGlmIChjdXJyZW50LmFkZGVkIHx8IGN1cnJlbnQucmVtb3ZlZCkge1xuICAgICAgLy8gSWYgd2UgaGF2ZSBwcmV2aW91cyBjb250ZXh0LCBzdGFydCB3aXRoIHRoYXRcbiAgICAgIGlmICghb2xkUmFuZ2VTdGFydCkge1xuICAgICAgICBjb25zdCBwcmV2ID0gZGlmZltpIC0gMV07XG4gICAgICAgIG9sZFJhbmdlU3RhcnQgPSBvbGRMaW5lO1xuICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gbmV3TGluZTtcblxuICAgICAgICBpZiAocHJldikge1xuICAgICAgICAgIGN1clJhbmdlID0gb3B0aW9ucy5jb250ZXh0ID4gMCA/IGNvbnRleHRMaW5lcyhwcmV2LmxpbmVzLnNsaWNlKC1vcHRpb25zLmNvbnRleHQpKSA6IFtdO1xuICAgICAgICAgIG9sZFJhbmdlU3RhcnQgLT0gY3VyUmFuZ2UubGVuZ3RoO1xuICAgICAgICAgIG5ld1JhbmdlU3RhcnQgLT0gY3VyUmFuZ2UubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE91dHB1dCBvdXIgY2hhbmdlc1xuICAgICAgY3VyUmFuZ2UucHVzaCguLi4gbGluZXMubWFwKGZ1bmN0aW9uKGVudHJ5KSB7XG4gICAgICAgIHJldHVybiAoY3VycmVudC5hZGRlZCA/ICcrJyA6ICctJykgKyBlbnRyeTtcbiAgICAgIH0pKTtcblxuICAgICAgLy8gVHJhY2sgdGhlIHVwZGF0ZWQgZmlsZSBwb3NpdGlvblxuICAgICAgaWYgKGN1cnJlbnQuYWRkZWQpIHtcbiAgICAgICAgbmV3TGluZSArPSBsaW5lcy5sZW5ndGg7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBvbGRMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWRlbnRpY2FsIGNvbnRleHQgbGluZXMuIFRyYWNrIGxpbmUgY2hhbmdlc1xuICAgICAgaWYgKG9sZFJhbmdlU3RhcnQpIHtcbiAgICAgICAgLy8gQ2xvc2Ugb3V0IGFueSBjaGFuZ2VzIHRoYXQgaGF2ZSBiZWVuIG91dHB1dCAob3Igam9pbiBvdmVybGFwcGluZylcbiAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA8PSBvcHRpb25zLmNvbnRleHQgKiAyICYmIGkgPCBkaWZmLmxlbmd0aCAtIDIpIHtcbiAgICAgICAgICAvLyBPdmVybGFwcGluZ1xuICAgICAgICAgIGN1clJhbmdlLnB1c2goLi4uIGNvbnRleHRMaW5lcyhsaW5lcykpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vIGVuZCB0aGUgcmFuZ2UgYW5kIG91dHB1dFxuICAgICAgICAgIGxldCBjb250ZXh0U2l6ZSA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCwgb3B0aW9ucy5jb250ZXh0KTtcbiAgICAgICAgICBjdXJSYW5nZS5wdXNoKC4uLiBjb250ZXh0TGluZXMobGluZXMuc2xpY2UoMCwgY29udGV4dFNpemUpKSk7XG5cbiAgICAgICAgICBsZXQgaHVuayA9IHtcbiAgICAgICAgICAgIG9sZFN0YXJ0OiBvbGRSYW5nZVN0YXJ0LFxuICAgICAgICAgICAgb2xkTGluZXM6IChvbGRMaW5lIC0gb2xkUmFuZ2VTdGFydCArIGNvbnRleHRTaXplKSxcbiAgICAgICAgICAgIG5ld1N0YXJ0OiBuZXdSYW5nZVN0YXJ0LFxuICAgICAgICAgICAgbmV3TGluZXM6IChuZXdMaW5lIC0gbmV3UmFuZ2VTdGFydCArIGNvbnRleHRTaXplKSxcbiAgICAgICAgICAgIGxpbmVzOiBjdXJSYW5nZVxuICAgICAgICAgIH07XG4gICAgICAgICAgaWYgKGkgPj0gZGlmZi5sZW5ndGggLSAyICYmIGxpbmVzLmxlbmd0aCA8PSBvcHRpb25zLmNvbnRleHQpIHtcbiAgICAgICAgICAgIC8vIEVPRiBpcyBpbnNpZGUgdGhpcyBodW5rXG4gICAgICAgICAgICBsZXQgb2xkRU9GTmV3bGluZSA9ICgvXFxuJC8udGVzdChvbGRTdHIpKTtcbiAgICAgICAgICAgIGxldCBuZXdFT0ZOZXdsaW5lID0gKC9cXG4kLy50ZXN0KG5ld1N0cikpO1xuICAgICAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA9PSAwICYmICFvbGRFT0ZOZXdsaW5lKSB7XG4gICAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb2xkIGhhcyBubyBlb2wgYW5kIG5vIHRyYWlsaW5nIGNvbnRleHQ7IG5vLW5sIGNhbiBlbmQgdXAgYmVmb3JlIGFkZHNcbiAgICAgICAgICAgICAgY3VyUmFuZ2Uuc3BsaWNlKGh1bmsub2xkTGluZXMsIDAsICdcXFxcIE5vIG5ld2xpbmUgYXQgZW5kIG9mIGZpbGUnKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIW9sZEVPRk5ld2xpbmUgfHwgIW5ld0VPRk5ld2xpbmUpIHtcbiAgICAgICAgICAgICAgY3VyUmFuZ2UucHVzaCgnXFxcXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGh1bmtzLnB1c2goaHVuayk7XG5cbiAgICAgICAgICBvbGRSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICBuZXdSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICBjdXJSYW5nZSA9IFtdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBvbGRMaW5lICs9IGxpbmVzLmxlbmd0aDtcbiAgICAgIG5ld0xpbmUgKz0gbGluZXMubGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgb2xkRmlsZU5hbWU6IG9sZEZpbGVOYW1lLCBuZXdGaWxlTmFtZTogbmV3RmlsZU5hbWUsXG4gICAgb2xkSGVhZGVyOiBvbGRIZWFkZXIsIG5ld0hlYWRlcjogbmV3SGVhZGVyLFxuICAgIGh1bmtzOiBodW5rc1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHdvRmlsZXNQYXRjaChvbGRGaWxlTmFtZSwgbmV3RmlsZU5hbWUsIG9sZFN0ciwgbmV3U3RyLCBvbGRIZWFkZXIsIG5ld0hlYWRlciwgb3B0aW9ucykge1xuICBjb25zdCBkaWZmID0gc3RydWN0dXJlZFBhdGNoKG9sZEZpbGVOYW1lLCBuZXdGaWxlTmFtZSwgb2xkU3RyLCBuZXdTdHIsIG9sZEhlYWRlciwgbmV3SGVhZGVyLCBvcHRpb25zKTtcblxuICBjb25zdCByZXQgPSBbXTtcbiAgaWYgKG9sZEZpbGVOYW1lID09IG5ld0ZpbGVOYW1lKSB7XG4gICAgcmV0LnB1c2goJ0luZGV4OiAnICsgb2xkRmlsZU5hbWUpO1xuICB9XG4gIHJldC5wdXNoKCc9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Jyk7XG4gIHJldC5wdXNoKCctLS0gJyArIGRpZmYub2xkRmlsZU5hbWUgKyAodHlwZW9mIGRpZmYub2xkSGVhZGVyID09PSAndW5kZWZpbmVkJyA/ICcnIDogJ1xcdCcgKyBkaWZmLm9sZEhlYWRlcikpO1xuICByZXQucHVzaCgnKysrICcgKyBkaWZmLm5ld0ZpbGVOYW1lICsgKHR5cGVvZiBkaWZmLm5ld0hlYWRlciA9PT0gJ3VuZGVmaW5lZCcgPyAnJyA6ICdcXHQnICsgZGlmZi5uZXdIZWFkZXIpKTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGRpZmYuaHVua3MubGVuZ3RoOyBpKyspIHtcbiAgICBjb25zdCBodW5rID0gZGlmZi5odW5rc1tpXTtcbiAgICByZXQucHVzaChcbiAgICAgICdAQCAtJyArIGh1bmsub2xkU3RhcnQgKyAnLCcgKyBodW5rLm9sZExpbmVzXG4gICAgICArICcgKycgKyBodW5rLm5ld1N0YXJ0ICsgJywnICsgaHVuay5uZXdMaW5lc1xuICAgICAgKyAnIEBAJ1xuICAgICk7XG4gICAgcmV0LnB1c2guYXBwbHkocmV0LCBodW5rLmxpbmVzKTtcbiAgfVxuXG4gIHJldHVybiByZXQuam9pbignXFxuJykgKyAnXFxuJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVBhdGNoKGZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpIHtcbiAgcmV0dXJuIGNyZWF0ZVR3b0ZpbGVzUGF0Y2goZmlsZU5hbWUsIGZpbGVOYW1lLCBvbGRTdHIsIG5ld1N0ciwgb2xkSGVhZGVyLCBuZXdIZWFkZXIsIG9wdGlvbnMpO1xufVxuIl19\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/arrayEqual = arrayEqual;\n\t/*istanbul ignore start*/exports. /*istanbul ignore end*/arrayStartsWith = arrayStartsWith;\n\tfunction arrayEqual(a, b) {\n\t  if (a.length !== b.length) {\n\t    return false;\n\t  }\n\n\t  return arrayStartsWith(a, b);\n\t}\n\n\tfunction arrayStartsWith(array, start) {\n\t  if (start.length > array.length) {\n\t    return false;\n\t  }\n\n\t  for (var i = 0; i < start.length; i++) {\n\t    if (start[i] !== array[i]) {\n\t      return false;\n\t    }\n\t  }\n\n\t  return true;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2FycmF5LmpzIl0sIm5hbWVzIjpbImFycmF5RXF1YWwiLCJhcnJheVN0YXJ0c1dpdGgiLCJhIiwiYiIsImxlbmd0aCIsImFycmF5Iiwic3RhcnQiLCJpIl0sIm1hcHBpbmdzIjoiOzs7Z0NBQWdCQSxVLEdBQUFBLFU7eURBUUFDLGUsR0FBQUEsZTtBQVJULFNBQVNELFVBQVQsQ0FBb0JFLENBQXBCLEVBQXVCQyxDQUF2QixFQUEwQjtBQUMvQixNQUFJRCxFQUFFRSxNQUFGLEtBQWFELEVBQUVDLE1BQW5CLEVBQTJCO0FBQ3pCLFdBQU8sS0FBUDtBQUNEOztBQUVELFNBQU9ILGdCQUFnQkMsQ0FBaEIsRUFBbUJDLENBQW5CLENBQVA7QUFDRDs7QUFFTSxTQUFTRixlQUFULENBQXlCSSxLQUF6QixFQUFnQ0MsS0FBaEMsRUFBdUM7QUFDNUMsTUFBSUEsTUFBTUYsTUFBTixHQUFlQyxNQUFNRCxNQUF6QixFQUFpQztBQUMvQixXQUFPLEtBQVA7QUFDRDs7QUFFRCxPQUFLLElBQUlHLElBQUksQ0FBYixFQUFnQkEsSUFBSUQsTUFBTUYsTUFBMUIsRUFBa0NHLEdBQWxDLEVBQXVDO0FBQ3JDLFFBQUlELE1BQU1DLENBQU4sTUFBYUYsTUFBTUUsQ0FBTixDQUFqQixFQUEyQjtBQUN6QixhQUFPLEtBQVA7QUFDRDtBQUNGOztBQUVELFNBQU8sSUFBUDtBQUNEIiwiZmlsZSI6ImFycmF5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGFycmF5RXF1YWwoYSwgYikge1xuICBpZiAoYS5sZW5ndGggIT09IGIubGVuZ3RoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIGFycmF5U3RhcnRzV2l0aChhLCBiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFycmF5U3RhcnRzV2l0aChhcnJheSwgc3RhcnQpIHtcbiAgaWYgKHN0YXJ0Lmxlbmd0aCA+IGFycmF5Lmxlbmd0aCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgc3RhcnQubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAoc3RhcnRbaV0gIT09IGFycmF5W2ldKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG4iXX0=\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/\"use strict\";\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/convertChangesToDMP = convertChangesToDMP;\n\t// See: http://code.google.com/p/google-diff-match-patch/wiki/API\n\tfunction convertChangesToDMP(changes) {\n\t  var ret = [],\n\t      change = /*istanbul ignore start*/void 0 /*istanbul ignore end*/,\n\t      operation = /*istanbul ignore start*/void 0 /*istanbul ignore end*/;\n\t  for (var i = 0; i < changes.length; i++) {\n\t    change = changes[i];\n\t    if (change.added) {\n\t      operation = 1;\n\t    } else if (change.removed) {\n\t      operation = -1;\n\t    } else {\n\t      operation = 0;\n\t    }\n\n\t    ret.push([operation, change.value]);\n\t  }\n\t  return ret;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb252ZXJ0L2RtcC5qcyJdLCJuYW1lcyI6WyJjb252ZXJ0Q2hhbmdlc1RvRE1QIiwiY2hhbmdlcyIsInJldCIsImNoYW5nZSIsIm9wZXJhdGlvbiIsImkiLCJsZW5ndGgiLCJhZGRlZCIsInJlbW92ZWQiLCJwdXNoIiwidmFsdWUiXSwibWFwcGluZ3MiOiI7OztnQ0FDZ0JBLG1CLEdBQUFBLG1CO0FBRGhCO0FBQ08sU0FBU0EsbUJBQVQsQ0FBNkJDLE9BQTdCLEVBQXNDO0FBQzNDLE1BQUlDLE1BQU0sRUFBVjtBQUFBLE1BQ0lDLHdDQURKO0FBQUEsTUFFSUMsMkNBRko7QUFHQSxPQUFLLElBQUlDLElBQUksQ0FBYixFQUFnQkEsSUFBSUosUUFBUUssTUFBNUIsRUFBb0NELEdBQXBDLEVBQXlDO0FBQ3ZDRixhQUFTRixRQUFRSSxDQUFSLENBQVQ7QUFDQSxRQUFJRixPQUFPSSxLQUFYLEVBQWtCO0FBQ2hCSCxrQkFBWSxDQUFaO0FBQ0QsS0FGRCxNQUVPLElBQUlELE9BQU9LLE9BQVgsRUFBb0I7QUFDekJKLGtCQUFZLENBQUMsQ0FBYjtBQUNELEtBRk0sTUFFQTtBQUNMQSxrQkFBWSxDQUFaO0FBQ0Q7O0FBRURGLFFBQUlPLElBQUosQ0FBUyxDQUFDTCxTQUFELEVBQVlELE9BQU9PLEtBQW5CLENBQVQ7QUFDRDtBQUNELFNBQU9SLEdBQVA7QUFDRCIsImZpbGUiOiJkbXAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTZWU6IGh0dHA6Ly9jb2RlLmdvb2dsZS5jb20vcC9nb29nbGUtZGlmZi1tYXRjaC1wYXRjaC93aWtpL0FQSVxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9ETVAoY2hhbmdlcykge1xuICBsZXQgcmV0ID0gW10sXG4gICAgICBjaGFuZ2UsXG4gICAgICBvcGVyYXRpb247XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgIGNoYW5nZSA9IGNoYW5nZXNbaV07XG4gICAgaWYgKGNoYW5nZS5hZGRlZCkge1xuICAgICAgb3BlcmF0aW9uID0gMTtcbiAgICB9IGVsc2UgaWYgKGNoYW5nZS5yZW1vdmVkKSB7XG4gICAgICBvcGVyYXRpb24gPSAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgb3BlcmF0aW9uID0gMDtcbiAgICB9XG5cbiAgICByZXQucHVzaChbb3BlcmF0aW9uLCBjaGFuZ2UudmFsdWVdKTtcbiAgfVxuICByZXR1cm4gcmV0O1xufVxuIl19\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports) {\n\n\t/*istanbul ignore start*/'use strict';\n\n\texports.__esModule = true;\n\texports. /*istanbul ignore end*/convertChangesToXML = convertChangesToXML;\n\tfunction convertChangesToXML(changes) {\n\t  var ret = [];\n\t  for (var i = 0; i < changes.length; i++) {\n\t    var change = changes[i];\n\t    if (change.added) {\n\t      ret.push('<ins>');\n\t    } else if (change.removed) {\n\t      ret.push('<del>');\n\t    }\n\n\t    ret.push(escapeHTML(change.value));\n\n\t    if (change.added) {\n\t      ret.push('</ins>');\n\t    } else if (change.removed) {\n\t      ret.push('</del>');\n\t    }\n\t  }\n\t  return ret.join('');\n\t}\n\n\tfunction escapeHTML(s) {\n\t  var n = s;\n\t  n = n.replace(/&/g, '&amp;');\n\t  n = n.replace(/</g, '&lt;');\n\t  n = n.replace(/>/g, '&gt;');\n\t  n = n.replace(/\"/g, '&quot;');\n\n\t  return n;\n\t}\n\t//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb252ZXJ0L3htbC5qcyJdLCJuYW1lcyI6WyJjb252ZXJ0Q2hhbmdlc1RvWE1MIiwiY2hhbmdlcyIsInJldCIsImkiLCJsZW5ndGgiLCJjaGFuZ2UiLCJhZGRlZCIsInB1c2giLCJyZW1vdmVkIiwiZXNjYXBlSFRNTCIsInZhbHVlIiwiam9pbiIsInMiLCJuIiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6Ijs7O2dDQUFnQkEsbUIsR0FBQUEsbUI7QUFBVCxTQUFTQSxtQkFBVCxDQUE2QkMsT0FBN0IsRUFBc0M7QUFDM0MsTUFBSUMsTUFBTSxFQUFWO0FBQ0EsT0FBSyxJQUFJQyxJQUFJLENBQWIsRUFBZ0JBLElBQUlGLFFBQVFHLE1BQTVCLEVBQW9DRCxHQUFwQyxFQUF5QztBQUN2QyxRQUFJRSxTQUFTSixRQUFRRSxDQUFSLENBQWI7QUFDQSxRQUFJRSxPQUFPQyxLQUFYLEVBQWtCO0FBQ2hCSixVQUFJSyxJQUFKLENBQVMsT0FBVDtBQUNELEtBRkQsTUFFTyxJQUFJRixPQUFPRyxPQUFYLEVBQW9CO0FBQ3pCTixVQUFJSyxJQUFKLENBQVMsT0FBVDtBQUNEOztBQUVETCxRQUFJSyxJQUFKLENBQVNFLFdBQVdKLE9BQU9LLEtBQWxCLENBQVQ7O0FBRUEsUUFBSUwsT0FBT0MsS0FBWCxFQUFrQjtBQUNoQkosVUFBSUssSUFBSixDQUFTLFFBQVQ7QUFDRCxLQUZELE1BRU8sSUFBSUYsT0FBT0csT0FBWCxFQUFvQjtBQUN6Qk4sVUFBSUssSUFBSixDQUFTLFFBQVQ7QUFDRDtBQUNGO0FBQ0QsU0FBT0wsSUFBSVMsSUFBSixDQUFTLEVBQVQsQ0FBUDtBQUNEOztBQUVELFNBQVNGLFVBQVQsQ0FBb0JHLENBQXBCLEVBQXVCO0FBQ3JCLE1BQUlDLElBQUlELENBQVI7QUFDQUMsTUFBSUEsRUFBRUMsT0FBRixDQUFVLElBQVYsRUFBZ0IsT0FBaEIsQ0FBSjtBQUNBRCxNQUFJQSxFQUFFQyxPQUFGLENBQVUsSUFBVixFQUFnQixNQUFoQixDQUFKO0FBQ0FELE1BQUlBLEVBQUVDLE9BQUYsQ0FBVSxJQUFWLEVBQWdCLE1BQWhCLENBQUo7QUFDQUQsTUFBSUEsRUFBRUMsT0FBRixDQUFVLElBQVYsRUFBZ0IsUUFBaEIsQ0FBSjs7QUFFQSxTQUFPRCxDQUFQO0FBQ0QiLCJmaWxlIjoieG1sLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRDaGFuZ2VzVG9YTUwoY2hhbmdlcykge1xuICBsZXQgcmV0ID0gW107XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgY2hhbmdlcy5sZW5ndGg7IGkrKykge1xuICAgIGxldCBjaGFuZ2UgPSBjaGFuZ2VzW2ldO1xuICAgIGlmIChjaGFuZ2UuYWRkZWQpIHtcbiAgICAgIHJldC5wdXNoKCc8aW5zPicpO1xuICAgIH0gZWxzZSBpZiAoY2hhbmdlLnJlbW92ZWQpIHtcbiAgICAgIHJldC5wdXNoKCc8ZGVsPicpO1xuICAgIH1cblxuICAgIHJldC5wdXNoKGVzY2FwZUhUTUwoY2hhbmdlLnZhbHVlKSk7XG5cbiAgICBpZiAoY2hhbmdlLmFkZGVkKSB7XG4gICAgICByZXQucHVzaCgnPC9pbnM+Jyk7XG4gICAgfSBlbHNlIGlmIChjaGFuZ2UucmVtb3ZlZCkge1xuICAgICAgcmV0LnB1c2goJzwvZGVsPicpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmV0LmpvaW4oJycpO1xufVxuXG5mdW5jdGlvbiBlc2NhcGVIVE1MKHMpIHtcbiAgbGV0IG4gPSBzO1xuICBuID0gbi5yZXBsYWNlKC8mL2csICcmYW1wOycpO1xuICBuID0gbi5yZXBsYWNlKC88L2csICcmbHQ7Jyk7XG4gIG4gPSBuLnJlcGxhY2UoLz4vZywgJyZndDsnKTtcbiAgbiA9IG4ucmVwbGFjZSgvXCIvZywgJyZxdW90OycpO1xuXG4gIHJldHVybiBuO1xufVxuIl19\n\n\n/***/ })\n/******/ ])\n});\n;","'use strict';\nmodule.exports = {\n\tstdout: false,\n\tstderr: false\n};\n","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.typeDetect = factory());\n}(this, (function () { 'use strict';\n\n/* !\n * type-detect\n * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>\n * MIT Licensed\n */\nvar promiseExists = typeof Promise === 'function';\n\n/* eslint-disable no-undef */\nvar globalObject = typeof self === 'object' ? self : global; // eslint-disable-line id-blacklist\n\nvar symbolExists = typeof Symbol !== 'undefined';\nvar mapExists = typeof Map !== 'undefined';\nvar setExists = typeof Set !== 'undefined';\nvar weakMapExists = typeof WeakMap !== 'undefined';\nvar weakSetExists = typeof WeakSet !== 'undefined';\nvar dataViewExists = typeof DataView !== 'undefined';\nvar symbolIteratorExists = symbolExists && typeof Symbol.iterator !== 'undefined';\nvar symbolToStringTagExists = symbolExists && typeof Symbol.toStringTag !== 'undefined';\nvar setEntriesExists = setExists && typeof Set.prototype.entries === 'function';\nvar mapEntriesExists = mapExists && typeof Map.prototype.entries === 'function';\nvar setIteratorPrototype = setEntriesExists && Object.getPrototypeOf(new Set().entries());\nvar mapIteratorPrototype = mapEntriesExists && Object.getPrototypeOf(new Map().entries());\nvar arrayIteratorExists = symbolIteratorExists && typeof Array.prototype[Symbol.iterator] === 'function';\nvar arrayIteratorPrototype = arrayIteratorExists && Object.getPrototypeOf([][Symbol.iterator]());\nvar stringIteratorExists = symbolIteratorExists && typeof String.prototype[Symbol.iterator] === 'function';\nvar stringIteratorPrototype = stringIteratorExists && Object.getPrototypeOf(''[Symbol.iterator]());\nvar toStringLeftSliceLength = 8;\nvar toStringRightSliceLength = -1;\n/**\n * ### typeOf (obj)\n *\n * Uses `Object.prototype.toString` to determine the type of an object,\n * normalising behaviour across engine versions & well optimised.\n *\n * @param {Mixed} object\n * @return {String} object type\n * @api public\n */\nfunction typeDetect(obj) {\n  /* ! Speed optimisation\n   * Pre:\n   *   string literal     x 3,039,035 ops/sec 1.62% (78 runs sampled)\n   *   boolean literal    x 1,424,138 ops/sec 4.54% (75 runs sampled)\n   *   number literal     x 1,653,153 ops/sec 1.91% (82 runs sampled)\n   *   undefined          x 9,978,660 ops/sec 1.92% (75 runs sampled)\n   *   function           x 2,556,769 ops/sec 1.73% (77 runs sampled)\n   * Post:\n   *   string literal     x 38,564,796 ops/sec 1.15% (79 runs sampled)\n   *   boolean literal    x 31,148,940 ops/sec 1.10% (79 runs sampled)\n   *   number literal     x 32,679,330 ops/sec 1.90% (78 runs sampled)\n   *   undefined          x 32,363,368 ops/sec 1.07% (82 runs sampled)\n   *   function           x 31,296,870 ops/sec 0.96% (83 runs sampled)\n   */\n  var typeofObj = typeof obj;\n  if (typeofObj !== 'object') {\n    return typeofObj;\n  }\n\n  /* ! Speed optimisation\n   * Pre:\n   *   null               x 28,645,765 ops/sec 1.17% (82 runs sampled)\n   * Post:\n   *   null               x 36,428,962 ops/sec 1.37% (84 runs sampled)\n   */\n  if (obj === null) {\n    return 'null';\n  }\n\n  /* ! Spec Conformance\n   * Test: `Object.prototype.toString.call(window)``\n   *  - Node === \"[object global]\"\n   *  - Chrome === \"[object global]\"\n   *  - Firefox === \"[object Window]\"\n   *  - PhantomJS === \"[object Window]\"\n   *  - Safari === \"[object Window]\"\n   *  - IE 11 === \"[object Window]\"\n   *  - IE Edge === \"[object Window]\"\n   * Test: `Object.prototype.toString.call(this)``\n   *  - Chrome Worker === \"[object global]\"\n   *  - Firefox Worker === \"[object DedicatedWorkerGlobalScope]\"\n   *  - Safari Worker === \"[object DedicatedWorkerGlobalScope]\"\n   *  - IE 11 Worker === \"[object WorkerGlobalScope]\"\n   *  - IE Edge Worker === \"[object WorkerGlobalScope]\"\n   */\n  if (obj === globalObject) {\n    return 'global';\n  }\n\n  /* ! Speed optimisation\n   * Pre:\n   *   array literal      x 2,888,352 ops/sec 0.67% (82 runs sampled)\n   * Post:\n   *   array literal      x 22,479,650 ops/sec 0.96% (81 runs sampled)\n   */\n  if (\n    Array.isArray(obj) &&\n    (symbolToStringTagExists === false || !(Symbol.toStringTag in obj))\n  ) {\n    return 'Array';\n  }\n\n  // Not caching existence of `window` and related properties due to potential\n  // for `window` to be unset before tests in quasi-browser environments.\n  if (typeof window === 'object' && window !== null) {\n    /* ! Spec Conformance\n     * (https://html.spec.whatwg.org/multipage/browsers.html#location)\n     * WhatWG HTML$7.7.3 - The `Location` interface\n     * Test: `Object.prototype.toString.call(window.location)``\n     *  - IE <=11 === \"[object Object]\"\n     *  - IE Edge <=13 === \"[object Object]\"\n     */\n    if (typeof window.location === 'object' && obj === window.location) {\n      return 'Location';\n    }\n\n    /* ! Spec Conformance\n     * (https://html.spec.whatwg.org/#document)\n     * WhatWG HTML$3.1.1 - The `Document` object\n     * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n     *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-26809268)\n     *       which suggests that browsers should use HTMLTableCellElement for\n     *       both TD and TH elements. WhatWG separates these.\n     *       WhatWG HTML states:\n     *         > For historical reasons, Window objects must also have a\n     *         > writable, configurable, non-enumerable property named\n     *         > HTMLDocument whose value is the Document interface object.\n     * Test: `Object.prototype.toString.call(document)``\n     *  - Chrome === \"[object HTMLDocument]\"\n     *  - Firefox === \"[object HTMLDocument]\"\n     *  - Safari === \"[object HTMLDocument]\"\n     *  - IE <=10 === \"[object Document]\"\n     *  - IE 11 === \"[object HTMLDocument]\"\n     *  - IE Edge <=13 === \"[object HTMLDocument]\"\n     */\n    if (typeof window.document === 'object' && obj === window.document) {\n      return 'Document';\n    }\n\n    if (typeof window.navigator === 'object') {\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/multipage/webappapis.html#mimetypearray)\n       * WhatWG HTML$8.6.1.5 - Plugins - Interface MimeTypeArray\n       * Test: `Object.prototype.toString.call(navigator.mimeTypes)``\n       *  - IE <=10 === \"[object MSMimeTypesCollection]\"\n       */\n      if (typeof window.navigator.mimeTypes === 'object' &&\n          obj === window.navigator.mimeTypes) {\n        return 'MimeTypeArray';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/multipage/webappapis.html#pluginarray)\n       * WhatWG HTML$8.6.1.5 - Plugins - Interface PluginArray\n       * Test: `Object.prototype.toString.call(navigator.plugins)``\n       *  - IE <=10 === \"[object MSPluginsCollection]\"\n       */\n      if (typeof window.navigator.plugins === 'object' &&\n          obj === window.navigator.plugins) {\n        return 'PluginArray';\n      }\n    }\n\n    if ((typeof window.HTMLElement === 'function' ||\n        typeof window.HTMLElement === 'object') &&\n        obj instanceof window.HTMLElement) {\n      /* ! Spec Conformance\n      * (https://html.spec.whatwg.org/multipage/webappapis.html#pluginarray)\n      * WhatWG HTML$4.4.4 - The `blockquote` element - Interface `HTMLQuoteElement`\n      * Test: `Object.prototype.toString.call(document.createElement('blockquote'))``\n      *  - IE <=10 === \"[object HTMLBlockElement]\"\n      */\n      if (obj.tagName === 'BLOCKQUOTE') {\n        return 'HTMLQuoteElement';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/#htmltabledatacellelement)\n       * WhatWG HTML$4.9.9 - The `td` element - Interface `HTMLTableDataCellElement`\n       * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n       *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-82915075)\n       *       which suggests that browsers should use HTMLTableCellElement for\n       *       both TD and TH elements. WhatWG separates these.\n       * Test: Object.prototype.toString.call(document.createElement('td'))\n       *  - Chrome === \"[object HTMLTableCellElement]\"\n       *  - Firefox === \"[object HTMLTableCellElement]\"\n       *  - Safari === \"[object HTMLTableCellElement]\"\n       */\n      if (obj.tagName === 'TD') {\n        return 'HTMLTableDataCellElement';\n      }\n\n      /* ! Spec Conformance\n       * (https://html.spec.whatwg.org/#htmltableheadercellelement)\n       * WhatWG HTML$4.9.9 - The `td` element - Interface `HTMLTableHeaderCellElement`\n       * Note: Most browsers currently adher to the W3C DOM Level 2 spec\n       *       (https://www.w3.org/TR/DOM-Level-2-HTML/html.html#ID-82915075)\n       *       which suggests that browsers should use HTMLTableCellElement for\n       *       both TD and TH elements. WhatWG separates these.\n       * Test: Object.prototype.toString.call(document.createElement('th'))\n       *  - Chrome === \"[object HTMLTableCellElement]\"\n       *  - Firefox === \"[object HTMLTableCellElement]\"\n       *  - Safari === \"[object HTMLTableCellElement]\"\n       */\n      if (obj.tagName === 'TH') {\n        return 'HTMLTableHeaderCellElement';\n      }\n    }\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   Float64Array       x 625,644 ops/sec 1.58% (80 runs sampled)\n  *   Float32Array       x 1,279,852 ops/sec 2.91% (77 runs sampled)\n  *   Uint32Array        x 1,178,185 ops/sec 1.95% (83 runs sampled)\n  *   Uint16Array        x 1,008,380 ops/sec 2.25% (80 runs sampled)\n  *   Uint8Array         x 1,128,040 ops/sec 2.11% (81 runs sampled)\n  *   Int32Array         x 1,170,119 ops/sec 2.88% (80 runs sampled)\n  *   Int16Array         x 1,176,348 ops/sec 5.79% (86 runs sampled)\n  *   Int8Array          x 1,058,707 ops/sec 4.94% (77 runs sampled)\n  *   Uint8ClampedArray  x 1,110,633 ops/sec 4.20% (80 runs sampled)\n  * Post:\n  *   Float64Array       x 7,105,671 ops/sec 13.47% (64 runs sampled)\n  *   Float32Array       x 5,887,912 ops/sec 1.46% (82 runs sampled)\n  *   Uint32Array        x 6,491,661 ops/sec 1.76% (79 runs sampled)\n  *   Uint16Array        x 6,559,795 ops/sec 1.67% (82 runs sampled)\n  *   Uint8Array         x 6,463,966 ops/sec 1.43% (85 runs sampled)\n  *   Int32Array         x 5,641,841 ops/sec 3.49% (81 runs sampled)\n  *   Int16Array         x 6,583,511 ops/sec 1.98% (80 runs sampled)\n  *   Int8Array          x 6,606,078 ops/sec 1.74% (81 runs sampled)\n  *   Uint8ClampedArray  x 6,602,224 ops/sec 1.77% (83 runs sampled)\n  */\n  var stringTag = (symbolToStringTagExists && obj[Symbol.toStringTag]);\n  if (typeof stringTag === 'string') {\n    return stringTag;\n  }\n\n  var objPrototype = Object.getPrototypeOf(obj);\n  /* ! Speed optimisation\n  * Pre:\n  *   regex literal      x 1,772,385 ops/sec 1.85% (77 runs sampled)\n  *   regex constructor  x 2,143,634 ops/sec 2.46% (78 runs sampled)\n  * Post:\n  *   regex literal      x 3,928,009 ops/sec 0.65% (78 runs sampled)\n  *   regex constructor  x 3,931,108 ops/sec 0.58% (84 runs sampled)\n  */\n  if (objPrototype === RegExp.prototype) {\n    return 'RegExp';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   date               x 2,130,074 ops/sec 4.42% (68 runs sampled)\n  * Post:\n  *   date               x 3,953,779 ops/sec 1.35% (77 runs sampled)\n  */\n  if (objPrototype === Date.prototype) {\n    return 'Date';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-promise.prototype-@@tostringtag)\n   * ES6$25.4.5.4 - Promise.prototype[@@toStringTag] should be \"Promise\":\n   * Test: `Object.prototype.toString.call(Promise.resolve())``\n   *  - Chrome <=47 === \"[object Object]\"\n   *  - Edge <=20 === \"[object Object]\"\n   *  - Firefox 29-Latest === \"[object Promise]\"\n   *  - Safari 7.1-Latest === \"[object Promise]\"\n   */\n  if (promiseExists && objPrototype === Promise.prototype) {\n    return 'Promise';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   set                x 2,222,186 ops/sec 1.31% (82 runs sampled)\n  * Post:\n  *   set                x 4,545,879 ops/sec 1.13% (83 runs sampled)\n  */\n  if (setExists && objPrototype === Set.prototype) {\n    return 'Set';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   map                x 2,396,842 ops/sec 1.59% (81 runs sampled)\n  * Post:\n  *   map                x 4,183,945 ops/sec 6.59% (82 runs sampled)\n  */\n  if (mapExists && objPrototype === Map.prototype) {\n    return 'Map';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   weakset            x 1,323,220 ops/sec 2.17% (76 runs sampled)\n  * Post:\n  *   weakset            x 4,237,510 ops/sec 2.01% (77 runs sampled)\n  */\n  if (weakSetExists && objPrototype === WeakSet.prototype) {\n    return 'WeakSet';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   weakmap            x 1,500,260 ops/sec 2.02% (78 runs sampled)\n  * Post:\n  *   weakmap            x 3,881,384 ops/sec 1.45% (82 runs sampled)\n  */\n  if (weakMapExists && objPrototype === WeakMap.prototype) {\n    return 'WeakMap';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-dataview.prototype-@@tostringtag)\n   * ES6$24.2.4.21 - DataView.prototype[@@toStringTag] should be \"DataView\":\n   * Test: `Object.prototype.toString.call(new DataView(new ArrayBuffer(1)))``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (dataViewExists && objPrototype === DataView.prototype) {\n    return 'DataView';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%mapiteratorprototype%-@@tostringtag)\n   * ES6$23.1.5.2.2 - %MapIteratorPrototype%[@@toStringTag] should be \"Map Iterator\":\n   * Test: `Object.prototype.toString.call(new Map().entries())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (mapExists && objPrototype === mapIteratorPrototype) {\n    return 'Map Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%setiteratorprototype%-@@tostringtag)\n   * ES6$23.2.5.2.2 - %SetIteratorPrototype%[@@toStringTag] should be \"Set Iterator\":\n   * Test: `Object.prototype.toString.call(new Set().entries())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (setExists && objPrototype === setIteratorPrototype) {\n    return 'Set Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%arrayiteratorprototype%-@@tostringtag)\n   * ES6$22.1.5.2.2 - %ArrayIteratorPrototype%[@@toStringTag] should be \"Array Iterator\":\n   * Test: `Object.prototype.toString.call([][Symbol.iterator]())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (arrayIteratorExists && objPrototype === arrayIteratorPrototype) {\n    return 'Array Iterator';\n  }\n\n  /* ! Spec Conformance\n   * (http://www.ecma-international.org/ecma-262/6.0/index.html#sec-%stringiteratorprototype%-@@tostringtag)\n   * ES6$21.1.5.2.2 - %StringIteratorPrototype%[@@toStringTag] should be \"String Iterator\":\n   * Test: `Object.prototype.toString.call(''[Symbol.iterator]())``\n   *  - Edge <=13 === \"[object Object]\"\n   */\n  if (stringIteratorExists && objPrototype === stringIteratorPrototype) {\n    return 'String Iterator';\n  }\n\n  /* ! Speed optimisation\n  * Pre:\n  *   object from null   x 2,424,320 ops/sec 1.67% (76 runs sampled)\n  * Post:\n  *   object from null   x 5,838,000 ops/sec 0.99% (84 runs sampled)\n  */\n  if (objPrototype === null) {\n    return 'Object';\n  }\n\n  return Object\n    .prototype\n    .toString\n    .call(obj)\n    .slice(toStringLeftSliceLength, toStringRightSliceLength);\n}\n\nreturn typeDetect;\n\n})));\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var\n\tprototype,\n\tactionParams = require( '../mobile.startup/actionParams' ),\n\tutil = require( '../mobile.startup/util' ),\n\tSearchGateway = require( '../mobile.startup/search/SearchGateway' );\n\n/**\n * Api for CategoryOverlay\n *\n * @class CategoryGateway\n * @extends SearchGateway\n */\nfunction CategoryGateway() {\n\tCategoryGateway.parent.apply( this, arguments );\n}\nprototype = {\n\t/**\n\t * @memberof CategoryGateway\n\t * @instance\n\t */\n\tcontinueParams: {},\n\t/**\n\t * @memberof CategoryGateway\n\t * @instance\n\t */\n\tcanContinue: true,\n\t/**\n\t * @inheritdoc\n\t * @memberof CategoryGateway\n\t * @instance\n\t */\n\tsearchNamespace: 14,\n\t/**\n\t * Saves the categories passed to this function to the page\n\t *\n\t * @memberof CategoryGateway\n\t * @instance\n\t * @param {string} title Title of the current page (to add the categories to)\n\t * @param {string} categories List of Categories to add\n\t * @return {jQuery.Deferred}\n\t */\n\tsave: function ( title, categories ) {\n\t\treturn this.api.postWithToken( 'csrf', {\n\t\t\taction: 'edit',\n\t\t\ttitle: title,\n\t\t\tappendtext: categories,\n\t\t\tsummary: mw.msg( 'mobile-frontend-categories-summary' )\n\t\t} );\n\t},\n\t/**\n\t * Returns the categories the title belongs to.\n\t *\n\t * @memberof CategoryGateway\n\t * @instance\n\t * @param {string} title Title of the current page (to add the categories to)\n\t * @return {jQuery.Deferred|boolean} False, if no further continuation is possible,\n\t *                                   jQuery.Deferred otherwise.\n\t */\n\tgetCategories: function ( title ) {\n\t\tvar self = this, params;\n\n\t\tif ( this.canContinue === false ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tparams = util.extend( {}, {\n\t\t\tprop: 'categories',\n\t\t\ttitles: title,\n\t\t\tclprop: 'hidden',\n\t\t\tcllimit: 50\n\t\t}, this.continueParams );\n\t\treturn this.api.get( actionParams( params ) ).then( function ( data ) {\n\t\t\tif ( data.continue !== undefined ) {\n\t\t\t\tself.continueParams = data.continue;\n\t\t\t} else {\n\t\t\t\tself.canContinue = false;\n\t\t\t}\n\n\t\t\treturn data;\n\t\t} );\n\t}\n};\n\nOO.inheritClass( CategoryGateway, SearchGateway );\nutil.extend( CategoryGateway.prototype, prototype );\n\nmodule.exports = CategoryGateway;\n","'use strict';\nconst Button = require( '../mobile.startup/Button' ),\n\tView = require( '../mobile.startup/View' ),\n\tIcon = require( '../mobile.startup/Icon' ),\n\tutil = require( '../mobile.startup/util' );\n\n/**\n * @extends View\n */\nclass BlockMessageDetails extends View {\n\t/** @inheritdoc */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\t/**\n\t * @inheritdoc\n\t */\n\tget defaults() {\n\t\treturn {\n\t\t\tcreateDetailsAnchorHref: function () {\n\t\t\t\treturn function ( blockId, render ) {\n\t\t\t\t\treturn mw.util.getUrl( 'Special:BlockList', { wpTarget: '#' + render( blockId ) } );\n\t\t\t\t};\n\t\t\t},\n\t\t\tcreateDetailsAnchorLabel: function () {\n\t\t\t\treturn mw.msg( 'mobile-frontend-editor-blocked-drawer-help' );\n\t\t\t},\n\t\t\tcreateTitle: function () {\n\t\t\t\tlet msgKey = 'mobile-frontend-editor-blocked-drawer-title';\n\t\t\t\tif ( mw.user.isAnon() ) {\n\t\t\t\t\tmsgKey += '-ip';\n\t\t\t\t}\n\t\t\t\tif ( this.partial ) {\n\t\t\t\t\tmsgKey += '-partial';\n\t\t\t\t}\n\t\t\t\t// The following messages can be passed here:\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-title\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-title-partial\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-title-ip\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-title-ip-partial\n\t\t\t\treturn mw.msg( msgKey );\n\t\t\t},\n\t\t\tcreateBody: function () {\n\t\t\t\tlet msgKey = '';\n\t\t\t\tif ( mw.user.isAnon() && this.anonOnly ) {\n\t\t\t\t\tmsgKey = 'mobile-frontend-editor-blocked-drawer-body';\n\t\t\t\t\tif ( this.noCreateAccount ) {\n\t\t\t\t\t\tmsgKey += '-login';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmsgKey += '-login-createaccount';\n\t\t\t\t\t}\n\t\t\t\t\tif ( this.partial ) {\n\t\t\t\t\t\tmsgKey += '-partial';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif ( this.partial ) {\n\t\t\t\t\t\tmsgKey = 'mobile-frontend-editor-blocked-drawer-body-partial';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// The following messages can be passed here:\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-body-partial\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-body-login\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-body-login-partial\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-body-login-createaccount\n\t\t\t\t// * mobile-frontend-editor-blocked-drawer-body-login-createaccount-partial\n\t\t\t\treturn msgKey ? mw.msg( msgKey ) : msgKey;\n\t\t\t},\n\t\t\tseeMoreLink: mw.msg( 'mobile-frontend-editor-blocked-drawer-body-link' ),\n\t\t\treasonHeader: mw.msg( 'mobile-frontend-editor-blocked-drawer-reason-header' ),\n\t\t\tcreatorHeader: function () {\n\t\t\t\t// The gender is the subject (the blockee) not the object (the blocker).\n\t\t\t\treturn mw.msg( 'mobile-frontend-editor-blocked-drawer-creator-header',\n\t\t\t\t\tmw.user.options.get( 'gender' ) );\n\t\t\t},\n\t\t\texpiryHeader: mw.msg( 'mobile-frontend-editor-blocked-drawer-expiry-header' )\n\t\t};\n\t}\n\t/**\n\t * Configure the call to action depending on the type of block.\n\t *\n\t * @return {Object} Configuration options\n\t */\n\tgetButtonConfig() {\n\t\tlet cta = true;\n\t\tconst config = {\n\t\t\t\tprogressive: true\n\t\t\t},\n\t\t\twiki = mw.config.get( 'wgDBname' );\n\n\t\tif ( mw.user.isAnon() && this.options.anonOnly ) {\n\t\t\t// The user can avoid the block by logging in\n\t\t\tconfig.label = mw.msg( 'mobile-frontend-editor-blocked-drawer-action-login' );\n\t\t\tconfig.href = new mw.Title( 'Special:UserLogin' ).getUrl();\n\t\t} else if ( this.options.partial ) {\n\t\t\t// The user can avoid the block by editing a different page\n\t\t\tconfig.label = mw.msg( 'mobile-frontend-editor-blocked-drawer-action-randompage' );\n\t\t\tconfig.href = new mw.Title( 'Special:Random' ).getUrl();\n\t\t\tconfig.quiet = true;\n\t\t} else {\n\t\t\t// The user cannot avoid the block\n\t\t\tconfig.tagName = 'button';\n\t\t\tconfig.label = mw.msg( 'mobile-frontend-editor-blocked-drawer-action-ok' );\n\t\t\tconfig.additionalClassNames = 'cancel';\n\t\t\tcta = false;\n\t\t}\n\n\t\tif ( cta && mw.config.get( 'wgMFTrackBlockNotices' ) ) {\n\t\t\tmw.track( 'counter.MediaWiki.BlockNotices.' + wiki + '.MobileFrontend.ctaShown', 1 );\n\t\t\tconfig.events = {\n\t\t\t\tclick: function () {\n\t\t\t\t\tmw.track( 'counter.MediaWiki.BlockNotices.' + wiki + '.MobileFrontend.ctaClicked', 1 );\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\treturn config;\n\t}\n\t/**\n\t * @inheritdoc\n\t */\n\tpostRender() {\n\t\tconst drawer = this;\n\t\tthis.$el.find( '.block-message-buttons' ).prepend(\n\t\t\tnew Button( this.getButtonConfig() ).$el\n\t\t);\n\t\tthis.$el.find( '.block-message-icon' ).prepend(\n\t\t\t( new Icon( {\n\t\t\t\tname: 'block-destructive',\n\t\t\t\tadditionalClassNames: 'mw-ui-icon-flush-top'\n\t\t\t} ) ).$el\n\t\t);\n\t\tthis.options.parsedReason.then( function ( htmlReason ) {\n\t\t\tdrawer.$el.find( '.block-message-reason div' ).html( htmlReason );\n\t\t} );\n\t}\n\t/**\n\t * @inheritdoc\n\t */\n\tget template() {\n\t\treturn util.template( `\n<div class=\"block-message block-message-container\">\n  <div class=\"block-message-icon\"></div>\n  <div class=\"block-message-info\">\n    <div class=\"block-message-item block-message-title\">\n      <h5>{{ createTitle }}</h5>\n    </div>\n    <div class=\"block-message-data\">\n      <div class=\"block-message-item\">\n        <p>\n          {{ createBody }}\n          <a class =\"block-message-see-more\" href=\"#\">{{ seeMoreLink }}</a>\n        </p>\n      </div>\n      <div class=\"block-message-item block-message-creator\">\n        {{#creator.name}}\n          <p>\n            {{ creatorHeader }}\n            <strong>\n              {{#creator.url}}\n                <a href=\"{{ creator.url }}\">{{ creator.name }}</a>\n              {{/creator.url}}\n              {{^creator.url}}\n                {{ creator.name }}\n              {{/creator.url}}\n            </strong>\n          </p>\n        {{/creator.name}}\n      </div>\n      {{#duration}}\n        <div class=\"block-message-item\">\n          <p>\n            {{ expiryHeader }}\n            <strong>{{ duration }}</strong>\n          </p>\n        </div>\n      {{/duration}}\n      {{#blockId}}\n        <div class=\"block-message-item\">\n          <a href=\"{{#createDetailsAnchorHref}}{{ blockId }}{{/createDetailsAnchorHref}}\">\n            {{ createDetailsAnchorLabel }}\n          </a>\n        </div>\n      {{/blockId}}\n    </div>\n  </div>\n  {{#reason}}\n    <div class=\"block-message-item block-message-reason\">\n      <h5>{{ reasonHeader }}</h5>\n      <div><p>{{{ reason }}}</p></div>\n    </div>\n  {{/reason}}\n  <div class=\"block-message-buttons\">\n  </div>\n</div>` );\n\t}\n}\n\nmodule.exports = BlockMessageDetails;\n","var util = require( '../mobile.startup/util' ),\n\tactionParams = require( '../mobile.startup/actionParams' );\n\n/**\n * API that helps save and retrieve page content\n *\n * @class EditorGateway\n *\n * @param {Object} options Configuration options\n * @param {mw.Api} options.api an Api to use.\n * @param {string} options.title the title to edit\n * @param {string|null} options.sectionId the id of the section to operate edits on.\n * @param {number} [options.oldId] revision to operate on. If absent defaults to latest.\n * @param {boolean} [options.isNewPage] whether the page being created is new\n * @param {boolean} [options.fromModified] whether the page was loaded in a modified state\n */\nfunction EditorGateway( options ) {\n\tthis.api = options.api;\n\tthis.title = options.title;\n\tthis.sectionId = options.sectionId;\n\tthis.oldId = options.oldId;\n\t// return an empty section for new pages\n\tthis.content = options.isNewPage ? '' : undefined;\n\tthis.fromModified = options.fromModified;\n\tthis.hasChanged = options.fromModified;\n}\n\nEditorGateway.prototype = {\n\n\t/**\n\t * Get the block (if there is one) from the result.\n\t *\n\t * @memberof EditorGateway\n\t * @param {Object} pageObj Page object\n\t * @return {Object|null}\n\t */\n\tgetBlockInfo: function ( pageObj ) {\n\t\tvar blockedError;\n\n\t\tif ( pageObj.actions &&\n\t\t\tpageObj.actions.edit &&\n\t\t\tArray.isArray( pageObj.actions.edit )\n\t\t) {\n\t\t\tpageObj.actions.edit.some( function ( error ) {\n\t\t\t\tif ( [ 'blocked', 'autoblocked' ].indexOf( error.code ) !== -1 ) {\n\t\t\t\t\tblockedError = error;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t} );\n\n\t\t\tif ( blockedError && blockedError.data && blockedError.data.blockinfo ) {\n\t\t\t\treturn blockedError.data.blockinfo;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\t/**\n\t * Get the content of a page.\n\t *\n\t * @memberof EditorGateway\n\t * @instance\n\t * @return {jQuery.Promise}\n\t */\n\tgetContent: function () {\n\t\tvar options,\n\t\t\tself = this;\n\n\t\tfunction resolve() {\n\t\t\treturn util.Deferred().resolve( {\n\t\t\t\ttext: self.content || '',\n\t\t\t\tblockinfo: self.blockinfo\n\t\t\t} );\n\t\t}\n\n\t\tif ( this.content !== undefined ) {\n\t\t\treturn resolve();\n\t\t} else {\n\t\t\toptions = actionParams( {\n\t\t\t\tprop: [ 'revisions', 'info' ],\n\t\t\t\trvprop: [ 'content', 'timestamp' ],\n\t\t\t\ttitles: self.title,\n\t\t\t\t// get block information for this user\n\t\t\t\tintestactions: 'edit',\n\t\t\t\tintestactionsdetail: 'full'\n\t\t\t} );\n\t\t\t// Load text of old revision if desired\n\t\t\tif ( this.oldId ) {\n\t\t\t\toptions.rvstartid = this.oldId;\n\t\t\t}\n\t\t\t// See Bug 50136 - passing rvsection will fail with non wikitext\n\t\t\tif ( this.sectionId ) {\n\t\t\t\toptions.rvsection = this.sectionId;\n\t\t\t}\n\t\t\treturn this.api.get( options ).then( function ( resp ) {\n\t\t\t\tvar revision, pageObj;\n\n\t\t\t\tif ( resp.error ) {\n\t\t\t\t\treturn util.Deferred().reject( resp.error.code );\n\t\t\t\t}\n\n\t\t\t\tpageObj = resp.query.pages[0];\n\t\t\t\t// page might not exist and caller might not have known.\n\t\t\t\tif ( pageObj.missing !== undefined ) {\n\t\t\t\t\tself.content = '';\n\t\t\t\t} else {\n\t\t\t\t\trevision = pageObj.revisions[0];\n\t\t\t\t\tself.content = revision.content;\n\t\t\t\t\tself.timestamp = revision.timestamp;\n\t\t\t\t}\n\n\t\t\t\t// save content a second time to be able to check for changes\n\t\t\t\tself.originalContent = self.content;\n\t\t\t\tself.blockinfo = self.getBlockInfo( pageObj );\n\n\t\t\t\treturn resolve();\n\t\t\t} );\n\t\t}\n\t},\n\n\t/**\n\t * Mark content as modified and set changes to be submitted when #save\n\t * is invoked.\n\t *\n\t * @memberof EditorGateway\n\t * @instance\n\t * @param {string} content New section content.\n\t */\n\tsetContent: function ( content ) {\n\t\tif ( this.originalContent !== content || this.fromModified ) {\n\t\t\tthis.hasChanged = true;\n\t\t} else {\n\t\t\tthis.hasChanged = false;\n\t\t}\n\t\tthis.content = content;\n\t},\n\n\t/**\n\t * Mark content as modified and set text that should be prepended to given\n\t * section when #save is invoked.\n\t *\n\t * @memberof EditorGateway\n\t * @instance\n\t * @param {string} text Text to be prepended.\n\t */\n\tsetPrependText: function ( text ) {\n\t\tthis.prependtext = text;\n\t\tthis.hasChanged = true;\n\t},\n\n\t/**\n\t * Save the new content of the section, previously set using #setContent.\n\t *\n\t * @memberof EditorGateway\n\t * @instance\n\t * @param {Object} options Configuration options\n\t * @param {string} [options.summary] Optional summary for the edit.\n\t * @param {string} [options.captchaId] If CAPTCHA was requested, ID of the\n\t * captcha.\n\t * @param {string} [options.captchaWord] If CAPTCHA was requested, term\n\t * displayed in the CAPTCHA.\n\t * @return {jQuery.Deferred} On failure callback is passed an object with\n\t * `type` and `details` properties. `type` is a string describing the type\n\t * of error, `details` can be any object (usually error message).\n\t */\n\tsave: function ( options ) {\n\t\tvar self = this,\n\t\t\tresult = util.Deferred();\n\n\t\toptions = options || {};\n\n\t\t/**\n\t\t * Save content. Make an API request.\n\t\t *\n\t\t * @return {jQuery.Deferred}\n\t\t */\n\t\tfunction saveContent() {\n\t\t\tvar apiOptions = {\n\t\t\t\taction: 'edit',\n\t\t\t\terrorformat: 'html',\n\t\t\t\terrorlang: mw.config.get( 'wgUserLanguage' ),\n\t\t\t\terrorsuselocal: 1,\n\t\t\t\tformatversion: 2,\n\t\t\t\ttitle: self.title,\n\t\t\t\tsummary: options.summary,\n\t\t\t\tcaptchaid: options.captchaId,\n\t\t\t\tcaptchaword: options.captchaWord,\n\t\t\t\tbasetimestamp: self.timestamp,\n\t\t\t\tstarttimestamp: self.timestamp\n\t\t\t};\n\n\t\t\tif ( self.content !== undefined ) {\n\t\t\t\tapiOptions.text = self.content;\n\t\t\t} else if ( self.prependtext ) {\n\t\t\t\tapiOptions.prependtext = self.prependtext;\n\t\t\t}\n\n\t\t\tif ( self.sectionId ) {\n\t\t\t\tapiOptions.section = self.sectionId;\n\t\t\t}\n\n\t\t\tself.api.postWithToken( 'csrf', apiOptions ).then( function ( data ) {\n\t\t\t\tif ( data && data.edit && data.edit.result === 'Success' ) {\n\t\t\t\t\tself.hasChanged = false;\n\t\t\t\t\tresult.resolve( data.edit.newrevid );\n\t\t\t\t} else {\n\t\t\t\t\tresult.reject( data );\n\t\t\t\t}\n\t\t\t}, function ( code, data ) {\n\t\t\t\tresult.reject( data );\n\t\t\t} );\n\t\t\treturn result;\n\t\t}\n\n\t\treturn saveContent();\n\t},\n\n\t/**\n\t * Abort any pending previews.\n\t *\n\t * @memberof EditorGateway\n\t * @instance\n\t */\n\tabortPreview: function () {\n\t\tif ( this._pending ) {\n\t\t\tthis._pending.abort();\n\t\t}\n\t},\n\n\t/**\n\t * Get page preview from the API and abort any existing previews.\n\t *\n\t * @memberof EditorGateway\n\t * @instance\n\t * @param {Object} options API query parameters\n\t * @return {jQuery.Deferred}\n\t */\n\tgetPreview: function ( options ) {\n\t\tvar\n\t\t\tsectionLine = '',\n\t\t\tsectionId = '',\n\t\t\tself = this;\n\n\t\tutil.extend( options, {\n\t\t\taction: 'parse',\n\t\t\t// Enable section preview mode to avoid errors (bug 49218)\n\t\t\tsectionpreview: true,\n\t\t\t// Hide section edit links\n\t\t\tdisableeditsection: true,\n\t\t\t// needed for pre-save transform to work (bug 53692)\n\t\t\tpst: true,\n\t\t\t// Output mobile HTML (bug 54243)\n\t\t\tmobileformat: true,\n\t\t\ttitle: this.title,\n\t\t\tprop: [ 'text', 'sections' ]\n\t\t} );\n\n\t\tthis.abortPreview();\n\t\tthis._pending = this.api.post( options );\n\n\t\treturn this._pending.then( function ( resp ) {\n\t\t\tif ( resp && resp.parse && resp.parse.text ) {\n\t\t\t\t// When editing section 0 or the whole page, there is no section name, so skip\n\t\t\t\tif ( self.sectionId && self.sectionId !== '0' &&\n\t\t\t\t\tresp.parse.sections !== undefined &&\n\t\t\t\t\tresp.parse.sections[0] !== undefined\n\t\t\t\t) {\n\t\t\t\t\tif ( resp.parse.sections[0].anchor !== undefined ) {\n\t\t\t\t\t\tsectionId = resp.parse.sections[0].anchor;\n\t\t\t\t\t}\n\t\t\t\t\tif ( resp.parse.sections[0].line !== undefined ) {\n\t\t\t\t\t\tsectionLine = resp.parse.sections[0].line;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\ttext: resp.parse.text['*'],\n\t\t\t\t\tid: sectionId,\n\t\t\t\t\tline: sectionLine\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn util.Deferred().reject();\n\t\t\t}\n\t\t} ).promise( {\n\t\t\tabort: function () { self._pending.abort(); }\n\t\t} );\n\t}\n};\n\nmodule.exports = EditorGateway;\n","/* global $ */\nvar Overlay = require( '../mobile.startup/Overlay' ),\n\tutil = require( '../mobile.startup/util' ),\n\tparseBlockInfo = require( './parseBlockInfo' ),\n\theaders = require( '../mobile.startup/headers' ),\n\tPageGateway = require( '../mobile.startup/PageGateway' ),\n\ticons = require( '../mobile.startup/icons' ),\n\tButton = require( '../mobile.startup/Button' ),\n\tIcon = require( '../mobile.startup/Icon' ),\n\ttoast = require( '../mobile.startup/showOnPageReload' ),\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tblockMessageDrawer = require( './blockMessageDrawer' ),\n\tMessageBox = require( '../mobile.startup/MessageBox' ),\n\tmwUser = mw.user;\n\n/**\n * 'Edit' button\n *\n * @param {OO.ui.ToolGroup} toolGroup\n * @param {Object} config\n */\nfunction EditVeTool( toolGroup, config ) {\n\tconfig = config || {};\n\tconfig.classes = [ 'visual-editor' ];\n\tEditVeTool.super.call( this, toolGroup, config );\n}\nOO.inheritClass( EditVeTool, OO.ui.Tool );\n\nEditVeTool.static.name = 'editVe';\nEditVeTool.static.icon = 'edit';\nEditVeTool.static.group = 'editorSwitcher';\nEditVeTool.static.title = mw.msg( 'mobile-frontend-editor-switch-visual-editor' );\n/**\n * click handler\n *\n * @memberof EditVeTool\n * @instance\n */\nEditVeTool.prototype.onSelect = function () {\n\t// will be overridden later\n};\n/**\n * Toolbar update state handler.\n *\n * @memberof EditVeTool\n * @instance\n */\nEditVeTool.prototype.onUpdateState = function () {\n\t// do nothing\n};\n\n/**\n * Base class for SourceEditorOverlay and VisualEditorOverlay\n *\n * @class EditorOverlayBase\n * @extends Overlay\n * @uses Icon\n * @uses user\n * @param {Object} params Configuration options\n * @param {number|null} params.editCount of user\n * @param {boolean} params.editSwitcher whether possible to switch mode in header\n * @param {boolean} params.hasToolbar whether the editor has a toolbar\n */\nfunction EditorOverlayBase( params ) {\n\tvar\n\t\toptions = util.extend(\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tonBeforeExit: this.onBeforeExit.bind( this ),\n\t\t\t\tclassName: 'overlay editor-overlay',\n\t\t\t\tisBorderBox: false\n\t\t\t},\n\t\t\tparams,\n\t\t\t{\n\t\t\t\tevents: util.extend(\n\t\t\t\t\t{\n\t\t\t\t\t\t'click .back': 'onClickBack',\n\t\t\t\t\t\t'click .continue': 'onClickContinue',\n\t\t\t\t\t\t'click .submit': 'onClickSubmit',\n\t\t\t\t\t\t'click .anonymous': 'onClickAnonymous'\n\t\t\t\t\t},\n\t\t\t\t\tparams.events\n\t\t\t\t)\n\t\t\t}\n\t\t);\n\n\tif ( options.isNewPage ) {\n\t\toptions.placeholder = mw.msg( 'mobile-frontend-editor-placeholder-new-page', mwUser );\n\t}\n\t// change the message to request a summary when not in article namespace\n\tif ( mw.config.get( 'wgNamespaceNumber' ) !== 0 ) {\n\t\toptions.summaryRequestMsg = mw.msg( 'mobile-frontend-editor-summary' );\n\t}\n\tthis.pageGateway = new PageGateway( options.api );\n\tthis.editCount = options.editCount;\n\tthis.isNewPage = options.isNewPage;\n\tthis.isNewEditor = options.editCount === 0;\n\tthis.sectionId = options.sectionId;\n\tthis.sessionId = options.sessionId;\n\tthis.overlayManager = options.overlayManager;\n\n\tOverlay.call( this, options );\n}\n\nmfExtend( EditorOverlayBase, Overlay, {\n\t/**\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @mixes Overlay#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {OverlayManager} defaults.overlayManager instance\n\t * @property {mw.Api} defaults.api to interact with\n\t * @property {boolean} defaults.hasToolbar Whether the editor has a toolbar or not. When\n\t *  disabled a header will be show instead.\n\t * @property {string} defaults.continueMsg Caption for the next button on edit form\n\t * which takes you to the screen that shows a preview and license information.\n\t * @property {string} defaults.closeMsg Caption for a button that takes you back to editing\n\t * from edit preview screen.\n\t * @property {string} defaults.summaryRequestMsg Header above edit summary input field\n\t * asking the user to summarize the changes they made to the page.\n\t * @property {string} defaults.summaryMsg A placeholder with examples for the summary input\n\t * field asking user what they changed.\n\t * @property {string} defaults.placeholder Placeholder text for empty sections.\n\t * @property {string} defaults.captchaMsg Placeholder for captcha input field.\n\t * @property {string} defaults.captchaTryAgainMsg A message shown when user enters\n\t * wrong CAPTCHA and a new one is displayed.\n\t * @property {string} defaults.switchMsg Label for button that allows the user\n\t * to switch between two different editing interfaces.\n\t * @property {string} defaults.licenseMsg Text and link of the license,\n\t * under which this contribution will be released to inform the user.\n\t */\n\tdefaults: util.extend( {}, Overlay.prototype.defaults, {\n\t\thasToolbar: false,\n\t\tcontinueMsg: mw.msg( 'mobile-frontend-editor-continue' ),\n\t\tcloseMsg: mw.msg( 'mobile-frontend-editor-keep-editing' ),\n\t\tsummaryRequestMsg: mw.msg( 'mobile-frontend-editor-summary-request' ),\n\t\tsummaryMsg: mw.msg( 'mobile-frontend-editor-summary-placeholder' ),\n\t\tplaceholder: mw.msg( 'mobile-frontend-editor-placeholder' ),\n\t\tcaptchaMsg: mw.msg( 'mobile-frontend-account-create-captcha-placeholder' ),\n\t\tcaptchaTryAgainMsg: mw.msg( 'mobile-frontend-editor-captcha-try-again' ),\n\t\tswitchMsg: mw.msg( 'mobile-frontend-editor-switch-editor' ),\n\t\tconfirmMsg: mw.msg( 'mobile-frontend-editor-cancel-confirm' ),\n\t\tlicenseMsg: undefined\n\t} ),\n\t/**\n\t * @inheritdoc\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\ttemplate: util.template( `\n<div class=\"overlay-header-container header-container position-fixed\"></div>\n\n<div class=\"overlay-content\">\n\t<div class=\"panels\">\n\t\t<div class=\"save-panel panel hideable hidden\">\n\t\t\t<div id=\"error-notice-container\"></div>\n\t\t\t<h2 class=\"summary-request\">{{{summaryRequestMsg}}}</h2>\n\t\t\t<textarea rows=\"2\" class=\"mw-ui-input summary\" placeholder=\"{{summaryMsg}}\"></textarea>\n\t\t\t{{#licenseMsg}}<div class=\"license\">{{{licenseMsg}}}</div>{{/licenseMsg}}\n\t\t</div>\n\t\t<div class=\"captcha-panel panel hideable hidden\">\n\t\t\t<div class=\"captcha-box\">\n\t\t\t\t<img id=\"image\" src=\"\">\n\t\t\t\t<div id=\"question\"></div>\n\t\t\t\t<input class=\"captcha-word mw-ui-input\" placeholder=\"{{captchaMsg}}\" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t{{>content}}\n</div>\n<div class=\"overlay-footer-container position-fixed\">\n\t{{>footer}}\n</div>\n\t` ),\n\t/**\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tsectionId: '',\n\t/**\n\t * Logs an event to http://meta.wikimedia.org/wiki/Schema:EditAttemptStep\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {Object} data\n\t */\n\tlog: function ( data ) {\n\t\tmw.track( 'mf.schemaEditAttemptStep', util.extend( data, {\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\teditor_interface: this.editor,\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tediting_session_id: this.sessionId\n\t\t} ) );\n\t},\n\t/**\n\t * Logs an event to http://meta.wikimedia.org/wiki/Schema:VisualEditorFeatureUse\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {Object} data\n\t */\n\tlogFeatureUse: function ( data ) {\n\t\tmw.track( 'mf.schemaVisualEditorFeatureUse', util.extend( data, {\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\teditor_interface: this.editor,\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\tediting_session_id: this.sessionId\n\t\t} ) );\n\t},\n\n\t/**\n\t * If this is a new article, require confirmation before saving.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @return {boolean} The user confirmed saving\n\t */\n\tconfirmSave: function () {\n\t\tif ( this.isNewPage &&\n\t\t\t// TODO: Replace with an OOUI dialog\n\t\t\t// eslint-disable-next-line no-alert\n\t\t\t!window.confirm( mw.msg( 'mobile-frontend-editor-new-page-confirm', mwUser ) )\n\t\t) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t},\n\t/**\n\t * Executed when page save is complete. Handles reloading the page, showing toast\n\t * messages.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {number} newRevId ID of the newly created revision\n\t */\n\tonSaveComplete: function ( newRevId ) {\n\t\tvar msg,\n\t\t\t$window = util.getWindow(),\n\t\t\ttitle = this.options.title,\n\t\t\tself = this;\n\n\t\tthis.saved = true;\n\n\t\t// FIXME: use generic method for following 3 lines\n\t\tthis.pageGateway.invalidatePage( title );\n\n\t\tif ( this.isNewPage ) {\n\t\t\tmsg = mw.msg( 'mobile-frontend-editor-success-new-page' );\n\t\t} else if ( this.isNewEditor ) {\n\t\t\tmsg = mw.msg( 'mobile-frontend-editor-success-landmark-1' );\n\t\t} else {\n\t\t\tmsg = mw.msg( 'mobile-frontend-editor-success' );\n\t\t}\n\t\t/**\n\t\t * Fired after an edit was successfully saved, like postEdit in MediaWiki core.\n\t\t *\n\t\t * @event postEditMobile\n\t\t * @member mw.hook\n\t\t */\n\t\tmw.hook( 'postEditMobile' ).fire();\n\n\t\tif ( !mw.config.get( 'wgPostEditConfirmationDisabled' ) ) {\n\t\t\ttoast.showOnPageReload( msg, { type: 'success' } );\n\t\t}\n\n\t\t// Ensure we don't lose this event when logging\n\t\tthis.log( {\n\t\t\taction: 'saveSuccess',\n\t\t\t// eslint-disable-next-line camelcase\n\t\t\trevision_id: newRevId\n\t\t} );\n\t\tif ( self.sectionId ) {\n\t\t\t// Ideally we'd want to do this via replaceState (see T189173)\n\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\twindow.location.hash = '#' + self.sectionId;\n\t\t} else {\n\t\t\t// Cancel the hash fragment\n\t\t\t// otherwise clicking back after a save will take you back to the editor.\n\t\t\t// We avoid calling the hide method of the overlay here as this can be asynchronous\n\t\t\t// and may conflict with the window.reload call below.\n\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\twindow.location.hash = '#';\n\t\t}\n\n\t\t$window.off( 'beforeunload.mfeditorwarning' );\n\n\t\t// Note the \"#\" may be in the URL.\n\t\t// If so, using window.location alone will not reload the page\n\t\t// we need to forcefully refresh\n\t\t// eslint-disable-next-line no-restricted-properties\n\t\twindow.location.reload();\n\t},\n\t/**\n\t * Executed when page save fails. Handles logging the error. Subclasses\n\t * should display error messages as appropriate.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {Object} data API response\n\t */\n\tonSaveFailure: function ( data ) {\n\t\tvar code = data && data.errors && data.errors[0] && data.errors[0].code,\n\t\t\t// Compare to ve.init.mw.ArticleTargetEvents.js in VisualEditor.\n\t\t\ttypeMap = {\n\t\t\t\tbadtoken: 'userBadToken',\n\t\t\t\tassertanonfailed: 'userNewUser',\n\t\t\t\tassertuserfailed: 'userNewUser',\n\t\t\t\tassertnameduserfailed: 'userNewUser',\n\t\t\t\t'abusefilter-disallowed': 'extensionAbuseFilter',\n\t\t\t\t'abusefilter-warning': 'extensionAbuseFilter',\n\t\t\t\tcaptcha: 'extensionCaptcha',\n\t\t\t\tspamblacklist: 'extensionSpamBlacklist',\n\t\t\t\t'titleblacklist-forbidden': 'extensionTitleBlacklist',\n\t\t\t\tpagedeleted: 'editPageDeleted',\n\t\t\t\teditconflict: 'editConflict'\n\t\t\t};\n\n\t\tif ( data.edit && data.edit.captcha ) {\n\t\t\tcode = 'captcha';\n\t\t}\n\n\t\tthis.log( {\n\t\t\taction: 'saveFailure',\n\t\t\tmessage: code,\n\t\t\ttype: typeMap[code] || 'responseUnknown'\n\t\t} );\n\t},\n\t/**\n\t * Report load errors back to the user. Silently record the error using EventLogging.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {string} text Text (HTML) of message to display to user\n\t */\n\treportError: function ( text ) {\n\t\tvar errorNotice = new MessageBox( {\n\t\t\tclassName: 'errorbox',\n\t\t\tmsg: text,\n\t\t\theading: mw.msg( 'mobile-frontend-editor-error' )\n\t\t} );\n\t\tthis.$errorNoticeContainer.html( errorNotice.$el );\n\t},\n\thideErrorNotice: function () {\n\t\tthis.$errorNoticeContainer.empty();\n\t},\n\t/**\n\t * Prepares the penultimate screen before saving.\n\t * Expects to be overridden by child class.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tonStageChanges: function () {\n\t\tthis.showHidden( '.save-header, .save-panel' );\n\t\tthis.hideErrorNotice();\n\t\tthis.log( {\n\t\t\taction: 'saveIntent'\n\t\t} );\n\t\t// Scroll to the top of the page, so that the summary input is visible\n\t\t// (even if overlay was scrolled down when editing) and weird iOS header\n\t\t// problems are avoided (header position not updating to the top of the\n\t\t// screen, instead staying lower until a subsequent scroll event).\n\t\twindow.scrollTo( 0, 1 );\n\t},\n\t/**\n\t * Executed when the editor clicks the save button. Expects to be overridden by child\n\t * class. Checks if the save needs to be confirmed.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tonSaveBegin: function () {\n\t\tthis.confirmAborted = false;\n\t\tthis.hideErrorNotice();\n\t\t// Ask for confirmation in some cases\n\t\tif ( !this.confirmSave() ) {\n\t\t\tthis.confirmAborted = true;\n\t\t\treturn;\n\t\t}\n\t\tthis.log( {\n\t\t\taction: 'saveAttempt'\n\t\t} );\n\t},\n\t/**\n\t * @inheritdoc\n\t */\n\tpreRender: function () {\n\t\tconst options = this.options;\n\n\t\tthis.options.headers = [\n\t\t\theaders.formHeader(\n\t\t\t\tutil.template( `\n{{^hasToolbar}}\n<div class=\"overlay-title\">\n\t<h2>{{{editingMsg}}}</h2>\n</div>\n{{/hasToolbar}}\n{{#hasToolbar}}<div class=\"toolbar\"></div>{{/hasToolbar}}\n{{#editSwitcher}}\n\t<div class=\"switcher-container\">\n\t</div>\n{{/editSwitcher}}\n\t\t\t\t` ).render( {\n\t\t\t\t\thasToolbar: options.hasToolbar,\n\t\t\t\t\teditSwitcher: options.editSwitcher,\n\t\t\t\t\teditingMsg: options.editingMsg\n\t\t\t\t} ),\n\t\t\t\toptions.readOnly ? [] : [\n\t\t\t\t\tnew Icon( {\n\t\t\t\t\t\ttagName: 'button',\n\t\t\t\t\t\tname: 'next-invert',\n\t\t\t\t\t\tadditionalClassNames: 'continue',\n\t\t\t\t\t\tdisabled: true,\n\t\t\t\t\t\ttitle: options.continueMsg\n\t\t\t\t\t} )\n\t\t\t\t],\n\t\t\t\ticons.cancel(),\n\t\t\t\t'initial-header'\n\t\t\t),\n\t\t\theaders.saveHeader( options.previewingMsg, 'save-header hidden' ),\n\t\t\theaders.savingHeader( mw.msg( 'mobile-frontend-editor-wait' ) )\n\t\t];\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.$errorNoticeContainer = this.$el.find( '#error-notice-container' );\n\n\t\tOverlay.prototype.postRender.apply( this );\n\n\t\tthis.showHidden( '.initial-header' );\n\t},\n\tshow: function () {\n\t\tvar self = this;\n\t\tthis.allowCloseWindow = mw.confirmCloseWindow( {\n\t\t\t// Returns true if content has changed\n\t\t\ttest: function () {\n\t\t\t\t// Check if content has changed\n\t\t\t\treturn self.hasChanged();\n\t\t\t},\n\n\t\t\t// Message to show the user, if content has changed\n\t\t\tmessage: mw.msg( 'mobile-frontend-editor-cancel-confirm' ),\n\t\t\t// Event namespace\n\t\t\tnamespace: 'editwarning'\n\t\t} );\n\n\t\tthis.saved = false;\n\t\tOverlay.prototype.show.call( this );\n\n\t\t// Inform other interested code that the editor has loaded\n\t\tmw.hook( 'mobileFrontend.editorOpened' ).fire( this.editor );\n\t},\n\t/**\n\t * Back button click handler\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tonClickBack: function () {},\n\t/**\n\t * Submit button click handler\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tonClickSubmit: function () {\n\t\tthis.onSaveBegin();\n\t},\n\t/**\n\t * Continue button click handler\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tonClickContinue: function () {\n\t\tthis.onStageChanges();\n\t},\n\t/**\n\t * \"Edit without logging in\" button click handler\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\tonClickAnonymous: function () {},\n\t/**\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {Function} exit Callback to exit the overlay\n\t * @param {Function} cancel Callback to cancel exiting the overlay\n\t */\n\tonBeforeExit: function ( exit, cancel ) {\n\t\tvar self = this;\n\t\tif ( this.hasChanged() && !this.switching ) {\n\t\t\tif ( !this.windowManager ) {\n\t\t\t\tthis.windowManager = OO.ui.getWindowManager();\n\t\t\t\tthis.windowManager.addWindows( [ new mw.widgets.AbandonEditDialog() ] );\n\t\t\t}\n\t\t\tthis.windowManager.openWindow( 'abandonedit' )\n\t\t\t\t.closed.then( function ( data ) {\n\t\t\t\t\tif ( data && data.action === 'discard' ) {\n\t\t\t\t\t\t// log abandonment\n\t\t\t\t\t\tself.log( {\n\t\t\t\t\t\t\taction: 'abort',\n\t\t\t\t\t\t\tmechanism: 'cancel',\n\t\t\t\t\t\t\ttype: 'abandon'\n\t\t\t\t\t\t} );\n\t\t\t\t\t\t// May not be set if overlay has not been previously shown\n\t\t\t\t\t\tif ( self.allowCloseWindow ) {\n\t\t\t\t\t\t\tself.allowCloseWindow.release();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmw.hook( 'mobileFrontend.editorClosed' ).fire();\n\t\t\t\t\t\texit();\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\tcancel();\n\t\t\treturn;\n\t\t}\n\t\tif ( !this.switching && !this.saved ) {\n\t\t\t// log leaving without changes\n\t\t\tthis.log( {\n\t\t\t\taction: 'abort',\n\t\t\t\tmechanism: 'cancel',\n\t\t\t\t// if this is VE, hasChanged will be false because the Surface has\n\t\t\t\t// already been destroyed (which is good because it stops us\n\t\t\t\t// double-showing the abandon changes dialog above)... but we can\n\t\t\t\t// test whether there *were* changes for logging purposes by\n\t\t\t\t// examining the target:\n\t\t\t\ttype: ( this.target && this.target.edited ) ? 'abandon' : 'nochange'\n\t\t\t} );\n\t\t}\n\t\t// If undefined .show may not have been called\n\t\tif ( this.allowCloseWindow ) {\n\t\t\tthis.allowCloseWindow.release();\n\t\t}\n\t\tmw.hook( 'mobileFrontend.editorClosed' ).fire();\n\t\texit();\n\t},\n\t/**\n\t * Sets additional values used for anonymous editing warning.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {Object} options\n\t * @return {jQuery.Element}\n\t */\n\tcreateAnonWarning: function ( options ) {\n\t\tvar $actions = $( '<div>' ).addClass( 'actions' ),\n\t\t\t$anonWarning = $( '<div>' ).addClass( 'anonwarning content' ).append(\n\t\t\t\tnew MessageBox( {\n\t\t\t\t\tclassName: 'warningbox anon-msg',\n\t\t\t\t\tmsg: mw.msg( 'mobile-frontend-editor-anonwarning' )\n\t\t\t\t} ).$el,\n\t\t\t\t$actions\n\t\t\t),\n\t\t\tparams = util.extend( {\n\t\t\t// use wgPageName as this includes the namespace if outside Main\n\t\t\t\treturnto: options.returnTo || mw.config.get( 'wgPageName' ),\n\t\t\t\treturntoquery: 'action=edit&section=' + options.sectionId,\n\t\t\t\twarning: 'mobile-frontend-edit-login-action'\n\t\t\t}, options.queryParams ),\n\t\t\tsignupParams = util.extend( {\n\t\t\t\ttype: 'signup',\n\t\t\t\twarning: 'mobile-frontend-edit-signup-action'\n\t\t\t}, options.signupQueryParams ),\n\t\t\tanonymousEditorActions = [\n\t\t\t\tnew Button( {\n\t\t\t\t\tlabel: mw.msg( 'mobile-frontend-editor-anon' ),\n\t\t\t\t\tblock: true,\n\t\t\t\t\tadditionalClassNames: 'anonymous progressive',\n\t\t\t\t\tprogressive: true\n\t\t\t\t} ),\n\t\t\t\tnew Button( {\n\t\t\t\t\tblock: true,\n\t\t\t\t\thref: mw.util.getUrl( 'Special:UserLogin', params ),\n\t\t\t\t\tlabel: mw.msg( 'mobile-frontend-watchlist-cta-button-login' )\n\t\t\t\t} ),\n\t\t\t\tnew Button( {\n\t\t\t\t\tblock: true,\n\t\t\t\t\thref: mw.util.getUrl( 'Special:UserLogin', util.extend( params, signupParams ) ),\n\t\t\t\t\tlabel: mw.msg( 'mobile-frontend-watchlist-cta-button-signup' )\n\t\t\t\t} )\n\t\t\t];\n\n\t\t$actions.append(\n\t\t\tanonymousEditorActions.map( function ( action ) {\n\t\t\t\treturn action.$el;\n\t\t\t} )\n\t\t);\n\n\t\treturn $anonWarning;\n\t},\n\n\t/**\n\t * Get an options object not containing any defaults or editor\n\t * specific options, so that it can be used to construct a\n\t * different editor for switching.\n\t *\n\t * @return {Object} Options\n\t */\n\tgetOptionsForSwitch: function () {\n\t\t// Only preserve options that would be passed in editor.js#setupEditor\n\t\t// and skip over defaults.\n\t\treturn {\n\t\t\tswitched: true,\n\t\t\toverlayManager: this.options.overlayManager,\n\t\t\tcurrentPageHTMLParser: this.options.currentPageHTMLParser,\n\t\t\tfakeScroll: this.options.fakeScroll,\n\t\t\tapi: this.options.api,\n\t\t\tlicenseMsg: this.options.licenseMsg,\n\t\t\ttitle: this.options.title,\n\t\t\ttitleObj: this.options.titleObj,\n\t\t\tisAnon: this.options.isAnon,\n\t\t\tisNewPage: this.options.isNewPage,\n\t\t\teditCount: this.options.editCount,\n\t\t\toldId: this.options.oldId,\n\t\t\tcontentLang: this.options.contentLang,\n\t\t\tcontentDir: this.options.contentDir,\n\t\t\tsessionId: this.options.sessionId,\n\t\t\tsectionId: this.options.sectionId\n\t\t};\n\t},\n\n\t/**\n\t * Checks whether the state of the thing being edited as changed. Expects to be\n\t * implemented by child class.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t */\n\thasChanged: function () {},\n\t/**\n\t * Get a promise that is resolved when the editor data has loaded,\n\t * or rejected when we're refusing to load the editor because the user is blocked.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @return {jQuery.Promise}\n\t */\n\tgetLoadingPromise: function () {\n\t\treturn this.dataPromise.then( function ( result ) {\n\t\t\t// check if user is blocked\n\t\t\tif ( result && result.blockinfo ) {\n\t\t\t\t// Lazy-load moment only if it's needed, it's somewhat large (it is already used on\n\t\t\t\t// mobile by Echo's notifications panel, where it's also lazy-loaded)\n\t\t\t\treturn mw.loader.using( 'moment' ).then( function () {\n\t\t\t\t\tvar block = parseBlockInfo( result.blockinfo ),\n\t\t\t\t\t\tmessage = blockMessageDrawer( block );\n\t\t\t\t\treturn util.Deferred().reject( message );\n\t\t\t\t} );\n\t\t\t}\n\t\t\treturn result;\n\t\t} );\n\t},\n\t/**\n\t * Handles a failed save due to a CAPTCHA provided by ConfirmEdit extension.\n\t *\n\t * @memberof EditorOverlayBase\n\t * @instance\n\t * @param {Object} details Details returned from the api.\n\t */\n\thandleCaptcha: function ( details ) {\n\t\tvar self = this,\n\t\t\t$input = this.$el.find( '.captcha-word' );\n\n\t\tif ( this.captchaShown ) {\n\t\t\t$input.val( '' );\n\t\t\t$input.attr( 'placeholder', this.options.captchaTryAgainMsg );\n\t\t\tsetTimeout( function () {\n\t\t\t\t$input.attr( 'placeholder', self.options.captchaMsg );\n\t\t\t}, 2000 );\n\t\t}\n\n\t\t// handle different mime types different\n\t\tif ( details.mime.indexOf( 'image/' ) === 0 ) {\n\t\t\t// image based CAPTCHA's like provided by FancyCaptcha, ReCaptcha or similar\n\t\t\tthis.$el.find( '.captcha-panel#question' ).detach();\n\t\t\tthis.$el.find( '.captcha-panel img' ).attr( 'src', details.url );\n\t\t} else {\n\t\t\t// not image based CAPTCHA.\n\t\t\tthis.$el.find( '.captcha-panel #image' ).detach();\n\t\t\tif ( details.mime.indexOf( 'text/html' ) === 0 ) {\n\t\t\t\t// handle mime type of HTML as HTML content (display as-is).\n\t\t\t\t// QuestyCaptcha now have default MIME type \"text/html\": see T147606\n\t\t\t\tthis.$el.find( '.captcha-panel #question' ).html( details.question );\n\t\t\t} else {\n\t\t\t\t// handle mime types\n\t\t\t\t// (other than image based ones and HTML based ones)\n\t\t\t\t// as plain text by default.\n\t\t\t\t// e.g. MathCaptcha (solve a math formula) or\n\t\t\t\t// SimpleCaptcha (simple math formula)\n\t\t\t\tthis.$el.find( '.captcha-panel #question' ).text( details.question );\n\t\t\t}\n\t\t}\n\n\t\tthis.showHidden( '.save-header, .captcha-panel' );\n\t\tthis.captchaShown = true;\n\t}\n} );\n\nmodule.exports = EditorOverlayBase;\n","var EditorOverlayBase = require( './EditorOverlayBase' ),\n\tutil = require( '../mobile.startup/util' ),\n\ticons = require( '../mobile.startup/icons' ),\n\tSection = require( '../mobile.startup/Section' ),\n\tsaveFailureMessage = require( './saveFailureMessage' ),\n\tEditorGateway = require( './EditorGateway' ),\n\tfakeToolbar = require( '../mobile.init/fakeToolbar' ),\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tsetPreferredEditor = require( './setPreferredEditor' ),\n\tVisualEditorOverlay = require( './VisualEditorOverlay' );\n\n/**\n * Overlay that shows an editor\n *\n * @class SourceEditorOverlay\n * @uses Section\n * @uses EditorGateway\n * @uses VisualEditorOverlay\n * @extends EditorOverlayBase\n *\n * @param {Object} options Configuration options\n * @param {Object} [options.visualEditorConfig] falls back to wgVisualEditorConfig if not defined\n * @param {jQuery.Promise} [dataPromise] Optional promise for loading content\n */\nfunction SourceEditorOverlay( options, dataPromise ) {\n\t// eslint-disable-next-line compat/compat\n\tthis.isFirefox = /firefox/i.test( window.navigator.userAgent );\n\tthis.visualEditorConfig = options.visualEditorConfig ||\n\t\tmw.config.get( 'wgVisualEditorConfig' ) || {};\n\tthis.gateway = new EditorGateway( {\n\t\tapi: options.api,\n\t\ttitle: options.title,\n\t\tsectionId: options.sectionId,\n\t\toldId: options.oldId,\n\t\tisNewPage: options.isNewPage,\n\t\tfromModified: !!dataPromise\n\t} );\n\tthis.readOnly = !!options.oldId; // If old revision, readOnly mode\n\tthis.dataPromise = dataPromise || this.gateway.getContent();\n\tif ( this.isVisualEditorEnabled() ) {\n\t\toptions.editSwitcher = true;\n\t}\n\tif ( this.readOnly ) {\n\t\toptions.readOnly = true;\n\t\toptions.editingMsg = mw.msg( 'mobile-frontend-editor-viewing-source-page', options.title );\n\t} else {\n\t\toptions.editingMsg = mw.msg( 'mobile-frontend-editor-editing-page', options.title );\n\t}\n\toptions.previewingMsg = mw.msg( 'mobile-frontend-editor-previewing-page', options.title );\n\tEditorOverlayBase.call(\n\t\tthis,\n\t\tutil.extend( true,\n\t\t\t{ events: { 'input .wikitext-editor': 'onInputWikitextEditor' } },\n\t\t\toptions\n\t\t)\n\t);\n}\n\nmfExtend( SourceEditorOverlay, EditorOverlayBase, {\n\t/**\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\ttemplatePartials: util.extend( {}, EditorOverlayBase.prototype.templatePartials, {\n\t\tcontent: util.template( `\n<div lang=\"{{contentLang}}\" dir=\"{{contentDir}}\" class=\"editor-container content\">\n\t<textarea class=\"wikitext-editor\" id=\"wikitext-editor\" cols=\"40\" rows=\"10\" placeholder=\"{{placeholder}}\"></textarea>\n\t<div class=\"preview\"></div>\n</div>\n\t\t` )\n\t} ),\n\t/**\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\teditor: 'wikitext',\n\t/**\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tsectionLine: '',\n\n\t/**\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tshow: function () {\n\t\tEditorOverlayBase.prototype.show.apply( this, arguments );\n\t\t// Ensure we do this after showing the overlay, otherwise it doesn't work.\n\t\tthis._resizeEditor();\n\t},\n\t/**\n\t * Check whether VisualEditor is enabled or not.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisVisualEditorEnabled: function () {\n\t\tvar config = this.visualEditorConfig,\n\t\t\tns = config.namespaces;\n\n\t\treturn ns &&\n\t\t\tns.indexOf(\n\t\t\t\tmw.config.get( 'wgNamespaceNumber' )\n\t\t\t) > -1 &&\n\t\t\tmw.config.get( 'wgTranslatePageTranslation' ) !== 'translation' &&\n\t\t\tmw.config.get( 'wgPageContentModel' ) === 'wikitext';\n\t},\n\t/**\n\t * Wikitext Editor input handler\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tonInputWikitextEditor: function () {\n\t\tthis.gateway.setContent( this.$el.find( '.wikitext-editor' ).val() );\n\t\tthis.$el.find( '.continue, .submit' ).prop( 'disabled', false );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tonClickBack: function () {\n\t\tEditorOverlayBase.prototype.onClickBack.apply( this, arguments );\n\t\tthis._hidePreview();\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar self = this,\n\t\t\tconfig = this.visualEditorConfig,\n\t\t\toptions = this.options,\n\t\t\tshowAnonWarning = options.isAnon && !options.switched;\n\n\t\t// log edit attempt\n\t\tthis.log( { action: 'ready' } );\n\t\tthis.log( { action: 'loaded' } );\n\n\t\tif ( this.isVisualEditorEnabled() ) {\n\t\t\tmw.loader.using( 'ext.visualEditor.switching' ).then( function () {\n\t\t\t\tvar switchToolbar, windowManager, switchWindow,\n\t\t\t\t\ttoolFactory = new OO.ui.ToolFactory(),\n\t\t\t\t\ttoolGroupFactory = new OO.ui.ToolGroupFactory();\n\n\t\t\t\ttoolFactory.register( mw.libs.ve.MWEditModeVisualTool );\n\t\t\t\ttoolFactory.register( mw.libs.ve.MWEditModeSourceTool );\n\t\t\t\tswitchToolbar = new OO.ui.Toolbar( toolFactory, toolGroupFactory, {\n\t\t\t\t\tclasses: [ 'editor-switcher' ]\n\t\t\t\t} );\n\n\t\t\t\tswitchToolbar.on( 'switchEditor', function ( mode ) {\n\t\t\t\t\tvar\n\t\t\t\t\t\tcanSwitch = config.fullRestbaseUrl || config.allowLossySwitching;\n\t\t\t\t\tif ( mode === 'visual' ) {\n\t\t\t\t\t\tif ( !self.gateway.hasChanged ) {\n\t\t\t\t\t\t\tself._switchToVisualEditor();\n\t\t\t\t\t\t} else if ( canSwitch ) {\n\t\t\t\t\t\t\t// Pass wikitext if there are changes.\n\t\t\t\t\t\t\tself._switchToVisualEditor( self.gateway.content );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindowManager = new OO.ui.WindowManager();\n\t\t\t\t\t\t\tswitchWindow = new mw.libs.ve.SwitchConfirmDialog();\n\t\t\t\t\t\t\twindowManager.$element.appendTo( document.body );\n\t\t\t\t\t\t\twindowManager.addWindows( [ switchWindow ] );\n\t\t\t\t\t\t\twindowManager.openWindow( switchWindow, { mode: 'simple' } )\n\t\t\t\t\t\t\t\t.closed.then( function ( data ) {\n\t\t\t\t\t\t\t\t\tif ( data && data.action === 'discard' ) {\n\t\t\t\t\t\t\t\t\t\tself._switchToVisualEditor();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\twindowManager.destroy();\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\n\t\t\t\tswitchToolbar.setup( [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'editMode',\n\t\t\t\t\t\ttype: 'list',\n\t\t\t\t\t\ticon: 'edit',\n\t\t\t\t\t\ttitle: mw.msg( 'visualeditor-mweditmode-tooltip' ),\n\t\t\t\t\t\tinclude: [ 'editModeVisual', 'editModeSource' ]\n\t\t\t\t\t}\n\t\t\t\t] );\n\n\t\t\t\tself.$el.find( '.switcher-container' ).html( switchToolbar.$element );\n\t\t\t\tswitchToolbar.emit( 'updateState' );\n\t\t\t} );\n\t\t}\n\n\t\tEditorOverlayBase.prototype.postRender.apply( this );\n\n\t\t// This spinner is still used when displaying save/preview panel\n\t\tthis.$el.find( '.overlay-content' ).append( icons.spinner().$el );\n\t\tthis.hideSpinner();\n\n\t\tthis.$preview = this.$el.find( '.preview' );\n\t\tthis.$content = this.$el.find( '.wikitext-editor' );\n\t\t// The following classes can be used here:\n\t\t// * mw-editfont-monospace\n\t\t// * mw-editfont-sans-serif\n\t\t// * mw-editfont-serif\n\t\tthis.$content.addClass( 'mw-editfont-' + mw.user.options.get( 'editfont' ) );\n\t\tif ( showAnonWarning ) {\n\t\t\tthis.$anonWarning = this.createAnonWarning( options );\n\t\t\tthis.$el.find( '.editor-container' ).append( this.$anonWarning );\n\t\t\tthis.$content.hide();\n\t\t\t// the user has to click login, signup or edit without login,\n\t\t\t// disable \"Next\" button on top right\n\t\t\tthis.$anonHiddenButtons = this.$el.find( '.overlay-header .continue, .editor-switcher' ).hide();\n\t\t}\n\t\t// make license links open in separate tabs\n\t\tthis.$el.find( '.license a' ).attr( 'target', '_blank' );\n\n\t\t// If in readOnly mode, make textarea readonly\n\t\tif ( this.readOnly ) {\n\t\t\tthis.$content.prop( 'readonly', true );\n\t\t}\n\n\t\tthis.$content\n\t\t\t.on( 'input', this._resizeEditor.bind( this ) )\n\t\t\t.one( 'input', function () {\n\t\t\t\tself.log( { action: 'firstChange' } );\n\t\t\t} );\n\n\t\tif ( this.isFirefox ) {\n\t\t\tthis.$content.on( 'mousedown', function () {\n\t\t\t\t// Support: Firefox Mobile\n\t\t\t\t// Firefox scrolls back to the top of the page *every time*\n\t\t\t\t// you tap on the textarea. This makes things slightly\n\t\t\t\t// more usable by restoring your scroll offset every time\n\t\t\t\t// the page scrolls for the next 1000ms.\n\t\t\t\t// The page will still flicker every time the user touches\n\t\t\t\t// to place the cursor, but this is better than completely\n\t\t\t\t// losing your scroll offset. (T214880)\n\t\t\t\tvar docEl = document.documentElement,\n\t\t\t\t\tscrollTop = docEl.scrollTop;\n\t\t\t\tfunction blockScroll() {\n\t\t\t\t\tdocEl.scrollTop = scrollTop;\n\t\t\t\t}\n\t\t\t\twindow.addEventListener( 'scroll', blockScroll );\n\t\t\t\tsetTimeout( function () {\n\t\t\t\t\twindow.removeEventListener( 'scroll', blockScroll );\n\t\t\t\t}, 1000 );\n\t\t\t} );\n\t\t}\n\n\t\tif ( !showAnonWarning ) {\n\t\t\tthis._loadContent();\n\t\t}\n\t},\n\n\t/**\n\t * Handles click on \"Edit without login\" in anonymous editing warning.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @private\n\t */\n\tonClickAnonymous: function () {\n\t\tthis.$anonWarning.hide();\n\t\t// reenable \"Next\" button\n\t\tthis.$anonHiddenButtons.show();\n\t\tthis._loadContent();\n\t},\n\n\t/**\n\t * Prepares the preview interface and reveals the save screen of the overlay\n\t *\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tonStageChanges: function () {\n\t\tvar self = this,\n\t\t\tparams = {\n\t\t\t\ttext: this.getContent()\n\t\t\t};\n\n\t\tthis.scrollTop = util.getDocument().find( 'body' ).scrollTop();\n\t\tthis.$content.hide();\n\t\tthis.showSpinner();\n\n\t\tif ( mw.config.get( 'wgIsMainPage' ) ) {\n\t\t\tparams.mainpage = 1; // Setting it to 0 will have the same effect\n\t\t}\n\n\t\tfunction hideSpinnerAndShowPreview() {\n\t\t\tself.hideSpinner();\n\t\t\tself.$preview.show();\n\t\t}\n\n\t\tthis.gateway.getPreview( params ).then( function ( result ) {\n\t\t\tvar parsedText = result.text,\n\t\t\t\tparsedSectionLine = result.line;\n\n\t\t\tself.sectionId = result.id;\n\t\t\t// On desktop edit summaries strip tags. Mimic this behavior on mobile devices\n\t\t\tself.sectionLine = self.parseHTML( '<div>' ).html( parsedSectionLine ).text();\n\t\t\tnew Section( {\n\t\t\t\tel: self.$preview,\n\t\t\t\ttext: parsedText\n\t\t\t} ).$el.find( 'a' ).on( 'click', false );\n\n\t\t\thideSpinnerAndShowPreview();\n\t\t}, function () {\n\t\t\tself.$preview.addClass( 'errorbox' ).text( mw.msg( 'mobile-frontend-editor-error-preview' ) );\n\n\t\t\thideSpinnerAndShowPreview();\n\t\t} );\n\n\t\tEditorOverlayBase.prototype.onStageChanges.apply( this, arguments );\n\t},\n\n\t/**\n\t * Hides the preview and reverts back to initial screen.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @private\n\t */\n\t_hidePreview: function () {\n\t\tthis.gateway.abortPreview();\n\t\tthis.hideSpinner();\n\t\tthis.$preview.removeClass( 'errorbox' ).hide();\n\t\tthis.$content.show();\n\t\twindow.scrollTo( 0, this.scrollTop );\n\t\tthis.showHidden( '.initial-header' );\n\t},\n\n\t/**\n\t * Resize the editor textarea, maintaining scroll position in iOS\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\t_resizeEditor: function () {\n\t\tvar scrollTop, container, $scrollContainer;\n\n\t\tif ( !this.$scrollContainer ) {\n\t\t\tcontainer = OO.ui.Element.static\n\t\t\t\t.getClosestScrollableContainer( this.$content[ 0 ] );\n\t\t\t// The scroll container will be either within the view\n\t\t\t// or the document element itself.\n\t\t\t$scrollContainer = this.$el.find( container ).length ?\n\t\t\t\tthis.$el.find( container ) : util.getDocument();\n\t\t\tthis.$scrollContainer = $scrollContainer;\n\t\t\tthis.$content.css( 'padding-bottom', this.$scrollContainer.height() * 0.6 );\n\t\t} else {\n\t\t\t$scrollContainer = this.$scrollContainer;\n\t\t}\n\n\t\t// Only do this if scroll container exists\n\t\tif ( this.$content.prop( 'scrollHeight' ) && $scrollContainer.length ) {\n\t\t\tscrollTop = $scrollContainer.scrollTop();\n\t\t\tthis.$content\n\t\t\t\t.css( 'height', 'auto' )\n\t\t\t\t// can't reuse prop( 'scrollHeight' ) because we need the current value\n\t\t\t\t.css( 'height', ( this.$content.prop( 'scrollHeight' ) + 2 ) + 'px' );\n\t\t\t$scrollContainer.scrollTop( scrollTop );\n\t\t}\n\t},\n\n\t/**\n\t * Set content to the user input field.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @param {string} content The content to set.\n\t */\n\tsetContent: function ( content ) {\n\t\tthis.$content\n\t\t\t.show()\n\t\t\t.val( content );\n\t\tthis._resizeEditor();\n\t},\n\n\t/**\n\t * Returns the content of the user input field.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @return {string}\n\t */\n\tgetContent: function () {\n\t\treturn this.$content.val();\n\t},\n\n\t/**\n\t * Requests content from the API and reveals it in UI.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @private\n\t */\n\t_loadContent: function () {\n\t\tvar self = this;\n\n\t\tthis.$content.hide();\n\n\t\tthis.getLoadingPromise()\n\t\t\t.then( function ( result ) {\n\t\t\t\tvar content = result.text;\n\n\t\t\t\tself.setContent( content );\n\n\t\t\t\tif ( self.gateway.fromModified ) {\n\t\t\t\t\t// Trigger intial EditorGateway#setContent and update save button\n\t\t\t\t\tself.onInputWikitextEditor();\n\t\t\t\t}\n\t\t\t} );\n\t},\n\n\t/**\n\t * Loads a {VisualEditorOverlay} and replaces the existing SourceEditorOverlay with it\n\t * based on the current option values.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @private\n\t * @param {string} [wikitext] Wikitext to pass to VE\n\t */\n\t_switchToVisualEditor: function ( wikitext ) {\n\t\tvar self = this;\n\t\tthis.log( {\n\t\t\taction: 'abort',\n\t\t\ttype: 'switchnochange',\n\t\t\tmechanism: 'navigate'\n\t\t} );\n\t\tthis.logFeatureUse( {\n\t\t\tfeature: 'editor-switch',\n\t\t\taction: 'visual-mobile'\n\t\t} );\n\n\t\t// Save a user setting indicating that this user prefers using the VisualEditor\n\t\tsetPreferredEditor( 'VisualEditor' );\n\n\t\tthis.$el.addClass( 'switching' );\n\t\tthis.$el.find( '.overlay-header-container' ).hide();\n\t\tthis.$el.append( fakeToolbar() );\n\t\tthis.$content.prop( 'readonly', true );\n\n\t\tmw.loader.using( 'ext.visualEditor.targetLoader' ).then( function () {\n\t\t\tmw.libs.ve.targetLoader.addPlugin( 'mobile.editor.ve' );\n\t\t\treturn mw.libs.ve.targetLoader.loadModules( 'visual' );\n\t\t} ).then(\n\t\t\tfunction () {\n\t\t\t\tvar newOverlay, options = self.getOptionsForSwitch();\n\t\t\t\toptions.SourceEditorOverlay = SourceEditorOverlay;\n\t\t\t\tif ( wikitext ) {\n\t\t\t\t\toptions.dataPromise = mw.libs.ve.targetLoader.requestPageData( 'visual', mw.config.get( 'wgRelevantPageName' ), {\n\t\t\t\t\t\tsection: options.sectionId,\n\t\t\t\t\t\toldId: options.oldId || mw.config.get( 'wgRevisionId' ),\n\t\t\t\t\t\ttargetName: 'mobile',\n\t\t\t\t\t\tmodified: true,\n\t\t\t\t\t\twikitext: wikitext\n\t\t\t\t\t} );\n\t\t\t\t} else {\n\t\t\t\t\tdelete options.dataPromise;\n\t\t\t\t}\n\t\t\t\tnewOverlay = new VisualEditorOverlay( options );\n\t\t\t\tnewOverlay.getLoadingPromise().then( function () {\n\t\t\t\t\tself.switching = true;\n\t\t\t\t\tself.overlayManager.replaceCurrent( newOverlay );\n\t\t\t\t\tself.switching = false;\n\t\t\t\t} );\n\t\t\t},\n\t\t\tfunction () {\n\t\t\t\tself.$el.removeClass( 'switching' );\n\t\t\t\tself.$el.find( '.overlay-header-container' ).show();\n\t\t\t\tself.$el.find( '.ve-mobile-fakeToolbar-container' ).remove();\n\t\t\t\tself.$content.prop( 'readonly', false );\n\t\t\t\t// FIXME: We should show an error notification, but right now toast\n\t\t\t\t// notifications are not dismissible when shown within the editor.\n\t\t\t}\n\t\t);\n\t},\n\n\t/**\n\t * Executed when the editor clicks the save/publish button. Handles logging and submitting\n\t * the save action to the editor API.\n\t *\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tonSaveBegin: function () {\n\t\tvar self = this,\n\t\t\toptions = {\n\t\t\t\tsummary: this.$el.find( '.summary' ).val()\n\t\t\t};\n\n\t\tif ( self.sectionLine !== '' ) {\n\t\t\toptions.summary = '/* ' + self.sectionLine + ' */' + options.summary;\n\t\t}\n\t\tEditorOverlayBase.prototype.onSaveBegin.apply( this, arguments );\n\t\tif ( this.confirmAborted ) {\n\t\t\treturn;\n\t\t}\n\t\tif ( this.captchaId ) {\n\t\t\toptions.captchaId = this.captchaId;\n\t\t\toptions.captchaWord = this.$el.find( '.captcha-word' ).val();\n\t\t}\n\n\t\tthis.showHidden( '.saving-header' );\n\n\t\tthis.gateway.save( options )\n\t\t\t.then( function ( newRevId ) {\n\t\t\t\tvar title = self.options.title;\n\t\t\t\t// Special case behaviour of main page\n\t\t\t\tif ( mw.config.get( 'wgIsMainPage' ) ) {\n\t\t\t\t\t// FIXME: Blocked on T189173\n\t\t\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\t\t\twindow.location = mw.util.getUrl( title );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tself.onSaveComplete( newRevId );\n\t\t\t}, function ( data ) {\n\t\t\t\tself.onSaveFailure( data );\n\t\t\t} );\n\t},\n\n\t/**\n\t * Executed when page save fails. Handles error display and bookkeeping,\n\t * passes logging duties to the parent.\n\t *\n\t * @inheritdoc\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t */\n\tonSaveFailure: function ( data ) {\n\t\tvar msg, noRetry;\n\n\t\tif ( data.edit && data.edit.captcha ) {\n\t\t\tthis.captchaId = data.edit.captcha.id;\n\t\t\tthis.handleCaptcha( data.edit.captcha );\n\t\t} else {\n\t\t\tmsg = saveFailureMessage( data );\n\t\t\tthis.reportError( msg );\n\t\t\tthis.showHidden( '.save-header, .save-panel' );\n\n\t\t\t// Some errors may be temporary, but for others we know for sure that the save will\n\t\t\t// never succeed, so don't confuse the user by giving them the option to retry.\n\t\t\tnoRetry = data.errors && data.errors.some( function ( error ) {\n\t\t\t\treturn error.code === 'abusefilter-disallowed';\n\t\t\t} );\n\n\t\t\tif ( noRetry ) {\n\t\t\t\t// disable continue and save buttons, reenabled when user changes content\n\t\t\t\tthis.$el.find( '.continue, .submit' ).prop( 'disabled', true );\n\t\t\t}\n\t\t}\n\n\t\tEditorOverlayBase.prototype.onSaveFailure.apply( this, arguments );\n\t},\n\n\t/**\n\t * Checks whether the existing content has changed.\n\t *\n\t * @memberof SourceEditorOverlay\n\t * @instance\n\t * @return {boolean}\n\t */\n\thasChanged: function () {\n\t\treturn this.gateway.hasChanged;\n\t}\n} );\n\nmodule.exports = SourceEditorOverlay;\n","/* global ve, $ */\nvar EditorOverlayBase = require( './EditorOverlayBase' ),\n\tEditorGateway = require( './EditorGateway' ),\n\tfakeToolbar = require( '../mobile.init/fakeToolbar' ),\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\trouter = mw.loader.require( 'mediawiki.router' ),\n\tidentifyLeadParagraph = require( './identifyLeadParagraph' ),\n\tsetPreferredEditor = require( './setPreferredEditor' ),\n\tutil = require( '../mobile.startup/util' );\n\n/**\n * Overlay for VisualEditor view\n *\n * @class VisualEditorOverlay\n * @extends EditorOverlayBase\n *\n * @param {Object} options Configuration options\n * @param {SourceEditorOverlay} options.SourceEditorOverlay Class to use for standard\n *  Wikitext editor. It must be passed in explicitly to avoid a cyclic\n *  dependency between VisualEditorOverlay and SourceEditorOverlay\n */\nfunction VisualEditorOverlay( options ) {\n\tvar surfaceReady = util.Deferred();\n\n\tEditorOverlayBase.call( this,\n\t\tutil.extend( {\n\t\t\teditSwitcher: false,\n\t\t\thasToolbar: true,\n\t\t\tonBeforeExit: this.onBeforeExit.bind( this ),\n\t\t\tisBorderBox: false,\n\t\t\tclassName: 'overlay editor-overlay editor-overlay-ve'\n\t\t}, options )\n\t);\n\tthis.SourceEditorOverlay = options.SourceEditorOverlay;\n\tthis.isNewPage = options.isNewPage;\n\tthis.fromModified = options.dataPromise && options.switched;\n\n\t// Gateway present for a few utility purposes; the VE articletarget\n\t// handles the actual API calls separately\n\tthis.gateway = new EditorGateway( {\n\t\tapi: options.api,\n\t\ttitle: options.title,\n\t\tsectionId: options.sectionId,\n\t\toldId: options.oldId,\n\t\tisNewPage: options.isNewPage\n\t} );\n\n\tthis.origDataPromise = this.options.dataPromise || mw.libs.ve.targetLoader.requestPageData(\n\t\t'visual',\n\t\toptions.titleObj.getPrefixedDb(),\n\t\t{\n\t\t\tsessionStore: true,\n\t\t\tsection: options.sectionId || null,\n\t\t\toldId: options.oldId || undefined,\n\t\t\ttargetName: ve.init.mw.MobileArticleTarget.static.trackingName\n\t\t}\n\t);\n\n\tthis.target = ve.init.mw.targetFactory.create( 'article', this, {\n\t\t$element: this.$el,\n\t\t// string or null, but not undefined\n\t\tsection: this.options.sectionId || null\n\t} );\n\tthis.target.once( 'surfaceReady', function () {\n\t\tsurfaceReady.resolve();\n\n\t\tthis.target.getSurface().getModel().getDocument().once( 'transact', function () {\n\t\t\tthis.log( { action: 'firstChange' } );\n\t\t}.bind( this ) );\n\t}.bind( this ) );\n\n\tthis.target.load( this.origDataPromise );\n\n\t// Overlay is only shown after this is resolved. It must be resolved\n\t// with the API response regardless of what we are waiting for.\n\tthis.dataPromise = this.origDataPromise.then( function ( data ) {\n\t\treturn surfaceReady.then( function () {\n\t\t\treturn data && data.visualeditor;\n\t\t} );\n\t} );\n}\n\nmfExtend( VisualEditorOverlay, EditorOverlayBase, {\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\ttemplatePartials: util.extend( {}, EditorOverlayBase.prototype.templatePartials, {\n\t\teditHeader: util.template( `\n<div class=\"overlay-header header initial-header hideable hidden\">\n\t<div class=\"toolbar\"></div>\n</div>\n\t\t` ),\n\t\tcontent: util.template( `\n<div class=\"surface\" lang=\"{{contentLang}}\" dir=\"{{contentDir}}\">\n</div>\n\t\t` )\n\t} ),\n\t/**\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\teditor: 'visualeditor',\n\t/**\n\t * Destroy the existing VisualEditor target.\n\t *\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tdestroyTarget: function () {\n\t\tif ( this.target ) {\n\t\t\tthis.target.destroy();\n\t\t\tthis.target = null;\n\t\t}\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tshow: function () {\n\t\tvar\n\t\t\toptions = this.options,\n\t\t\tshowAnonWarning = options.isAnon && !options.switched;\n\n\t\tEditorOverlayBase.prototype.show.apply( this, arguments );\n\n\t\t// log edit attempt\n\t\tthis.log( { action: 'ready' } );\n\t\tthis.log( { action: 'loaded' } );\n\n\t\tif ( !showAnonWarning ) {\n\t\t\tthis.redoTargetInit();\n\t\t} else {\n\t\t\tthis.$anonWarning = this.createAnonWarning( this.options );\n\t\t\tthis.$el.append( this.$anonWarning );\n\t\t\tthis.$el.find( '.overlay-content' ).hide();\n\t\t}\n\n\t\tthis.emit( 'editor-loaded' );\n\t},\n\t/**\n\t * Re-do some initialization steps that might have happened while the overlay\n\t * was hidden, but only work correctly after it is shown.\n\t */\n\tredoTargetInit: function () {\n\t\t// Note this.target will not be set if an error occurred and/or destroyTarget was called.\n\t\tif ( this.target ) {\n\t\t\tthis.target.adjustContentPadding();\n\t\t\tthis.target.restoreEditSection();\n\t\t\tthis.scrollToLeadParagraph();\n\t\t}\n\t},\n\t/**\n\t * Scroll so that the lead paragraph in edit mode shows at the same place on the screen\n\t * as the lead paragraph in read mode.\n\t *\n\t * Their normal position is different because of (most importantly) the lead paragraph\n\t * transformation to move it before the infobox, and also invisible templates and slugs\n\t * caused by the presence of hatnote templates (both only shown in edit mode).\n\t */\n\tscrollToLeadParagraph: function () {\n\t\tvar editLead, editLeadView, readLead, offset, initialCursorOffset,\n\t\t\tcurrentPageHTMLParser = this.options.currentPageHTMLParser,\n\t\t\tfakeScroll = this.options.fakeScroll,\n\t\t\t$window = $( window ),\n\t\t\tsection = this.target.section,\n\t\t\tsurface = this.target.getSurface(),\n\t\t\tmode = surface.getMode();\n\n\t\tif ( ( section === null || section === '0' ) && mode === 'visual' ) {\n\t\t\teditLead = identifyLeadParagraph( surface.getView().$attachedRootNode );\n\t\t\tif ( currentPageHTMLParser.getLeadSectionElement() ) {\n\t\t\t\treadLead = identifyLeadParagraph( currentPageHTMLParser.getLeadSectionElement() );\n\t\t\t}\n\n\t\t\tif ( editLead && readLead ) {\n\t\t\t\toffset = $( editLead ).offset().top - ( $( readLead ).offset().top - fakeScroll );\n\t\t\t\t// Set a model range to match\n\t\t\t\teditLeadView = $( editLead ).data( 'view' );\n\t\t\t\tif ( editLeadView ) {\n\t\t\t\t\tsurface.getModel().setLinearSelection(\n\t\t\t\t\t\tnew ve.Range( editLeadView.getModel().getRange().start )\n\t\t\t\t\t);\n\t\t\t\t\tinitialCursorOffset =\n\t\t\t\t\t\tsurface.getView().getSelection().getSelectionBoundingRect().top;\n\t\t\t\t\t// Ensure the surface is tall enough to scroll the cursor into view\n\t\t\t\t\tsurface.$element.css( 'min-height', $window.height() + initialCursorOffset - surface.padding.top );\n\t\t\t\t}\n\t\t\t\t$window.scrollTop( offset );\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tonBeforeExit: function ( exit, cancel ) {\n\t\tvar overlay = this;\n\t\tEditorOverlayBase.prototype.onBeforeExit.call( this, function () {\n\t\t\t// If this function is called, the parent method has decided that we should exit\n\t\t\texit();\n\t\t\t// VE-specific cleanup\n\t\t\toverlay.destroyTarget();\n\t\t}, cancel );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tonClickBack: function () {\n\t\tEditorOverlayBase.prototype.onClickBack.apply( this, arguments );\n\t\tthis.switchToEditor();\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tonClickAnonymous: function () {\n\t\tvar self = this;\n\t\tthis.$anonWarning.hide();\n\t\tself.$el.find( '.overlay-content' ).show();\n\t\tthis.redoTargetInit();\n\t},\n\t/**\n\t * Reveal the editing interface.\n\t *\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tswitchToEditor: function () {\n\t\tthis.showHidden( '.initial-header' );\n\t},\n\t/**\n\t * Loads an {SourceEditorOverlay} and replaces the existing {VisualEditorOverlay}\n\t *\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t * @param {jQuery.Promise} [dataPromise] Optional promise for loading content\n\t */\n\tswitchToSourceEditor: function ( dataPromise ) {\n\t\tvar self = this,\n\t\t\tSourceEditorOverlay = this.SourceEditorOverlay,\n\t\t\tnewOverlay,\n\t\t\toptions = this.getOptionsForSwitch();\n\t\tthis.log( {\n\t\t\taction: 'abort',\n\t\t\ttype: 'switchnochange',\n\t\t\tmechanism: 'navigate'\n\t\t} );\n\t\tthis.logFeatureUse( {\n\t\t\tfeature: 'editor-switch',\n\t\t\taction: 'source-mobile'\n\t\t} );\n\n\t\t// Save a user setting indicating that this user prefers using the SourceEditor\n\t\tsetPreferredEditor( 'SourceEditor' );\n\n\t\tthis.$el.addClass( 'switching' );\n\t\tthis.$el.find( '.overlay-header-container' ).hide();\n\t\tthis.$el.append( fakeToolbar() );\n\t\tthis.target.getSurface().setReadOnly( true );\n\n\t\tif ( dataPromise ) {\n\t\t\t// If switching with edits we can't stay in section editing, as a VE edit\n\t\t\t// can always affect the whole document (e.g. references)\n\t\t\toptions.sectionId = null;\n\t\t\trouter.navigateTo( document.title, {\n\t\t\t\tpath: '#/editor/all',\n\t\t\t\tuseReplaceState: true\n\t\t\t} );\n\t\t}\n\t\tnewOverlay = new SourceEditorOverlay( options, dataPromise );\n\t\tnewOverlay.getLoadingPromise().then( function () {\n\t\t\tself.switching = true;\n\t\t\tself.overlayManager.replaceCurrent( newOverlay );\n\t\t\tself.switching = false;\n\t\t} );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\tonSaveComplete: function () {\n\t\tEditorOverlayBase.prototype.onSaveComplete.apply( this, arguments );\n\t\tthis.destroyTarget();\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof VisualEditorOverlay\n\t * @instance\n\t */\n\thasChanged: function () {\n\t\tif ( this.saved ) {\n\t\t\t// If we just saved, there's not really any changes, and the\n\t\t\t// target is going to be destroyed in one tick\n\t\t\treturn false;\n\t\t}\n\t\treturn this.fromModified || (\n\t\t\tthis.target &&\n\t\t\tthis.target.getSurface() &&\n\t\t\tthis.target.getSurface().getModel().hasBeenModified()\n\t\t);\n\t}\n} );\n\nmodule.exports = VisualEditorOverlay;\n","const\n\tDrawer = require( '../mobile.startup/Drawer' ),\n\tBlockMessageDetails = require( './BlockMessageDetails' );\n\n/**\n * @typedef {Object} BlockMessageOptions\n * @property {number} blockId representing the block\n * @property {boolean} partial is this a partial block?\n * @property {Object} creator\n * @property {string} creator.name of the blocker\n * @property {string} creator.url associated with the block\n * @property {string} reason for block\n * @property {string} [duration] of block e.g. \"1 week\"\n * @property {string} [expiry] of block, wrapped in parentheses\n *  e.g. \"(1st September 2019)\"\n */\n\n/**\n * This creates the drawer at the bottom of the screen that appears when a\n * blocked user tries to edit.\n *\n * @param {BlockMessageOptions} props\n * @return {Drawer}\n */\nmodule.exports = function blockMessageDrawer( props ) {\n\tconst blockDrawer = new Drawer( {\n\t\tclassName: 'drawer block-message',\n\t\tonBeforeHide: function ( drawer ) {\n\t\t\tdrawer.$el.remove();\n\t\t},\n\t\tonShow: function () {\n\t\t\tconst $drawer = blockDrawer.$el.find( '.drawer.block-message' ),\n\t\t\t\tdrawerTop = $drawer.offset().top - 100,\n\t\t\t\tcreatorTop = blockDrawer.$el.find( '.block-message-creator' ).offset().top - 100,\n\t\t\t\tbuttonsTop = blockDrawer.$el.find( '.block-message-buttons' ).offset().top - 100,\n\t\t\t\t$seeMore = blockDrawer.$el.find( '.block-message-see-more' ),\n\t\t\t\twiki = mw.config.get( 'wgDBname' );\n\n\t\t\t$drawer.css( 'top', drawerTop + ( buttonsTop - creatorTop ) );\n\t\t\t$seeMore.on(\n\t\t\t\t'click',\n\t\t\t\tfunction () {\n\t\t\t\t\tconst $container = blockDrawer.$el.find( '.block-message-container' );\n\t\t\t\t\t$drawer.css( 'top', 0 );\n\t\t\t\t\t$container.css( 'overflow-y', 'auto' );\n\t\t\t\t\t$container.css( 'height', buttonsTop - $container.offset().top );\n\t\t\t\t\t$seeMore.hide();\n\n\t\t\t\t\tif ( mw.config.get( 'wgMFTrackBlockNotices' ) ) {\n\t\t\t\t\t\tmw.track( 'counter.MediaWiki.BlockNotices.' + wiki + '.MobileFrontend.reasonShown', 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif ( mw.config.get( 'wgMFTrackBlockNotices' ) ) {\n\t\t\t\tmw.track( 'counter.MediaWiki.BlockNotices.' + wiki + '.MobileFrontend.shown', 1 );\n\t\t\t}\n\t\t},\n\t\tchildren: [\n\t\t\t( new BlockMessageDetails( props ) ).$el\n\t\t]\n\t} );\n\treturn blockDrawer;\n};\n","/* global $ */\n/**\n * Find first paragraph that has text content, i.e. paragraphs that are not empty.\n * Keep in sync with MoveLeadParagraphTransform::identifyLeadParagraph().\n *\n * @param {jQuery} $body Where to search for paragraphs\n * @return {Node|null} The lead paragraph\n */\nmodule.exports = function identifyLeadParagraph( $body ) {\n\tvar $paragraphs, i, node;\n\n\t// Keep in sync with MoveLeadParagraphTransform::isNotEmptyNode()\n\tfunction isNotEmptyNode( node ) {\n\t\t// Ignore VE whitespace characters\n\t\treturn !/^[\\s]*$/.test( node.textContent );\n\t}\n\n\t// Keep in sync with MoveLeadParagraphTransform::isNonLeadParagraph()\n\tfunction isNonLeadParagraph( node ) {\n\t\tnode = node.cloneNode( true );\n\t\t// Ignore non-content nodes, TemplateStyles and coordinates\n\t\t$( node ).find( '.ve-ce-branchNode-inlineSlug, .ve-ce-focusableNode-invisible, style, span#coordinates' ).remove();\n\t\tif ( isNotEmptyNode( node ) ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\t$paragraphs = $body.children( 'p' );\n\tfor ( i = 0; i < $paragraphs.length; i++ ) {\n\t\tnode = $paragraphs[ i ];\n\t\tif ( !isNonLeadParagraph( node ) ) {\n\t\t\treturn node;\n\t\t}\n\t}\n\treturn null;\n};\n","var util = require( '../mobile.startup/util' );\n\n/**\n * @param {string} blockinfo\n * @return {Object}\n */\nmodule.exports = function parseBlockInfo( blockinfo ) {\n\tconst blockInfo = {\n\t\t\tpartial: blockinfo.blockpartial || false,\n\t\t\tnoCreateAccount: blockinfo.blocknocreate || false,\n\t\t\tanonOnly: blockinfo.blockanononly === undefined ? true : blockinfo.blockanononly,\n\t\t\tcreator: {\n\t\t\t\tname: blockinfo.blockedby,\n\t\t\t\turl: null\n\t\t\t},\n\t\t\texpiry: null,\n\t\t\tduration: null,\n\t\t\treason: '',\n\t\t\tblockId: blockinfo.blockid\n\t\t},\n\t\texpiry = blockinfo.blockexpiry,\n\t\treason = blockinfo.blockreason,\n\t\tmoment = window.moment;\n\n\t// Workaround to parse a message parameter for mw.message, see T96885\n\tfunction jqueryMsgParse( wikitext ) {\n\t\t// eslint-disable-next-line new-cap\n\t\tconst parser = new mw.jqueryMsg.parser();\n\t\ttry {\n\t\t\tconst ast = parser.wikiTextToAst( wikitext );\n\t\t\treturn parser.emitter.emit( ast ).html();\n\t\t} catch ( e ) {\n\t\t\t// Ignore error as it's probably the parser error. Usually this is because we\n\t\t\t// can't parse templates.\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t// URL only useful if block creator is a local user\n\tif ( blockinfo.blockedbyid === 0 ) {\n\t\tblockInfo.creator.url = '';\n\t} else {\n\t\tblockInfo.creator.url = mw.Title.makeTitle(\n\t\t\tmw.config.get( 'wgNamespaceIds' ).user,\n\t\t\tblockInfo.creator.name\n\t\t).getUrl();\n\t}\n\n\tif ( [ 'infinite', 'indefinite', 'infinity', 'never' ].indexOf( expiry ) === -1 && moment ) {\n\t\tif ( moment( expiry ).diff( moment(), 'seconds' ) <= 86400 ) {\n\t\t\t// For 24 hour blocks/or remaining expiry time and less, show both date and time\n\t\t\tblockInfo.expiry = mw.message( 'parentheses', moment( expiry ).format( 'LL, LT' ) ).escaped();\n\t\t} else {\n\t\t\tblockInfo.expiry = mw.message( 'parentheses', moment( expiry ).format( 'LL' ) ).escaped();\n\t\t}\n\t\tblockInfo.duration = moment().to( expiry, true );\n\t}\n\n\tif ( reason ) {\n\t\tblockInfo.reason = jqueryMsgParse( reason ) || mw.html.escape( reason );\n\t\tblockInfo.parsedReason = ( new mw.Api() ).get( {\n\t\t\taction: 'parse',\n\t\t\tformatversion: 2,\n\t\t\ttext: reason,\n\t\t\tcontentmodel: 'wikitext'\n\t\t} ).then( function ( result ) {\n\t\t\treturn result.parse.text;\n\t\t} ).catch( function () {\n\t\t\treturn jqueryMsgParse( reason ) || mw.html.escape( reason );\n\t\t} );\n\t} else {\n\t\tblockInfo.reason = mw.message( 'mobile-frontend-editor-generic-block-reason' ).escaped();\n\t\tblockInfo.parsedReason = util.Deferred().resolve( blockInfo.reason ).promise();\n\t}\n\n\treturn blockInfo;\n};\n","/**\n * Build a save failure message from the API response\n *\n * @param {Object} data API response\n * @return {string} message HTML text describing the failure for display to the user\n */\nmodule.exports = function saveFailureMessage( data ) {\n\t// In most cases, return the error message from the API directly.\n\t// Handle a few exceptions where it is unsuitable for end-users\n\t// (some error messages are seemingly intended for tool developers).\n\n\tvar code = data && data.errors && data.errors[0] && data.errors[0].code;\n\n\tif ( code === 'editconflict' ) {\n\t\treturn mw.msg( 'mobile-frontend-editor-error-conflict' );\n\t}\n\n\tif ( code === 'readonly' ) {\n\t\treturn data.errors[0].html + '<br>' + data.errors[0].data.readonlyreason;\n\t}\n\n\tif ( data.errors && data.errors[0] ) {\n\t\treturn data.errors[0].html;\n\t}\n\n\t// This probably indicates a connection problem and a \"fake\" response\n\t// generated by mediawiki.Api. TODO Give a better error message here.\n\treturn '';\n};\n","/**\n * Store the user's preferred editor\n *\n * @param {string} editor 'VisualEditor' or 'SourceEditor'\n */\nmodule.exports = function setPreferredEditor( editor ) {\n\tif ( !mw.user.isAnon() ) {\n\t\tnew mw.Api().saveOption( 'mobile-editor', editor ).then( function () {\n\t\t\tmw.user.options.set( 'mobile-editor', editor );\n\t\t} );\n\t} else {\n\t\tmw.storage.set( 'preferredEditor', editor );\n\t}\n};\n","var\n\tfakeToolbar = require( './fakeToolbar' ),\n\tOverlay = require( '../mobile.startup/Overlay' );\n\n/**\n * Like loadingOverlay(), but with a fake editor toolbar instead of the spinner.\n *\n * @param {Function} afterShow Callback which runs after overlay is shown\n * @param {Function} afterHide Callback which runs after overlay is hidden\n * @return {Overlay}\n */\nfunction editorLoadingOverlay( afterShow, afterHide ) {\n\tvar\n\t\t$fakeToolbar = fakeToolbar(),\n\t\toverlay = new Overlay( {\n\t\t\tclassName: 'overlay overlay-loading',\n\t\t\tnoHeader: true,\n\t\t\tisBorderBox: false,\n\t\t\tonBeforeExit: function ( exit ) {\n\t\t\t\texit();\n\t\t\t\tafterHide();\n\t\t\t}\n\t\t} );\n\n\toverlay.show = function () {\n\t\tOverlay.prototype.show.call( this );\n\t\tafterShow();\n\t};\n\n\t$fakeToolbar.appendTo( overlay.$el.find( '.overlay-content' ) );\n\n\t// Animate the toolbar sliding into place.\n\t$fakeToolbar.addClass( 'toolbar-hidden' );\n\tsetTimeout( function () {\n\t\t$fakeToolbar.addClass( 'toolbar-shown' );\n\t\tsetTimeout( function () {\n\t\t\t$fakeToolbar.addClass( 'toolbar-shown-done' );\n\t\t}, 250 );\n\t} );\n\n\treturn overlay;\n}\n\nmodule.exports = editorLoadingOverlay;\n","const icons = require( '../mobile.startup/icons' );\n\n/* global $ */\nmodule.exports = function fakeToolbar() {\n\tvar $fakeToolbar, $goBack, $loadingMessage;\n\n\t$goBack = icons.cancel( null, {\n\t\ttagName: 'a'\n\t} ).$el.attr( 'tabindex', '0' )\n\t\t.attr( 'role', 'button' );\n\n\t$loadingMessage = icons.spinner( {\n\t\ttagName: 'span',\n\t\thasText: true,\n\t\tadditionalClassNames: '',\n\t\tlabel: mw.msg( 'mobile-frontend-editor-loading' )\n\t} ).$el;\n\n\t// Wrappers similar to .overlay-header-container, .overlay-header and .oo-ui-toolbar\n\t$fakeToolbar = $( '<div>' )\n\t\t.addClass( 've-mobile-fakeToolbar-container' )\n\t\t.append( $( '<div>' )\n\t\t\t.addClass( 've-mobile-fakeToolbar-header' )\n\t\t\t// Minerva has some complicated styling for this class, so we have to include it\n\t\t\t.addClass( 'header' )\n\t\t\t.append( $( '<div>' )\n\t\t\t\t.addClass( 've-mobile-fakeToolbar' )\n\t\t\t\t.append( $goBack, $loadingMessage )\n\t\t\t)\n\t\t);\n\n\treturn $fakeToolbar;\n};\n","const\n\tView = require( '../mobile.startup/View' ),\n\tutil = require( '../mobile.startup/util' ),\n\tlangUtil = require( './util' ),\n\tmfExtend = require( '../mobile.startup/mfExtend' );\n\n/**\n * Overlay displaying a structured list of languages for a page\n *\n * @class LanguageSearcher\n * @extends View\n *\n * @param {Object} props Configuration options\n * @param {Object[]} props.languages list of language objects as returned by the API\n * @param {Array|boolean} props.variants language variant objects\n *  or false if no variants exist\n * @param {boolean} props.showSuggestedLanguages If the suggested languages\n *  section should be rendered.\n * @param {string} [props.deviceLanguage] the device's primary language\n */\nfunction LanguageSearcher( props ) {\n\t/**\n\t * @prop {StructuredLanguages} languages` JSDoc.\n\t */\n\tconst languages = langUtil.getStructuredLanguages(\n\t\tprops.languages,\n\t\tprops.variants,\n\t\tlangUtil.getFrequentlyUsedLanguages(),\n\t\tprops.showSuggestedLanguages,\n\t\tprops.deviceLanguage\n\t);\n\n\tView.call(\n\t\tthis,\n\t\tutil.extend(\n\t\t\t{\n\t\t\t\tclassName: 'language-searcher',\n\t\t\t\tevents: {\n\t\t\t\t\t'click a': 'onLinkClick',\n\t\t\t\t\t'input .search': 'onSearchInput'\n\t\t\t\t},\n\t\t\t\t// the rest are template properties\n\t\t\t\tinputPlaceholder: mw.msg( 'mobile-frontend-languages-structured-overlay-search-input-placeholder' ),\n\t\t\t\t// we can't rely on CSS only to uppercase the headings. See https://stackoverflow.com/questions/3777443/css-text-transform-not-working-properly-for-turkish-characters\n\t\t\t\tallLanguagesHeader: mw.msg( 'mobile-frontend-languages-structured-overlay-all-languages-header' ).toLocaleUpperCase(),\n\t\t\t\tsuggestedLanguagesHeader: mw.msg( 'mobile-frontend-languages-structured-overlay-suggested-languages-header' ).toLocaleUpperCase(),\n\t\t\t\tallLanguages: languages.all,\n\t\t\t\tallLanguagesCount: languages.all.length,\n\t\t\t\tsuggestedLanguages: languages.suggested,\n\t\t\t\tsuggestedLanguagesCount: languages.suggested.length\n\t\t\t},\n\t\t\tprops\n\t\t)\n\t);\n}\n\nmfExtend( LanguageSearcher, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof LanguageSearcher\n\t * @instance\n\t */\n\ttemplate: util.template( `\n<div class=\"panel\">\n\t<div class=\"panel-body search-box\">\n\t\t<input type=\"search\" class=\"search\" placeholder=\"{{inputPlaceholder}}\">\n\t</div>\n</div>\n\n<div class=\"overlay-content-body\">\n\t{{#suggestedLanguagesCount}}\n\t<h3 class=\"list-header\">{{suggestedLanguagesHeader}}</h3>\n\t<ol class=\"site-link-list suggested-languages\">\n\t\t{{#suggestedLanguages}}\n\t\t\t<li>\n\t\t\t\t<a href=\"{{url}}\" class=\"{{lang}}\" hreflang=\"{{lang}}\" lang=\"{{lang}}\" dir=\"{{dir}}\">\n\t\t\t\t\t<span class=\"autonym\">{{autonym}}</span>\n\t\t\t\t\t{{#title}}\n\t\t\t\t\t\t<span class=\"title\">{{title}}</span>\n\t\t\t\t\t{{/title}}\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t{{/suggestedLanguages}}\n\t</ol>\n\t{{/suggestedLanguagesCount}}\n\n\t{{#allLanguagesCount}}\n\t<h3 class=\"list-header\">{{allLanguagesHeader}} ({{allLanguagesCount}})</h3>\n\t<ul class=\"site-link-list all-languages\">\n\t\t{{#allLanguages}}\n\t\t\t<li>\n\t\t\t\t<a href=\"{{url}}\" class=\"{{lang}}\" hreflang=\"{{lang}}\" lang=\"{{lang}}\" dir=\"{{dir}}\">\n\t\t\t\t\t<span class=\"autonym\">{{autonym}}</span>\n\t\t\t\t\t{{#title}}\n\t\t\t\t\t\t<span class=\"title\">{{title}}</span>\n\t\t\t\t\t{{/title}}\n\t\t\t\t</a>\n\t\t\t</li>\n\t\t{{/allLanguages}}\n\t</ul>\n\t{{/allLanguagesCount}}\n</div>\n\t` ),\n\t/**\n\t * @inheritdoc\n\t * @memberof LanguageSearcher\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\t// cache\n\t\tthis.$siteLinksList = this.$el.find( '.site-link-list' );\n\t\tthis.$languageItems = this.$siteLinksList.find( 'a' );\n\t\tthis.$subheaders = this.$el.find( 'h3' );\n\t},\n\t/**\n\t * Article link click event handler\n\t *\n\t * @memberof LanguageSearcher\n\t * @instance\n\t * @param {jQuery.Event} ev\n\t */\n\tonLinkClick: function ( ev ) {\n\t\tconst $link = this.$el.find( ev.currentTarget ),\n\t\t\tlang = $link.attr( 'lang' );\n\n\t\tmw.hook( 'mobileFrontend.languageSearcher.linkClick' ).fire( lang );\n\t\tlangUtil.saveLanguageUsageCount( lang, langUtil.getFrequentlyUsedLanguages() );\n\t},\n\t/**\n\t * Search input handler\n\t *\n\t * @memberof LanguageSearcher\n\t * @instance\n\t * @param {jQuery.Event} ev Event object.\n\t */\n\tonSearchInput: function ( ev ) {\n\t\tthis.filterLanguages( this.$el.find( ev.target ).val().toLowerCase() );\n\t},\n\t/**\n\t * Filter the language list to only show languages that match the current search term.\n\t *\n\t * @memberof LanguageSearcher\n\t * @instance\n\t * @param {string} val of search term (lowercase).\n\t */\n\tfilterLanguages: function ( val ) {\n\t\tconst filteredList = [];\n\n\t\tif ( val ) {\n\t\t\tthis.options.languages.forEach( function ( language ) {\n\t\t\t\tconst langname = language.langname;\n\t\t\t\t// search by language code or language name\n\t\t\t\tif ( language.autonym.toLowerCase().indexOf( val ) > -1 ||\n\t\t\t\t\t\t( langname && langname.toLowerCase().indexOf( val ) > -1 ) ||\n\t\t\t\t\t\tlanguage.lang.toLowerCase().indexOf( val ) > -1\n\t\t\t\t) {\n\t\t\t\t\tfilteredList.push( language.lang );\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tif ( this.options.variants ) {\n\t\t\t\tthis.options.variants.forEach( function ( variant ) {\n\t\t\t\t\t// search by variant code or variant name\n\t\t\t\t\tif ( variant.autonym.toLowerCase().indexOf( val ) > -1 ||\n\t\t\t\t\t\tvariant.lang.toLowerCase().indexOf( val ) > -1\n\t\t\t\t\t) {\n\t\t\t\t\t\tfilteredList.push( variant.lang );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\tthis.$languageItems.addClass( 'hidden' );\n\t\t\tif ( filteredList.length ) {\n\t\t\t\tthis.$siteLinksList.find( '.' + filteredList.join( ',.' ) ).removeClass( 'hidden' );\n\t\t\t}\n\t\t\tthis.$siteLinksList.addClass( 'filtered' );\n\t\t\tthis.$subheaders.addClass( 'hidden' );\n\t\t} else {\n\t\t\tthis.$languageItems.removeClass( 'hidden' );\n\t\t\tthis.$siteLinksList.removeClass( 'filtered' );\n\t\t\tthis.$subheaders.removeClass( 'hidden' );\n\t\t}\n\t}\n} );\n\nmodule.exports = LanguageSearcher;\n","module.exports = [\n\t'aeb',\n\t'aeb-arab',\n\t'ar',\n\t'arc',\n\t'arq',\n\t'arz',\n\t'azb',\n\t'bcc',\n\t'bgn',\n\t'bqi',\n\t'ckb',\n\t'dv',\n\t'fa',\n\t'glk',\n\t'he',\n\t'khw',\n\t'kk-arab',\n\t'kk-cn',\n\t'ks',\n\t'ks-arab',\n\t'ku-arab',\n\t'lki',\n\t'lrc',\n\t'luz',\n\t'mzn',\n\t'nqo',\n\t'pnb',\n\t'ps',\n\t'sd',\n\t'sdh',\n\t'skr',\n\t'skr-arab',\n\t'ug',\n\t'ug-arab',\n\t'ur',\n\t'yi'\n];\n","var\n\tlog = mw.log,\n\tmfUtils = require( '../mobile.startup/util' ),\n\trtlLanguages = require( './rtlLanguages' );\n\n/**\n * @typedef {Object} Language\n * @prop {string} autonym of language e.g. franais\n * @prop {string} langname in the user's current language e.g French\n * @prop {string} title of the page in the language e.g. Espagne\n * @prop {string} dir (rtl or ltr)\n * @prop {string} url of the page\n *\n * @typedef {Object} SuggestedLanguage\n * @prop {string} autonym of language e.g. franais\n * @prop {string} langname in the user's current language e.g French\n * @prop {string} title of the page in the language e.g. Espagne\n * @prop {string} dir (rtl or ltr)\n * @prop {string} url of the page\n * @prop {number} frequency of times the language has been used by the given user\n *\n * @typedef {Object} StructuredLanguages\n * @prop {Language[]} all languages that are available\n * @prop {SuggestedLanguage[]} suggested languages based on users browsing history\n */\n\n/**\n * Return the device language if it's in the list of article languages.\n * If the language is a variant of a general language, and if the article\n * is not available in that language, then return the general language\n * if article is available in it. For example, if the device language is\n * 'en-gb', and the article is only available in 'en', then return 'en'.\n *\n * @param {Object[]} languages list of language objects as returned by the API\n * @param {string|undefined} deviceLanguage the device's primary language\n * @return {string|undefined} Return undefined if the article is not available in\n *  the (general or variant) device language\n */\nfunction getDeviceLanguageOrParent( languages, deviceLanguage ) {\n\tvar parentLanguage, index,\n\t\thasOwn = Object.prototype.hasOwnProperty,\n\t\tdeviceLanguagesWithVariants = {};\n\n\tif ( !deviceLanguage ) {\n\t\treturn;\n\t}\n\n\t// Are we dealing with a variant?\n\tindex = deviceLanguage.indexOf( '-' );\n\tif ( index !== -1 ) {\n\t\tparentLanguage = deviceLanguage.slice( 0, index );\n\t}\n\n\tlanguages.forEach( function ( language ) {\n\t\tif ( language.lang === parentLanguage || language.lang === deviceLanguage ) {\n\t\t\tdeviceLanguagesWithVariants[ language.lang ] = true;\n\t\t}\n\t} );\n\n\tif ( hasOwn.call( deviceLanguagesWithVariants, deviceLanguage ) ) {\n\t\t// the device language is one of the available languages\n\t\treturn deviceLanguage;\n\t} else if ( hasOwn.call( deviceLanguagesWithVariants, parentLanguage ) ) {\n\t\t// no device language, but the parent language is one of the available languages\n\t\treturn parentLanguage;\n\t}\n}\n\n/**\n * Utility function for the structured language overlay\n *\n * @class util\n * @singleton\n */\nmodule.exports = {\n\t/**\n\t * Determine whether a language is LTR or RTL\n\t * This works around T74153 and T189036\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {Object} language with 'lang' key.\n\t * @return {Object} language with 'lang' key and new 'dir' key.\n\t */\n\tgetDir: function ( language ) {\n\t\tvar dir = rtlLanguages.indexOf( language.lang ) > -1 ? 'rtl' : 'ltr';\n\t\treturn mfUtils.extend( {}, language, { dir: dir } );\n\t},\n\n\t/**\n\t * Return two sets of languages: suggested and all (everything else)\n\t *\n\t * Suggested languages are the ones that the user has used before. This also\n\t * includes the user device's primary language. Suggested languages are ordered\n\t * by frequency in descending order. The device's language is always at the top.\n\t * This group also includes the variants.\n\t *\n\t * All languages are the languages that are not suggested.\n\t * Languages in this list are ordered in the lexicographical order of\n\t * their language names.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {Object[]} languages list of language objects as returned by the API\n\t * @param {Array|boolean} variants language variant objects or false if no variants exist\n\t * @param {Object} frequentlyUsedLanguages list of the frequently used languages\n\t * @param {boolean} showSuggestedLanguages\n\t * @param {string} [deviceLanguage] the device's primary language\n\t * @return {StructuredLanguages}\n\t */\n\tgetStructuredLanguages: function (\n\t\tlanguages,\n\t\tvariants,\n\t\tfrequentlyUsedLanguages,\n\t\tshowSuggestedLanguages,\n\t\tdeviceLanguage\n\t) {\n\t\tvar hasOwn = Object.prototype.hasOwnProperty,\n\t\t\tmaxFrequency = 0,\n\t\t\tminFrequency = 0,\n\t\t\tmissingDir = 0,\n\t\t\tsuggestedLanguages = [],\n\t\t\tallLanguages = [],\n\t\t\tself = this;\n\n\t\t// Is the article available in the user's device language?\n\t\tdeviceLanguage = getDeviceLanguageOrParent( languages, deviceLanguage );\n\t\tif ( deviceLanguage ) {\n\t\t\tObject.keys( frequentlyUsedLanguages ).forEach( function ( language ) {\n\t\t\t\tvar frequency = frequentlyUsedLanguages[ language ];\n\t\t\t\tmaxFrequency = maxFrequency < frequency ? frequency : maxFrequency;\n\t\t\t\tminFrequency = minFrequency > frequency ? frequency : minFrequency;\n\t\t\t} );\n\n\t\t\t// Make the device language the most frequently used one so that\n\t\t\t// it appears at the top of the list when sorted by frequency.\n\t\t\tfrequentlyUsedLanguages[ deviceLanguage ] = maxFrequency + 1;\n\t\t}\n\n\t\t/**\n\t\t * @param {Object} language\n\t\t * @return {Object} which has 'dir' key.\n\t\t */\n\t\tfunction addLangDir( language ) {\n\t\t\tif ( language.dir ) {\n\t\t\t\treturn language;\n\t\t\t} else {\n\t\t\t\tmissingDir++;\n\t\t\t\treturn self.getDir( language );\n\t\t\t}\n\t\t}\n\n\t\t// Separate languages into suggested and all languages.\n\t\tif ( showSuggestedLanguages ) {\n\t\t\tlanguages.map( addLangDir ).forEach( function ( language ) {\n\t\t\t\tif ( hasOwn.call( frequentlyUsedLanguages, language.lang ) ) {\n\t\t\t\t\tlanguage.frequency = frequentlyUsedLanguages[language.lang];\n\t\t\t\t\tsuggestedLanguages.push( language );\n\t\t\t\t} else {\n\t\t\t\t\tallLanguages.push( language );\n\t\t\t\t}\n\t\t\t} );\n\t\t} else {\n\t\t\tallLanguages = languages.map( addLangDir );\n\t\t}\n\n\t\t// Add variants to the suggested languages list and assign the lowest\n\t\t// frequency because the variant hasn't been clicked on yet.\n\t\t// Note that the variants data doesn't contain the article title, thus\n\t\t// we cannot show it for the variants.\n\t\tif ( variants && showSuggestedLanguages ) {\n\t\t\tvariants.map( addLangDir ).forEach( function ( variant ) {\n\t\t\t\tif ( hasOwn.call( frequentlyUsedLanguages, variant.lang ) ) {\n\t\t\t\t\tvariant.frequency = frequentlyUsedLanguages[variant.lang];\n\t\t\t\t} else {\n\t\t\t\t\tvariant.frequency = minFrequency - 1;\n\t\t\t\t}\n\t\t\t\tsuggestedLanguages.push( variant );\n\t\t\t} );\n\t\t}\n\n\t\t// sort suggested languages in descending order by frequency\n\t\tsuggestedLanguages = suggestedLanguages.sort( function ( a, b ) {\n\t\t\treturn b.frequency - a.frequency;\n\t\t} );\n\n\t\t/**\n\t\t * Compare language names lexicographically\n\t\t *\n\t\t * @param {Object} a first language\n\t\t * @param {Object} b second language\n\t\t * @return {number} Comparison value, 1 or -1\n\t\t */\n\t\tfunction compareLanguagesByLanguageName( a, b ) {\n\t\t\treturn a.autonym.toLocaleLowerCase() < b.autonym.toLocaleLowerCase() ? -1 : 1;\n\t\t}\n\n\t\tallLanguages = allLanguages.sort( compareLanguagesByLanguageName );\n\n\t\t// This works around T74153\n\t\tlog.warn(\n\t\t\tmissingDir === 0 ? 'Direction is provided. Please remove handling in getStructuredLanguages' :\n\t\t\t\t'`dir` attribute was missing from languages. Is T74153 resolved?'\n\t\t);\n\n\t\treturn {\n\t\t\tsuggested: suggestedLanguages,\n\t\t\tall: allLanguages\n\t\t};\n\t},\n\n\t/**\n\t * Return a map of frequently used languages on the current device.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {Object}\n\t */\n\tgetFrequentlyUsedLanguages: function () {\n\t\tvar languageMap = mw.storage.get( 'langMap' );\n\n\t\treturn languageMap ? JSON.parse( languageMap ) : {};\n\t},\n\n\t/**\n\t * Save the frequently used languages to the user's device\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {Object} languageMap\n\t */\n\tsaveFrequentlyUsedLanguages: function ( languageMap ) {\n\t\tmw.storage.set( 'langMap', JSON.stringify( languageMap ) );\n\t},\n\n\t/**\n\t * Increment the current language usage by one and save it to the device.\n\t * Cap the result at 100.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {string} languageCode\n\t * @param {Object} frequentlyUsedLanguages list of the frequently used languages\n\t */\n\tsaveLanguageUsageCount: function ( languageCode, frequentlyUsedLanguages ) {\n\t\tvar count = frequentlyUsedLanguages[ languageCode ] || 0;\n\n\t\tcount += 1;\n\t\t// cap at 100 as this is enough data to work on\n\t\tfrequentlyUsedLanguages[ languageCode ] = count > 100 ? 100 : count;\n\t\tthis.saveFrequentlyUsedLanguages( frequentlyUsedLanguages );\n\t}\n};\n","var View = require( '../mobile.startup/View' ),\n\tutil = require( '../mobile.startup/util' ),\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tIcon = require( '../mobile.startup/Icon' ),\n\ticons = require( '../mobile.startup/icons' ),\n\tButton = require( '../mobile.startup/Button' ),\n\tdetailsButton = new Button( {\n\t\tlabel: mw.msg( 'mobile-frontend-media-details' ),\n\t\tadditionalClassNames: 'button',\n\t\tprogressive: true\n\t} ),\n\tslideLeftButton = new Icon( {\n\t\trotation: 90,\n\t\tname: 'expand-invert'\n\t} ),\n\tslideRightButton = new Icon( {\n\t\trotation: -90,\n\t\tname: 'expand-invert'\n\t} ),\n\tLoadErrorMessage = require( './LoadErrorMessage' ),\n\tImageGateway = require( './ImageGateway' ),\n\t// FIXME: mw.loader.require is a private function but there's no other way to get hold of\n\t// this right now using require will cause webpack to resolve it\n\t// Can be rewritten to mw.router when https://gerrit.wikimedia.org/r/#/c/mediawiki/core/+/482732 has been merged\n\trouter = mw.loader.require( 'mediawiki.router' );\n\n/**\n * Displays images in full screen overlay\n *\n * @class ImageCarousel\n * @extends View\n * @param {Object} options Configuration options\n * @param {OO.EventEmitter} options.eventBus Object used to listen for resize:throttled events\n */\nfunction ImageCarousel( options ) {\n\tthis.gateway = options.gateway || new ImageGateway( {\n\t\tapi: options.api\n\t} );\n\tthis.router = options.router || router;\n\tthis.eventBus = options.eventBus;\n\tthis.hasLoadError = false;\n\n\tView.call(\n\t\tthis,\n\t\tutil.extend(\n\t\t\t{\n\t\t\t\tclassName: 'image-carousel',\n\t\t\t\tevents: {\n\t\t\t\t\t'click .image-wrapper': 'onToggleDetails',\n\t\t\t\t\t// Click tracking for table of contents so we can see if people interact with it\n\t\t\t\t\t'click .slider-button': 'onSlide'\n\t\t\t\t}\n\t\t\t},\n\t\t\toptions\n\t\t)\n\t);\n}\n\nmfExtend( ImageCarousel, View, {\n\t/**\n\t * @memberof ImageCarousel\n\t * @instance\n\t */\n\ttemplate: util.template( `\n<button class=\"prev slider-button\"></button>\n<div class=\"main\">\n\t<div class=\"image-wrapper\">\n\t\t<div class=\"image\"></div>\n\t</div>\n\t<!-- cancel button will go here -->\n\t<div class=\"image-details\">\n\t\t<!-- details button will go here -->\n\t\t<p class=\"truncated-text\">{{caption}}</p>\n\t\t<p class=\"license\"><a href=\"#\">{{licenseLinkMsg}}</a></p>\n\t</div>\n</div>\n<button class=\"next slider-button\"></button>\n\t` ),\n\n\t/**\n\t * @memberof ImageCarousel\n\t * @instance\n\t * @mixes Overlay#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {mw.Api} defaults.api instance of API to use\n\t * @property {string} defaults.licenseLinkMsg Link to license information in media viewer.\n\t * @property {Thumbnail[]} defaults.thumbnails a list of thumbnails to browse\n\t */\n\tdefaults: util.extend( {}, View.prototype.defaults, {\n\t\tlicenseLinkMsg: mw.msg( 'mobile-frontend-media-license-link' ),\n\t\tthumbnails: []\n\t} ),\n\t/**\n\t * Event handler for slide event\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t * @param {jQuery.Event} ev\n\t */\n\tonSlide: function ( ev ) {\n\t\tvar\n\t\t\tnewImageCarousel,\n\t\t\tnextThumbnail = this.$el.find( ev.target ).closest( '.slider-button' ).data( 'thumbnail' ),\n\t\t\ttitle = nextThumbnail.options.filename;\n\n\t\tthis.router.navigateTo( null, {\n\t\t\tpath: '#/media/' + title,\n\t\t\tuseReplaceState: true\n\t\t} );\n\t\tthis.options.title = nextThumbnail.options.filename;\n\t\tnewImageCarousel = new ImageCarousel( this.options );\n\t\tthis.$el.replaceWith( newImageCarousel.$el );\n\t\tthis.$el = newImageCarousel.$el;\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof ImageCarousel\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tvar self = this;\n\t\tthis.options.thumbnails.forEach( function ( thumbnail, i ) {\n\t\t\tif ( thumbnail.getFileName() === self.options.title ) {\n\t\t\t\tself.options.caption = thumbnail.getDescription();\n\t\t\t\tself.galleryOffset = i;\n\t\t\t}\n\t\t} );\n\t},\n\t/**\n\t * Setup the next and previous images to enable the user to arrow through\n\t * all images in the set of images given in thumbs.\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t * @param {Array} thumbs A set of images, which are available\n\t * @private\n\t */\n\t_enableArrowImages: function ( thumbs ) {\n\t\tvar offset = this.galleryOffset,\n\t\t\tlastThumb, nextThumb;\n\n\t\tif ( this.galleryOffset === undefined ) {\n\t\t\t// couldn't find a suitable matching thumbnail so make\n\t\t\t// next slide start at beginning and previous slide be end\n\t\t\tlastThumb = thumbs[thumbs.length - 1];\n\t\t\tnextThumb = thumbs[0];\n\t\t} else {\n\t\t\t// identify last thumbnail\n\t\t\tlastThumb = thumbs[ offset === 0 ? thumbs.length - 1 : offset - 1 ];\n\t\t\tnextThumb = thumbs[ offset === thumbs.length - 1 ? 0 : offset + 1 ];\n\t\t}\n\n\t\tthis.$el.find( '.prev' ).data( 'thumbnail', lastThumb );\n\t\tthis.$el.find( '.next' ).data( 'thumbnail', nextThumb );\n\t},\n\t/**\n\t * Disables the possibility to arrow through all images of the page.\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t * @private\n\t */\n\t_disableArrowImages: function () {\n\t\tthis.$el.find( '.prev, .next' ).remove();\n\t},\n\n\t/**\n\t * Handler for retry event which triggers when user tries to reload overlay\n\t * after a loading error.\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t * @private\n\t */\n\t_handleRetry: function () {\n\t\t// A hacky way to simulate a reload of the overlay\n\t\tthis.router.emit( 'hashchange' );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof ImageCarousel\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar\n\t\t\t$img,\n\t\t\t$el = this.$el,\n\t\t\t$spinner = icons.spinner().$el,\n\t\t\tthumbs = this.options.thumbnails || [],\n\t\t\tself = this;\n\n\t\t/**\n\t\t * Display media load failure message\n\t\t *\n\t\t * @method\n\t\t * @ignore\n\t\t */\n\t\tfunction showLoadFailMsg() {\n\t\t\tself.hasLoadError = true;\n\n\t\t\t$spinner.hide();\n\t\t\t// hide broken image if present\n\t\t\t$el.find( '.image img' ).hide();\n\n\t\t\t// show error message if not visible already\n\t\t\tif ( $el.find( '.load-fail-msg' ).length === 0 ) {\n\t\t\t\tnew LoadErrorMessage( { retryPath: self.router.getPath() } )\n\t\t\t\t\t.on( 'retry', self._handleRetry.bind( self ) )\n\t\t\t\t\t.prependTo( $el.find( '.image' ) );\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Start image load transitions\n\t\t *\n\t\t * @method\n\t\t * @ignore\n\t\t */\n\t\tfunction addImageLoadClass() {\n\t\t\t$img.addClass( 'image-loaded' );\n\t\t}\n\n\t\tif ( thumbs.length < 2 ) {\n\t\t\tthis._disableArrowImages();\n\t\t} else {\n\t\t\tthis._enableArrowImages( thumbs );\n\t\t}\n\n\t\tthis.$details = $el.find( '.image-details' );\n\t\t$el.find( '.image' ).append( $spinner );\n\n\t\tthis.$details.prepend( detailsButton.$el );\n\n\t\tthis.gateway.getThumb( self.options.title ).then( function ( data ) {\n\t\t\tvar author, url = data.descriptionurl + '#mw-jump-to-license';\n\n\t\t\t$spinner.hide();\n\n\t\t\tself.thumbWidth = data.thumbwidth;\n\t\t\tself.thumbHeight = data.thumbheight;\n\t\t\tself.imgRatio = data.thumbwidth / data.thumbheight;\n\n\t\t\t// We need to explicitly specify document for context param as jQuery 3\n\t\t\t// will create a new document for the element if the context is\n\t\t\t// undefined. If element is appended to active document, event handlers\n\t\t\t// can fire in both the active document and new document which can cause\n\t\t\t// insidious bugs.\n\t\t\t// (https://api.jquery.com/jquery.parsehtml/#entry-longdesc)\n\t\t\t$img = self.parseHTML( '<img>', document );\n\n\t\t\t// Remove the loader when the image is loaded or display load fail\n\t\t\t// message on failure\n\t\t\t//\n\t\t\t// Error event handler must be attached before error occurs\n\t\t\t// (https://api.jquery.com/error/#entry-longdesc)\n\t\t\t//\n\t\t\t// For the load event, it is more unclear what happens cross-browser when\n\t\t\t// the image is loaded from cache. It seems that a .complete check is\n\t\t\t// needed if attaching the load event after setting the src.\n\t\t\t// (http://stackoverflow.com/questions/910727/jquery-event-for-images-loaded#comment10616132_1110094)\n\t\t\t//\n\t\t\t// However, perhaps .complete check is not needed if attaching load\n\t\t\t// event prior to setting the image src\n\t\t\t// (https://stackoverflow.com/questions/12354865/image-onload-event-and-browser-cache#answer-12355031)\n\t\t\t$img.on( 'load', addImageLoadClass ).on( 'error', showLoadFailMsg );\n\t\t\t$img.attr( 'src', data.thumburl ).attr( 'alt', self.options.caption );\n\t\t\t$el.find( '.image' ).append( $img );\n\n\t\t\tself.$details.addClass( 'is-visible' );\n\t\t\tself._positionImage();\n\t\t\t$el.find( '.image-details a' ).attr( 'href', url );\n\t\t\tif ( data.extmetadata ) {\n\t\t\t\t// Add license information\n\t\t\t\tif ( data.extmetadata.LicenseShortName ) {\n\t\t\t\t\t$el.find( '.license a' )\n\t\t\t\t\t\t.text( data.extmetadata.LicenseShortName.value )\n\t\t\t\t\t\t.attr( 'href', url );\n\t\t\t\t}\n\t\t\t\t// Add author information\n\t\t\t\tif ( data.extmetadata.Artist ) {\n\t\t\t\t\t// Strip any tags\n\t\t\t\t\tauthor = data.extmetadata.Artist.value.replace( /<.*?>/g, '' );\n\t\t\t\t\t$el.find( '.license' ).prepend( author + ' &bull; ' );\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.adjustDetails();\n\t\t}, function () {\n\t\t\t// retrieving image location failed so show load fail msg\n\t\t\tshowLoadFailMsg();\n\t\t} );\n\n\t\tthis.eventBus.on( 'resize:throttled', this._positionImage.bind( this ) );\n\t\tthis._positionImage();\n\t},\n\n\t/**\n\t * Event handler that toggles the details bar.\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t */\n\tonToggleDetails: function () {\n\t\tif ( !this.hasLoadError ) {\n\t\t\tthis.$el.find( '.cancel, .slider-button' ).toggle();\n\t\t\tthis.$details.toggle();\n\t\t\tthis._positionImage();\n\t\t}\n\t},\n\t/**\n\t * Fit the image into the window if its dimensions are bigger than the window dimensions.\n\t * Compare window width to height ratio to that of image width to height when setting\n\t * image width or height.\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t * @private\n\t */\n\t_positionImage: function () {\n\t\tvar detailsHeight, windowWidth, windowHeight, windowRatio, $img,\n\t\t\t$window = util.getWindow();\n\n\t\tthis.adjustDetails();\n\t\t// with a hidden details box we have a little bit more space, we just need to use it\n\t\t// TODO: Get visibility from the model\n\t\t// eslint-disable-next-line no-jquery/no-sizzle\n\t\tdetailsHeight = !this.$details.is( ':visible' ) ? 0 : this.$details.outerHeight();\n\t\twindowWidth = $window.width();\n\t\twindowHeight = $window.height() - detailsHeight;\n\t\twindowRatio = windowWidth / windowHeight;\n\t\t$img = this.$el.find( 'img' );\n\n\t\tif ( this.imgRatio > windowRatio ) {\n\t\t\tif ( windowWidth < this.thumbWidth ) {\n\t\t\t\t$img.css( {\n\t\t\t\t\twidth: windowWidth,\n\t\t\t\t\theight: 'auto'\n\t\t\t\t} );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( windowHeight < this.thumbHeight ) {\n\t\t\t\t$img.css( {\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t\theight: windowHeight\n\t\t\t\t} );\n\t\t\t}\n\t\t}\n\n\t\tthis.$el.find( '.image-wrapper' ).css( 'bottom', detailsHeight );\n\t\tthis.$el.find( '.slider-button.prev' ).append( slideLeftButton.$el );\n\t\tthis.$el.find( '.slider-button.next' ).append( slideRightButton.$el );\n\t},\n\n\t/**\n\t * Function to adjust the height of details section to not more than 50% of window height.\n\t *\n\t * @memberof ImageCarousel\n\t * @instance\n\t */\n\tadjustDetails: function () {\n\t\tvar windowHeight = util.getWindow().height();\n\t\tif ( this.$el.find( '.image-details' ).height() > windowHeight * 0.50 ) {\n\t\t\tthis.$el.find( '.image-details' ).css( 'max-height', windowHeight * 0.50 );\n\t\t}\n\t}\n} );\n\nmodule.exports = ImageCarousel;\n","var sizeBuckets = [ 320, 640, 800, 1024, 1280, 1920, 2560, 2880 ],\n\tactionParams = require( './../mobile.startup/actionParams' ),\n\tutil = require( './../mobile.startup/util' );\n\n/**\n * Gets the first size larger than or equal to the provided size\n *\n * @memberof ImageGateway\n * @param {number} size\n * @return {number}\n */\nfunction findSizeBucket( size ) {\n\tvar i = 0;\n\twhile ( size > sizeBuckets[i] && i < sizeBuckets.length - 1 ) {\n\t\t++i;\n\t}\n\treturn sizeBuckets[i];\n}\n\n/**\n * API for retrieving image thumbnails for a given page\n *\n * @class ImageGateway\n *\n * @param {Object} options Configuration options\n * @cfg {mw.Api} options.api\n */\nfunction ImageGateway( options ) {\n\tthis._cache = {};\n\tthis.api = options.api;\n}\n/**\n * Get thumbnail via the API and cache it. Return the result from the cache if exists.\n *\n * @param {string} title Url of image\n * @return {jQuery.Deferred} with the image info\n */\nImageGateway.prototype.getThumb = function ( title ) {\n\tvar cachedThumb = this._cache[title],\n\t\t$window = util.getWindow(),\n\t\timageSizeMultiplier = ( window.devicePixelRatio && window.devicePixelRatio > 1 ) ?\n\t\t\twindow.devicePixelRatio : 1;\n\n\tif ( !cachedThumb ) {\n\t\tthis._cache[title] = this.api.get( actionParams( {\n\t\t\tprop: 'imageinfo',\n\t\t\ttitles: title,\n\t\t\tiiprop: [ 'url', 'extmetadata' ],\n\t\t\t// request an image devicePixelRatio times bigger than the reported screen size\n\t\t\t// for retina displays and zooming\n\t\t\tiiurlwidth: findSizeBucket( $window.width() * imageSizeMultiplier ),\n\t\t\tiiurlheight: findSizeBucket( $window.height() * imageSizeMultiplier )\n\t\t} ) ).then( function ( resp ) {\n\t\t\t// imageinfo is undefined for missing pages.\n\t\t\tif ( resp.query && resp.query.pages &&\n\t\t\t\tresp.query.pages[0] && resp.query.pages[0].imageinfo ) {\n\t\t\t\treturn resp.query.pages[0].imageinfo[0];\n\t\t\t}\n\t\t\tthrow new Error( 'The API failed to return any pages matching the titles.' );\n\t\t} );\n\t}\n\n\treturn this._cache[title];\n};\n\nImageGateway._findSizeBucket = findSizeBucket;\nmodule.exports = ImageGateway;\n","var util = require( './../mobile.startup/util' ),\n\tmfExtend = require( './../mobile.startup/mfExtend' ),\n\ticons = require( './../mobile.startup/icons' ),\n\tView = require( './../mobile.startup/View' );\n\n/**\n * Shows the user a load failure message\n *\n * @class LoadErrorMessage\n * @extends View\n * @fires LoadErrorMessage#retry\n *\n * @param {Object} options Configuration options\n * @param {string} options.retryPath path of URL to try again\n */\nfunction LoadErrorMessage( options ) {\n\tView.call(\n\t\tthis,\n\t\t{ events: { 'click .load-fail-msg-link a': 'onRetry' } },\n\t\toptions\n\t);\n}\n\nmfExtend( LoadErrorMessage, View, {\n\ttemplate: util.template( `\n<div class=\"load-fail-msg\">\n  <div class=\"load-fail-msg-text\">{{msgToUser}}</div>\n  <div class=\"load-fail-msg-link\">\n    <a href=\"#\">{{retryTxt}}</a>\n  </div>\n</div>\n\t` ),\n\tisTemplateMode: true,\n\n\t/**\n\t\t* @inheritdoc\n\t\t* @cfg {Object} defaults Default options hash.\n\t\t* @cfg {string} defaults.icon HTML of the alert icon\n\t\t* @cfg {string} defaults.msgToUser Message shown when media load fails\n\t\t* @cfg {string} defaults.retryTxt Text of retry link\n\t\t* @memberof LoadErrorMessage\n\t\t* @instance\n\t\t*/\n\tdefaults: util.extend( {}, LoadErrorMessage.prototype.defaults, {\n\t\tmsgToUser: mw.msg( 'mobile-frontend-media-load-fail-message' ),\n\t\tretryTxt: mw.msg( 'mobile-frontend-media-load-fail-retry' )\n\t} ),\n\n\t/**\n\t * @inheritdoc\n\t * @memberof LoadErrorMessage\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.$el.prepend( icons.error().$el );\n\t\tthis.$el.find( '.load-fail-msg-link a' ).attr( 'href', '#' + this.options.retryPath );\n\t},\n\n\t/**\n\t * Event handler for retry event\n\t *\n\t * @param {jQuery.Event} ev\n\t * @return {boolean} Returns false to prevent default behavior for links and\n\t * stop the event from propagating\n\t * @memberof LoadErrorMessage\n\t * @instance\n\t */\n\tonRetry: function () {\n\t\t/**\n\t\t * Triggered when retry button is clicked.\n\t\t *\n\t\t * @event LoadErrorMessage#retry\n\t\t */\n\t\tthis.emit( 'retry' );\n\n\t\treturn false;\n\t}\n} );\n\nmodule.exports = LoadErrorMessage;\n","var limit = 50,\n\tpageJSONParser = require( '../mobile.startup/page/pageJSONParser' ),\n\tns = mw.config.get( 'wgContentNamespaces' ),\n\tutil = require( '../mobile.startup/util' ),\n\textendSearchParams = require( '../mobile.startup/extendSearchParams' );\n\n/**\n * API for retrieving nearby pages\n *\n * @class NearbyGateway\n * @param {Object} options Configuration options\n * @param {mw.Api} options.api\n */\nfunction NearbyGateway( options ) {\n\tthis.api = options.api;\n}\n\nNearbyGateway.prototype = {\n\t/**\n\t * Returns a human readable string stating the distance in meters or kilometers\n\t * depending on size.\n\t *\n\t * @memberof NearbyGateway\n\t * @instance\n\t * @private\n\t * @param {number} d The distance in meters.\n\t * @return {string} message stating how far the user is from the point of interest.\n\t */\n\t_distanceMessage: function ( d ) {\n\t\tif ( d < 1 ) {\n\t\t\td *= 100;\n\t\t\td = Math.ceil( d ) * 10;\n\t\t\tif ( d === 1000 ) {\n\t\t\t\td = 1;\n\t\t\t} else {\n\t\t\t\treturn mw.msg( 'mobile-frontend-nearby-distance-meters', mw.language.convertNumber( d ) );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( d > 2 ) {\n\t\t\t\td *= 10;\n\t\t\t\td = Math.ceil( d ) / 10;\n\t\t\t\td = d.toFixed( 1 );\n\t\t\t} else {\n\t\t\t\td *= 100;\n\t\t\t\td = Math.ceil( d ) / 100;\n\t\t\t\td = d.toFixed( 2 );\n\t\t\t}\n\t\t}\n\t\treturn mw.msg( 'mobile-frontend-nearby-distance', mw.language.convertNumber( d ) );\n\t},\n\t/**\n\t * Returns a list of pages around a given point\n\t *\n\t * @memberof NearbyGateway\n\t * @instance\n\t * @param {Object} coords In form { latitude: 0, longitude: 2 }\n\t * @param {number} range Number of meters to perform a geosearch for\n\t * @param {string} exclude Name of a title to exclude from the list of results\n\t * @return {jQuery.Deferred} Object taking list of pages as argument\n\t */\n\tgetPages: function ( coords, range, exclude ) {\n\t\treturn this._search( {\n\t\t\tggscoord: [ coords.latitude, coords.longitude ]\n\t\t}, range, exclude );\n\t},\n\n\t/**\n\t * Gets the pages around a page. It excludes itself from the search\n\t *\n\t * @memberof NearbyGateway\n\t * @instance\n\t * @param {string} page Page title like \"W_San_Francisco\"\n\t * @param {number} range Number of meters to perform a geosearch for\n\t * @return {jQuery.Deferred} Object taking list of pages as argument\n\t */\n\tgetPagesAroundPage: function ( page, range ) {\n\t\treturn this._search( {\n\t\t\tggspage: page\n\t\t}, range, page );\n\t},\n\n\t/**\n\t * Searches for pages nearby\n\t *\n\t * @memberof NearbyGateway\n\t * @instance\n\t * @private\n\t * @param {Object} params Parameters to use for searching\n\t * @param {number} range Number of meters to perform a geosearch for\n\t * @param {string} [exclude] Name of a title to exclude from the list of results\n\t * @return {jQuery.Deferred} Object taking list of pages as argument\n\t */\n\t_search: function ( params, range, exclude ) {\n\t\tvar requestParams,\n\t\t\td = util.Deferred(),\n\t\t\tself = this;\n\n\t\trequestParams = extendSearchParams( 'nearby', {\n\t\t\tcolimit: 'max',\n\t\t\tprop: [ 'coordinates' ],\n\t\t\tgenerator: 'geosearch',\n\t\t\tggsradius: range,\n\t\t\tggsnamespace: ns,\n\t\t\tggslimit: limit\n\t\t}, params );\n\n\t\tif ( params.ggscoord ) {\n\t\t\trequestParams.codistancefrompoint = params.ggscoord;\n\t\t} else if ( params.ggspage ) {\n\t\t\trequestParams.codistancefrompage = params.ggspage;\n\t\t}\n\n\t\tthis.api.ajax( requestParams ).then( function ( resp ) {\n\t\t\tvar pages;\n\n\t\t\t// resp.query.pages is an Array<Page> instead of a map like in other\n\t\t\t// API requests\n\t\t\tif ( resp.query ) {\n\t\t\t\tpages = resp.query.pages || [];\n\t\t\t} else {\n\t\t\t\tpages = [];\n\t\t\t}\n\n\t\t\tpages = pages.map( function ( page, i ) {\n\t\t\t\tvar coords, p;\n\t\t\t\tp = pageJSONParser.parse( page );\n\t\t\t\tp.anchor = 'item_' + i;\n\n\t\t\t\t// protect against declined bug T49133\n\t\t\t\tif ( page.coordinates ) {\n\t\t\t\t\tcoords = page.coordinates[0];\n\t\t\t\t\t// FIXME: Make part of the Page object\n\t\t\t\t\tp.dist = coords.dist / 1000;\n\t\t\t\t\tp.latitude = coords.lat;\n\t\t\t\t\tp.longitude = coords.lon;\n\t\t\t\t\tp.proximity = self._distanceMessage( p.dist );\n\t\t\t\t} else {\n\t\t\t\t\tp.dist = 0;\n\t\t\t\t}\n\t\t\t\tif ( exclude !== page.title ) {\n\t\t\t\t\treturn p;\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} ).filter( function ( page ) { return !!page; } );\n\n\t\t\tpages.sort( function ( a, b ) {\n\t\t\t\treturn a.dist > b.dist ? 1 : -1;\n\t\t\t} );\n\t\t\tif ( pages.length === 0 ) {\n\t\t\t\td.reject( 'empty' );\n\t\t\t} else {\n\t\t\t\td.resolve( pages );\n\t\t\t}\n\t\t}, function ( error ) {\n\t\t\td.reject( error );\n\t\t} );\n\t\treturn d;\n\t}\n};\n\nmodule.exports = NearbyGateway;\n","var\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tPageList = require( '../mobile.startup/PageList' ),\n\tWatchstarPageList = require( '../mobile.startup/watchstar/WatchstarPageList' ),\n\tScrollEndEventEmitter = require( '../mobile.startup/ScrollEndEventEmitter' ),\n\tutil = require( '../mobile.startup/util' ),\n\tWatchListGateway = require( './WatchListGateway' );\n\n/**\n * An extension of the WatchstarPageList which preloads pages as all being\n * watched.\n *\n * @extends WatchstarPageList\n * @class WatchList\n * @uses ScrollEndEventEmitter\n *\n * @fires watched\n * @fires watch\n * @param {Object} params Configuration options\n * @param {OO.EventEmitter} params.eventBus Object used to listen for scroll:throttled events\n */\nfunction WatchList( params ) {\n\tvar lastTitle,\n\t\toptions = util.extend( {}, {\n\t\t\tisBorderBox: false\n\t\t}, params );\n\n\t// Set up infinite scroll helper and listen to events\n\tthis.scrollEndEventEmitter = new ScrollEndEventEmitter( options.eventBus );\n\tthis.scrollEndEventEmitter.on( ScrollEndEventEmitter.EVENT_SCROLL_END,\n\t\tthis._loadPages.bind( this ) );\n\n\tif ( options.el ) {\n\t\tlastTitle = this.getLastTitle( options.el );\n\t}\n\tthis.gateway = new WatchListGateway( options.api, lastTitle );\n\n\tWatchstarPageList.call( this, options );\n}\n\nmfExtend( WatchList, WatchstarPageList, {\n\t/**\n\t * @inheritdoc\n\t * @memberof WatchList\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\t// The DOM will be modified. Prevent any false scroll end events from\n\t\t// being emitted.\n\t\tthis.scrollEndEventEmitter.disable();\n\t\tthis.scrollEndEventEmitter.setElement( this.$el );\n\t},\n\t/**\n\t * Also sets a watch uploads funnel.\n\t *\n\t * @inheritdoc\n\t * @memberof WatchList\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar\n\t\t\t$items,\n\t\t\tstatuses;\n\n\t\t// Skip a level from WatchstarPageList directly to PageList.\n\t\tPageList.prototype.postRender.apply( this );\n\n\t\t$items = this.queryUnitializedItems();\n\n\t\t// WatchList requests list of watched pages. The list contains only\n\t\t// watched pages so it's safe to transform the title map to a status map\n\t\t// with each entry marked watched (true).\n\t\tstatuses = Object.keys( this.parsePagesFromItems( $items ) )\n\t\t\t.reduce( function ( statuses, title ) {\n\t\t\t\tstatuses[ title ] = true;\n\t\t\t\treturn statuses;\n\t\t\t}, {} );\n\t\tthis.renderItems( $items, statuses );\n\n\t\t// The list has been extended. Re-enable scroll end events.\n\t\tthis.scrollEndEventEmitter.enable();\n\t},\n\n\t/**\n\t * Loads pages from the api and triggers render.\n\t * Infinite scroll is re-enabled in postRender.\n\t *\n\t * @memberof WatchList\n\t * @instance\n\t */\n\t_loadPages: function () {\n\t\tthis.gateway.loadWatchlist().then( function ( pages ) {\n\t\t\tpages.forEach( function ( page ) {\n\t\t\t\tthis.appendPage( page );\n\t\t\t}.bind( this ) );\n\t\t\tthis.render();\n\t\t}.bind( this ) );\n\t},\n\n\t/**\n\t * Appends a list item\n\t *\n\t * @memberof WatchList\n\t * @instance\n\t * @param {Page} page\n\t */\n\tappendPage: function ( page ) {\n\t\t// wikidata descriptions should not show in this view.\n\t\tvar templateOptions = util.extend( {}, page, {\n\t\t\twikidataDescription: undefined\n\t\t} );\n\t\tthis.$el.append( this.templatePartials.item.render( templateOptions ) );\n\t},\n\n\t/**\n\t * Get the last title from the rendered HTML.\n\t * Used for initializing the API\n\t *\n\t * @memberof WatchList\n\t * @instance\n\t * @param {jQuery.Object} $el Dom element of the list\n\t * @return {string}\n\t */\n\tgetLastTitle: function ( $el ) {\n\t\treturn $el.find( 'li' ).last().attr( 'title' );\n\t}\n} );\n\nmodule.exports = WatchList;\n","var\n\tpageJSONParser = require( '../mobile.startup/page/pageJSONParser' ),\n\tutil = require( '../mobile.startup/util' ),\n\textendSearchParams = require( '../mobile.startup/extendSearchParams' );\n\n/**\n * @class WatchListGateway\n * @param {mw.Api} api\n * @param {string} lastTitle of page listed in Watchlist to be used as a continuation parameter\n */\nfunction WatchListGateway( api, lastTitle ) {\n\tthis.api = api;\n\t// Try to keep it in sync with SpecialMobileWatchlist::LIMIT (php)\n\tthis.limit = 50;\n\n\tif ( lastTitle ) {\n\t\tthis.continueParams = {\n\t\t\tcontinue: 'gwrcontinue||',\n\t\t\tgwrcontinue: '0|' + lastTitle.replace( / /g, '_' )\n\t\t};\n\t\tthis.shouldSkipFirstTitle = true;\n\t} else {\n\t\tthis.continueParams = {\n\t\t\tcontinue: ''\n\t\t};\n\t\tthis.shouldSkipFirstTitle = false;\n\t}\n\n\tthis.canContinue = true;\n}\n\nWatchListGateway.prototype = {\n\t/**\n\t * Load the list of items on the watchlist\n\t *\n\t * @return {jQuery.Deferred}\n\t */\n\tloadWatchlist: function () {\n\t\tvar self = this,\n\t\t\tparams = extendSearchParams( 'watchlist', {\n\t\t\t\tprop: [ 'info', 'revisions' ],\n\t\t\t\trvprop: 'timestamp|user',\n\t\t\t\tgenerator: 'watchlistraw',\n\t\t\t\tgwrnamespace: '0',\n\t\t\t\tgwrlimit: this.limit\n\t\t\t}, this.continueParams );\n\n\t\tif ( this.canContinue === false ) {\n\t\t\treturn util.Deferred().resolve( [] );\n\t\t}\n\t\treturn this.api.get( params, {\n\t\t\turl: this.apiUrl\n\t\t} ).then( function ( data ) {\n\t\t\tif ( data.continue !== undefined ) {\n\t\t\t\tself.continueParams = data.continue;\n\t\t\t} else {\n\t\t\t\tself.canContinue = false;\n\t\t\t}\n\n\t\t\treturn self.parseData( data );\n\t\t} );\n\t},\n\n\t/**\n\t * Parse api response data into pagelist item format\n\t *\n\t * @param {Object[]} data\n\t * @return {Page[]}\n\t */\n\tparseData: function ( data ) {\n\t\tvar pages;\n\n\t\tif ( !data.query || !data.query.pages ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tpages = data.query.pages;\n\n\t\t// Sort results alphabetically (the api map doesn't have any order). The\n\t\t// watchlist is ordered alphabetically right now.\n\t\tpages.sort( function ( p1, p2 ) {\n\t\t\treturn p1.title === p2.title ? 0 : ( p1.title < p2.title ? -1 : 1 );\n\t\t} );\n\n\t\t// If we requested from the last item of the previous page, we shall\n\t\t// remove the first result (to avoid it being repeated)\n\t\tif ( this.shouldSkipFirstTitle ) {\n\t\t\tpages = pages.slice( 1 );\n\t\t\tthis.shouldSkipFirstTitle = false;\n\t\t}\n\n\t\t// Transform the items to a sensible format\n\t\treturn pages.map( pageJSONParser.parse );\n\t}\n\n};\n\nmodule.exports = WatchListGateway;\n","var\n\tView = require( './View' ),\n\tutil = require( './util' );\n\n/**\n * A wrapper for creating an anchor.\n *\n * @extends View\n */\nclass Anchor extends View {\n\t/**\n\t * @inheritdoc\n\t */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\t/**\n\t * @memberof Anchor\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {boolean} defaults.progressive is progressive action\n\t * @property {boolean} defaults.destructive is destructive action\n\t * @property {string} defaults.additionalClassNames Additional class name(s).\n\t * @property {string} defaults.href url\n\t * @property {string} defaults.label of anchor\n\t */\n\tget defaults() {\n\t\treturn {\n\t\t\tprogressive: undefined,\n\t\t\tdestructive: undefined,\n\t\t\tadditionalClassNames: '',\n\t\t\thref: undefined,\n\t\t\tlabel: undefined\n\t\t};\n\t}\n\t/**\n\t * @inheritdoc\n\t */\n\tget template() {\n\t\treturn util.template( `\n<a {{#href}}href=\"{{href}}\"{{/href}} class=\"mw-ui-anchor\n\t{{#progressive}} mw-ui-progressive{{/progressive}}\n\t{{#destructive}} mw-ui-destructive{{/destructive}}\n\t {{additionalClassNames}}\">{{label}}</a>\n\t` );\n\t}\n}\n\nmodule.exports = Anchor;\n","var\n\tutil = require( './util' ),\n\tbrowser;\n\n/**\n * Memoize a class method. Caches the result of the method based on the\n * arguments. Instances do not share a cache.\n *\n * @param {Function} method Method to be memoized\n * @return {Function}\n */\nfunction memoize( method ) {\n\t/**\n\t * Memoized version of the method\n\t *\n\t * @return {Function}\n\t */\n\tvar memoized = function () {\n\t\tvar cache = this[ '__cache' + memoized.cacheId ] ||\n\t\t\t( this[ '__cache' + memoized.cacheId ] = {} ),\n\t\t\tkey = [].join.call( arguments, '|' );\n\t\tif ( Object.prototype.hasOwnProperty.call( cache, key ) ) {\n\t\t\treturn cache[ key ];\n\t\t}\n\t\treturn ( cache[ key ] = method.apply( this, arguments ) );\n\t};\n\tmemoized.cacheId = Date.now().toString() + Math.random().toString();\n\treturn memoized;\n}\n\n/**\n * Representation of user's current browser\n *\n * @class Browser\n * @param {string} ua the user agent of the current browser\n * @param {jQuery.Object} $container an element to associate with the Browser object\n */\nfunction Browser( ua, $container ) {\n\tthis.userAgent = ua;\n\tthis.$el = $container;\n}\n\nBrowser.prototype = {\n\t/**\n\t * Returns whether the current browser is an ios device.\n\t * FIXME: jquery.client does not support iPad detection so we cannot use it.\n\t *\n\t * @memberof Browser\n\t * @instance\n\t * @param {number} [version] integer describing a specific version you want to test against.\n\t * @return {boolean}\n\t */\n\tisIos: memoize( function ( version ) {\n\t\tvar ua = this.userAgent,\n\t\t\tios = /ipad|iphone|ipod/i.test( ua );\n\n\t\tif ( ios && version ) {\n\t\t\tswitch ( version ) {\n\t\t\t\tcase 8:\n\t\t\t\t\t// Test UA for iOS8. Or for simulator look for Version 8\n\t\t\t\t\t// In the iOS simulator the OS is the host machine OS version\n\t\t\t\t\t// This makes testing in iOS8 simulator work as expected\n\t\t\t\t\treturn /OS 8_/.test( ua ) || /Version\\/8/.test( ua );\n\t\t\t\tcase 4:\n\t\t\t\t\treturn /OS 4_/.test( ua );\n\t\t\t\tcase 5:\n\t\t\t\t\treturn /OS 5_/.test( ua );\n\t\t\t\tdefault:\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t} else {\n\t\t\treturn ios;\n\t\t}\n\t} ),\n\t/**\n\t * Determine if a device has a widescreen.\n\t *\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisWideScreen: memoize( function () {\n\t\tvar val = parseInt( mw.config.get( 'wgMFDeviceWidthTablet' ), 10 );\n\t\t// Check viewport width to determine mobile vs tablet.\n\t\t// Note: Mobile devices held in landscape mode might receive tablet treatment.\n\t\treturn window.innerWidth >= val;\n\t} ),\n\t/**\n\t * Whether touchstart and other touch events are supported by the current browser.\n\t *\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tsupportsTouchEvents: memoize( function () {\n\t\treturn 'ontouchstart' in window;\n\t} ),\n\t/**\n\t * Detect if browser supports geolocation\n\t *\n\t * @memberof Browser\n\t * @instance\n\t * @return {boolean}\n\t */\n\tsupportsGeoLocation: memoize( function () {\n\t\t// eslint-disable-next-line compat/compat\n\t\treturn 'geolocation' in window.navigator;\n\t} )\n};\n\n/**\n * @memberof Browser\n * @return {Browser}\n */\nBrowser.getSingleton = function () {\n\tvar $html;\n\tif ( !browser ) {\n\t\t$html = util.getDocument();\n\t\tbrowser = new Browser( window.navigator.userAgent, $html );\n\t}\n\treturn browser;\n};\n\nmodule.exports = Browser;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * A wrapper for creating a button.\n *\n * @class Button\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Button( options ) {\n\tif ( options.href ) {\n\t\toptions.tagName = 'a';\n\t}\n\tView.call( this, options );\n}\n\nmfExtend( Button, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Button\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Button\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.tagName The name of the tag in which the button is wrapped.\n\t * @property {boolean} defaults.block is stacked button\n\t * @property {boolean} defaults.progressive is progressive action\n\t * @property {boolean} defaults.quiet is quiet button\n\t * @property {boolean} defaults.destructive is destructive action\n\t * @property {string} defaults.additionalClassNames Additional class name(s).\n\t * @property {string} defaults.href url\n\t * @property {string} defaults.label of button\n\t * @property {boolean} defaults.disabled should only be used with tagName button\n\t */\n\tdefaults: {\n\t\ttagName: 'a',\n\t\tdisabled: false,\n\t\tblock: undefined,\n\t\tprogressive: undefined,\n\t\tdestructive: undefined,\n\t\tquiet: undefined,\n\t\tadditionalClassNames: '',\n\t\thref: undefined,\n\t\tlabel: undefined\n\t},\n\t/**\n\t * @memberof Button\n\t * @instance\n\t */\n\ttemplate: util.template( `<{{tagName}} {{#disabled}}disabled{{/disabled}}\n{{#href}}href=\"{{href}}\"{{/href}}\nclass=\"mw-ui-button {{#progressive}}mw-ui-progressive{{/progressive}}\n\t{{#block}}mw-ui-block{{/block}}\n\t{{#quiet}}mw-ui-quiet{{/quiet}}\n\t{{#destructive}}mw-ui-destructive{{/destructive}} {{additionalClassNames}}\n\">{{label}}</{{tagName}}>` )\n} );\n\nmodule.exports = Button;\n","var\n\tDrawer = require( './Drawer' ),\n\tutil = require( './util' ),\n\tButton = require( './Button' ),\n\tAnchor = require( './Anchor' );\n\n/**\n * @typedef {string|number|boolean|undefined} QueryVal\n * @typedef {Object.<string, QueryVal|QueryVal[]>} QueryParams\n *\n * @typedef {Object} Options\n * @prop {string} [returnTo]\n * @prop {QueryParams} [queryParams]\n * @prop {QueryParams} [signupQueryParams]\n * @prop {Object} [progressiveButton] button options for Button element for signing in.\n *  If omitted will create a login URL.\n * @prop {Object} [actionAnchor] anchor options for Anchor element for signing up. If omitted\n *   will create a sign up URL\n * @prop {string} content text - what is the call to action?\n */\n\n/**\n * This creates the drawer at the bottom of the screen that appears when an anonymous\n * user tries to perform an action that requires being logged in. It presents the user\n * with options to log in or sign up for a new account.\n *\n * @uses Button\n * @uses Icon\n * @uses Anchor\n * @param {Options} options\n * @return {Drawer}\n */\nfunction CtaDrawer( options = {} ) {\n\tvar params = redirectParams( options.queryParams, options.returnTo );\n\treturn new Drawer(\n\t\tutil.extend( {\n\t\t\tchildren: [\n\t\t\t\tutil.parseHTML( '<p>' ).text( options.content ),\n\t\t\t\tnew Button( util.extend( {\n\t\t\t\t\tprogressive: true,\n\t\t\t\t\thref: mw.util.getUrl( 'Special:UserLogin', params ),\n\t\t\t\t\tlabel: mw.msg( 'mobile-frontend-watchlist-cta-button-login' )\n\t\t\t\t}, options.progressiveButton ) ).$el,\n\t\t\t\tutil.parseHTML( '<div>' ).addClass( 'cta-drawer__anchors' ).append(\n\t\t\t\t\t// Update Minerva first to avoid needing to keep this closeAnchor\n\t\t\t\t\tnew Anchor( util.extend( {\n\t\t\t\t\t\thref: mw.util.getUrl(\n\t\t\t\t\t\t\t'Special:UserLogin', signUpParams( params, options.signupQueryParams )\n\t\t\t\t\t\t),\n\t\t\t\t\t\tprogressive: true,\n\t\t\t\t\t\tlabel: mw.msg( 'mobile-frontend-watchlist-cta-button-signup' )\n\t\t\t\t\t}, options.actionAnchor ) ).$el\n\t\t\t\t)\n\t\t\t]\n\t\t}, options )\n\t);\n}\n\n/**\n * Special:UserLogin post-request redirect query parameters.\n *\n * @param {QueryParams} params\n * @param {string} [redirectURL]\n * @return {QueryParams}\n */\nfunction redirectParams( params, redirectURL ) {\n\treturn util.extend( {\n\t\t// use wgPageName as this includes the namespace if outside Main\n\t\treturnto: redirectURL || mw.config.get( 'wgPageName' )\n\t}, params );\n}\n\n/**\n * Special:UserLogin account creation query parameters.\n *\n * @param {...QueryParams} params\n * @return {QueryParams}\n */\nfunction signUpParams() {\n\t[].push.call( arguments, { type: 'signup' } );\n\treturn util.extend.apply( util, arguments );\n}\n\nCtaDrawer.prototype.test = {\n\tredirectParams: redirectParams,\n\tsignUpParams: signUpParams\n};\n\nmodule.exports = CtaDrawer;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' ),\n\tutil = require( './util' ),\n\tIcon = require( './Icon' );\n\n/**\n * A {@link View} that pops up from the bottom of the screen.\n *\n * @class Drawer\n * @extends View\n * @final\n * @param {Object} props\n * @param {string} [props.className] Additional CSS classes to add\n * @param {jQuery.Element[]} [props.children] An array of elements to append to\n * @param {Function} [props.onShow] Callback called before showing the drawer.\n *  It receives a promise given the show process is asynchronous.\n * @param {Function} [props.onBeforeHide] Callback called before hiding the drawer\n */\nfunction Drawer( props ) {\n\tthis.drawerClassName = props.className || '';\n\tthis.collapseIcon = new Icon( {\n\t\tname: 'expand',\n\t\tadditionalClassNames: 'cancel'\n\t} );\n\tView.call( this,\n\t\tutil.extend(\n\t\t\t{\n\t\t\t\tonBeforeHide: () => {},\n\t\t\t\tshowCollapseIcon: true\n\t\t\t},\n\t\t\tprops,\n\t\t\t{\n\t\t\t\tclassName: 'drawer-container'\n\t\t\t},\n\t\t\t{ events: util.extend( {\n\t\t\t\t'click .drawer-container__mask': function () {\n\t\t\t\t\tthis.hide();\n\t\t\t\t}.bind( this ),\n\t\t\t\t'click .cancel': function ( ev ) {\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t\tthis.hide();\n\t\t\t\t}.bind( this ),\n\t\t\t\tclick: function ( ev ) {\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t}\n\t\t\t}, props.events ) }\n\t\t)\n\t);\n}\n\nmfExtend( Drawer, View, {\n\t// in milliseconds\n\tminHideDelay: 100,\n\n\t/**\n\t * Shows panel after a slight delay\n\t *\n\t * @memberof View\n\t * @instance\n\t * @method\n\t * @return {jQuery.Promise}\n\t */\n\tshow: function () {\n\t\tconst d = util.Deferred();\n\t\tthis.$el.find( '.drawer-container__mask' )\n\t\t\t.addClass( 'drawer-container__mask--visible' );\n\t\tif ( !this.$el.find( '.drawer' ).hasClass( 'visible' ) ) {\n\t\t\t// use setTimeout to allow the browser to redraw if render() was called\n\t\t\t// just before show(); this is important for animations to work\n\t\t\t// (0ms doesn't work on Firefox, 10ms is enough)\n\t\t\t//\n\t\t\t// FIXME: setTimeout should be reconsidered in T209129\n\t\t\tsetTimeout( function () {\n\t\t\t\tthis.$el.find( '.drawer' ).addClass( 'visible' );\n\t\t\t\tif ( this.options.onShow ) {\n\t\t\t\t\tthis.options.onShow( d );\n\t\t\t\t}\n\t\t\t\tsetTimeout( function () {\n\t\t\t\t\td.resolve();\n\t\t\t\t}, this.minHideDelay );\n\t\t\t}.bind( this ), this.minHideDelay );\n\t\t} else {\n\t\t\td.resolve();\n\t\t}\n\t\treturn d.promise();\n\t},\n\n\t/**\n\t * Hides panel\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\thide: function () {\n\t\tthis.$el.find( '.drawer-container__mask' )\n\t\t\t.removeClass( 'drawer-container__mask--visible' );\n\t\tthis.$el.find( '.drawer' ).removeClass( 'visible' );\n\t\t// see comment in show()\n\t\tsetTimeout( function () {\n\t\t\tthis.$el.find( '.drawer' ).removeClass( 'visible' );\n\t\t\tthis.options.onBeforeHide( this );\n\t\t}.bind( this ), this.minHideDelay );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Drawer\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tconst props = this.options,\n\t\t\t$mask = util.parseHTML( '<div>' )\n\t\t\t\t.addClass( 'drawer-container__mask' ),\n\t\t\t// eslint-disable-next-line mediawiki/class-doc\n\t\t\t$drawer = util.parseHTML( '<div>' )\n\t\t\t\t.addClass( `drawer drawer-container__drawer position-fixed ${this.drawerClassName}`.trim() );\n\n\t\tif ( props.showCollapseIcon ) {\n\t\t\t// append the collapse icon at the top of the drawer\n\t\t\t$drawer.prepend( this.collapseIcon.$el );\n\t\t}\n\n\t\tif ( props.children ) {\n\t\t\t// append children\n\t\t\t$drawer.append( props.children );\n\t\t}\n\t\tthis.$el.append( $mask );\n\t\tthis.$el.append( $drawer );\n\t}\n} );\n\nmodule.exports = Drawer;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * A wrapper for creating an icon.\n *\n * @class Icon\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Icon( options ) {\n\tif ( options.hasText ) {\n\t\toptions.modifier = `mw-ui-icon-before ${options.modifier || ''}`;\n\t}\n\tif ( options.href ) {\n\t\toptions.tagName = 'a';\n\t}\n\tif ( options.tagName === 'button' ) {\n\t\toptions.isTypeButton = true;\n\t}\n\tView.call( this, options );\n}\n\nmfExtend( Icon, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof Icon\n\t * @instance\n\t */\n\tpreRender: function () {\n\t\tthis.setRotationClass();\n\t},\n\t/**\n\t * Internal method that sets the correct rotation class for the icon\n\t * based on the value of rotation\n\t *\n\t * @memberof Icon\n\t * @instance\n\t * @private\n\t */\n\tsetRotationClass: function () {\n\t\tvar options = this.options;\n\t\tif ( options.rotation ) {\n\t\t\tswitch ( options.rotation ) {\n\t\t\t\tcase -180:\n\t\t\t\tcase 180:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-flip';\n\t\t\t\t\tbreak;\n\t\t\t\tcase -90:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-anti-clockwise';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 90:\n\t\t\t\t\toptions._rotationClass = 'mf-mw-ui-icon-rotate-clockwise';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 0:\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Bad value for rotation given. Must be 90, 0 or 180.' );\n\t\t\t}\n\t\t}\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Icon\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof Icon\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {boolean} defaults.hasText Whether the icon has text.\n\t * @property {boolean} defaults.isSmall Whether the icon should be small.\n\t * @property {string} [defaults.href] value of href attribute,\n\t *  when set tagName will default to anchor tag\n\t * @property {string} defaults.tagName The name of the tag in which the icon is wrapped.\n\t *  Defaults to 'a' when href option present.\n\t * @property {string} defaults.base String used as a base for generating class names.\n\t * Defaults to 'mw-ui-icon'.\n\t * @property {string} defaults.name Name of the icon.\n\t * @property {string} defaults.modifier Additional class name.\n\t * Defaults to 'mw-ui-icon-element'.\n\t * @property {string} defaults.title Tooltip text.\n\t * @property {boolean} defaults.rotation will rotate the icon by a certain number\n\t *  of degrees.\n\t *  Must be 90, 0 or 180 or will throw exception.\n\t * @property {boolean} defaults.disabled should only be used with tagName button\n\t */\n\tdefaults: {\n\t\trotation: 0,\n\t\thasText: false,\n\t\thref: undefined,\n\t\tglyphPrefix: 'mf',\n\t\ttagName: 'div',\n\t\tdisabled: false,\n\t\tisSmall: false,\n\t\tbase: 'mw-ui-icon',\n\t\tname: '',\n\t\tmodifier: 'mw-ui-icon-element',\n\t\ttitle: ''\n\t},\n\t/**\n\t * Return the full class name that is required for the icon to render\n\t *\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\tgetClassName: function () {\n\t\treturn this.$el.attr( 'class' );\n\t},\n\t/**\n\t * Return the class that relates to the icon glyph\n\t *\n\t * @memberof Icon\n\t * @instance\n\t * @return {string}\n\t */\n\tgetGlyphClassName: function () {\n\t\treturn this.options.base + '-' + this.options.glyphPrefix + '-' + this.options.name;\n\t},\n\ttemplate: util.template(\n\t\t'<{{tagName}} {{#disabled}}disabled{{/disabled}} ' +\n\t\t\t'{{#isTypeButton}}type=\"button\"{{/isTypeButton}} ' +\n\t\t\t'class=\"{{base}} ' +\n\t\t\t\t'{{base}}-{{glyphPrefix}}-{{name}} ' +\n\t\t\t\t'{{modifier}} ' +\n\t\t\t\t'{{#isSmall}}mw-ui-icon-small{{/isSmall}} ' +\n\t\t\t\t'{{#_rotationClass}}{{_rotationClass}}{{/_rotationClass}} ' +\n\t\t\t\t'{{additionalClassNames}}\" ' +\n\t\t\t'{{#id}}id=\"{{id}}\"{{/id}} ' +\n\t\t\t'{{#href}}href=\"{{href}}\"{{/href}} ' +\n\t\t\t'{{#title}}title=\"{{title}}\"{{/title}}>' +\n\t\t\t'{{#hasText}}<span>{{/hasText}}' +\n\t\t\t\t'{{label}}' +\n\t\t\t'{{#hasText}}</span>{{/hasText}}' +\n\t\t'</{{tagName}}>'\n\t)\n} );\n\nmodule.exports = Icon;\n","var\n\tView = require( './View' ),\n\tutil = require( './util' ),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * @class MessageBox\n * @extends View\n */\nfunction MessageBox() {\n\tView.apply( this, arguments );\n}\n\nmfExtend( MessageBox, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof MessageBox\n\t * @instance\n\t */\n\tisTemplateMode: true,\n\t/**\n\t * @memberof MessageBox\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} [defaults.heading] heading to show along with message (text)\n\t * @property {string} defaults.msg message to show (html)\n\t * @property {string} defaults.className either errorbox, warningbox or successbox\n\t */\n\tdefaults: {},\n\t/**\n\t * @memberof MessageBox\n\t * @instance\n\t */\n\ttemplate: util.template( `\n<div class=\"{{className}}\">\n\t{{#heading}}<h2>{{heading}}</h2>{{/heading}}\n\t{{{msg}}}\n</div>\n\t` )\n} );\n\nmodule.exports = MessageBox;\n","var\n\tView = require( './View' ),\n\theader = require( './headers' ).header,\n\tAnchor = require( './Anchor' ),\n\tutil = require( './util' ),\n\tbrowser = require( './Browser' ).getSingleton(),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * Mobile modal window\n *\n * @class Overlay\n * @extends View\n * @uses Icon\n * @uses Button\n * @fires Overlay#hide\n * @param {Object} props\n * @param {Object} props.events - custom events to be bound to the overlay.\n * @param {boolean} [props.headerChrome] Whether the header has chrome.\n * @param {View[]} [props.headerActions] children (usually buttons or icons)\n *   that should be placed in the header actions. Ignored when `headers` used.\n * @param {string} [props.heading] heading for the overlay header. Use `headers` where\n *  overlays require more than one header. Ignored when `headers` used.\n * @param {boolean} props.noHeader renders an overlay without a header\n * @param {Element[]} [props.headers] allows overlays to have more than one\n *  header. When used it is an array of jQuery Objects representing\n *  headers created via the header util function. It is expected that only one of these\n *  should be visible. If undefined, headerActions and heading is used.\n * @param {Object} [props.footerAnchor] options for an optional Anchor\n *  that can appear in the footer\n * @param {Function} props.onBeforeExit allows a consumer to prevent exits in certain\n *  situations. This callback gets the following parameters:\n *  - 1) the exit function which should be run after the consumer has made their changes.\n *  - 2) the cancel function which should be run if the consumer explicitly changes their mind\n */\nfunction Overlay( props ) {\n\tthis.isIos = browser.isIos();\n\n\tView.call(\n\t\tthis,\n\t\tutil.extend(\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\theaderChrome: false,\n\t\t\t\tclassName: 'overlay'\n\t\t\t},\n\t\t\tprops,\n\t\t\t{\n\t\t\t\tevents: util.extend(\n\t\t\t\t\t{\n\t\t\t\t\t\t// FIXME: Remove .initial-header selector\n\t\t\t\t\t\t'click .cancel, .confirm, .initial-header .back': 'onExitClick',\n\t\t\t\t\t\tclick: ( ev ) => {\n\t\t\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tprops.events\n\t\t\t\t)\n\t\t\t}\n\t\t)\n\t);\n}\n\nmfExtend( Overlay, View, {\n\ttemplate: util.template( `\n{{^noHeader}}\n<div class=\"overlay-header-container header-container{{#headerChrome}}\n\theader-chrome{{/headerChrome}} position-fixed\">\n</div>\n{{/noHeader}}\n<div class=\"overlay-content\">\n\t{{>content}}\n</div>\n<div class=\"overlay-footer-container position-fixed\"></div>\n\t` ),\n\n\thideTimeout: null,\n\n\t/**\n\t * Shows the spinner right to the input field.\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t * @method\n\t */\n\tshowSpinner: function () {\n\t\tthis.$el.find( '.spinner' ).removeClass( 'hidden' );\n\t},\n\n\t/**\n\t * Hide the spinner near to the input field.\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t * @method\n\t */\n\thideSpinner: function () {\n\t\tthis.$el.find( '.spinner' ).addClass( 'hidden' );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof Overlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tconst footerAnchor = this.options.footerAnchor;\n\t\tthis.$overlayContent = this.$el.find( '.overlay-content' );\n\t\tif ( this.isIos ) {\n\t\t\tthis.$el.addClass( 'overlay-ios' );\n\t\t}\n\t\tif ( footerAnchor ) {\n\t\t\tthis.$el.find( '.overlay-footer-container' ).append( new Anchor( footerAnchor ).$el );\n\t\t}\n\t\tconst headers = this.options.headers || [\n\t\t\theader(\n\t\t\t\tthis.options.heading,\n\t\t\t\tthis.options.headerActions\n\t\t\t)\n\t\t];\n\t\tthis.$el.find( '.overlay-header-container' ).append( headers );\n\t},\n\n\t/**\n\t * ClickBack event handler\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t * @param {Object} ev event object\n\t */\n\tonExitClick: function ( ev ) {\n\t\tconst exit = function () {\n\t\t\tthis.hide();\n\t\t}.bind( this );\n\t\tev.preventDefault();\n\t\tev.stopPropagation();\n\t\tif ( this.options.onBeforeExit ) {\n\t\t\tthis.options.onBeforeExit( exit, function () {} );\n\t\t} else {\n\t\t\texit();\n\t\t}\n\n\t},\n\t/**\n\t * Attach overlay to current view and show it.\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t */\n\tshow: function () {\n\t\tvar $html = util.getDocument();\n\n\t\tthis.scrollTop = window.pageYOffset;\n\n\t\t$html.addClass( 'overlay-enabled' );\n\t\t// skip the URL bar if possible\n\t\twindow.scrollTo( 0, 1 );\n\n\t\tthis.$el.addClass( 'visible' );\n\n\t\t// If .hide() was called earlier, and it scheduled an asynchronous detach\n\t\t// but it hasn't happened yet, cancel it\n\t\tif ( this.hideTimeout !== null ) {\n\t\t\tclearTimeout( this.hideTimeout );\n\t\t\tthis.hideTimeout = null;\n\t\t}\n\t},\n\t/**\n\t * Detach the overlay from the current view\n\t * Should not be overriden as soon to be deprecated.\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t * @final\n\t * @return {boolean} Whether the overlay was successfully hidden or not\n\t */\n\thide: function () {\n\t\tutil.getDocument().removeClass( 'overlay-enabled' );\n\t\t// return to last known scroll position\n\t\twindow.scrollTo( window.pageXOffset, this.scrollTop );\n\n\t\t// Since the hash change event caused by emitting hide will be detected later\n\t\t// and to avoid the article being shown during a transition from one overlay to\n\t\t// another, we regretfully detach the element asynchronously.\n\t\tthis.hideTimeout = setTimeout( function () {\n\t\t\tthis.$el.detach();\n\t\t\tthis.hideTimeout = null;\n\t\t}.bind( this ), 0 );\n\n\t\t/**\n\t\t * Fired when the overlay is closed.\n\t\t *\n\t\t * @event Overlay#hide\n\t\t */\n\t\tthis.emit( 'hide' );\n\n\t\treturn true;\n\t},\n\n\t/**\n\t * Show elements that are selected by the className.\n\t * Also hide .hideable elements\n\t * Can't use jQuery's hide() and show() because show() sets display: block.\n\t * And we want display: table for headers.\n\t *\n\t * @memberof Overlay\n\t * @instance\n\t * @protected\n\t * @param {string} className CSS selector to show\n\t */\n\tshowHidden: function ( className ) {\n\t\tthis.$el.find( '.hideable' ).addClass( 'hidden' );\n\t\tthis.$el.find( className ).removeClass( 'hidden' );\n\t}\n} );\n\n/**\n * Factory method for an overlay with a single child\n *\n * @memberof Overlay\n * @instance\n * @protected\n * @param {Object} options\n * @param {View} view\n * @return {Overlay}\n */\nOverlay.make = function ( options, view ) {\n\tvar overlay = new Overlay( options );\n\toverlay.$el.find( '.overlay-content' ).append( view.$el );\n\treturn overlay;\n};\n\nmodule.exports = Overlay;\n","var\n\tutil = require( './util' ),\n\toverlayManager = null;\n\n// We pass this to history.pushState/replaceState to indicate that we're controlling the page URL.\n// Then we look for this marker on page load so that if the page is refreshed, we don't generate an\n// extra history entry (see #getSingleton below and T201852).\nconst MANAGED_STATE = 'MobileFrontend OverlayManager was here!';\n\n/**\n * Manages opening and closing overlays when the URL hash changes to one\n * of the registered values (see OverlayManager.add()).\n *\n * This allows overlays to function like real pages, with similar browser back/forward\n * and refresh behavior.\n *\n * @class OverlayManager\n * @param {Router} router\n * @param {Element} container where overlays should be managed\n */\nfunction OverlayManager( router, container ) {\n\trouter.on( 'route', this._checkRoute.bind( this ) );\n\tthis.router = router;\n\t// use an object instead of an array for entries so that we don't\n\t// duplicate entries that already exist\n\tthis.entries = {};\n\t// stack of all the open overlays, stack[0] is the latest one\n\tthis.stack = [];\n\tthis.hideCurrent = true;\n\t// Set the element that overlays will be appended to\n\tthis.container = container;\n}\n\n/**\n * Attach an event to the overlays hide event\n *\n * @param {Overlay} overlay\n */\nfunction attachHideEvent( overlay ) {\n\toverlay.on( 'hide', function () {\n\t\toverlay.emit( '_om_hide' );\n\t} );\n}\n\nOverlayManager.prototype = {\n\t/**\n\t * Don't try to hide the active overlay on a route change event triggered\n\t * by hiding another overlay.\n\t * Called when something other than OverlayManager calls Overlay.hide\n\t * on an overlay that it itself managed by the OverlayManager.\n\t * MUST be called when the stack is not empty.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t */\n\t_onHideOverlayOutsideOverlayManager: function () {\n\t\tif ( !this.stack.length ) {\n\t\t\treturn;\n\t\t}\n\t\tconst currentRoute = this.stack[0].route,\n\t\t\trouteIsString = typeof currentRoute === 'string',\n\t\t\tcurrentPath = this.router.getPath(),\n\t\t\t// Since routes can be strings or regexes, it's important to do an equality\n\t\t\t// check BEFORE a match check.\n\t\t\trouteIsSame = ( routeIsString && currentPath === currentRoute ) ||\n\t\t\t\tcurrentPath.match( currentRoute );\n\n\t\tthis.hideCurrent = false;\n\n\t\t// If the path hasn't changed then the user didn't close the overlay by\n\t\t// calling history.back() or triggering a route change. We must go back\n\t\t// to get out of the overlay. See T237677.\n\t\tif ( routeIsSame ) {\n\t\t\t// does the route need to change?\n\t\t\tthis.router.back();\n\t\t}\n\t},\n\n\t/** Attach overlay to DOM\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Overlay} overlay to attach\n\t */\n\t_attachOverlay: function ( overlay ) {\n\t\tif ( !overlay.$el.parents().length ) {\n\t\t\tthis.container.appendChild( overlay.$el[0] );\n\t\t}\n\t},\n\t/**\n\t * Show the overlay and bind the '_om_hide' event to _onHideOverlay.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Overlay} overlay to show\n\t */\n\t_show: function ( overlay ) {\n\t\t// Mark the state so that if the page is refreshed, we don't generate an extra history entry\n\t\t// (see #getSingleton below and T201852).\n\t\t// eslint-disable-next-line no-restricted-properties\n\t\twindow.history.replaceState( MANAGED_STATE, null, window.location.href );\n\n\t\t// the _om_hide event is added to an overlay that is displayed.\n\t\t// It will fire if an Overlay emits a hide event (See attachHideEvent)\n\t\t// in the case where a route change has not occurred (this event is disabled\n\t\t// inside _hideOverlay which is called inside _checkRoute)\n\t\toverlay.once( '_om_hide', this._onHideOverlayOutsideOverlayManager.bind( this ) );\n\n\t\tthis._attachOverlay( overlay );\n\t\toverlay.show();\n\t},\n\n\t/**\n\t * Hide overlay\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Overlay} overlay to hide\n\t * @param {Function} onBeforeExitCancel to pass to onBeforeExit\n\t * @return {boolean} Whether the overlay has been hidden\n\t */\n\t_hideOverlay: function ( overlay, onBeforeExitCancel ) {\n\t\tlet result;\n\n\t\tfunction exit() {\n\t\t\tresult = true;\n\t\t\toverlay.hide();\n\t\t}\n\t\t// remove the callback for updating state when overlay closed using\n\t\t// overlay close button\n\t\toverlay.off( '_om_hide' );\n\n\t\tif ( overlay.options && overlay.options.onBeforeExit ) {\n\t\t\toverlay.options.onBeforeExit( exit, onBeforeExitCancel );\n\t\t} else {\n\t\t\texit();\n\t\t}\n\n\t\t// if closing prevented, reattach the callback\n\t\tif ( !result ) {\n\t\t\toverlay.once( '_om_hide', this._onHideOverlayOutsideOverlayManager.bind( this ) );\n\t\t}\n\n\t\treturn result;\n\t},\n\n\t/**\n\t * Show match's overlay if match is not null.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {Object|null} match Object with factory function's result. null if no match.\n\t */\n\t_processMatch: function ( match ) {\n\t\tvar factoryResult,\n\t\t\tself = this;\n\n\t\tif ( match ) {\n\t\t\tif ( match.overlay ) {\n\t\t\t\t// if the match is an overlay that was previously opened, reuse it\n\t\t\t\tself._show( match.overlay );\n\t\t\t} else {\n\t\t\t\t// else create an overlay using the factory function result\n\t\t\t\tfactoryResult = match.factoryResult;\n\t\t\t\t// We were getting errors relating to no factoryResult.\n\t\t\t\t// This should never happen.\n\t\t\t\t// If it does an error should not be thrown.\n\t\t\t\tif ( factoryResult ) {\n\t\t\t\t\tmatch.overlay = factoryResult;\n\t\t\t\t\tattachHideEvent( match.overlay );\n\t\t\t\t\tself._show( factoryResult );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * A callback for Router's `route` event.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {jQuery.Event} ev Event object.\n\t */\n\t_checkRoute: function ( ev ) {\n\t\tconst current = this.stack[0];\n\n\t\t// When entering an overlay for the first time,\n\t\t// the manager should remember the user's scroll position\n\t\t// overlays always open at top of page\n\t\t// and we'll want to restore it later.\n\t\t// This should happen before the call to _matchRoute which will \"show\" the overlay.\n\t\t// The Overlay has similar logic for overlays that are not managed via the overlay.\n\t\tif ( !current ) {\n\t\t\tthis.scrollTop = window.pageYOffset;\n\t\t}\n\n\t\t// if there is an overlay in the stack and it's opened, try to close it\n\t\tif (\n\t\t\tcurrent &&\n\t\t\tcurrent.overlay !== undefined &&\n\t\t\tthis.hideCurrent &&\n\t\t\t!this._hideOverlay( current.overlay, () => {\n\t\t\t\t// if hide prevented, prevent route change event\n\t\t\t\tev.preventDefault();\n\t\t\t} )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = Object.keys( this.entries ).reduce( function ( m, id ) {\n\t\t\treturn m || this._matchRoute( ev.path, this.entries[ id ] );\n\t\t}.bind( this ), null );\n\n\t\tif ( !match ) {\n\t\t\t// if hidden and no new matches, reset the stack\n\t\t\tthis.stack = [];\n\t\t\t// restore the scroll position.\n\t\t\twindow.scrollTo( window.pageXOffset, this.scrollTop );\n\t\t}\n\n\t\tthis.hideCurrent = true;\n\t\tthis._processMatch( match );\n\t},\n\n\t/**\n\t * Check if a given path matches one of the existing entries and\n\t * remove it from the stack.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @private\n\t * @param {string} path Path (hash) to check.\n\t * @param {Object} entry Entry object created in OverlayManager#add.\n\t * @return {Object|null} Match object with factory function's result.\n\t *  Returns null if no match.\n\t */\n\t_matchRoute: function ( path, entry ) {\n\t\tvar\n\t\t\tnext,\n\t\t\tdidMatch,\n\t\t\tcaptures,\n\t\t\tmatch,\n\t\t\tprevious = this.stack[1],\n\t\t\tself = this;\n\n\t\tif ( typeof entry.route === 'string' ) {\n\t\t\tdidMatch = entry.route === path;\n\t\t\tcaptures = [];\n\t\t} else {\n\t\t\tmatch = path.match( entry.route );\n\t\t\tdidMatch = !!match;\n\t\t\tcaptures = didMatch ? match.slice( 1 ) : [];\n\t\t}\n\n\t\t/**\n\t\t * Returns object to add to stack\n\t\t *\n\t\t * @method\n\t\t * @ignore\n\t\t * @return {Object}\n\t\t */\n\t\tfunction getNext() {\n\t\t\treturn {\n\t\t\t\tpath: path,\n\t\t\t\t// Important for managing states of things such as the image overlay which change\n\t\t\t\t// overlay routing parameters during usage.\n\t\t\t\troute: entry.route,\n\t\t\t\tfactoryResult: entry.factory.apply( self, captures )\n\t\t\t};\n\t\t}\n\n\t\tif ( didMatch ) {\n\t\t\t// if previous stacked overlay's path matches, assume we're going back\n\t\t\t// and reuse a previously opened overlay\n\t\t\tif ( previous && previous.path === path ) {\n\t\t\t\tself.stack.shift();\n\t\t\t\treturn previous;\n\t\t\t} else {\n\t\t\t\tnext = getNext();\n\t\t\t\tif ( this.stack[0] && next.path === this.stack[0].path ) {\n\t\t\t\t\t// current overlay path is same as path to check which means overlay\n\t\t\t\t\t// is attempting to refresh so just replace current overlay with new\n\t\t\t\t\t// overlay\n\t\t\t\t\tself.stack[0] = next;\n\t\t\t\t} else {\n\t\t\t\t\tself.stack.unshift( next );\n\t\t\t\t}\n\t\t\t\treturn next;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t},\n\n\t/**\n\t * Add an overlay that should be shown for a specific fragment identifier.\n\t *\n\t * The following code will display an overlay whenever a user visits a URL that\n\t * ends with '#/hi/name'. The value of `name` will be passed to the overlay.\n\t * Note the factory must return an Overlay.\n\t * If the overlay needs to load code asynchronously that should be done inside\n\t * the overlay.\n\t *\n\t *     @example\n\t *     overlayManager.add( /\\/hi\\/(.*)/, function ( name ) {\n\t *         var HiOverlay = M.require( 'HiOverlay' );\n\t *         return new HiOverlay( { name: name } ) );\n\t *     } );\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @param {RegExp|string} route definition that can be a regular\n\t * expression (optionally with parameters) or a string literal.\n\t *\n\t * T238364: Routes should only contain characters allowed by RFC3986 to ensure\n\t * compatibility across browsers. Encode the route with `encodeURIComponent()`\n\t * prior to registering it with OverlayManager if necessary (should probably\n\t * be done with all routes containing user generated characters) to avoid\n\t * inconsistencies with how different browsers encode illegal URI characters:\n\t *\n\t * ```\n\t *   var encodedRoute = encodeURIComponent('ugc < \" ` >');\n\t *\n\t *   overlayManager.add(\n\t *     encodedRoute,\n\t *     function () { return new Overlay(); }\n\t *   );\n\t *\n\t *   window.location.hash = '#' + encodedRoute;\n\t * ```\n\t * The above example shows how to register a string literal route with illegal\n\t * URI characters. Routes registered as a regex will likely NOT have to\n\t * perform any encoding (unless they explicitly contain illegal URI\n\t * characters) as their user generated content portion will likely just be a\n\t * capturing group (e.g. `/\\/hi\\/(.*)/`).\n\t * @param {Function} factory a function returning an overlay\n\t */\n\tadd: function ( route, factory ) {\n\t\tvar self = this,\n\t\t\tentry = {\n\t\t\t\troute: route,\n\t\t\t\tfactory: factory\n\t\t\t};\n\n\t\tthis.entries[route] = entry;\n\t\t// Check if overlay should be shown for the current path.\n\t\t// The DOM must fully load before we can show the overlay because Overlay relies on it.\n\t\tutil.docReady( function () {\n\t\t\tself._processMatch( self._matchRoute( self.router.getPath(), entry ) );\n\t\t} );\n\t},\n\n\t/**\n\t * Replace the currently displayed overlay with a new overlay without changing the\n\t * URL. This is useful for when you want to switch overlays, but don't want to\n\t * change the back button or close box behavior.\n\t *\n\t * @memberof OverlayManager\n\t * @instance\n\t * @param {Object} overlay The overlay to display\n\t */\n\treplaceCurrent: function ( overlay ) {\n\t\tif ( this.stack.length === 0 ) {\n\t\t\tthrow new Error( 'Trying to replace OverlayManager\\'s current overlay, but stack is empty' );\n\t\t}\n\t\tconst stackOverlay = this.stack[0].overlay;\n\t\tif ( stackOverlay ) {\n\t\t\tthis._hideOverlay( stackOverlay );\n\t\t}\n\t\tthis.stack[0].overlay = overlay;\n\t\tattachHideEvent( overlay );\n\t\tthis._show( overlay );\n\t}\n};\n\n/**\n * Retrieve a singleton instance using 'mediawiki.router'.\n *\n * @memberof OverlayManager\n * @return {OverlayManager}\n */\nOverlayManager.getSingleton = function () {\n\tif ( !overlayManager ) {\n\t\tconst\n\t\t\trouter = mw.loader.require( 'mediawiki.router' ),\n\t\t\tcontainer = document.createElement( 'div' ),\n\t\t\t// Note getPath returns hash minus the '#' character:\n\t\t\thash = router.getPath(),\n\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\tstate = window.history.state;\n\t\tcontainer.className = 'mw-overlays-container';\n\t\tdocument.body.appendChild( container );\n\t\t// If an overlay was loaded by directly navigating to an URL with a hash (e.g. linked from\n\t\t// another page or browser bookmark), generate an extra history entry to allow closing the\n\t\t// overlay without leaving the page (see T201852). Put our marker into the entry state so\n\t\t// that we can detect it if the page is refreshed and do not generate another entry.\n\t\tif ( hash && state !== MANAGED_STATE ) {\n\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\twindow.history.replaceState( null, null, '#' );\n\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\twindow.history.pushState( MANAGED_STATE, null, `#${hash}` );\n\t\t}\n\t\toverlayManager = new OverlayManager( router, container );\n\t}\n\treturn overlayManager;\n};\n\nOverlayManager.test = {\n\tMANAGED_STATE,\n\t__clearCache: () => {\n\t\toverlayManager = null;\n\t}\n};\nmodule.exports = OverlayManager;\n","var\n\tHTML = mw.html,\n\tutil = require( './util' ),\n\tSection = require( './Section' );\n\n/**\n * Mobile page view object\n */\nclass Page {\n\t/**\n\t * @param {Object} options Configuration options\n\t * @param {number} options.id Page ID. The default value of 0 represents a\n\t * new or missing page. Be sure to override it to avoid side effects.\n\t * @param {string} options.title Title of the page. It includes prefix where needed and\n\t * is human readable, e.g. Talk:The man who lived.\n\t * @param {Object} options.titleObj\n\t * @param {string} options.displayTitle HTML title of the page for display. Falls back\n\t * to defaults.title (escaped) if no value is provided. Must be safe HTML!\n\t * @param {number} options.namespaceNumber the number of the\n\t *  namespace the page belongs to\n\t * @param {Object} options.protection List of permissions as returned by API,\n\t * e.g. [{ edit: ['*'] }]\n\t * @param {Array} options.sections Array of {Section} objects.\n\t * @param {string} options.url\n\t * @param {string} options.wikidataDescription\n\t * @param {boolean} options.isMainPage Whether the page is the Main Page.\n\t * @param {boolean} options.isMissing Whether the page exists in the wiki.\n\t * @param {Date} [options.lastModified]\n\t * @param {string} options.anchor\n\t * @param {string} [options.relevantTitle] associated with page.\n\t *  For example Special:WhatLinksHere/Foo would be associated with the page `Foo`.\n\t * @param {number} options.revId  Revision ID. See `wgRevisionId`.\n\t * @param {boolean} options.isWatched Whether the page is being watched\n\t * @param {Object} options.thumbnail thumbnail definition corresponding to page image\n\t * @param {boolean} options.thumbnail.isLandscape whether the image is in\n\t *  landscape format\n\t * @param {number} options.thumbnail.width of image in pixels.\n\t * @param {number} options.thumbnail.height of image in pixels.\n\t * @param {string} options.thumbnail.source url for image\n\t */\n\tconstructor( options ) {\n\t\tconst title = options.title || '';\n\t\tutil.extend( this, {\n\t\t\tid: options.id || 0,\n\t\t\t// FIXME: Deprecate title property as it can be derived from titleObj\n\t\t\t// using getPrefixedText\n\t\t\ttitle,\n\t\t\trelevantTitle: options.relevantTitle || title,\n\t\t\ttitleObj: options.titleObj,\n\t\t\tdisplayTitle: options.displayTitle || HTML.escape( title ),\n\t\t\tnamespaceNumber: options.namespaceNumber || 0,\n\t\t\tprotection: options.protection,\n\t\t\tsections: [],\n\t\t\turl: options.url || mw.util.getUrl( title ),\n\t\t\twikidataDescription: options.wikidataDescription,\n\t\t\t_isMainPage: options.isMainPage || false,\n\t\t\tisMissing: ( options.isMissing !== undefined ) ?\n\t\t\t\toptions.isMissing : options.id === 0,\n\t\t\tlastModified: options.lastModified,\n\t\t\tanchor: options.anchor,\n\t\t\trevId: options.revId,\n\t\t\t_isWatched: options.isWatched,\n\t\t\tthumbnail: ( Object.prototype.hasOwnProperty.call( options, 'thumbnail' ) ) ?\n\t\t\t\toptions.thumbnail : false,\n\t\t\t_sectionLookup: {}\n\t\t} );\n\n\t\t( options.sections || [] ).forEach( function ( sectionData ) {\n\t\t\tvar section = new Section( sectionData );\n\t\t\tthis.sections.push( section );\n\t\t\tthis._sectionLookup[section.id] = section;\n\t\t}.bind( this ) );\n\n\t\tif ( this.thumbnail && this.thumbnail.width ) {\n\t\t\tthis.thumbnail.isLandscape = this.thumbnail.width > this.thumbnail.height;\n\t\t}\n\t}\n\n\t/**\n\t * Retrieve the title that should be displayed to the user\n\t *\n\t * @return {string} HTML\n\t */\n\tgetDisplayTitle() {\n\t\treturn this.displayTitle;\n\t}\n\t/**\n\t * Determine if current page is in a specified namespace\n\t *\n\t * @param {string} namespace Name of namespace\n\t * @return {boolean}\n\t */\n\tinNamespace( namespace ) {\n\t\treturn this.namespaceNumber === mw.config.get( 'wgNamespaceIds' )[namespace];\n\t}\n\n\t/**\n\t * Determines if content model is wikitext\n\t *\n\t * @return {boolean}\n\t */\n\tisWikiText() {\n\t\treturn mw.config.get( 'wgPageContentModel' ) === 'wikitext';\n\t}\n\n\t/**\n\t * Checks whether the current page is the main page\n\t *\n\t * @return {boolean}\n\t */\n\tisMainPage() {\n\t\treturn this._isMainPage;\n\t}\n\t/**\n\t * Checks whether the current page is watched\n\t *\n\t * @return {boolean}\n\t */\n\tisWatched() {\n\t\treturn this._isWatched;\n\t}\n\n\t/**\n\t * Return the latest revision id for this page\n\t *\n\t * @return {number}\n\t */\n\tgetRevisionId() {\n\t\treturn this.revId;\n\t}\n\n\t/**\n\t * Return prefixed page title\n\t *\n\t * @return {string}\n\t */\n\tgetTitle() {\n\t\treturn this.title;\n\t}\n\n\t/**\n\t * return namespace id\n\t *\n\t * @return {number} namespace Number\n\t */\n\tgetNamespaceId() {\n\t\tvar nsId,\n\t\t\targs = this.title.split( ':' );\n\n\t\tif ( args[1] ) {\n\t\t\tnsId = mw.config.get( 'wgNamespaceIds' )[ args[0].toLowerCase().replace( ' ', '_' ) ] || 0;\n\t\t} else {\n\t\t\tnsId = 0;\n\t\t}\n\t\treturn nsId;\n\t}\n\n\t/**\n\t * FIXME: Change function signature to take the anchor of the heading\n\t *\n\t * @param {string} id of the section as defined by MobileFormatter.\n\t * Note, that currently, this is different from\n\t * the PHP parser in that it relates to top-level sections.\n\t * For example, mf-section-1 would relate to section 1. See FIXME.\n\t * @return {Section}\n\t */\n\tgetSection( id ) {\n\t\treturn this._sectionLookup[ id ];\n\t}\n\n\t/**\n\t * Obtain the list of high level (and grouped) sections.\n\t * Note that this list will not include subsections.\n\t *\n\t * @return {Array} of Section instances\n\t */\n\tgetSections() {\n\t\treturn this.sections;\n\t}\n}\n\nmodule.exports = Page;\n","var util = require( './util.js' ),\n\tSection = require( './Section' ),\n\tsectionTemplate = Section.prototype.template,\n\tactionParams = require( './actionParams' ),\n\tcache = {};\n\n/**\n * Add child to listOfSections if the level of child is the same as the last\n * child of listOfSections, otherwise add it to the children of the last\n * section of listOfSections. If listOfSections is empty, just add child to it.\n *\n * @private\n * @param {Array} listOfSections - Array of section ids\n * @param {Object} child - Section to be added to listOfSections\n */\nfunction assignToParent( listOfSections, child ) {\n\tvar section;\n\tif ( listOfSections.length === 0 ) {\n\t\tlistOfSections.push( child );\n\t} else {\n\t\t// take a look at the last child\n\t\tsection = listOfSections[listOfSections.length - 1];\n\t\t// If the level is the same as another section in this list it is a sibling\n\t\tif ( parseInt( section.level, 10 ) === parseInt( child.level, 10 ) ) {\n\t\t\tlistOfSections.push( child );\n\t\t} else {\n\t\t\t// Otherwise take a look at that sections children recursively\n\t\t\tassignToParent( section.subsections, child );\n\t\t}\n\t}\n}\n\n/**\n * Order sections hierarchically\n *\n * @private\n * @param {Array} sections Array of section objects created from response HTML\n * @return {Array} Ordered array of sections\n */\nfunction transformSections( sections ) {\n\tvar\n\t\tsectionLevels = sections.map( function ( s ) {\n\t\t\treturn s.level;\n\t\t} ),\n\t\texistingSectionLevels = sectionLevels.filter( function ( level ) {\n\t\t\treturn !!level;\n\t\t} ),\n\t\tcollapseLevel = Math.min.apply( this, existingSectionLevels ).toString(),\n\t\tlastSection,\n\t\tresult = [];\n\n\t// if the first section level is not equal to collapseLevel, this first\n\t// section will not have a parent and will be appended to the result.\n\tsections.forEach( function ( section ) {\n\t\tsection.subsections = [];\n\n\t\tif (\n\t\t\t!lastSection ||\n\t\t\t(\n\t\t\t\t!section.level ||\n\t\t\t\tsection.level === collapseLevel\n\t\t\t) ||\n\t\t\t// make sure lastSections first child's level is bigger than section.level\n\t\t\t(\n\t\t\t\tlastSection.subsections.length &&\n\t\t\t\tlastSection.subsections[0].level > section.level\n\t\t\t) ||\n\t\t\t// also make sure section.level is not bigger than the lastSection.level\n\t\t\t(\n\t\t\t\tlastSection.level &&\n\t\t\t\tlastSection.level >= section.level\n\t\t\t)\n\t\t) {\n\t\t\tresult.push( section );\n\t\t\tlastSection = section;\n\t\t} else {\n\t\t\tassignToParent( lastSection.subsections, section );\n\t\t\tlastSection.text += sectionTemplate.render( section );\n\t\t}\n\t} );\n\n\treturn result;\n}\n\n/**\n * API for providing Page data\n *\n * @class PageGateway\n * @param {mw.Api} api\n */\nfunction PageGateway( api ) {\n\tthis.api = api;\n}\n\nPageGateway.prototype = {\n\t/**\n\t * Invalidate the internal cache for a given page\n\t *\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {string} title the title of the page who's cache you want to invalidate\n\t */\n\tinvalidatePage: function ( title ) {\n\t\tdelete cache[title];\n\t},\n\n\t/**\n\t * Gets language variant list for a page; helper function for getPageLanguages()\n\t *\n\t * @memberof PageGateway\n\t * @instance\n\t * @private\n\t * @param  {string} title Name of the page to obtain variants for\n\t * @param  {Object} data Data from API\n\t * @return {Array|boolean} List of language variant objects or false if no variants exist\n\t */\n\t_getLanguageVariantsFromApiResponse: function ( title, data ) {\n\t\tvar generalData = data.query.general,\n\t\t\tvariantPath = generalData.variantarticlepath,\n\t\t\tvariants = [];\n\n\t\tif ( !generalData.variants ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Create the data object for each variant and store it\n\t\tObject.keys( generalData.variants ).forEach( function ( index ) {\n\t\t\tvar item = generalData.variants[ index ],\n\t\t\t\tvariant = {\n\t\t\t\t\tautonym: item.name,\n\t\t\t\t\tlang: item.code\n\t\t\t\t};\n\n\t\t\tif ( variantPath ) {\n\t\t\t\tvariant.url = variantPath\n\t\t\t\t\t.replace( '$1', title )\n\t\t\t\t\t.replace( '$2', item.code );\n\t\t\t} else {\n\t\t\t\tvariant.url = mw.util.getUrl( title, {\n\t\t\t\t\tvariant: item.code\n\t\t\t\t} );\n\t\t\t}\n\t\t\tvariants.push( variant );\n\t\t} );\n\n\t\treturn variants;\n\t},\n\n\t/**\n\t * Retrieve available languages for a given title\n\t *\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {string} title the title of the page languages should be retrieved for\n\t * @param {string} [language] when provided the names of the languages returned\n\t *  will be translated additionally into this language.\n\t * @return {jQuery.Deferred} which is called with an object containing langlinks\n\t * and variant links as defined @ https://en.m.wikipedia.org/w/api.php?action=help&modules=query%2Blanglinks\n\t */\n\tgetPageLanguages: function ( title, language ) {\n\t\tvar self = this,\n\t\t\targs = actionParams( {\n\t\t\t\tmeta: 'siteinfo',\n\t\t\t\tsiprop: 'general',\n\t\t\t\tprop: 'langlinks',\n\t\t\t\tlllimit: 'max',\n\t\t\t\ttitles: title\n\t\t\t} );\n\n\t\tif ( language ) {\n\t\t\targs.llprop = 'url|autonym|langname';\n\t\t\targs.llinlanguagecode = language;\n\t\t} else {\n\t\t\targs.llprop = 'url|autonym';\n\t\t}\n\t\treturn this.api.get( args ).then( function ( resp ) {\n\t\t\treturn {\n\t\t\t\tlanguages: resp.query.pages[0].langlinks || [],\n\t\t\t\tvariants: self._getLanguageVariantsFromApiResponse( title, resp )\n\t\t\t};\n\t\t}, function () {\n\t\t\treturn util.Deferred().reject();\n\t\t} );\n\t},\n\n\t/**\n\t * Extract sections from headings in $el\n\t *\n\t * @memberof PageGateway\n\t * @instance\n\t * @private\n\t * @param {jQuery.Object} $el object from which sections are extracted\n\t * @return {Array} Array of section objects created from headings in $el\n\t * FIXME: Where's a better place for getSectionsFromHTML and this function to live?\n\t * Answer: Possibly Page.js\n\t */\n\t_getAPIResponseFromHTML: function ( $el ) {\n\t\t// FIXME: use PageHTMLParser.HEADING_SELECTOR\n\t\tvar $headings = $el.find( 'h1,h2,h3,h4,h5,h6' ),\n\t\t\tsections = [];\n\n\t\t$headings.each( function () {\n\t\t\tvar level = this.tagName.substr( 1 ),\n\t\t\t\t$span = $el.find( this ).find( '.mw-headline' );\n\n\t\t\tif ( $span.length ) {\n\t\t\t\tsections.push( {\n\t\t\t\t\tlevel: level,\n\t\t\t\t\tline: $span.html(),\n\t\t\t\t\tanchor: $span.attr( 'id' ) || '',\n\t\t\t\t\ttext: ''\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t\treturn sections;\n\t},\n\n\t/**\n\t * Order sections hierarchically\n\t *\n\t * @memberof PageGateway\n\t * @instance\n\t * @param {jQuery.Object} $el object from which sections are extracted\n\t * @return {Array} Ordered array of sections\n\t */\n\tgetSectionsFromHTML: function ( $el ) {\n\t\treturn transformSections( this._getAPIResponseFromHTML( $el ) );\n\t}\n};\n\nmodule.exports = PageGateway;\n","const\n\tThumbnail = require( './Thumbnail' ),\n\tHEADING_SELECTOR = mw.config.get( 'wgMFMobileFormatterHeadings', [ 'h1', 'h2', 'h3', 'h4', 'h5' ] ).join( ',' ),\n\tBLACKLISTED_THUMBNAIL_CLASS_SELECTORS = [ 'noviewer', 'metadata' ];\n\nclass PageHTMLParser {\n\t/**\n\t * @param {jQuery.Object} $container Used when parsing to find children within\n\t * this container\n\t */\n\tconstructor( $container ) {\n\t\tthis.$el = $container;\n\n\t\t// T220751: Cache headings as $el.find is a very expensive call.\n\t\t/** @private */\n\t\tthis.$headings = this.$el.find( HEADING_SELECTOR );\n\t}\n\n\t/**\n\t * Find the heading in the page.\n\t * This has the benefit of excluding any additional h2s and h3s that may\n\t * have been added programatically.\n\t *\n\t * @param {number} sectionIndex as defined by the PHP parser.\n\t *  It should correspond to the section id\n\t *  used in the edit link for the section.\n\t *  Note, confusingly, this is different from section \"ID\" which is\n\t * used in methods\n\t * @return {jQuery.Object}\n\t */\n\tfindSectionHeadingByIndex( sectionIndex ) {\n\t\tif ( sectionIndex < 1 ) {\n\t\t\t// negative indexes will search from the end, which is behaviour we do not want.\n\t\t\t// return an empty set when this happens.\n\t\t\t// eslint-disable-next-line no-undef\n\t\t\treturn $( [] );\n\t\t} else {\n\t\t\treturn this.$headings\n\t\t\t\t// Headings must strictly be a child element of a section element\n\t\t\t\t// or the parser-output.\n\t\t\t\t// Not an ancestor!\n\t\t\t\t.filter( '.mw-parser-output > *, [class^=\"mf-section-\"] > *' ).eq( sectionIndex - 1 );\n\t\t}\n\t}\n\n\t/**\n\t * Finds all child elements that match the selector in a given section or subsection.\n\t * Returns any direct child elements that match the selector,\n\t * (i.e. searches only one level deep)\n\t * as well as any elements that match the selector within those children.\n\t * If the Page has no headings (e.g. a stub),\n\t * then the search will target all nodes within the page.\n\t *\n\t * This code should work on desktop (PHP parser HTML)\n\t * as well as mobile formatted HTML (PHP parser + MobileFormatter)\n\t *\n\t * @param {number} sectionIndex as defined by the PHP parser. It should correspond to\n\t *  the section id used in the edit link for the section.\n\t *  Note, confusingly, this is different from section \"ID\" which is\n\t *  used in methods\n\t * @param {string} selector to match\n\t * @return {jQuery.Object}\n\t */\n\tfindChildInSectionLead( sectionIndex, selector ) {\n\t\tvar $heading, $nextHeading, $el, $lead,\n\t\t\theadingSelector = HEADING_SELECTOR;\n\n\t\tfunction withNestedChildren( $matchingNodes ) {\n\t\t\treturn $matchingNodes.find( selector ).addBack();\n\t\t}\n\n\t\tif ( sectionIndex === 0 ) {\n\t\t\t// lead is easy\n\t\t\t$lead = this.getLeadSectionElement();\n\t\t\tif ( $lead && $lead.length ) {\n\t\t\t\treturn withNestedChildren( $lead.children( selector ) );\n\t\t\t} else {\n\t\t\t\t$heading = this.findSectionHeadingByIndex( 1 );\n\t\t\t\treturn $heading.length ? withNestedChildren( $heading.prevAll( selector ) ) :\n\t\t\t\t\t// this page is a stub so search entire page\n\t\t\t\t\tthis.$el.find( selector );\n\t\t\t}\n\t\t}\n\n\t\t// find heading associated with the section by looking at its\n\t\t// index position in the article\n\t\t// section ids relate to the element position in the page and the first heading\n\t\t// lead has been dealt with above, so first heading corresponds to section 1,\n\t\t// the first heading in the article.\n\t\t$heading = this.findSectionHeadingByIndex( sectionIndex );\n\n\t\t// If section-heading is present on the heading,\n\t\t// then we know the page has been MobileFormatted\n\t\t// and that this is a wrapped section\n\t\tif ( $heading.hasClass( 'section-heading' ) ) {\n\t\t\t// get content of section\n\t\t\t$el = $heading.next();\n\t\t\t// inside section find the first heading\n\t\t\t$nextHeading = $el.find( headingSelector ).eq( 0 );\n\t\t\treturn $nextHeading.length ?\n\t\t\t\t// find all amboxes before the next heading\n\t\t\t\twithNestedChildren( $nextHeading.prevAll( selector ) ) :\n\t\t\t\t// There is no subheadings inside\n\t\t\t\t// Grab all issues in section\n\t\t\t\twithNestedChildren( $el.children( selector ) );\n\t\t} else {\n\t\t\t// the heading relates to a subsection (or unwrapped desktop section),\n\t\t\t// so grab elements between this and the next one\n\t\t\t$nextHeading = $heading.eq( 0 ).nextAll( headingSelector ).eq( 0 );\n\t\t\treturn $heading.nextUntil( $nextHeading, selector );\n\t\t}\n\t}\n\n\t/**\n\t * Get the lead section of the page view.\n\t *\n\t * @return {jQuery.Object|null}\n\t */\n\tgetLeadSectionElement() {\n\t\t/*\n\t\t * The page is formatted as follows:\n\t\t * <div id=\"bodyContent\">\n\t\t *   <!-- content of the page.. -->\n\t\t *   <div id=\"mw-content-text\">\n\t\t *     <div class=\"mf-section-0\">lead section</div>\n\t\t *     <h2></h2>\n\t\t *     <div class=\"mf-section-1\">second section</div>\n\t\t *   </div>\n\t\t * </div>\n\t\t */\n\t\tconst $leadSection = this.$el.find( '.mf-section-0' );\n\n\t\tif ( $leadSection.length ) {\n\t\t\treturn $leadSection;\n\t\t}\n\t\t// no lead section found\n\t\treturn null;\n\t}\n\n\t/**\n\t * Return all the thumbnails in the article.\n\t * Images which have a class or link container (.image|.thumbimage)\n\t * that matches one of the items of the constant BLACKLISTED_THUMBNAIL_CLASS_SELECTORS\n\t * will be excluded.\n\t * A thumbnail nested inside one of these classes will still be returned.\n\t * e.g. `<div class=\"noviewer\"><a class=\"image\"><img></a></div>` is not a valid thumbnail\n\t * `<a class=\"image noviewer\"><img></a>` is not a valid thumbnail\n\t * `<a class=\"image\"><img class=\"noviewer\"></a>` is not a valid thumbnail\n\t *\n\t * @param {jQuery} [$el] Container to search, defaults to this.$el.\n\t * @return {Thumbnail[]}\n\t */\n\tgetThumbnails( $el ) {\n\t\tvar $thumbs,\n\t\t\tblacklistSelector = '.' + BLACKLISTED_THUMBNAIL_CLASS_SELECTORS.join( ',.' ),\n\t\t\tthumbs = [];\n\n\t\t$el = $el || this.$el;\n\n\t\t$thumbs = $el.find( 'a.image, a.thumbimage' )\n\t\t\t.not( blacklistSelector );\n\n\t\t$thumbs.each( function () {\n\t\t\tvar $a = $el.find( this ),\n\t\t\t\t$lazyImage = $a.find( '.lazy-image-placeholder' ),\n\t\t\t\t// Parents need to be checked as well.\n\t\t\t\tvalid = $a.parents( blacklistSelector ).length === 0 &&\n\t\t\t\t\t$a.find( blacklistSelector ).length === 0,\n\t\t\t\thref = $a.attr( 'href' ),\n\t\t\t\tlegacyMatch = href && href.match( /title=([^/&]+)/ ),\n\t\t\t\tmatch = href && href.match( /[^/]+$/ );\n\n\t\t\t// filter out invalid lazy loaded images if so far image is valid\n\t\t\tif ( $lazyImage.length && valid ) {\n\t\t\t\t// if the regex matches it means the image has one of the classes\n\t\t\t\t// thus we must invert the result\n\t\t\t\tvalid = !new RegExp( '\\\\b(' + BLACKLISTED_THUMBNAIL_CLASS_SELECTORS.join( '|' ) + ')\\\\b' )\n\t\t\t\t\t.test( $lazyImage.data( 'class' ) );\n\t\t\t}\n\n\t\t\tif ( valid && ( legacyMatch || match ) ) {\n\t\t\t\tthumbs.push(\n\t\t\t\t\tnew Thumbnail( {\n\t\t\t\t\t\tel: $a,\n\t\t\t\t\t\tfilename: decodeURIComponent(\n\t\t\t\t\t\t\tlegacyMatch ? legacyMatch[1] : match[0]\n\t\t\t\t\t\t)\n\t\t\t\t\t} )\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\t\treturn thumbs;\n\t}\n\n\t/**\n\t * Returns a jQuery object representing all redlinks on the page.\n\t *\n\t * @return {jQuery.Object}\n\t */\n\tgetRedLinks() {\n\t\treturn this.$el.find( '.new' );\n\t}\n}\n\n/**\n * Selector for matching headings\n *\n * @memberof PageHTMLParser\n */\nPageHTMLParser.HEADING_SELECTOR = HEADING_SELECTOR;\n\nmodule.exports = PageHTMLParser;\n","var util = require( './util.js' ),\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' ),\n\tbrowser = require( './Browser' ).getSingleton();\n\n/**\n * List of items page view\n *\n * @class PageList\n * @extends View\n */\nfunction PageList() {\n\tView.apply( this, arguments );\n}\n\nmfExtend( PageList, View, {\n\t/**\n\t * @memberof PageList\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {Page[]} defaults.pages Array of Page objects. These should match\n\t *                              the Page model and not necessarily the\n\t *                              underlying API format used.\n\t * E.g. [\n\t *   {\n\t *     heading: \"<strong>C</strong>laude Monet\",\n\t *     id: undefined,\n\t *     title: \"Claude Monet\",\n\t *     displayTitle: \"<i>Claude Monet</i>\",\n\t *     url: \"/wiki/Claude_Monet\",\n\t *     thumbnail: {\n\t *       height: 62,\n\t *       source: \"http://127.0.0.1:8080/images/thumb/thumb.jpg\",\n\t *       width: 80,\n\t *       isLandscape: true\n\t *     }\n\t *   }\n\t * ]\n\t */\n\tdefaults: {\n\t\tpages: []\n\t},\n\t/**\n\t * Render page images for the existing page list. Assumes no page images have been loaded.\n\t *\n\t * @memberof PageList\n\t * @instance\n\t */\n\trenderPageImages: function () {\n\t\tvar self = this;\n\n\t\tsetTimeout( function () {\n\t\t\tself.$el.find( '.list-thumb' ).each( function () {\n\t\t\t\tvar style = self.$el.find( this ).data( 'style' );\n\t\t\t\tself.$el.find( this ).attr( 'style', style );\n\t\t\t} );\n\t\t\t// Delay an unnecessary load of images on mobile (slower?) connections\n\t\t\t// In particular on search results which can be regenerated quickly.\n\t\t}, browser.isWideScreen() ? 0 : 1000 );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof PageList\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.renderPageImages();\n\t},\n\ttemplate: util.template( `\n<ul class=\"page-list thumbs actionable\">\n\t{{#pages}}\n\t\t{{>item}}\n\t{{/pages}}\n</ul>\n\t` ),\n\t/**\n\t * @memberof PageList\n\t * @instance\n\t */\n\ttemplatePartials: {\n\t\t// The server uses a very different structure in\n\t\t// SpecialMobileEditWatchlist.getLineHtml(). Be aware of these differences\n\t\t// when updating server rendered items.\n\t\titem: util.template( `\n<li title=\"{{title}}\" data-id=\"{{id}}\" class=\"page-summary\">\n  <a href=\"{{url}}\" class=\"title {{#isMissing}}new{{/isMissing}}\"\n    {{#anchor}}name=\"{{anchor}}\"{{/anchor}}\n    {{#latitude}}data-latlng=\"{{latitude}},{{longitude}}\"{{/latitude}}\n    data-title=\"{{title}}\">\n    <div class=\"list-thumb\n      {{^thumbnail}}list-thumb-none list-thumb-x{{/thumbnail}}\n      {{#thumbnail.isLandscape}}list-thumb-y{{/thumbnail.isLandscape}}\n      {{^thumbnail.isLandscape}}list-thumb-x{{/thumbnail.isLandscape}}\"\n      {{#thumbnail}}data-style=\"background-image: url( {{thumbnail.source}} )\"{{/thumbnail}}></div>\n    <h3>{{{displayTitle}}}</h3>\n    {{#wikidataDescription}}\n    <div class=\"wikidata-description\">{{wikidataDescription}}</div>\n    {{/wikidataDescription}}\n    {{#lastModified}}\n    <div class=\"info\">{{lastModified}}</div>\n    {{/lastModified}}\n    {{#proximity}}\n    <div class=\"info proximity\">{{proximity}}</div>\n    {{/proximity}}\n  </a>\n</li>\n\t` )\n\t}\n} );\n\nmodule.exports = PageList;\n","var util = require( './util' ),\n\tmfExtend = require( './mfExtend' );\n\n/**\n * Class to assist a view in implementing infinite scrolling on some DOM\n * element. This module itself is only responsible for emitting an Event when\n * the bottom of an Element is scrolled to.\n *\n * @class ScrollEndEventEmitter\n * @mixins OO.EventEmitter\n *\n * Use this class in a view to help it do infinite scrolling.\n *\n * 1. Initialize it in the constructor `initialize` and listen to the\n *   EVENT_SCROLL_END event it emits (and call your loading function then)\n * 2. On preRender (once we have the DOM element) set it into the infinite\n *   scrolling object and disable it until we've loaded.\n * 3. Once you have loaded the list and put it in the DOM, enable the\n *   infinite scrolling detection.\n *   * Everytime the scroller detection triggers a load, it auto disables\n *     to not trigger multiple times. After you have loaded, manually\n *     re-enable it.\n *\n * Example:\n *     @example\n *     <code>\n *       var\n *         mfExtend = require( './mfExtend' ),\n *         ScrollEndEventEmitter = require( './ScrollEndEventEmitter' ),\n *         eventBus = require( './eventBusSingleton' );\n *       mfExtend( PhotoList, View, {\n *         //...\n *         initialize: function ( options ) {\n *           this.gateway = new PhotoListGateway( {\n *             username: options.username\n *           } );\n *           // 1. Set up infinite scroll helper and listen to events\n *           this.scrollEndEventEmitter = new ScrollEndEventEmitter( eventBus, 1000 );\n *           this.scrollEndEventEmitter.on( ScrollEndEventEmitter.EVENT_SCROLL_END,\n *             this._loadPhotos.bind( this ) );\n *           View.prototype.initialize.apply( this, arguments );\n *         },\n *         preRender: function () {\n *           // 2. Disable until we've got the list rendered and set DOM el\n *           this.scrollEndEventEmitter.setElement( this.$el );\n *           this.scrollEndEventEmitter.disable();\n *         },\n *         _loadPhotos: function () {\n *           var self = this;\n *           this.gateway.getPhotos().then( function ( photos ) {\n *             // load photos into the DOM ...\n *             // 3. and (re-)enable infinite scrolling\n *             self.scrollEndEventEmitter.enable();\n *           } );\n *         }\n *       } );\n *     </code>\n *\n * @fires ScrollEndEventEmitter#ScrollEndEventEmitter-scrollEnd\n * @param {Object} eventBus object to listen for scroll:throttled events\n * @param {number} [threshold=100] distance in pixels used to calculate if scroll\n * position is near the end of the $el\n */\nfunction ScrollEndEventEmitter( eventBus, threshold ) {\n\tthis.threshold = threshold || 100;\n\tthis.eventBus = eventBus;\n\tthis.enable();\n\tOO.EventEmitter.call( this );\n}\nOO.mixinClass( ScrollEndEventEmitter, OO.EventEmitter );\n\n/**\n * Fired when scroll bottom has been reached.\n *\n * @event ScrollEndEventEmitter#ScrollEndEventEmitter-scrollEnd\n */\nScrollEndEventEmitter.EVENT_SCROLL_END = 'ScrollEndEventEmitter-scrollEnd';\n\nmfExtend( ScrollEndEventEmitter, {\n\t/**\n\t * Listen to scroll on window and notify this._onScroll\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t */\n\t_bindScroll: function () {\n\t\tif ( !this._scrollHandler ) {\n\t\t\tthis._scrollHandler = this._onScroll.bind( this );\n\t\t\tthis.eventBus.on( 'scroll:throttled', this._scrollHandler );\n\t\t}\n\t},\n\t/**\n\t * Unbind scroll handler\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t */\n\t_unbindScroll: function () {\n\t\tif ( this._scrollHandler ) {\n\t\t\tthis.eventBus.off( 'scroll:throttled', this._scrollHandler );\n\t\t\tthis._scrollHandler = null;\n\t\t}\n\t},\n\t/**\n\t * Scroll handler. Triggers load event when near the end of the container.\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t */\n\t_onScroll: function () {\n\t\tif ( this.$el && this.enabled && this.scrollNearEnd() ) {\n\t\t\t// Disable when triggering an event. Won't trigger again until\n\t\t\t// re-enabled.\n\t\t\tthis.disable();\n\t\t\tthis.emit( ScrollEndEventEmitter.EVENT_SCROLL_END );\n\t\t}\n\t},\n\t/**\n\t * Is the scroll position near the end of the container element?\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @private\n\t * @return {boolean}\n\t */\n\tscrollNearEnd: function () {\n\t\tvar $window = util.getWindow(),\n\t\t\tscrollBottom = $window.scrollTop() + $window.height(),\n\t\t\tendPosition = this.$el.offset().top + this.$el.outerHeight();\n\t\treturn scrollBottom + this.threshold > endPosition;\n\t},\n\t/**\n\t * Enable the ScrollEndEventEmitter so that it triggers events.\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t */\n\tenable: function () {\n\t\tthis.enabled = true;\n\t\tthis._bindScroll();\n\t},\n\t/**\n\t * Disable the ScrollEndEventEmitter so that it doesn't trigger events.\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t */\n\tdisable: function () {\n\t\tthis.enabled = false;\n\t\tthis._unbindScroll();\n\t},\n\t/**\n\t * Set the element to compare to scroll position to\n\t *\n\t * @memberof ScrollEndEventEmitter\n\t * @instance\n\t * @param {jQuery.Object} $el jQuery element where we want to listen for\n\t * scroll end.\n\t */\n\tsetElement: function ( $el ) {\n\t\tthis.$el = $el;\n\t}\n} );\n\nmodule.exports = ScrollEndEventEmitter;\n","var util = require( './util.js' ),\n\tmfExtend = require( './mfExtend' ),\n\tView = require( './View' );\n\n/**\n * Builds a section of a page\n *\n * @class Section\n * @extends View\n *\n * @param {Object} options Configuration options\n */\nfunction Section( options ) {\n\tvar self = this;\n\toptions.tag = 'h' + options.level;\n\tthis.line = options.line;\n\tthis.text = options.text;\n\tthis.hasReferences = options.hasReferences || false;\n\tthis.id = options.id || null;\n\tthis.anchor = options.anchor;\n\tthis.subsections = [];\n\t( options.subsections || [] ).forEach( function ( section ) {\n\t\tself.subsections.push( new Section( section ) );\n\t} );\n\tView.call( this, options );\n}\n\nmfExtend( Section, View, {\n\ttemplate: util.template( `\n<h{{level}} id=\"{{anchor}}\">{{{line}}}</h{{level}}>\n{{{text}}}\n\t` ),\n\t/**\n\t * @memberof Section\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.text Section text.\n\t */\n\tdefaults: {\n\t\tline: undefined,\n\t\ttext: ''\n\t}\n} );\n\nmodule.exports = Section;\n","var\n\tmfExtend = require( './mfExtend' ),\n\tutil = require( './util' ),\n\tView = require( './View' );\n\n/**\n * Representation of a thumbnail\n *\n * @class Thumbnail\n * @extends View\n * @param {Object} options\n */\nfunction Thumbnail( options ) {\n\tView.call( this,\n\t\tutil.extend( { isBorderBox: false }, options )\n\t);\n}\n\nmfExtend( Thumbnail, View, {\n\t/**\n\t * @memberof Thumbnail\n\t * @instance\n\t * @mixes View#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.filename uri decoded filename including File: prefix\n\t *  associated with thumbnail\n\t */\n\tdefaults: {\n\t\tfilename: undefined\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof Thumbnail\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tthis.options.description = this.$el.siblings( '.thumbcaption' ).text();\n\t},\n\t/**\n\t * Obtain description for thumbnail\n\t *\n\t * @memberof Thumbnail\n\t * @instance\n\t * @return {string}\n\t */\n\tgetDescription: function () {\n\t\treturn this.options.description;\n\t},\n\t/**\n\t * Return the page title for the thumbnail\n\t *\n\t * @memberof Thumbnail\n\t * @instance\n\t * @return {string}\n\t */\n\tgetFileName: function () {\n\t\treturn this.options.filename;\n\t}\n} );\n\nmodule.exports = Thumbnail;\n","var browser = require( './Browser' ).getSingleton(),\n\tutil = require( './util' ),\n\tescapeHash = util.escapeHash,\n\tarrowOptions = {\n\t\tname: 'expand',\n\t\tisSmall: true,\n\t\tadditionalClassNames: 'indicator mw-ui-icon-flush-left'\n\t},\n\tIcon = require( './Icon' );\n\n/**\n *\n * @typedef {Object} ToggledEvent\n * @prop {boolean} expanded True if section is opened, false if closed.\n * @prop {Page} page\n * @prop {boolean} isReferenceSection\n * @prop {jQuery.Object} $heading\n */\n\n/**\n * A class for enabling toggling\n *\n * @class Toggler\n * @param {Object} options\n * @param {OO.EventEmitter} options.eventBus Object used to emit section-toggled events.\n * @param {jQuery.Object} options.$container to apply toggling to\n * @param {string} options.prefix a prefix to use for the id.\n * @param {Page} options.page to allow storage of session for future visits\n * @param {boolean} [options.isClosed]\n */\nfunction Toggler( options ) {\n\tthis.eventBus = options.eventBus;\n\tthis._enable( options.$container, options.prefix, options.page, options.isClosed );\n}\n\n/**\n * Using the settings module looks at what sections were previously expanded on\n * existing page.\n *\n * @param {Page} page\n * @return {Object} representing open sections\n */\nfunction getExpandedSections( page ) {\n\tvar expandedSections = JSON.parse( mw.storage.session.get( 'expandedSections' ) || '{}' );\n\texpandedSections[page.title] = expandedSections[page.title] || {};\n\treturn expandedSections;\n}\n\n/**\n * @param {Object} expandedSections\n * Save expandedSections to localStorage\n */\nfunction saveExpandedSections( expandedSections ) {\n\tif ( mw.storage.get( 'expandedSections' ) ) {\n\t\tmw.storage.session.set(\n\t\t\t'expandedSections', JSON.stringify( mw.storage.get( 'expandedSections' ) )\n\t\t);\n\t\t// Clean up any old storage.\n\t\t// The following line can be removed 1 week after\n\t\t// Ib7c0a45fcf8645a900288a26d172781612fa1606 is deployed\n\t\tmw.storage.remove( 'expandedSections' );\n\t}\n\tmw.storage.session.set(\n\t\t'expandedSections', JSON.stringify( expandedSections )\n\t);\n}\n\n/**\n * Given an expanded heading, store it to localStorage.\n * If the heading is collapsed, remove it from localStorage.\n *\n * @param {jQuery.Object} $heading - A heading belonging to a section\n * @param {Page} page\n */\nfunction storeSectionToggleState( $heading, page ) {\n\tvar headline = $heading.find( 'span' ).attr( 'id' ),\n\t\tisSectionOpen = $heading.hasClass( 'open-block' ),\n\t\texpandedSections = getExpandedSections( page );\n\n\tif ( headline && expandedSections[page.title] ) {\n\t\tif ( isSectionOpen ) {\n\t\t\texpandedSections[page.title][headline] = ( new Date() ).getTime();\n\t\t} else {\n\t\t\tdelete expandedSections[page.title][headline];\n\t\t}\n\n\t\tsaveExpandedSections( expandedSections );\n\t}\n}\n\n/**\n * Expand sections that were previously expanded before leaving this page.\n *\n * @param {Toggler} toggler\n * @param {jQuery.Object} $container\n * @param {Page} page\n */\nfunction expandStoredSections( toggler, $container, page ) {\n\tvar $sectionHeading, $headline,\n\t\texpandedSections = getExpandedSections( page ),\n\t\t$headlines = $container.find( '.section-heading span' );\n\n\t$headlines.each( function () {\n\t\t$headline = $container.find( this );\n\t\t$sectionHeading = $headline.parents( '.section-heading' );\n\t\t// toggle only if the section is not already expanded\n\t\tif (\n\t\t\texpandedSections[page.title][$headline.attr( 'id' )] &&\n\t\t!$sectionHeading.hasClass( 'open-block' )\n\t\t) {\n\t\t\ttoggler.toggle( $sectionHeading, page );\n\t\t}\n\t} );\n}\n\n/**\n * Clean obsolete (saved more than a day ago) expanded sections from\n * localStorage.\n *\n * @param {Page} page\n */\nfunction cleanObsoleteStoredSections( page ) {\n\tvar now = ( new Date() ).getTime(),\n\t\texpandedSections = getExpandedSections( page ),\n\t\t// the number of days between now and the time a setting was saved\n\t\tdaysDifference;\n\tObject.keys( expandedSections ).forEach( function ( page ) {\n\t\tvar sections = expandedSections[ page ];\n\t\t// clean the setting if it is more than a day old\n\t\tObject.keys( sections ).forEach( function ( section ) {\n\t\t\tvar timestamp = sections[ section ];\n\t\t\tdaysDifference = Math.floor( ( now - timestamp ) / 1000 / 60 / 60 / 24 );\n\t\t\tif ( daysDifference >= 1 ) {\n\t\t\t\tdelete expandedSections[page][section];\n\t\t\t}\n\t\t} );\n\t} );\n\tsaveExpandedSections( expandedSections );\n}\n\n/**\n * Given a heading, toggle it and any of its children\n *\n * @memberof Toggler\n * @instance\n * @param {jQuery.Object} $heading A heading belonging to a section\n * @param {Page} page\n */\nToggler.prototype.toggle = function ( $heading, page ) {\n\tvar indicator,\n\t\tself = this,\n\t\twasExpanded = $heading.is( '.open-block' ),\n\t\t$headingLabel = $heading.find( '.mw-headline' ),\n\t\t$content = $heading.next();\n\n\t$heading.toggleClass( 'open-block' );\n\t$heading.data( 'indicator' ).remove();\n\n\tarrowOptions.rotation = wasExpanded ? 0 : 180;\n\tindicator = new Icon( arrowOptions ).prependTo( $heading );\n\t$heading.data( 'indicator', indicator );\n\n\t$headingLabel.attr( 'aria-expanded', !wasExpanded );\n\n\t$content.toggleClass( 'open-block' );\n\n\t/* T239418 We consider this event as a low-priority one and emit it asynchronously.\n\tThis ensures that any logic associated with section toggling is async and not contributing\n\tdirectly to a slow click/press event handler.\n\n\tCurrently costly reflow-inducing viewport size computation is being done for lazy-loaded\n\timages by the main listener to this event. */\n\tmw.requestIdleCallback( function () {\n\t\t/**\n\t\t * Global event emitted after a section has been toggled\n\t\t *\n\t\t * @event section-toggled\n\t\t * @type {ToggledEvent}\n\t\t */\n\n\t\tself.eventBus.emit( 'section-toggled', {\n\t\t\texpanded: wasExpanded,\n\t\t\tisReferenceSection: Boolean( $content.attr( 'data-is-reference-section' ) ),\n\t\t\t$heading: $heading\n\t\t} );\n\t} );\n\n\tif ( !browser.isWideScreen() ) {\n\t\tstoreSectionToggleState( $heading, page );\n\t}\n};\n\n/**\n * Enables toggling via enter and space keys\n *\n * @param {Toggler} toggler instance.\n * @param {jQuery.Object} $heading\n * @param {Page} page\n */\nfunction enableKeyboardActions( toggler, $heading, page ) {\n\t$heading.on( 'keypress', function ( ev ) {\n\t\tif ( ev.which === 13 || ev.which === 32 ) {\n\t\t\t// Only handle keypresses on the \"Enter\" or \"Space\" keys\n\t\t\ttoggler.toggle( $heading, page );\n\t\t}\n\t} ).find( 'a' ).on( 'keypress mouseup', function ( ev ) {\n\t\tev.stopPropagation();\n\t} );\n}\n\n/**\n * Reveals an element and its parent section as identified by it's id\n *\n * @memberof Toggler\n * @instance\n * @param {string} selector A css selector that identifies a single element\n * @param {Object} $container jQuery element to search in\n * @param {Page} page\n */\nToggler.prototype.reveal = function ( selector, $container, page ) {\n\tvar $target, $heading;\n\n\t// jQuery will throw for hashes containing certain characters which can break toggling\n\ttry {\n\t\t$target = $container.find( escapeHash( selector ) );\n\t\t$heading = $target.parents( '.collapsible-heading' );\n\t\t// The heading is not a section heading, check if in a content block!\n\t\tif ( !$heading.length ) {\n\t\t\t$heading = $target.parents( '.collapsible-block' ).prev( '.collapsible-heading' );\n\t\t}\n\t\tif ( $heading.length && !$heading.hasClass( 'open-block' ) ) {\n\t\t\tthis.toggle( $heading, page );\n\t\t}\n\t\tif ( $heading.length ) {\n\t\t\t// scroll again after opening section (opening section makes the page longer)\n\t\t\twindow.scrollTo( 0, $target.offset().top );\n\t\t}\n\t} catch ( e ) {}\n};\n\n/**\n * Enables section toggling in a given container when wgMFCollapseSectionsByDefault\n * is enabled.\n *\n * @memberof Toggler\n * @instance\n * @param {jQuery.Object} $container to apply toggling to\n * @param {string} prefix a prefix to use for the id.\n * @param {Page} page to allow storage of session for future visits\n * @param {boolean} [isClosed] whether the element should begin closed\n * @private\n */\nToggler.prototype._enable = function ( $container, prefix, page, isClosed ) {\n\tvar tagName, expandSections, indicator, $content,\n\t\t$firstHeading,\n\t\t$link,\n\t\tself = this,\n\t\tcollapseSectionsByDefault = mw.config.get( 'wgMFCollapseSectionsByDefault' );\n\n\t// Also allow .section-heading if some extensions like Wikibase\n\t// want to toggle other headlines than direct descendants of $container.\n\t$firstHeading = $container.find( '> h1,> h2,> h3,> h4,> h5,> h6,.section-heading' ).eq( 0 );\n\ttagName = $firstHeading.prop( 'tagName' ) || 'H1';\n\n\tif ( collapseSectionsByDefault === undefined ) {\n\t\t// Old default behavior if on cached output\n\t\tcollapseSectionsByDefault = true;\n\t}\n\t// NB: 'expandSections' uses localStorage, unlike 'expandedSections' which uses sessionStorage\n\texpandSections = !collapseSectionsByDefault || mw.storage.get( 'expandSections' ) === 'true';\n\n\t$container.children( tagName ).each( function ( i ) {\n\t\tvar isReferenceSection,\n\t\t\t$heading = $container.find( this ),\n\t\t\t$headingLabel = $heading.find( '.mw-headline' ),\n\t\t\t$indicator = $heading.find( '.indicator' ),\n\t\t\tid = prefix + 'collapsible-block-' + i;\n\t\t// Be sure there is a `section` wrapping the section content.\n\t\t// Otherwise, collapsible sections for this page is not enabled.\n\t\tif ( $heading.next().is( 'section' ) ) {\n\t\t\t$content = $heading.next( 'section' );\n\t\t\tisReferenceSection = Boolean( $content.attr( 'data-is-reference-section' ) );\n\t\t\t$heading\n\t\t\t\t.addClass( 'collapsible-heading ' )\n\t\t\t\t.data( 'section-number', i )\n\t\t\t\t.on( 'click', function ( ev ) {\n\t\t\t\t\t// don't toggle, if the click target was a link\n\t\t\t\t\t// (a link in a section heading)\n\t\t\t\t\t// See T117880\n\t\t\t\t\tif ( !ev.target.href ) {\n\t\t\t\t\t\t// prevent taps/clicks on edit button after toggling (bug 56209)\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\tself.toggle( $heading, page );\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t$headingLabel\n\t\t\t\t.attr( {\n\t\t\t\t\ttabindex: 0,\n\t\t\t\t\trole: 'button',\n\t\t\t\t\t'aria-controls': id,\n\t\t\t\t\t'aria-expanded': 'false'\n\t\t\t\t} );\n\n\t\t\tarrowOptions.rotation = expandSections ? 180 : 0;\n\t\t\tindicator = new Icon( arrowOptions );\n\n\t\t\tif ( $indicator.length ) {\n\t\t\t\t// replace the existing indicator\n\t\t\t\t$indicator.replaceWith( indicator.$el );\n\t\t\t} else {\n\t\t\t\tindicator.prependTo( $heading );\n\t\t\t}\n\t\t\t$heading.data( 'indicator', indicator.$el );\n\t\t\t$content\n\t\t\t\t.addClass( 'collapsible-block' )\n\t\t\t\t.eq( 0 )\n\t\t\t\t.attr( {\n\t\t\t\t\t// We need to give each content block a unique id as that's\n\t\t\t\t\t// the only way we can tell screen readers what element we're\n\t\t\t\t\t// referring to via `aria-controls`.\n\t\t\t\t\tid: id\n\t\t\t\t} );\n\n\t\t\tenableKeyboardActions( self, $heading, page );\n\t\t\tif (\n\t\t\t\t!isReferenceSection && (\n\t\t\t\t\t!isClosed && browser.isWideScreen() || expandSections\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// Expand sections by default on wide screen devices\n\t\t\t\t// or if the expand sections setting is set.\n\t\t\t\t// The wide screen logic for determining whether to collapse sections initially\n\t\t\t\t// should be kept in sync with mobileoptions#initLocalStorageElements().\n\t\t\t\tself.toggle( $heading, page );\n\t\t\t}\n\t\t}\n\t} );\n\n\t/* eslint-disable no-restricted-properties */\n\t/**\n\t * Checks the existing hash and toggles open any section that contains the fragment.\n\t *\n\t * @method\n\t */\n\tfunction checkHash() {\n\t\tvar hash = window.location.hash;\n\t\tvar decodedHash;\n\t\tif ( hash.indexOf( '#' ) === 0 ) {\n\t\t\t// Non-latin characters in the hash will be provided percent-encoded, which\n\t\t\t// jQuery would later fail to cope with.\n\t\t\ttry {\n\t\t\t\tdecodedHash = decodeURIComponent( hash );\n\t\t\t\tself.reveal( decodedHash, $container, page );\n\t\t\t} catch ( e ) {\n\t\t\t\t// sometimes decoding will fail e.g. T262599, T264914. If that happens ignore.\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks the value of wgInternalRedirectTargetUrl and reveals the collapsed\n\t * section that contains it if present\n\t *\n\t * @method\n\t */\n\tfunction checkInternalRedirectAndHash() {\n\t\tvar internalRedirect = mw.config.get( 'wgInternalRedirectTargetUrl' ),\n\t\t\tinternalRedirectHash = internalRedirect ? internalRedirect.split( '#' )[1] : false;\n\n\t\tif ( internalRedirectHash ) {\n\t\t\twindow.location.hash = internalRedirectHash;\n\t\t\tself.reveal( internalRedirectHash, $container, page );\n\t\t}\n\t}\n\t/* eslint-enable no-restricted-properties */\n\n\tcheckInternalRedirectAndHash();\n\tcheckHash();\n\t// Restricted to links created by editors and thus outside our control\n\t// T166544 - don't do this for reference links - they will be handled elsewhere\n\t$link = $container.find( 'a:not(.reference a)' );\n\t$link.on( 'click', function () {\n\t\t// the link might be an internal link with a hash.\n\t\t// if it is check if we need to reveal any sections.\n\t\tif ( $link.attr( 'href' ) !== undefined &&\n\t\t$link.attr( 'href' ).indexOf( '#' ) > -1\n\t\t) {\n\t\t\tcheckHash();\n\t\t}\n\t} );\n\tutil.getWindow().on( 'hashchange', function () {\n\t\tcheckHash();\n\t} );\n\n\tif ( !browser.isWideScreen() && page ) {\n\t\texpandStoredSections( this, $container, page );\n\t\tcleanObsoleteStoredSections( page );\n\t}\n};\n\nToggler._getExpandedSections = getExpandedSections;\nToggler._expandStoredSections = expandStoredSections;\nToggler._cleanObsoleteStoredSections = cleanObsoleteStoredSections;\n\nmodule.exports = Toggler;\n","/* global $ */\nvar util = require( './util' ),\n\tmfExtend = require( './mfExtend' ),\n\t// Cached regex to split keys for `delegate`.\n\tdelegateEventSplitter = /^(\\S+)\\s*(.*)$/,\n\tidCounter = 0;\n\n/**\n * Generate a unique integer id (unique within the entire client session).\n * Useful for temporary DOM ids.\n *\n * @param {string} prefix Prefix to be used when generating the id.\n * @return {string}\n */\nfunction uniqueId( prefix ) {\n\tvar id = ( ++idCounter ).toString();\n\treturn prefix ? prefix + id : id;\n}\n\n/**\n * Should be extended using extend().\n *\n * When options contains el property, this.$el in the constructed object\n * will be set to the corresponding jQuery object. Otherwise, this.$el\n * will be an empty div.\n *\n * When extended using extend(), if the extended prototype contains\n * template property, this.$el will be filled with rendered template (with\n * options parameter used as template data).\n *\n * template property can be a string which will be passed to mw.template.compile()\n * or an object that has a render() function which accepts an object with\n * template data as its argument (similarly to an object created by\n * mw.template.compile()).\n *\n * You can also define a defaults property which should be an object\n * containing default values for the template (if they're not present in\n * the options parameter).\n *\n * If this.$el is not a jQuery object bound to existing DOM element, the\n * view can be attached to an element using appendTo(), prependTo(),\n * insertBefore(), insertAfter() proxy functions.\n *\n * append(), prepend(), before(), after() can be used to modify $el. on()\n * can be used to bind events.\n *\n * You can also use declarative DOM events binding by specifying an `events`\n * map on the class. The keys will be 'event selector' and the value can be\n * either the name of a method to call, or a function. All methods and\n * functions will be executed on the context of the View.\n *\n * Inspired from Backbone.js\n * https://github.com/jashkenas/backbone/blob/master/backbone.js#L1128\n *\n * Example:\n * ```js\n *     var\n *       MyComponent = View.extend( {\n *         edit: function ( ev ) {\n *           //...\n *         },\n *         save: function ( ev ) {\n *           //...\n *         }\n *       } ),\n *       instance = new MyComponent({\n *         events: {\n *           'mousedown .title': 'edit',\n *           'click .button': 'save',\n *           'click .open': function(e) { ... }\n *         }\n *       });\n * ```\n *\n * Example:\n * ```js\n *     var View, section;\n *     function Section( options ) {\n *       var defaultOptions = {\n *         events: {\n *           // ...\n *         }\n *       }\n *       View.call( this, util.extends( {}, defaultOptions, options ) );\n *     }\n *     View = require( './View' );\n *     require( './mfExtend' )( Section, View, {\n *       template: mw.template.compile( \"&lt;h2&gt;{{title}}&lt;/h2&gt;\" ),\n *     } );\n *     section = new Section( { title: 'Test', text: 'Test section body' } );\n *     section.appendTo( 'body' );\n * ```\n *\n * @class View\n * @mixins OO.EventEmitter\n */\n\nfunction View() {\n\tthis.initialize.apply( this, arguments );\n}\nOO.mixinClass( View, OO.EventEmitter );\nmfExtend( View, {\n\t/**\n\t * Name of tag that contains the rendered template\n\t *\n\t * @memberof View\n\t * @instance\n\t * @property {string} tagName\n\t */\n\ttagName: 'div',\n\t/**\n\t * Tells the View to ignore tagName and className when constructing the element\n\t * and to rely solely on the template\n\t *\n\t * @memberof View\n\t * @instance\n\t * @property {boolean} isTemplateMode\n\t */\n\tisTemplateMode: false,\n\t/**\n\t * @memberof View\n\t * @instance\n\t * @property {Mixed}\n\t * Specifies the template used in render(). Object|string\n\t */\n\ttemplate: undefined,\n\n\t/**\n\t * Specifies partials (sub-templates) for the main template. Example:\n\t *\n\t *     @example\n\t *     // example content for the \"some\" template (sub-template will be\n\t *     // inserted where {{>content}} is):\n\t *     // <h1>Heading</h1>\n\t *     // {{>content}}\n\t *\n\t *     oo.mfExtend( SomeView, View, {\n\t *       template: util.template( '<source-code>' ),\n\t *       templatePartials: { content: util.template( '<source-code>' ) }\n\t *     }\n\t *\n\t * @memberof View\n\t * @instance\n\t * @property {Object}\n\t */\n\ttemplatePartials: {},\n\n\t/**\n\t * A set of default options that are merged with options passed into the initialize\n\t * function.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @property {Object} defaults Default options hash.\n\t * @property {jQuery.Object|string} [defaults.el] jQuery selector to use for rendering.\n\t * @property {boolean} [defaults.skipTemplateRender] Whether to enhance views already in\n\t * DOM. When enabled, the template is disabled so that it is not rendered in the DOM.\n\t * Use in conjunction with View::defaults.$el to associate the View with an existing\n\t * already rendered element in the DOM.\n\t */\n\tdefaults: {},\n\n\t/**\n\t * Run once during construction to set up the View\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} options Object passed to the constructor.\n\t * @param {Object.<string, string>} [options.events]\n\t */\n\tinitialize: function ( options ) {\n\t\tvar self = this;\n\n\t\tOO.EventEmitter.call( this );\n\t\toptions = util.extend( {}, this.defaults, options );\n\t\tthis.options = options;\n\t\t// Assign a unique id for dom events binding/unbinding\n\t\tthis.cid = uniqueId( 'view' );\n\n\t\t// TODO: if template compilation is too slow, don't compile them on a\n\t\t// per object basis, but don't worry about it now (maybe add cache to\n\t\t// M.template.compile())\n\t\tif ( typeof this.template === 'string' ) {\n\t\t\tthis.template = mw.template.compile( this.template );\n\t\t}\n\n\t\tif ( options.el ) {\n\t\t\t// Note the element may not be in the document so must use global jQuery here\n\t\t\tthis.$el = $( options.el );\n\t\t} else {\n\t\t\tthis.$el = this.parseHTML( '<' + this.tagName + '>' );\n\t\t}\n\n\t\t// Make sure the element is ready to be manipulated\n\t\tif ( this.$el.length ) {\n\t\t\tthis._postInitialize( options );\n\t\t} else {\n\t\t\tutil.docReady( function () {\n\t\t\t\t// Note the element may not be in the document so must use global jQuery here\n\t\t\t\tself.$el = $( options.el );\n\t\t\t\tself._postInitialize( options );\n\t\t\t} );\n\t\t}\n\t},\n\n\t/**\n\t * Called when this.$el is ready.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @private\n\t * @param {Object} props\n\t */\n\t_postInitialize: function ( props ) {\n\t\t// eslint-disable-next-line mediawiki/class-doc\n\t\tthis.$el.addClass( props.className );\n\t\t// border-box will be added provided this flag is not set\n\t\tif ( props.isBorderBox !== false ) {\n\t\t\tthis.$el.addClass( 'view-border-box' );\n\t\t}\n\n\t\tthis.render( {} );\n\t},\n\n\t/**\n\t * Function called before the view is rendered. Can be redefined in\n\t * objects that extend View.\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\tpreRender: function () {},\n\n\t/**\n\t * Function called after the view is rendered. Can be redefined in\n\t * objects that extend View.\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\tpostRender: function () {},\n\n\t/**\n\t * Fill this.$el with template rendered using data if template is set.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} data Template data. Will be merged into the view's\n\t * options\n\t * @chainable\n\t */\n\trender: function ( data ) {\n\t\tvar $el, html;\n\t\tutil.extend( this.options, data );\n\t\tthis.preRender();\n\t\tthis.undelegateEvents();\n\t\tif ( this.template && !this.options.skipTemplateRender ) {\n\t\t\thtml = this.template.render( this.options, this.templatePartials );\n\t\t\tif ( this.isTemplateMode ) {\n\t\t\t\t$el = $( html );\n\t\t\t\tthis.$el.replaceWith( $el );\n\t\t\t\tthis.$el = $el;\n\t\t\t} else {\n\t\t\t\tthis.$el.html( html );\n\t\t\t}\n\t\t}\n\t\tthis.postRender();\n\t\tthis.delegateEvents();\n\t\treturn this;\n\t},\n\n\t/**\n\t * Set callbacks, where `this.options.events` is a hash of\n\t *\n\t * { 'event selector': 'callback' }\n\t *\n\t * {\n\t *   'mousedown .title': 'edit',\n\t *   'click .button': 'save',\n\t *   'click .open': function(e) { ... }\n\t * }\n\t *\n\t * pairs. Callbacks will be bound to the view, with `this` set properly.\n\t * Uses event delegation for efficiency.\n\t * Omitting the selector binds the event to `this.el`.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {Object} events Optionally set this events instead of the ones on this.\n\t */\n\tdelegateEvents: function ( events ) {\n\t\tvar match, key, method;\n\t\tevents = events || this.options.events;\n\t\tif ( events ) {\n\t\t\t// Remove current events before re-binding them\n\t\t\tthis.undelegateEvents();\n\t\t\tfor ( key in events ) {\n\t\t\t\tmethod = events[ key ];\n\t\t\t\t// If the method is a string name of this.method, get it\n\t\t\t\tif ( typeof method !== 'function' ) {\n\t\t\t\t\tmethod = this[ events[ key ] ];\n\t\t\t\t}\n\t\t\t\tif ( method ) {\n\t\t\t\t\t// Extract event and selector from the key\n\t\t\t\t\tmatch = key.match( delegateEventSplitter );\n\t\t\t\t\tthis.delegate( match[ 1 ], match[ 2 ], method.bind( this ) );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t/**\n\t * Add a single event listener to the view's element (or a child element\n\t * using `selector`). This only works for delegate-able events: not `focus`,\n\t * `blur`, and not `change`, `submit`, and `reset` in Internet Explorer.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} eventName\n\t * @param {string} selector\n\t * @param {Function} listener\n\t */\n\tdelegate: function ( eventName, selector, listener ) {\n\t\tthis.$el.on( eventName + '.delegateEvents' + this.cid, selector,\n\t\t\tlistener );\n\t},\n\n\t/**\n\t * Clears all callbacks previously bound to the view by `delegateEvents`.\n\t * You usually don't need to use this, but may wish to if you have multiple\n\t * views attached to the same DOM element.\n\t *\n\t * @memberof View\n\t * @instance\n\t */\n\tundelegateEvents: function () {\n\t\tif ( this.$el ) {\n\t\t\tthis.$el.off( '.delegateEvents' + this.cid );\n\t\t}\n\t},\n\n\t/**\n\t * A finer-grained `undelegateEvents` for removing a single delegated event.\n\t * `selector` and `listener` are both optional.\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} eventName\n\t * @param {string} selector\n\t * @param {Function} listener\n\t */\n\tundelegate: function ( eventName, selector, listener ) {\n\t\tthis.$el.off( eventName + '.delegateEvents' + this.cid, selector,\n\t\t\tlistener );\n\t},\n\n\t/**\n\t * See parseHTML method of util singleton\n\t *\n\t * @memberof View\n\t * @instance\n\t * @param {string} html to turn into a jQuery object.\n\t * @return {jQuery.Object}\n\t */\n\tparseHTML: function ( html ) {\n\t\t// document is explicitly passed due to a bug we found in Safari 11.1.2 where failure\n\t\t// to use document resulted in an element without access to the documentElement\n\t\t// this should be redundant, but no problem in being explicit (T214451).\n\t\treturn util.parseHTML( html, document );\n\t}\n} );\n\n/**\n * @memberof View\n * @instance\n * @func append\n * @param {...(string|Node|Node[]|jQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func append\n * @param {function(number, string): string|Node|Node[]|jQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prepend\n * @param {...(string|Node|Node[]|jQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prepend\n * @param {function(number, string): string|Node|Node[]|jQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func appendTo\n * @param {string|Node|Node[]|jQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func prependTo\n * @param {string|Node|Node[]|jQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func after\n * @param {...(string|Node|Node[]|jQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func after\n * @param {function(number, string): string|Node|Node[]|jQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func before\n * @param {...(string|Node|Node[]|jQuery)} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func before\n * @param {function(number, string): string|Node|Node[]|jQuery} contents\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @property {jQuery.Object} $el\n */\n\n/**\n * @memberof View\n * @instance\n * @func insertAfter\n * @param {string|Node|Node[]|jQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func insertBefore\n * @param {string|Node|Node[]|jQuery} target\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func remove\n * @param {string} [selector]\n * @return {this}\n */\n\n/**\n * @memberof View\n * @instance\n * @func detach\n * @param {string} [selector]\n * @return {this}\n */\n\n[\n\t'append',\n\t'prepend',\n\t'appendTo',\n\t'prependTo',\n\t'after',\n\t'before',\n\t'insertAfter',\n\t'insertBefore',\n\t'remove',\n\t'detach'\n].forEach( function ( prop ) {\n\tView.prototype[prop] = function () {\n\t\tthis.$el[prop].apply( this.$el, arguments );\n\t\treturn this;\n\t};\n} );\n\n/**\n * Generates a view with children\n *\n * @param {Object} options\n * @param {jQuery.Element[]} children\n * @return {View}\n */\nView.make = function ( options = {}, children = [] ) {\n\tvar view = new View( options );\n\tchildren.forEach( function ( $child ) {\n\t\tview.append( $child );\n\t} );\n\treturn view;\n};\n\nmodule.exports = View;\n","var util = require( './util' ),\n\tdefaultParams = {\n\t\taction: 'query',\n\t\tformatversion: 2\n\t};\n\n/**\n * Extends the default params for an action query with otherParams\n *\n * @param {Object} otherParams\n * @return {Object}\n */\nfunction actionParams( otherParams ) {\n\tvar scriptPath = mw.config.get( 'wgMFContentProviderScriptPath' );\n\treturn util.extend( {}, defaultParams, {\n\t\torigin: scriptPath ? '*' : undefined\n\t}, otherParams );\n}\n\nmodule.exports = actionParams;\n","const\n\tButton = require( '../Button' ),\n\tutil = require( '../util' ),\n\tView = require( '../View' );\n\n/**\n * @typedef {Object} FormField\n * @property {string} name\n * @property {string} value\n */\n\n/**\n * @param {Object} options\n * @param {string} options.postUrl Form will POST to this endpoint\n * @param {FormField[]} options.fields An array of hidden form fields\n * @param {string} options.buttonLabel Label for submit button\n * submitted\n * @extends View\n */\nclass AmcEnableForm extends View {\n\t/** @inheritdoc */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\n\t/** @inheritdoc */\n\tget template() {\n\t\treturn util.template( `\n<form class=\"amc-enable-form\" action=\"{{postUrl}}\" method=\"POST\">\n\t{{#fields}}\n\t\t<input type=\"hidden\" name=\"{{name}}\" value=\"{{value}}\">\n\t{{/fields}}\n</form>\n\t\t` );\n\t}\n\n\t/** @inheritdoc */\n\tpostRender() {\n\t\tthis.$el.append(\n\t\t\tnew Button( {\n\t\t\t\ttagName: 'button',\n\t\t\t\tprogressive: true,\n\t\t\t\tlabel: this.options.buttonLabel\n\t\t\t} ).$el\n\t\t);\n\t}\n}\n\nmodule.exports = AmcEnableForm;\n","const\n\tDrawer = require( '../Drawer' ),\n\tAnchor = require( '../Anchor' ),\n\tutil = require( '../util' ),\n\tAmcEnableForm = require( './AmcEnableForm' ),\n\t// These constants should be kept in sync with SpecialMobileOptions.php\n\tAMC_ENABLE_FIELD_NAME = 'enableAMC',\n\tAMC_ENABLE_FIELD_VALUE = '1';\n\n/**\n * Callback intended to allow the client run extra logic (e.g. show a modal)\n * after the drawer is dismissed.\n *\n * @callback onBeforeHide\n */\n\n/**\n * @param {string} action Used by the drawer to notify promoCampaign when the\n * action has become 'ineligible' (e.g. after enabling or dismissing the drawer).\n * @param {PromoCampaign} promoCampaign\n * @param {mw.message} mwMessage Used for i18n\n * @param {mw.util} mwUtil Used to determine POST url for the enable form\n * @param {Toast} toast Displays success message after user submits enable form\n * @param {string} csrfToken\n * @param {onBeforeHide} onBeforeHide\n * @param {string} returnToTitle Title to redirect to after user enables\n * AMC\n * @param {string} [returnToQuery] Optional query params to add to redirected\n * URL after user enables AMC\n * @return {Drawer} Returns the drawer that is shown\n */\nfunction amcOutreachDrawer(\n\taction,\n\tpromoCampaign,\n\tmwMessage,\n\tmwUtil,\n\ttoast,\n\tcsrfToken,\n\tonBeforeHide,\n\treturnToTitle,\n\treturnToQuery\n) {\n\treturn new Drawer( {\n\t\tclassName: 'amc-outreach-drawer',\n\t\tchildren: [\n\t\t\tutil.parseHTML( '<div>' ).addClass( 'amc-outreach-image' ),\n\t\t\tutil.parseHTML( '<p>' ).append(\n\t\t\t\tutil.parseHTML( '<strong>' ).text(\n\t\t\t\t\tmwMessage( 'mobile-frontend-amc-outreach-intro' ).text()\n\t\t\t\t)\n\t\t\t),\n\t\t\tutil.parseHTML( '<p>' ).text(\n\t\t\t\tmwMessage( 'mobile-frontend-amc-outreach-description' ).text()\n\t\t\t),\n\t\t\tnew AmcEnableForm( {\n\t\t\t\tpostUrl: mwUtil.getUrl( 'Special:MobileOptions', {\n\t\t\t\t\treturnto: returnToTitle,\n\t\t\t\t\treturntoquery: returnToQuery || ''\n\t\t\t\t} ),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'updateSingleOption',\n\t\t\t\t\t\tvalue: AMC_ENABLE_FIELD_NAME\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'enableAMC',\n\t\t\t\t\t\tvalue: AMC_ENABLE_FIELD_VALUE\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'token',\n\t\t\t\t\t\tvalue: csrfToken\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tbuttonLabel: mwMessage( 'mobile-frontend-amc-outreach-enable' ).text(),\n\t\t\t\tevents: {\n\t\t\t\t\tsubmit: () => {\n\t\t\t\t\t\tpromoCampaign.makeActionIneligible( action );\n\t\t\t\t\t\ttoast.showOnPageReload( mwMessage( 'mobile-frontend-amc-outreach-enabled-message' ).text() );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ).$el,\n\t\t\tnew Anchor( {\n\t\t\t\thref: '#',\n\t\t\t\tadditionalClassNames: 'cancel',\n\t\t\t\tprogressive: true,\n\t\t\t\tlabel: mwMessage( 'mobile-frontend-amc-outreach-no-thanks' ).text()\n\t\t\t} ).$el\n\t\t],\n\t\tonBeforeHide: () => {\n\t\t\tpromoCampaign.makeActionIneligible( action );\n\t\t\tonBeforeHide();\n\t\t}\n\t} );\n}\n\nmodule.exports = amcOutreachDrawer;\n","/* This module defines several types of cache classes to use in other\n * modules.\n * The interface, that all types use, is kept synchronous driven by current\n * usage patterns, but will need to be revisited in case usage patterns\n * suggest we need asynchronous caches.\n */\n\n/**\n * In memory cache implementation\n *\n * @class MemoryCache\n */\nfunction MemoryCache() {\n\tthis._cache = {};\n}\n\n/**\n * Retrieve a cached value from a key\n *\n * @memberof MemoryCache\n * @instance\n * @param {string} key\n * @return {Mixed}\n */\nMemoryCache.prototype.get = function ( key ) {\n\treturn this._cache[ key ];\n};\n\n/**\n * Cache a value by key\n *\n * @memberof MemoryCache\n * @instance\n * @param {string} key\n * @param {Mixed} value\n */\nMemoryCache.prototype.set = function ( key, value ) {\n\tthis._cache[ key ] = value;\n};\n\n/**\n * Null object cache implementation\n *\n * @class NoCache\n */\nfunction NoCache() { }\n\n/**\n * NoOp\n *\n * @memberof NoCache\n * @instance\n */\nNoCache.prototype.get = function () { };\n\n/**\n * NoOp\n *\n * @memberof NoCache\n * @instance\n */\nNoCache.prototype.set = function () { };\n\nmodule.exports = {\n\tMemoryCache: MemoryCache,\n\tNoCache: NoCache\n};\n","var util = require( './util' ),\n\tactionParams = require( './actionParams.js' );\n\n/**\n * Extends the API query parameters to include those parameters required to also fetch Wikibase\n * descriptions and appropriately sized thumbnail images as well as those required to make a query.\n *\n * This function wraps `util.extend` with some Wikibase-specific configuration\n * variable management\n * but, like `util.extend`, is variadic and so can be used as a replacement for it in search\n * gateways, e.g.\n *\n * ```\n * var params = extendSearchParams(\n *   'nearby',\n *   baseParams,\n *   specializedParams,\n *   moreSpecializedParams\n * );\n * ```\n *\n * @param {string} feature The name of the feature\n * @throws {Error} If `feature` isn't one that shows Wikidata descriptions. See the\n *  `wgMFDisplayWikibaseDescriptions` configuration variable for detail\n * @return {Object}\n */\nfunction extendSearchParams( feature ) {\n\tvar displayWikibaseDescriptions = mw.config.get( 'wgMFDisplayWikibaseDescriptions' ) || {\n\t\t\t// Fail safe for when config is not available e.g. storybook\n\t\t\t// These must be defined, as these are all the features that this can be used on.\n\t\t\t// If not defined, all these features will see their API calls broken\n\t\t\tsearch: true,\n\t\t\tnearby: true,\n\t\t\twatchlist: true,\n\t\t\ttagline: false\n\t\t},\n\t\tscriptPath = mw.config.get( 'wgMFContentProviderScriptPath' ),\n\t\targs,\n\t\tresult;\n\n\tif ( !Object.prototype.hasOwnProperty.call( displayWikibaseDescriptions, feature ) ) {\n\t\tthrow new Error( '\"' + feature + '\" isn\\'t a feature that shows Wikibase descriptions.' );\n\t}\n\n\t// Construct the arguments for a call to `util.extend`\n\t// such that if it were hand-written, then it\n\t// would look like the following:\n\t//\n\t// ```\n\t// var result = util.extend( {\n\t//   prop: []\n\t// }, params, /* ..., */ mw.config.get( 'wgMFSearchAPIParams' ) );\n\t// ```\n\targs = Array.prototype.slice.call( arguments, 1 );\n\targs.unshift( {\n\t\tprop: []\n\t} );\n\targs.push( mw.config.get( 'wgMFSearchAPIParams' ) );\n\n\tresult = util.extend.apply( {}, args );\n\tresult.prop = result.prop.concat( mw.config.get( 'wgMFQueryPropModules' ) );\n\n\tif ( displayWikibaseDescriptions[feature] ) {\n\t\tif ( result.prop.indexOf( 'description' ) === -1 ) {\n\t\t\tresult.prop.push( 'description' );\n\t\t}\n\t}\n\n\tif ( scriptPath ) {\n\t\t// A foreign api is being accessed! Enable anonymous CORS queries!\n\t\tresult.origin = '*';\n\t}\n\treturn actionParams( result );\n}\nmodule.exports = extendSearchParams;\n","var util = require( './util' ),\n\tButton = require( './Button' ),\n\ticons = require( './icons' );\n\n/**\n * Creates a header\n *\n * @param {string|View} headingOrView (HTML allowed)\n * @param {View[]} headerActions\n * @param {View} [headerCancel] defaults to cancel button\n * @param {string} [additionalClassNames] (should be escaped)\n * @return {Element}\n */\nfunction makeHeader( headingOrView, headerActions, headerCancel, additionalClassNames ) {\n\tconst heading = typeof headingOrView === 'string' ? headingOrView : undefined,\n\t\ttemplateData = {\n\t\t\thasActions: headerActions && headerActions.length,\n\t\t\tisHidden: false,\n\t\t\theading\n\t\t},\n\t\thtml = util.template( `\n<div class=\"overlay-header header ${additionalClassNames || ''} hideable\">\n\t<ul class=\"header-cancel\">\n\t\t<li></li>\n\t</ul>\n\t{{{heading}}}\n\t{{#hasActions}}\n\t<div class=\"header-action\"></div>\n\t{{/hasActions}}\n</div>\n\t\t` ).render( templateData );\n\theaderCancel = headerCancel || icons.cancel();\n\tconst $el = util.parseHTML( html );\n\t// Truncate any text inside in the overlay header.\n\t$el.find( 'h2 span' ).addClass( 'truncated-text' );\n\t$el.find( '.header-cancel li' ).append(\n\t\theaderCancel.$el\n\t);\n\tif ( heading === undefined ) {\n\t\theadingOrView.$el.insertAfter( $el.find( '.header-cancel' ) );\n\t}\n\tif ( headerActions && headerActions.length ) {\n\t\t$el.find( '.header-action' ).append(\n\t\t\theaderActions.map( function ( component ) {\n\t\t\t\treturn component.$el;\n\t\t\t} )\n\t\t);\n\t}\n\treturn $el[0];\n}\n\n/**\n * Creates a header with a h2 heading\n *\n * @param {string} heading (HTML allowed)\n * @param {View[]} headerActions\n * @param {View} [headerCancel] defaults to cancel button\n * @param {string} [additionalClassNames] (should be escaped)\n * @return {Element}\n */\nfunction header( heading, headerActions, headerCancel, additionalClassNames ) {\n\theading = `<div class=\"overlay-title\"><h2>${heading}</h2></div>`;\n\treturn makeHeader( heading, headerActions, headerCancel, additionalClassNames );\n}\n\n/**\n * Creates a header with a form\n *\n * @param {string|View} formHTMLOrView of the header\n * @param {View[]} headerActions\n * @param {View} [headerCancel] defaults to cancel button\n * @param {string} [additionalClassNames] (should be escaped)\n * @return {Element}\n */\nfunction formHeader( formHTMLOrView, headerActions, headerCancel, additionalClassNames ) {\n\treturn makeHeader( formHTMLOrView, headerActions, headerCancel, additionalClassNames );\n}\n\n/**\n * Creates a header with a form\n *\n * @param {string} heading of the header\n * @param {string} additionalClassNames of the header\n * @return {Element}\n */\nfunction saveHeader( heading, additionalClassNames ) {\n\treturn header(\n\t\theading,\n\t\t[\n\t\t\tnew Button( {\n\t\t\t\ttagName: 'button',\n\t\t\t\tadditionalClassNames: 'save submit',\n\t\t\t\tdisabled: true,\n\t\t\t\tlabel: util.saveButtonMessage()\n\t\t\t} )\n\t\t],\n\t\ticons.back(),\n\t\tadditionalClassNames\n\t);\n}\n/**\n * Creates a header with a form\n *\n * @param {string} heading of the header\n * @param {string} additionalClassNames of the header\n * @return {Element}\n */\nfunction savingHeader( heading ) {\n\treturn header(\n\t\theading,\n\t\t[\n\t\t\ticons.spinner( {\n\t\t\t\tadditionalClassNames: 'savespinner loading'\n\t\t\t} )\n\t\t],\n\t\ticons.cancel(),\n\t\t'saving-header hidden'\n\t);\n}\n\nmodule.exports = {\n\tsavingHeader: savingHeader,\n\tsaveHeader: saveHeader,\n\tformHeader: formHeader,\n\theader: header\n};\n","var\n\tCANCEL_GLYPH = 'close',\n\tIcon = require( './Icon' ),\n\tutil = require( './util' );\n\n/**\n * A set of shared icons.\n *\n * Factory methods are used to keep separate features that use the same icons\n * from accidentally manipulating one another's DOM when calling methods like\n * `remove`.\n *\n * @class icons\n * @singleton\n * @uses Icon\n */\nmodule.exports = {\n\tCANCEL_GLYPH: CANCEL_GLYPH,\n\t// Exported to support testing and stubbing\n\tIcon: Icon,\n\t/**\n\t * Gets a back icon\n\t *\n\t * The icon should be used to inform the user that the front-end is\n\t * communicating with the back-end.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @return {Icon}\n\t */\n\tback: function () {\n\t\treturn new Icon( {\n\t\t\ttagName: 'button',\n\t\t\tname: 'previous-base20',\n\t\t\tadditionalClassNames: 'back',\n\t\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' )\n\t\t} );\n\t},\n\t/**\n\t * Gets a cancel icon\n\t *\n\t * The icon should be used to inform the user that the front-end is\n\t * communicating with the back-end.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @param {string} [variant] defaults to `base20`.\n\t * @param {Object} [props] to extend\n\t * @return {Icon}\n\t */\n\tcancel: function ( variant, props ) {\n\t\tvar glyph = variant ? `${CANCEL_GLYPH}-${variant}` : `${CANCEL_GLYPH}-base20`;\n\t\treturn new this.Icon( util.extend( {\n\t\t\ttagName: 'button',\n\t\t\tname: glyph,\n\t\t\tadditionalClassNames: 'cancel',\n\t\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' )\n\t\t}, props || {} ) );\n\t},\n\t/**\n\t * Gets a spinner icon.\n\t *\n\t * The icon should be used to inform the user that the front-end is\n\t * communicating with the back-end.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @param {Object} [options] See `Icon` for more details\n\t * @return {Icon}\n\t */\n\tspinner: function ( options ) {\n\t\toptions = options || {};\n\t\tif ( options.additionalClassNames === undefined ) {\n\t\t\toptions.additionalClassNames = 'spinner loading';\n\t\t}\n\n\t\treturn new this.Icon( util.extend( options, {\n\t\t\tname: 'spinner',\n\t\t\tlabel: mw.msg( 'mobile-frontend-loading-message' )\n\t\t} ) );\n\t},\n\t/**\n\t * Gets a failure (error) icon\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @return {Icon}\n\t */\n\terror: function () {\n\t\treturn new Icon( {\n\t\t\tname: 'alert-invert',\n\t\t\tadditionalClassNames: 'load-fail-msg-icon'\n\t\t} );\n\t},\n\t/**\n\t * Gets a non-filled watch star icon.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @param {Object} props\n\t * @return {Icon}\n\t */\n\twatchIcon: function ( props ) {\n\t\treturn new this.Icon( util.extend( props, {\n\t\t\tname: 'star-base20',\n\t\t\tglyphPrefix: 'wikimedia',\n\t\t\tadditionalClassNames: 'watch-this-article'\n\t\t} ) );\n\t},\n\t/**\n\t * Gets a filled watch star icon.\n\t *\n\t * @memberof icons\n\t * @instance\n\t * @param {Object} props\n\t * @return {Icon}\n\t */\n\twatchedIcon: function ( props ) {\n\t\treturn new this.Icon( util.extend( props, {\n\t\t\tname: 'unStar-progressive',\n\t\t\tglyphPrefix: 'wikimedia',\n\t\t\tadditionalClassNames: 'watch-this-article watched'\n\t\t} ) );\n\t}\n};\n","/**\n * Return the language code of the device in lowercase\n *\n * @ignore\n * @param {window.navigator} navigator\n * @return {string|undefined}\n */\nfunction getDeviceLanguage( navigator ) {\n\tconst lang = navigator.languages ?\n\t\tnavigator.languages[ 0 ] :\n\t\tnavigator.language || navigator.userLanguage ||\n\t\t\t\tnavigator.browserLanguage || navigator.systemLanguage;\n\n\treturn lang ? lang.toLowerCase() : undefined;\n}\n\nmodule.exports = getDeviceLanguage;\n","const\n\tm = require( '../moduleLoaderSingleton' ),\n\tgetDeviceLanguage = require( './getDeviceLanguage' ),\n\tOverlay = require( '../Overlay' ),\n\tpromisedView = require( '../promisedView' );\n\n/**\n * @ignore\n * @param {PageGateway} pageGateway\n * getPageLanguages API call.\n * @return {jQuery.Promise} Resolves to LanguageSearcher\n */\nfunction loadLanguageSearcher( pageGateway ) {\n\treturn mw.loader.using( 'mobile.languages.structured' ).then( function () {\n\t\treturn pageGateway.getPageLanguages( mw.config.get( 'wgPageName' ), mw.config.get( 'wgUserLanguage' ) );\n\t} ).then( function ( data ) {\n\t\tconst LanguageSearcher = m.require( 'mobile.languages.structured/LanguageSearcher' );\n\n\t\treturn new LanguageSearcher( {\n\t\t\tlanguages: data.languages,\n\t\t\tvariants: data.variants,\n\t\t\tshowSuggestedLanguages: true,\n\t\t\tdeviceLanguage: getDeviceLanguage( navigator )\n\t\t} );\n\n\t} );\n}\n\n/**\n * Factory function that returns a language featured instance of an Overlay\n *\n * @param {PageGateway} pageGateway\n * @return {Overlay}\n */\nfunction languageOverlay( pageGateway ) {\n\treturn Overlay.make(\n\t\t{\n\t\t\theading: mw.msg( 'mobile-frontend-language-heading' ),\n\t\t\tclassName: 'overlay language-overlay'\n\t\t}, promisedView( loadLanguageSearcher( pageGateway ) )\n\t);\n}\n\n// To make knowing when async logic has resolved easier in tests\nlanguageOverlay.test = {\n\tloadLanguageSearcher: loadLanguageSearcher\n};\n\nmodule.exports = languageOverlay;\n","var\n\tutil = require( '../util' ),\n\tplaceholderClass = 'lazy-image-placeholder';\n\n/**\n * @param {HTMLElement} root\n * @return {HTMLElement[]}\n */\nfunction queryPlaceholders( root ) {\n\treturn Array.prototype.slice.call(\n\t\troot.getElementsByClassName( placeholderClass )\n\t);\n}\n\n/**\n * Load an image on demand\n *\n * @param {HTMLElement[]} placeholders a list of images that have not been loaded.\n * @return {jQuery.Deferred}\n */\nfunction loadImages( placeholders ) {\n\treturn util.Promise.all(\n\t\tplaceholders.map( function ( placeholder ) {\n\t\t\treturn module.exports.loadImage( placeholder ).promise;\n\t\t} )\n\t);\n}\n\n/**\n * Load an image on demand\n *\n * @param {HTMLElement} placeholder\n * @return {{promise: jQuery.Deferred<'load'|'error'>, image: HTMLImageElement}}\n */\nfunction loadImage( placeholder ) {\n\tvar\n\t\tdeferred = util.Deferred(),\n\t\t// data-width and height are attributes and do not specify dimension.\n\t\twidth = placeholder.dataset.width || '0',\n\t\theight = placeholder.dataset.height || '0',\n\t\timage = new Image( parseInt( width, 10 ), parseInt( height, 10 ) );\n\n\t// eslint-disable-next-line mediawiki/class-doc\n\timage.className = placeholder.dataset.class || '';\n\timage.alt = placeholder.dataset.alt || '';\n\timage.useMap = placeholder.dataset.usemap;\n\timage.style.cssText = placeholder.style.cssText || '';\n\n\t// When the image has loaded\n\timage.addEventListener( 'load', function () {\n\t\t// Swap the HTML inside the placeholder (to keep the layout and\n\t\t// dimensions the same and not trigger layouts\n\t\timage.classList.add( 'image-lazy-loaded' );\n\t\tif ( placeholder.parentNode ) {\n\t\t\tplaceholder.parentNode.replaceChild( image, placeholder );\n\t\t}\n\t\tdeferred.resolve( 'load' );\n\t}, { once: true } );\n\timage.addEventListener( 'error', function () {\n\t\t// Never reject. Quietly resolve so that Promise.all() awaits for all Deferreds to complete.\n\t\t// Reevaluate using Deferred.reject in T136693.\n\t\tdeferred.resolve( 'error' );\n\t}, { once: true } );\n\n\t// Trigger image download after binding the load handler\n\timage.src = placeholder.dataset.src || '';\n\timage.srcset = placeholder.dataset.srcset || '';\n\n\treturn {\n\t\tpromise: deferred,\n\t\timage: image\n\t};\n}\n\nmodule.exports = {\n\tplaceholderClass,\n\tqueryPlaceholders: queryPlaceholders,\n\tloadImages: loadImages,\n\tloadImage: loadImage,\n\ttest: {\n\t\tplaceholderClass: placeholderClass\n\t}\n};\n","/**\n * Extends a class with new methods and member properties.\n *\n * @param {Function} Child function\n * @param {Object|Function} ParentOrPrototype class to inherit from\n *  OR if no inheriting class a prototype to extend the class with\n * @param {Object} [prototype]\n */\nfunction mfExtend( Child, ParentOrPrototype, prototype ) {\n\tvar key;\n\tif ( prototype ) {\n\t\tOO.inheritClass( Child, ParentOrPrototype );\n\t} else {\n\t\tOO.initClass( Child );\n\t\tprototype = ParentOrPrototype;\n\t}\n\tfor ( key in prototype ) {\n\t\tChild.prototype[key] = prototype[key];\n\t}\n}\n\nmodule.exports = mfExtend;\n","/**\n * Class for managing modules\n *\n * A module in this context is essentially a Javascript class (not to be confused with\n * ResourceLoader modules).\n *\n * @class ModuleLoader\n */\nfunction ModuleLoader() {\n\t/**\n\t * @property {Object} register of defined modules\n\t * @private\n\t */\n\tthis._register = {};\n}\n\nModuleLoader.prototype = {\n\t/**\n\t * Require (import) a module previously defined using define().\n\t * Searches core module registry using mw.loader.require before consulting\n\t * its own local registry. This method is deprecated, please do not use.\n\t *\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Required module id.\n\t * @return {Object} Required module, can be any JavaScript object.\n\t */\n\trequire: function ( id ) {\n\t\tvar module, args,\n\t\t\tregistry = this._register;\n\n\t\t/**\n\t\t * @return {Object} Module\n\t\t */\n\t\tfunction localRequire() {\n\t\t\tif ( !Object.hasOwnProperty.call( registry, id ) ) {\n\t\t\t\tthrow new Error( 'MobileFrontend Module not found: ' + id );\n\t\t\t}\n\t\t\treturn registry[ id ];\n\t\t}\n\t\targs = id.split( '/' );\n\t\ttry {\n\t\t\tmodule = mw.loader.require( args[0] );\n\t\t\tif ( module[ args[1] ] ) {\n\t\t\t\treturn module[ args[1] ];\n\t\t\t} else {\n\t\t\t\treturn localRequire();\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\treturn localRequire();\n\t\t}\n\t},\n\n\t/**\n\t * Define a module which can be later required (imported) using require().\n\t *\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Defined module id.\n\t * @param {Object} obj Defined module body, can be any JavaScript object.\n\t * @return {Object}\n\t */\n\tdefine: function ( id, obj ) {\n\t\tvar self = this;\n\n\t\tif ( Object.hasOwnProperty.call( this._register, id ) ) {\n\t\t\tthrow new Error( 'Module already exists: ' + id );\n\t\t}\n\t\tthis._register[ id ] = obj;\n\t\t// return an object of additionally functions to do with the registered module\n\t\treturn {\n\t\t\t/**\n\t\t\t * @see ModuleLoader#deprecate\n\t\t\t * @param {string} deprecatedId Defined module id, which is deprecated.\n\t\t\t * @ignore\n\t\t\t */\n\t\t\tdeprecate: function ( deprecatedId ) {\n\t\t\t\tself.deprecate( deprecatedId, obj, id );\n\t\t\t}\n\t\t};\n\t},\n\n\t/**\n\t * Deprecate a module and give an replacement (if there is any).\n\t *\n\t * @memberof ModuleLoader\n\t * @instance\n\t * @param {string} id Defined module id, which is deprecated.\n\t * @param {Object} obj Defined module body, can be any JavaScript object.\n\t * @param {string} [replacement] Give an optional replacement for this module (which\n\t * needs to be already defined!)\n\t */\n\tdeprecate: function ( id, obj, replacement ) {\n\t\tvar msg;\n\t\tif ( replacement ) {\n\t\t\t// add an alternative for this module, if any given\n\t\t\tmsg = 'Use ' + replacement + ' instead.';\n\t\t}\n\t\t// register it as a deprecated one\n\t\tmw.log.deprecate( this._register, id, obj, msg );\n\t}\n};\n\nmodule.exports = ModuleLoader;\n","var ModuleLoader = require( './moduleLoader' );\n\nmodule.exports = new ModuleLoader();\n","const Page = require( '../Page' );\nconst util = require( '../util' );\n\n/**\n * Create a Page object from an API response.\n *\n * @memberof Page\n * @param {Object} resp as representing a page in the API\n * @return {Page}\n */\nfunction parse( resp ) {\n\tvar revision, displayTitle,\n\t\tthumb = resp.thumbnail,\n\t\tpageprops = resp.pageprops || {\n\t\t\tdisplaytitle: mw.html.escape( resp.title )\n\t\t},\n\t\tterms = resp.terms;\n\n\tif ( pageprops || terms ) {\n\t\t// The label is either the display title or the label pageprop\n\t\t// (the latter used by Wikidata)\n\t\t// Long term we want to consolidate these.\n\t\t// Note that pageprops.displaytitle is HTML, while\n\t\t// terms.label[0] is plain text.\n\t\tdisplayTitle = terms && terms.label ?\n\t\t\tmw.html.escape( terms.label[0] ) : pageprops.displaytitle;\n\t}\n\t// Add Wikidata descriptions if available (T101719)\n\tresp.wikidataDescription = resp.description || undefined;\n\n\tif ( thumb ) {\n\t\tresp.thumbnail.isLandscape = thumb.width > thumb.height;\n\t}\n\n\t// page may or may not exist.\n\tif ( resp.revisions && resp.revisions[0] ) {\n\t\trevision = resp.revisions[0];\n\t\tresp.lastModified = new Date( revision.timestamp );\n\t}\n\n\treturn new Page(\n\t\tutil.extend( resp, {\n\t\t\tid: resp.pageid,\n\t\t\tisMissing: !!resp.missing,\n\t\t\turl: mw.util.getUrl( resp.title ),\n\t\t\tdisplayTitle: displayTitle // this is HTML!\n\t\t} )\n\t);\n}\n\nmodule.exports = { parse };\n","var\n\ticons = require( './icons' ),\n\tView = require( './View' );\n\n/**\n * It's a view that spins until the promise resolves!\n * If the promise successfully resolves, the newView will be shown. if the\n * promise rejects and rejects to a view, the errorView will be shown.\n *\n * @param {jQuery.Promise} promise\n * @return {View}\n */\nfunction promisedView( promise ) {\n\tvar view = new View( {\n\t\tclassName: 'promised-view'\n\t} );\n\tview.$el.append( icons.spinner().$el );\n\tpromise.then( function ( newView ) {\n\t\tview.$el.replaceWith( newView.$el );\n\t\t// update the internal reference.\n\t\tview.$el = newView.$el;\n\t}, function ( errorView ) {\n\t\tif ( !errorView || !errorView.$el ) {\n\t\t\t// return early to keep backwards compatibility with clients of\n\t\t\t// promisedView that do not reject to an error view\n\t\t\treturn;\n\t\t}\n\n\t\tview.$el.replaceWith( errorView.$el );\n\t\t// update the internal reference.\n\t\tview.$el = errorView.$el;\n\t} );\n\n\treturn view;\n}\n\nmodule.exports = promisedView;\n","/**\n * @typedef {Object} PromoCampaign\n * @property {Function} showIfEligible\n * @property {Function} makeActionIneligible\n * @property {Function} makeAllActionsIneligible\n * @property {Function} isCampaignActive\n */\n\n/**\n * Creates a campaign that makes showing promo drawers, modals, etc that should\n * only be shown once (using localStorage) per action (when page loads, when\n * user clicks on a link, etc) easier. The campaign executes a given callback\n * (e.g. showing a drawer or modal) for a specific action only when it is\n * eligible. A campaign can have multiple arbitrary actions via the supplied\n * `actions` object. An action is either 'eligible' or 'ineligible' at any given\n * time. If `ineligible`, the `showIfEligible` will not execute the `onShow`\n * callback.\n *\n * @param {Function} onShow A callback intended to show something related to the\n * campaign (drawer, modal, etc) when executed. The callback will only execute\n * after the client calls `showIfEligible` and only if the passed in action is\n * 'eligible'.\n * @param {Object} actions Object of arbitrary actions that are intended to be\n * either \"eligible\" or \"ineligible\" at any given time (onPageLoad,\n * onHistoryLinkClick). The `onShow` callback will only be executed when an\n * action is 'eligible'. For each action, the key and value should be the same\n * (e.g. \"onLoad\":\"onLoad\") to mimic an enum. The client is responsible for\n * notifying when each action becomes \"ineligible\" by calling the\n * `makeActionIneligible` method. All actions can be marked as ineligible by\n * calling the `makeAllActionsIneligible` method.\n * @param {string} campaignName Name of campaign. This is only used to form part\n * of the localStorage key for each action.\n * @param {boolean} campaignActive Is campaign active\n * @param {boolean} userEligible Is current user eligible\n * @param {mw.storage} mwStorage Used to mark actions as ineligible\n * into localStorage\n * @return {PromoCampaign}\n */\nfunction createPromoCampaign(\n\tonShow,\n\tactions,\n\tcampaignName,\n\tcampaignActive,\n\tuserEligible,\n\tmwStorage\n) {\n\t// This object maps actions to localStorage keys\n\tconst ACTIONS_TO_STORAGE_KEYS = {};\n\tvar key, action;\n\tfor ( key in actions ) {\n\t\taction = actions[key];\n\t\tACTIONS_TO_STORAGE_KEYS[action] = `mobile-frontend-${campaignName}-ineligible-${action}`;\n\t}\n\n\t/**\n\t * @return {boolean}\n\t */\n\tfunction isCampaignActive() {\n\t\treturn campaignActive;\n\t}\n\n\t/**\n\t * @param {string} action\n\t * @throws {Error} Throws an error if action is not valid.\n\t */\n\tfunction validateAction( action ) {\n\t\tif ( !( action in actions ) ) {\n\t\t\tthrow new Error(\n\t\t\t\t`Action '${action}' not found in 'actions' object. Please add this to\n\t\t\t\tthe object when creating a campaign with promoCampaign.js if you believe\n\t\t\t\tthis is a valid action.`\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} action Will check the eligibility of this action. This\n\t * should be a value in the actions object.\n\t * @throws {Error} Throws an error if action is not valid.\n\t * @return {boolean}\n\t */\n\tfunction isActionEligible( action ) {\n\t\tvalidateAction( action );\n\n\t\treturn isCampaignActive() &&\n\t\t\tuserEligible &&\n\t\t\tmwStorage.get( ACTIONS_TO_STORAGE_KEYS[action] ) === null;\n\t}\n\n\treturn {\n\t\t/**\n\t\t * @param {string} action Should be one of the values in the\n\t\t * actions param\n\t\t * @param {...*} [args] Args to pass to the onShow callback\n\t\t * @throws {Error} Throws an error if action is not valid.\n\t\t * @return {Drawer|null} Returns Drawer if drawer is eligible to be shown and\n\t\t * null if not.\n\t\t */\n\t\tshowIfEligible: function ( action, ...args ) {\n\t\t\tif ( !isActionEligible( action ) ) {\n\t\t\t\t// If not eligible, there is no sense in continuing.\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn onShow( action, ...args );\n\t\t},\n\t\t/**\n\t\t * @param {string} action\n\t\t * @throws {Error} Throws an error if action is not valid.\n\t\t * @return {boolean} Whether the save operation was successful\n\t\t */\n\t\tmakeActionIneligible: function ( action ) {\n\t\t\tvalidateAction( action );\n\n\t\t\t// The value here actually doesn't matter. The only thing that matters is\n\t\t\t// if this key exists in localStorage.\n\t\t\treturn mwStorage.set( ACTIONS_TO_STORAGE_KEYS[action], '~' );\n\t\t},\n\t\tmakeAllActionsIneligible: function () {\n\t\t\tvar key, action;\n\t\t\tfor ( key in actions ) {\n\t\t\t\taction = actions[key];\n\t\t\t\tthis.makeActionIneligible( action );\n\t\t\t}\n\t\t},\n\t\tisCampaignActive: isCampaignActive\n\t};\n}\n\nmodule.exports = createPromoCampaign;\n","/**\n * Abstract base class\n * Gateway for retrieving references\n *\n * @class ReferencesGateway\n * @abstract\n *\n * @param {mw.Api} api\n */\nfunction ReferencesGateway( api ) {\n\tthis.api = api;\n}\n\n/**\n * Return the matched reference via API or DOM query\n *\n * @memberof ReferencesGateway\n * @instance\n * @param {string} id CSS selector\n * @param {Page} page to find reference for\n * @param {PageHTMLParser} pageHTMLParser\n * @return {jQuery.Promise} resolves with an Object representing reference\n *  with a `text` property\n *  The promise should be rejected with ReferenceGateway.ERROR_NOT_EXIST:\n *  if the reference is not found.\n *  If for some reason locating the reference fails return ReferenceGateway.ERROR_OTHER.\n */\nReferencesGateway.prototype.getReference = null;\n\n/**\n * @memberof ReferencesGateway\n * @property ERROR_NOT_EXIST error code to be returned by getReference\n *  when a reference does not exist.\n */\nReferencesGateway.ERROR_NOT_EXIST = 'NOT_EXIST_ERROR';\n/**\n * @memberof ReferencesGateway\n * @property ERROR_OTHER error code to be returned by getReference\n *  under any other circumstance not covered\n *  by ERROR_NOT_EXIST. It should be used if it is unclear whether a reference exists or not.\n */\nReferencesGateway.ERROR_OTHER = 'OTHER_ERROR';\n\nmodule.exports = ReferencesGateway;\n","var ReferencesGateway = require( './ReferencesGateway' ),\n\tmfExtend = require( './../mfExtend' ),\n\tutil = require( './../util' );\n\n/**\n * Gateway for retrieving references via the content of the Page\n *\n * @class ReferencesHtmlScraperGateway\n * @extends ReferencesGateway\n * @inheritdoc\n */\nfunction ReferencesHtmlScraperGateway() {\n\tReferencesGateway.apply( this, arguments );\n}\n\nmfExtend( ReferencesHtmlScraperGateway, ReferencesGateway, {\n\t/**\n\t * @memberof ReferencesHtmlScraperGateway\n\t * @property EXTERNAL_LINK_CLASS a CSS class to place on external links\n\t * in addition to the default 'external' class.\n\t */\n\tEXTERNAL_LINK_CLASS: 'external--reference',\n\t/**\n\t * @memberof ReferencesHtmlScraperGateway\n\t * @instance\n\t * @param {string} id of a DOM element in the page with '#' prefix.\n\t *  can be encoded or decoded.\n\t * @param {jQuery.Object} $container to scan for an element\n\t * @return {jQuery.Promise} that can be used by getReference\n\t */\n\tgetReferenceFromContainer: function ( id, $container ) {\n\t\tvar $el, $ol, $parent,\n\t\t\tresult = util.Deferred();\n\n\t\t$el = $container.find( '#' + util.escapeSelector( id.substr( 1 ) ) );\n\t\tif ( $el.length ) {\n\t\t\t// This finds either the inner <ol class=\"mw-extended-references\">, or the outer\n\t\t\t// <ol class=\"references\">\n\t\t\t$ol = $el.closest( 'ol' );\n\t\t\tif ( $ol.hasClass( 'mw-extended-references' ) ) {\n\t\t\t\t$parent = $ol.parent();\n\t\t\t}\n\t\t\t// The following classes are used here:\n\t\t\t// * external--reference\n\t\t\t// * other values of EXTERNAL_LINK_CLASS in sub-classes\n\t\t\t( $parent || $el ).find( '.external' ).addClass( this.EXTERNAL_LINK_CLASS );\n\t\t\tresult.resolve( {\n\t\t\t\ttext: this.getReferenceHtml( $el ),\n\t\t\t\tparentText: this.getReferenceHtml( $parent )\n\t\t\t} );\n\t\t} else {\n\t\t\tresult.reject( ReferencesGateway.ERROR_NOT_EXIST );\n\t\t}\n\t\treturn result.promise();\n\t},\n\t/**\n\t * @param {jQuery.Object|undefined} $reference\n\t * @returns {string}\n\t */\n\tgetReferenceHtml: function ( $reference ) {\n\t\treturn $reference ?\n\t\t\t$reference.find( '.mw-reference-text, .reference-text' ).first().html() :\n\t\t\t'';\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof ReferencesHtmlScraperGateway\n\t * @instance\n\t * @param {string} id\n\t * @param {Page} page (unused)\n\t * @param {PageHTMLParser} pageHTMLParser\n\t */\n\tgetReference: function ( id, page, pageHTMLParser ) {\n\t\ttry {\n\t\t\tid = decodeURIComponent( id );\n\t\t} catch ( e ) {\n\t\t\t// try id passed in - may already be decoded (T268059)\n\t\t\t// if it's not found it will throw an error later down the chain.\n\t\t}\n\t\t// If an id is not found it's possible the id passed needs decoding (per T188547).\n\t\treturn this.getReferenceFromContainer( id, pageHTMLParser.$el.find( 'ol.references' ) );\n\t}\n} );\n\nmodule.exports = ReferencesHtmlScraperGateway;\n","var references,\n\tDrawer = require( '../Drawer' ),\n\tutil = require( '../util' ),\n\ticons = require( '../icons' ),\n\tReferencesGateway = require( './ReferencesGateway' ),\n\tIcon = require( '../Icon' );\n\n/**\n * Create a callback for clicking references\n *\n * @param {Function} onNestedReferenceClick\n * @return {Function}\n */\nfunction makeOnNestedReferenceClickHandler( onNestedReferenceClick ) {\n\treturn ( ev ) => {\n\t\tconst target = ev.currentTarget.querySelector( 'a' );\n\t\tif ( target ) {\n\t\t\tonNestedReferenceClick(\n\t\t\t\ttarget.getAttribute( 'href' ),\n\t\t\t\ttarget.textContent\n\t\t\t);\n\t\t\t// Don't hide the already shown drawer via propagation\n\t\t\treturn false;\n\t\t}\n\t};\n}\n\n/**\n * Drawer for references\n *\n * @uses Icon\n * @param {Object} props\n * @param {boolean} [props.error] whether an error has occurred\n * @param {string} props.title of reference e.g [1]\n * @param {string} props.text is the HTML of the reference\n * @param {string} [props.parentText] is the HTML of the parent reference if there is one\n * @param {Function} [props.onNestedReferenceClick] callback for when a reference\n *  inside the reference is clicked.\n * @return {Drawer}\n */\nfunction referenceDrawer( props ) {\n\tconst errorIcon = props.error ? new Icon( {\n\t\tname: 'error',\n\t\tisSmall: true\n\t} ).$el : null;\n\treturn new Drawer(\n\t\tutil.extend(\n\t\t\t{\n\t\t\t\tshowCollapseIcon: false,\n\t\t\t\tclassName: 'drawer position-fixed text references-drawer',\n\t\t\t\tevents: {\n\t\t\t\t\t'click sup a': function ( ev ) {\n\t\t\t\t\t\t// Stop default scroll to hash fragment behaviour.\n\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t},\n\t\t\t\t\t'click sup': props.onNestedReferenceClick &&\n\t\t\t\t\t\tmakeOnNestedReferenceClickHandler( props.onNestedReferenceClick )\n\t\t\t\t},\n\t\t\t\tchildren: [\n\t\t\t\t\tutil.parseHTML( '<div>' )\n\t\t\t\t\t\t.addClass( 'references-drawer__header' )\n\t\t\t\t\t\t.append( [\n\t\t\t\t\t\t\tnew Icon( {\n\t\t\t\t\t\t\t\tisSmall: true,\n\t\t\t\t\t\t\t\tname: 'reference',\n\t\t\t\t\t\t\t\tmodifier: ''\n\t\t\t\t\t\t\t} ).$el,\n\t\t\t\t\t\t\tutil.parseHTML( '<span>' ).addClass( 'references-drawer__title' ).text( mw.msg( 'mobile-frontend-references-citation' ) ),\n\t\t\t\t\t\t\ticons.cancel( 'gray', {\n\t\t\t\t\t\t\t\tisSmall: true,\n\t\t\t\t\t\t\t\tmodifier: 'mw-ui-icon-element mw-ui-icon-flush-right'\n\t\t\t\t\t\t\t} ).$el\n\t\t\t\t\t\t] ),\n\t\t\t\t\t// Add .mw-parser-output so that TemplateStyles styles apply (T244510)\n\t\t\t\t\tutil.parseHTML( '<div>' ).addClass( 'mw-parser-output' ).append( [\n\t\t\t\t\t\terrorIcon,\n\t\t\t\t\t\tprops.parentText ?\n\t\t\t\t\t\t\tutil.parseHTML( '<div>' ).html( props.parentText ) :\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\tutil.parseHTML( '<sup>' ).text( props.title ),\n\t\t\t\t\t\tprops.text ?\n\t\t\t\t\t\t\tutil.parseHTML( '<span>' ).html( ' ' + props.text ) :\n\t\t\t\t\t\t\ticons.spinner().$el\n\t\t\t\t\t] )\n\t\t\t\t]\n\t\t\t},\n\t\t\tprops\n\t\t)\n\t);\n}\n\nreferences = {\n\ttest: {\n\t\tmakeOnNestedReferenceClickHandler\n\t},\n\treferenceDrawer,\n\t/**\n\t * Fetch and render nested reference upon click\n\t *\n\t * @param {string} id of the reference to be retrieved\n\t * @param {Page} page to locate reference for\n\t * @param {string} refNumber the number it identifies as in the page\n\t * @param {PageHTMLParser} pageHTMLParser\n\t * @param {Gateway} gateway\n\t * @param {Object} props for referenceDrawer\n\t * @param {Function} onShowNestedReference function call when a nested reference is triggered.\n\t * @return {jQuery.Deferred}\n\t */\n\tshowReference: function ( id, page, refNumber, pageHTMLParser, gateway, props,\n\t\tonShowNestedReference\n\t) {\n\t\treturn gateway.getReference( id, page, pageHTMLParser ).then( function ( reference ) {\n\t\t\tconst drawer = referenceDrawer( util.extend( {\n\t\t\t\ttitle: refNumber,\n\t\t\t\ttext: reference.text,\n\t\t\t\tparentText: reference.parentText,\n\t\t\t\tonNestedReferenceClick: function ( href, text ) {\n\t\t\t\t\treferences.showReference(\n\t\t\t\t\t\thref,\n\t\t\t\t\t\tpage,\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\tpageHTMLParser,\n\t\t\t\t\t\tgateway\n\t\t\t\t\t).then( ( nestedDrawer ) => {\n\t\t\t\t\t\tif ( props.onShowNestedReference ) {\n\t\t\t\t\t\t\tonShowNestedReference( drawer, nestedDrawer );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmw.log.warn( 'Please provide onShowNestedReferences parameter.' );\n\t\t\t\t\t\t\tdocument.body.appendChild( nestedDrawer.$el[ 0 ] );\n\t\t\t\t\t\t\tdrawer.hide();\n\t\t\t\t\t\t\tnestedDrawer.show();\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}, props ) );\n\t\t\treturn drawer;\n\t\t}, function ( err ) {\n\t\t\t// If non-existent reference nothing to do.\n\t\t\tif ( err === ReferencesGateway.ERROR_NOT_EXIST ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\treturn referenceDrawer( {\n\t\t\t\terror: true,\n\t\t\t\ttitle: refNumber,\n\t\t\t\ttext: mw.msg( 'mobile-frontend-references-citation-error' )\n\t\t\t} );\n\t\t} );\n\t}\n};\n\nmodule.exports = references;\n","/**\n * Coordinates the logging of MobileWebSchema events.\n * Implements schema defined at https://meta.wikimedia.org/wiki/Schema:MobileWebSearch\n *\n * @class\n */\nfunction MobileWebSearchLogger() {\n\tthis.userSessionToken = null;\n\tthis.searchSessionToken = null;\n}\n\nMobileWebSearchLogger.prototype = {\n\t/**\n\t * Sets the internal state required to deal with logging user session\n\t * data.\n\t *\n\t * @memberof MobileWebSearchLogger\n\t * @instance\n\t * @private\n\t */\n\t_newUserSession: function () {\n\t\tthis.userSessionToken = mw.user.generateRandomSessionId();\n\t},\n\n\t/**\n\t * Sets the internal state required to deal with logging search session\n\t * data.\n\t *\n\t * @memberof MobileWebSearchLogger\n\t * @instance\n\t * @private\n\t */\n\t_newSearchSession: function () {\n\t\tthis.searchSessionToken = mw.user.generateRandomSessionId();\n\t\tthis.searchSessionCreatedAt = new Date().getTime();\n\t},\n\n\t/**\n\t * Handles the 'search-show' event.\n\t *\n\t * @memberof MobileWebSearchLogger\n\t * @instance\n\t */\n\tonSearchShow: function () {\n\t\tthis._newUserSession();\n\t},\n\n\t/**\n\t * Handles the 'search-start' event.\n\t *\n\t * @memberof MobileWebSearchLogger\n\t * @instance\n\t */\n\tonSearchStart: function () {\n\t\tthis._newSearchSession();\n\t\tmw.track( 'mf.schemaMobileWebSearch', {\n\t\t\taction: 'session-start',\n\t\t\tuserSessionToken: this.userSessionToken,\n\t\t\tsearchSessionToken: this.searchSessionToken,\n\t\t\ttimeOffsetSinceStart: 0\n\t\t} );\n\t},\n\n\t/**\n\t * Handles the 'search-results' event.\n\t *\n\t * @memberof MobileWebSearchLogger\n\t * @instance\n\t * @param {Object} event with property {Object[]} event.results\n\t */\n\tonSearchResults: function ( event ) {\n\t\tvar timeOffsetSinceStart =\n\t\t\tnew Date().getTime() - this.searchSessionCreatedAt;\n\n\t\tmw.track( 'mf.schemaMobileWebSearch', {\n\t\t\taction: 'impression-results',\n\t\t\tresultSetType: 'prefix',\n\t\t\tnumberOfResults: event.results.length,\n\t\t\tuserSessionToken: this.userSessionToken,\n\t\t\tsearchSessionToken: this.searchSessionToken,\n\t\t\t// FIXME: Unless I'm mistaken, the timeToDisplayResults\n\t\t\t// property isn't necessary.\n\t\t\ttimeToDisplayResults: timeOffsetSinceStart,\n\t\t\ttimeOffsetSinceStart: timeOffsetSinceStart\n\t\t} );\n\t},\n\n\t/**\n\t * Handles the 'search-result-click' event.\n\t *\n\t * @memberof MobileWebSearchLogger\n\t * @instance\n\t * @param {Object} event with property {number} event.index\n\t *  The zero-based index of the result in the set of results.\n\t */\n\tonSearchResultClick: function ( event ) {\n\t\tvar timeOffsetSinceStart =\n\t\t\tnew Date().getTime() - this.searchSessionCreatedAt;\n\n\t\tmw.track( 'mf.schemaMobileWebSearch', {\n\t\t\taction: 'click-result',\n\t\t\t// NOTE: clickIndex is 1-based.\n\t\t\tclickIndex: event.resultIndex + 1,\n\t\t\tuserSessionToken: this.userSessionToken,\n\t\t\tsearchSessionToken: this.searchSessionToken,\n\t\t\ttimeOffsetSinceStart: timeOffsetSinceStart\n\t\t} );\n\t}\n};\n\n/**\n * Convenience function that wires up an instance of the\n * MobileWebSearchLogger class to the search-* events emitted by the\n * search overlay.\n *\n * @memberof MobileWebSearchLogger\n * @param {SearchOverlay} searchOverlay\n */\nMobileWebSearchLogger.register = function ( searchOverlay ) {\n\tvar logger = new MobileWebSearchLogger();\n\n\tsearchOverlay.on( 'search-show', logger.onSearchShow.bind( logger ) );\n\tsearchOverlay.on( 'search-start', logger.onSearchStart.bind( logger ) );\n\tsearchOverlay.on( 'search-results', logger.onSearchResults.bind( logger ) );\n\tsearchOverlay.on( 'search-result-click', logger.onSearchResultClick.bind( logger ) );\n};\n\nmodule.exports = MobileWebSearchLogger;\n","var\n\tpageJSONParser = require( '../page/pageJSONParser' ),\n\tutil = require( '../util' ),\n\textendSearchParams = require( '../extendSearchParams' );\n\n/**\n * @class SearchGateway\n * @uses mw.Api\n * @param {mw.Api} api\n */\nfunction SearchGateway( api ) {\n\tthis.api = api;\n\tthis.searchCache = {};\n\tthis.generator = mw.config.get( 'wgMFSearchGenerator' );\n}\n\nSearchGateway.prototype = {\n\t/**\n\t * The namespace to search in.\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @type {number}\n\t */\n\tsearchNamespace: 0,\n\n\t/**\n\t * Get the data used to do the search query api call.\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} query to search for\n\t * @return {Object}\n\t */\n\tgetApiData: function ( query ) {\n\t\tvar prefix = this.generator.prefix,\n\t\t\tdata = extendSearchParams( 'search', {\n\t\t\t\tgenerator: this.generator.name\n\t\t\t} );\n\n\t\tdata.redirects = '';\n\n\t\tdata['g' + prefix + 'search'] = query;\n\t\tdata['g' + prefix + 'namespace'] = this.searchNamespace;\n\t\tdata['g' + prefix + 'limit'] = 15;\n\n\t\t// If PageImages is being used configure further.\n\t\tif ( data.pilimit ) {\n\t\t\tdata.pilimit = 15;\n\t\t\tdata.pithumbsize = mw.config.get( 'wgMFThumbnailSizes' ).tiny;\n\t\t}\n\t\treturn data;\n\t},\n\n\t/**\n\t * Escapes regular expression wildcards (metacharacters) by adding a \\\\ prefix\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} str a string\n\t * @return {Object} a regular expression that can be used to search for that str\n\t * @private\n\t */\n\t_createSearchRegEx: function ( str ) {\n\t\t// '\\[' can be unescaped, but leave it balanced with '`]'\n\t\t// eslint-disable-next-line no-useless-escape\n\t\tstr = str.replace( /[-\\[\\]{}()*+?.,\\\\^$|#\\s]/g, '\\\\$&' );\n\t\treturn new RegExp( '^(' + str + ')', 'ig' );\n\t},\n\n\t/**\n\t * Takes a label potentially beginning with term\n\t * and highlights term if it is present with strong\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} label a piece of text\n\t * @param {string} term a string to search for from the start\n\t * @return {string} safe html string with matched terms encapsulated in strong tags\n\t * @private\n\t */\n\t_highlightSearchTerm: function ( label, term ) {\n\t\tlabel = util.parseHTML( '<span>' ).text( label ).html();\n\t\tterm = util.parseHTML( '<span>' ).text( term ).html();\n\n\t\treturn label.replace( this._createSearchRegEx( term ), '<strong>$1</strong>' );\n\t},\n\n\t/**\n\t * Return data used for creating {Page} objects\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} query to search for\n\t * @param {Object} pageInfo from the API\n\t * @return {Object} data needed to create a {Page}\n\t * @private\n\t */\n\t_getPage: function ( query, pageInfo ) {\n\t\tvar page = pageJSONParser.parse( pageInfo );\n\n\t\t// If displaytext is set in the generator result (eg. by Wikibase),\n\t\t// use that as display title.\n\t\t// Otherwise default to the page's title.\n\t\t// FIXME: Given that displayTitle could have html in it be safe and just highlight text.\n\t\t// Note that highlightSearchTerm does full HTML escaping before highlighting.\n\t\tpage.displayTitle = this._highlightSearchTerm(\n\t\t\tpageInfo.displaytext ? pageInfo.displaytext : page.title,\n\t\t\tquery\n\t\t);\n\t\tpage.index = pageInfo.index;\n\n\t\treturn page;\n\t},\n\n\t/**\n\t * Process the data returned by the api call.\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} query to search for\n\t * @param {Object} data from api\n\t * @return {Array}\n\t * @private\n\t */\n\t_processData: function ( query, data ) {\n\t\tvar self = this,\n\t\t\tresults = [];\n\n\t\tif ( data.query ) {\n\n\t\t\tresults = data.query.pages || {};\n\t\t\tresults = Object.keys( results ).map( function ( id ) {\n\t\t\t\treturn self._getPage( query, results[ id ] );\n\t\t\t} );\n\t\t\t// sort in order of index\n\t\t\tresults.sort( function ( a, b ) {\n\t\t\t\treturn a.index < b.index ? -1 : 1;\n\t\t\t} );\n\t\t}\n\n\t\treturn results;\n\t},\n\n\t/**\n\t * Perform a search for the given query.\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} query to search for\n\t * @return {jQuery.Deferred}\n\t */\n\tsearch: function ( query ) {\n\t\tvar xhr, request,\n\t\t\tself = this;\n\n\t\tif ( !this.isCached( query ) ) {\n\t\t\txhr = this.api.get( this.getApiData( query ) );\n\t\t\trequest = xhr\n\t\t\t\t.then( function ( data ) {\n\t\t\t\t\t// resolve the Deferred object\n\t\t\t\t\treturn {\n\t\t\t\t\t\tquery: query,\n\t\t\t\t\t\tresults: self._processData( query, data )\n\t\t\t\t\t};\n\t\t\t\t}, function () {\n\t\t\t\t\t// reset cached result, it maybe contains no value\n\t\t\t\t\tself.searchCache[query] = undefined;\n\t\t\t\t} );\n\n\t\t\t// cache the result to prevent the execution of one search query twice\n\t\t\t// in one session\n\t\t\tthis.searchCache[query] = request.promise( {\n\t\t\t\tabort: function () { xhr.abort(); }\n\t\t\t} );\n\t\t}\n\n\t\treturn this.searchCache[query];\n\t},\n\n\t/**\n\t * Check if the search has already been performed in given session.\n\t *\n\t * @memberof SearchGateway\n\t * @instance\n\t * @param {string} query\n\t * @return {boolean}\n\t */\n\tisCached: function ( query ) {\n\t\treturn Boolean( this.searchCache[ query ] );\n\t}\n};\n\nmodule.exports = SearchGateway;\n","const util = require( '../util' ),\n\tView = require( '../View' ),\n\tIcon = require( '../Icon' );\n\n/**\n * @extends View\n */\nclass SearchHeaderView extends View {\n\t/**\n\t * constructor\n\t *\n\t * @inheritdoc\n\t * @param {Object} props\n\t * @param {Function} props.onInput executed every time input changes\n\t * @param {string} props.placeholderMsg\n\t * @param {string} props.action\n\t * @param {string} [props.searchTerm] default\n\t */\n\tconstructor( props ) {\n\t\tsuper(\n\t\t\tutil.extend( {}, props, {\n\t\t\t\tevents: {\n\t\t\t\t\t'input input': 'onInput'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t}\n\t/** @inheritdoc */\n\tonInput( ev ) {\n\t\tconst query = ev.target.value;\n\t\tthis.options.onInput( query );\n\t\tif ( query ) {\n\t\t\tthis.clearIcon.$el.show();\n\t\t} else {\n\t\t\tthis.clearIcon.$el.hide();\n\t\t}\n\t}\n\t/** @inheritdoc */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\t/** @inheritdoc */\n\tget template() {\n\t\treturn util.template( `<div class=\"overlay-title search-header-view\">\n\t\t<form method=\"get\" action=\"{{action}}\" class=\"search-box\">\n\t\t<input class=\"search mw-ui-background-icon-search\" type=\"search\" name=\"search\" autocomplete=\"off\" placeholder=\"{{placeholderMsg}}\" aria-label=\"{{placeholderMsg}}\" value=\"{{searchTerm}}\">\n\t\t<input type=\"hidden\" name=\"title\" value=\"{{defaultSearchPage}}\">\n\t\t</form>\n</div>` );\n\t}\n\t/** @inheritdoc */\n\tpostRender() {\n\t\tconst clearIcon = new Icon( {\n\t\t\ttagName: 'button',\n\t\t\tname: 'clear',\n\t\t\tisSmall: true,\n\t\t\tlabel: mw.msg( 'mobile-frontend-clear-search' ),\n\t\t\tadditionalClassNames: 'clear',\n\t\t\tevents: {\n\t\t\t\tclick: function () {\n\t\t\t\t\tthis.$el.find( 'input' ).val( '' ).trigger( 'focus' );\n\t\t\t\t\tthis.options.onInput( '' );\n\t\t\t\t\tclearIcon.$el.hide();\n\t\t\t\t\t// In beta the clear button is on top of the search input.\n\t\t\t\t\t// Stop propagation so that the input doesn't receive the click.\n\t\t\t\t\treturn false;\n\t\t\t\t}.bind( this )\n\t\t\t}\n\t\t} );\n\t\tthis.clearIcon = clearIcon;\n\t\tclearIcon.$el.hide();\n\t\tclearIcon.$el.attr( 'aria-hidden', 'true' );\n\t\tthis.$el.find( 'form' ).append( clearIcon.$el );\n\t}\n}\n\nmodule.exports = SearchHeaderView;\n","var\n\tmfExtend = require( '../mfExtend' ),\n\tOverlay = require( '../Overlay' ),\n\tutil = require( '../util' ),\n\tsearchHeader = require( './searchHeader' ),\n\tSearchResultsView = require( './SearchResultsView' ),\n\tWatchstarPageList = require( '../watchstar/WatchstarPageList' ),\n\tSEARCH_DELAY = 300,\n\tSEARCH_SPINNER_DELAY = 2000;\n\n/**\n * Overlay displaying search results\n *\n * @class SearchOverlay\n * @extends Overlay\n * @uses SearchGateway\n * @uses Icon\n *\n * @param {Object} params Configuration options\n * @param {string} params.placeholderMsg Search input placeholder text.\n * @param {string} [params.action] of form defaults to the value of wgScript\n * @param {string} [params.defaultSearchPage] The default search page e.g. Special:Search\n * @param {SearchGateway} [params.gateway]\n * @fires SearchOverlay#search-show\n * @fires SearchOverlay#search-start\n * @fires SearchOverlay#search-results\n * @fires SearchOverlay#search-result-click\n */\nfunction SearchOverlay( params ) {\n\tvar header = searchHeader(\n\t\t\tparams.placeholderMsg,\n\t\t\tparams.action || mw.config.get( 'wgScript' ),\n\t\t\tfunction ( query ) {\n\t\t\t\tthis.performSearch( query );\n\t\t\t}.bind( this ),\n\t\t\tparams.defaultSearchPage || ''\n\t\t),\n\t\toptions = util.extend( true, {\n\t\t\theaderChrome: true,\n\t\t\tisBorderBox: false,\n\t\t\tclassName: 'overlay search-overlay',\n\t\t\theaders: [ header ],\n\t\t\tevents: {\n\t\t\t\t'click .search-content': 'onClickSearchContent',\n\t\t\t\t'click .overlay-content': 'onClickOverlayContent',\n\t\t\t\t'click .overlay-content > div': function ( ev ) {\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t},\n\t\t\t\t'touchstart .results': 'hideKeyboardOnScroll',\n\t\t\t\t'mousedown .results': 'hideKeyboardOnScroll',\n\t\t\t\t'click .results a': 'onClickResult'\n\t\t\t}\n\t\t},\n\t\tparams );\n\n\tthis.header = header;\n\tOverlay.call( this, options );\n\n\tthis.api = options.api;\n\t// eslint-disable-next-line new-cap\n\tthis.gateway = options.gateway || new options.gatewayClass( this.api );\n\n\tthis.router = options.router;\n}\n\nmfExtend( SearchOverlay, Overlay, {\n\n\t/**\n\t * Initialize 'search within pages' functionality\n\t *\n\t * @memberof SearchOverlay\n\t * @instance\n\t */\n\tonClickSearchContent: function () {\n\t\tvar $el = util.getDocument().find( 'body' ),\n\t\t\t$form = this.$el.find( 'form' );\n\n\t\t// Add fulltext input to force fulltext search\n\t\tthis.parseHTML( '<input>' )\n\t\t\t.attr( {\n\t\t\t\ttype: 'hidden',\n\t\t\t\tname: 'fulltext',\n\t\t\t\tvalue: 'search'\n\t\t\t} )\n\t\t\t.appendTo( $form );\n\t\t// history.back queues a task so might run after this call. Thus we use setTimeout\n\t\t// http://www.w3.org/TR/2011/WD-html5-20110113/webappapis.html#queue-a-task\n\t\tsetTimeout( function () {\n\t\t\t// Firefox doesn't allow submission of a form not in the DOM\n\t\t\t// so temporarily re-add it\n\t\t\t$form.appendTo( $el );\n\t\t\t$form.trigger( 'submit' );\n\t\t}, 0 );\n\t},\n\n\t/**\n\t * Tapping on background only should hide the overlay\n\t *\n\t * @memberof SearchOverlay\n\t * @instance\n\t */\n\tonClickOverlayContent: function () {\n\t\tthis.$el.find( '.cancel' ).trigger( 'click' );\n\t},\n\n\t/**\n\t * Hide the keyboard when scrolling starts (avoid weird situation when\n\t * user taps on an item, the keyboard hides and wrong item is clicked).\n\t *\n\t * @memberof SearchOverlay\n\t * @instance\n\t */\n\thideKeyboardOnScroll: function () {\n\t\tthis.$input.trigger( 'blur' );\n\t},\n\n\t/**\n\t * Handle the user clicking a result.\n\t *\n\t * @memberof SearchOverlay\n\t * @instance\n\t * @param {jQuery.Event} ev\n\t */\n\tonClickResult: function ( ev ) {\n\t\tvar $link = this.$el.find( ev.currentTarget ),\n\t\t\t$result = $link.closest( 'li' );\n\t\t/**\n\t\t * Fired when the user clicks a search result\n\t\t *\n\t\t * @event SearchOverlay#search-result-click\n\t\t * @type {Object}\n\t\t * @property {jQuery.Object} result The jQuery-wrapped DOM element that\n\t\t *  the user clicked\n\t\t * @property {number} resultIndex The zero-based index of the\n\t\t *  result in the set of results\n\t\t * @property {jQuery.Event} originalEvent The original event\n\t\t */\n\t\tthis.emit( 'search-result-click', {\n\t\t\tresult: $result,\n\t\t\tresultIndex: this.$results.index( $result ),\n\t\t\toriginalEvent: ev\n\t\t} );\n\n\t\t// FIXME: ugly hack that removes search from browser history\n\t\t// when navigating to search results\n\t\tev.preventDefault();\n\t\tthis.router.back().then( function () {\n\t\t\t// Router.navigate does not support changing href.\n\t\t\t// FIXME: Needs upstream change T189173\n\t\t\t// eslint-disable-next-line no-restricted-properties\n\t\t\twindow.location.href = $link.attr( 'href' );\n\t\t} );\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof SearchOverlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tvar self = this,\n\t\t\tsearchResults = new SearchResultsView( {\n\t\t\t\tsearchContentLabel: mw.msg( 'mobile-frontend-search-content' ),\n\t\t\t\tnoResultsMsg: mw.msg( 'mobile-frontend-search-no-results' ),\n\t\t\t\tsearchContentNoResultsMsg: mw.message( 'mobile-frontend-search-content-no-results' ).parse()\n\t\t\t} ),\n\t\t\ttimer;\n\n\t\tthis.$el.find( '.overlay-content' ).append( searchResults.$el );\n\t\tOverlay.prototype.postRender.call( this );\n\n\t\t// FIXME: `this.$input` should not be set. Isolate to searchHeader function\n\t\tthis.$input = this.$el.find( this.header ).find( 'input' );\n\t\t// FIXME: `this.$searchContent` should not be set. Isolate to SearchResultsView class.\n\t\tthis.$searchContent = searchResults.$el.hide();\n\t\t// FIXME: `this.$resultContainer` should not be set. Isolate to SearchResultsView class.\n\t\tthis.$resultContainer = searchResults.$el.find( '.results-list-container' );\n\n\t\t/**\n\t\t * Hide the spinner and abort timed spinner shows.\n\t\t * FIXME: Given this manipulates SearchResultsView this should be moved into that class\n\t\t */\n\t\tfunction clearSearch() {\n\t\t\tself.$spinner.hide();\n\t\t\tclearTimeout( timer );\n\t\t}\n\n\t\t// Show a spinner on top of search results\n\t\t// FIXME: Given this manipulates SearchResultsView this should be moved into that class\n\t\tthis.$spinner = searchResults.$el.find( '.spinner-container' );\n\t\tthis.on( 'search-start', function ( searchData ) {\n\t\t\tif ( timer ) {\n\t\t\t\tclearSearch();\n\t\t\t}\n\t\t\ttimer = setTimeout( function () {\n\t\t\t\tself.$spinner.show();\n\t\t\t}, SEARCH_SPINNER_DELAY - searchData.delay );\n\t\t} );\n\t\tthis.on( 'search-results', clearSearch );\n\t},\n\n\t/**\n\t * Trigger a focus() event on search input in order to\n\t * bring up the virtual keyboard.\n\t *\n\t * @memberof SearchOverlay\n\t * @instance\n\t */\n\tshowKeyboard: function () {\n\t\tvar len = this.$input.val().length;\n\t\tthis.$input.trigger( 'focus' );\n\t\t// Cursor to the end of the input\n\t\tif ( this.$input[0].setSelectionRange ) {\n\t\t\tthis.$input[0].setSelectionRange( len, len );\n\t\t}\n\t},\n\n\t/**\n\t * @inheritdoc\n\t * @memberof SearchOverlay\n\t * @instance\n\t */\n\tshow: function () {\n\t\t// Overlay#show defines the actual overlay visibility.\n\t\tOverlay.prototype.show.apply( this, arguments );\n\n\t\tthis.showKeyboard();\n\t\t/**\n\t\t * Fired after the search overlay is shown\n\t\t *\n\t\t * @event SearchOverlay#search-show\n\t\t */\n\t\tthis.emit( 'search-show' );\n\t},\n\n\t/**\n\t * Perform search and render results inside current view.\n\t * FIXME: Much of the logic for caching and pending queries inside this function should\n\t * actually live in SearchGateway, please move out.\n\t *\n\t * @memberof SearchOverlay\n\t * @instance\n\t * @param {string} query\n\t */\n\tperformSearch: function ( query ) {\n\t\tvar\n\t\t\tself = this,\n\t\t\tapi = this.api,\n\t\t\tdelay = this.gateway.isCached( query ) ? 0 : SEARCH_DELAY;\n\n\t\t// it seems the input event can be fired when virtual keyboard is closed\n\t\t// (Chrome for Android)\n\t\tif ( query !== this.lastQuery ) {\n\t\t\tif ( self._pendingQuery ) {\n\t\t\t\tself._pendingQuery.abort();\n\t\t\t}\n\t\t\tclearTimeout( this.timer );\n\n\t\t\tif ( query.length ) {\n\t\t\t\tthis.timer = setTimeout( function () {\n\t\t\t\t\tvar xhr;\n\t\t\t\t\t/**\n\t\t\t\t\t * Fired immediately before the search API request is sent\n\t\t\t\t\t *\n\t\t\t\t\t * @event SearchOverlay#search-start\n\t\t\t\t\t * @property {Object} data related to the current search\n\t\t\t\t\t */\n\t\t\t\t\tself.emit( 'search-start', {\n\t\t\t\t\t\tquery: query,\n\t\t\t\t\t\tdelay: delay\n\t\t\t\t\t} );\n\n\t\t\t\t\txhr = self.gateway.search( query );\n\t\t\t\t\tself._pendingQuery = xhr.then( function ( data ) {\n\t\t\t\t\t\t// FIXME: Given this manipulates SearchResultsView\n\t\t\t\t\t\t// this should be moved into that class\n\t\t\t\t\t\t// check if we're getting the rights response in case of out of\n\t\t\t\t\t\t// order responses (need to get the current value of the input)\n\t\t\t\t\t\tif ( data && data.query === self.$input.val() ) {\n\t\t\t\t\t\t\tself.$el.toggleClass( 'no-results', data.results.length === 0 );\n\t\t\t\t\t\t\tself.$searchContent\n\t\t\t\t\t\t\t\t.show()\n\t\t\t\t\t\t\t\t.find( 'p' )\n\t\t\t\t\t\t\t\t.hide()\n\t\t\t\t\t\t\t\t.filter( data.results.length ? '.with-results' : '.without-results' )\n\t\t\t\t\t\t\t\t.show();\n\n\t\t\t\t\t\t\t// eslint-disable-next-line no-new\n\t\t\t\t\t\t\tnew WatchstarPageList( {\n\t\t\t\t\t\t\t\tapi: api,\n\t\t\t\t\t\t\t\tfunnel: 'search',\n\t\t\t\t\t\t\t\tpages: data.results,\n\t\t\t\t\t\t\t\tel: self.$resultContainer\n\t\t\t\t\t\t\t} );\n\n\t\t\t\t\t\t\tself.$results = self.$resultContainer.find( 'li' );\n\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * Fired when search API returns results\n\t\t\t\t\t\t\t *\n\t\t\t\t\t\t\t * @event SearchOverlay#search-results\n\t\t\t\t\t\t\t * @type {Object}\n\t\t\t\t\t\t\t * @property {Object[]} results The results returned by the search\n\t\t\t\t\t\t\t *  API\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tself.emit( 'search-results', {\n\t\t\t\t\t\t\t\tresults: data.results\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t} ).promise( { abort: function () { xhr.abort(); } } );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tself.resetSearch();\n\t\t\t}\n\n\t\t\tthis.lastQuery = query;\n\t\t}\n\t},\n\t/**\n\t * Clear results\n\t *\n\t * @private\n\t */\n\tresetSearch: function () {\n\t\tthis.$el.find( '.overlay-content' ).children().hide();\n\t}\n} );\n\nmodule.exports = SearchOverlay;\n","const View = require( '../View' ),\n\tIcon = require( '../Icon' ),\n\tAnchor = require( '../Anchor' ),\n\ticons = require( '../icons' ),\n\t$spinner = icons.spinner().$el,\n\tutil = require( '../util' );\n\n/**\n * @class SearchResultsView\n * @extends View\n * @param {Object} options\n * @param {string} options.searchContentLabel actionable label to tell the user they can \"search\n *  within pages rather than doing a full text search\n * @param {string} options.noResultsMsg shows when no results displayed\n * @param {string} options.searchContentNoResultsMsg alternative to options.searchContentLabel that\n * shows when no search results have been displayed.\n */\nclass SearchResultsView extends View {\n\t/** @inheritdoc */\n\tget isTemplateMode() {\n\t\treturn true;\n\t}\n\t/** @inheritdoc */\n\tget template() {\n\t\treturn util.template( `\n<div class=\"search-results-view\">\n\t<div class=\"search-content overlay-header\">\n\t\t<ul>\n\t\t\t<li>{{! search content icon goes here }}</li>\n\t\t</ul>\n\t\t<div class=\"caption\">\n\t\t\t<p class=\"with-results\">{{searchContentLabel}}</p>\n\t\t\t<p class=\"without-results\">{{noResultsMsg}}</p>\n\t\t\t<p class=\"without-results\">{{{searchContentNoResultsMsg}}}</p>\n\t\t</div>\n\t</div>\n\t<div class=\"spinner-container position-fixed\"></div>\n\t<div class=\"results\">\n\t\t<div class=\"results-list-container\"></div>\n\t\t{{#feedback}}\n\t\t\t<div class=\"search-feedback\">\n\t\t\t\t{{prompt}}\n\t\t\t</div>\n\t\t{{/feedback}}\n\t</div>\n</div>`\n\t\t);\n\t}\n\t/** @inheritdoc */\n\tpreRender() {\n\t\tconst feedbackLink = mw.config.get( 'wgCirrusSearchFeedbackLink' );\n\t\tif ( feedbackLink ) {\n\t\t\tthis.options.feedback = {\n\t\t\t\tprompt: mw.msg( 'mobile-frontend-search-feedback-prompt' ) };\n\t\t}\n\t}\n\t/** @inheritdoc */\n\tpostRender( options ) {\n\t\tconst feedbackLink = mw.config.get( 'wgCirrusSearchFeedbackLink' );\n\t\tsuper.postRender( options );\n\t\tthis.$el.find( '.search-content li' ).append(\n\t\t\tnew Icon( {\n\t\t\t\ttagName: 'a',\n\t\t\t\t// When this icon is clicked we want to reset the hash for subsequent views\n\t\t\t\thref: '#',\n\t\t\t\tname: 'articlesSearch',\n\t\t\t\tadditionalClassNames: 'mw-ui-icon-flush-left',\n\t\t\t\tlabel: mw.msg( 'mobile-frontend-search-content' )\n\t\t\t} ).$el\n\t\t);\n\t\tthis.$el.find( '.spinner-container' ).append( $spinner );\n\t\tif ( feedbackLink ) {\n\t\t\tthis.$el.find( '.search-feedback' ).append(\n\t\t\t\tnew Anchor( {\n\t\t\t\t\tlabel: mw.msg( 'mobile-frontend-search-feedback-link-text' ),\n\t\t\t\t\thref: feedbackLink\n\t\t\t\t} ).$el\n\t\t\t);\n\t\t}\n\t}\n}\n\nmodule.exports = SearchResultsView;\n","const formHeader = require( '../headers' ).formHeader,\n\tSearchHeaderView = require( './SearchHeaderView' ),\n\ticons = require( '../icons' );\n\n/**\n * Generate a search header\n *\n * @param {string} placeholderMsg\n * @param {string} action\n * @param {Function} onInput\n * @param {string} defaultSearchPage\n * @return {jQuery.Element}\n */\nfunction searchHeader( placeholderMsg, action, onInput, defaultSearchPage ) {\n\treturn formHeader(\n\t\tnew SearchHeaderView( {\n\t\t\tplaceholderMsg,\n\t\t\taction,\n\t\t\tonInput,\n\t\t\tdefaultSearchPage\n\t\t} ),\n\t\t[\n\t\t\ticons.cancel()\n\t\t],\n\t\tfalse\n\t);\n}\n\nmodule.exports = searchHeader;\n","var\n\tstorageKey = 'mobileFrontend/toast';\n\n/**\n * Show the previously saved toast data and delete it from storage\n *\n * @memberof Toast\n * @instance\n * @private\n */\nfunction showPending() {\n\tvar data = mw.storage.get( storageKey );\n\tif ( data ) {\n\t\tdata = JSON.parse( data );\n\t\tmw.notify( data.content, data.options );\n\t\tmw.storage.remove( storageKey );\n\t}\n}\n\nmw.requestIdleCallback( showPending );\n\n/**\n * Save the toast data in storage so that we can show it on page reload.\n * Also check whether there is a pending message that's not shown yet.\n * If yes, output a warning message and discard this message.\n * This is to ensure that the page needs to be reloaded before adding\n * a new message for showing later.\n *\n * @memberof Toast\n * @instance\n * @param {string} content Content to be placed in element\n * @param {Object|string} [options]\n *  If a string (deprecated) CSS class to add to the element\n *  If an object, more options for the notification see mw.notification.show.\n *  For backwards compatibility reasons if a string is given it will be\n *  treated as options.type\n */\nfunction showOnPageReload( content, options ) {\n\tif ( mw.storage.get( storageKey ) ) {\n\t\tmw.log.warn(\n\t\t\t'A pending toast message already exits. ' +\n\t\t\t\t'The page should have been reloaded by now.'\n\t\t);\n\t\treturn;\n\t}\n\tmw.storage.set( storageKey, JSON.stringify( {\n\t\tcontent: content,\n\t\toptions: options\n\t} ) );\n}\n\nmodule.exports = { showOnPageReload: showOnPageReload };\n","var units = [ 'seconds', 'minutes', 'hours', 'days', 'months', 'years' ],\n\tutil = require( './util' ),\n\tlimits = [ 1, 60, 3600, 86400, 2592000, 31536000 ];\n\n/** @class time */\n\n/**\n * Calculate the correct unit of timestamp\n *\n * @memberof time\n * @instance\n * @param {number} timestampDelta\n * @return {{value: number, unit: string}}\n */\nfunction timeAgo( timestampDelta ) {\n\tvar i = 0;\n\twhile ( i < limits.length && timestampDelta > limits[i + 1] ) {\n\t\t++i;\n\t}\n\treturn {\n\t\tvalue: Math.round( timestampDelta / limits[i] ),\n\t\tunit: units[i]\n\t};\n}\n\n/**\n * Calculate the correct unit of timestamp delta\n *\n * @memberof time\n * @instance\n * @param {number} timestamp\n * @return {{value: number, unit: string}}\n */\nfunction getTimeAgoDelta( timestamp ) {\n\tvar currentTimestamp = Math.round( new Date().getTime() / 1000 );\n\n\treturn timeAgo( currentTimestamp - timestamp );\n}\n\n/**\n * Whether timestamp delta is less than a day old\n *\n * @memberof time\n * @instance\n * @param {{value: number, unit: string}} delta Object of timestamp and its label\n * @return {boolean}\n */\nfunction isRecent( delta ) {\n\treturn [ 'seconds', 'minutes', 'hours' ].indexOf( delta.unit ) > -1;\n}\n\n/**\n * Is delta less than 10 seconds?\n *\n * @memberof time\n * @instance\n * @param {{value: number, unit: string}} delta Object of timestamp and its label\n * @return {boolean}\n */\nfunction isNow( delta ) {\n\treturn delta.unit === 'seconds' && delta.value < 10;\n}\n\n/**\n * Return a message relating to the last modified relative time.\n *\n * @memberof time\n * @instance\n * @param {number} ts timestamp\n * @param {string} username of the last user to modify the page\n * @param {string} gender of the last user to modify the page\n * @param {string} historyUrl url to the history page for the message\n * @return {string}\n */\nfunction getLastModifiedMessage( ts, username, gender, historyUrl ) {\n\tvar delta,\n\t\thistoryPageAnchor, userPageAnchor,\n\t\tkeys = {\n\t\t\tseconds: 'mobile-frontend-last-modified-with-user-seconds',\n\t\t\tminutes: 'mobile-frontend-last-modified-with-user-minutes',\n\t\t\thours: 'mobile-frontend-last-modified-with-user-hours',\n\t\t\tdays: 'mobile-frontend-last-modified-with-user-days',\n\t\t\tmonths: 'mobile-frontend-last-modified-with-user-months',\n\t\t\tyears: 'mobile-frontend-last-modified-with-user-years'\n\t\t},\n\t\targs = [];\n\n\tgender = gender || 'unknown';\n\n\tdelta = getTimeAgoDelta( ts );\n\tif ( isNow( delta ) ) {\n\t\targs.push( 'mobile-frontend-last-modified-with-user-just-now', gender, username );\n\t} else {\n\t\targs.push( keys[ delta.unit ], gender, username,\n\t\t\tmw.language.convertNumber( delta.value )\n\t\t);\n\t}\n\n\thistoryPageAnchor = util.parseHTML( '<a>' ).attr( 'href', historyUrl || '#' );\n\tuserPageAnchor = util.parseHTML( '<a>' ).attr( 'href', mw.util.getUrl( 'User:' + username ) );\n\n\targs.push(\n\t\thistoryPageAnchor,\n\t\t// Abuse PLURAL support to determine if the user is anonymous or not\n\t\tmw.language.convertNumber( username ? 1 : 0 ),\n\t\t// Our abuse of PLURAL support means we have to pass the relative URL\n\t\t// rather than construct it from a wikilink\n\t\tusername ? userPageAnchor : ''\n\t);\n\n\treturn mw.message.apply( this, args ).parse();\n}\n\n/**\n * Return a message relating to the registration date of the user\n *\n * @memberof time\n * @instance\n * @param {string} ts timestamp\n * @param {string} [gender] of the last user editing this page\n * @return {string}\n */\nfunction getRegistrationMessage( ts, gender ) {\n\tvar delta, html,\n\t\tkeys = {\n\t\t\tseconds: 'mobile-frontend-joined-seconds',\n\t\t\tminutes: 'mobile-frontend-joined-minutes',\n\t\t\thours: 'mobile-frontend-joined-hours',\n\t\t\tdays: 'mobile-frontend-joined-days',\n\t\t\tmonths: 'mobile-frontend-joined-months',\n\t\t\tyears: 'mobile-frontend-joined-years'\n\t\t},\n\t\targs = [];\n\n\tgender = gender || 'unknown';\n\n\tdelta = getTimeAgoDelta( parseInt( ts, 10 ) );\n\tif ( isNow( delta ) ) {\n\t\targs.push( 'mobile-frontend-joined-just-now', gender );\n\t} else {\n\t\targs.push( keys[ delta.unit ], gender, mw.language.convertNumber( delta.value ) );\n\t}\n\thtml = mw.message.apply( this, args ).parse();\n\treturn html;\n}\n\nmodule.exports = {\n\tgetLastModifiedMessage: getLastModifiedMessage,\n\tgetRegistrationMessage: getRegistrationMessage,\n\ttimeAgo: timeAgo,\n\tgetTimeAgoDelta: getTimeAgoDelta,\n\tisNow: isNow,\n\tisRecent: isRecent\n};\n","/* global $ */\n\n/**\n * Utility library\n *\n * @class util\n * @singleton\n */\nmodule.exports = {\n\t/**\n\t * Obtains the correct label for the save button which is project specific. It's either\n\t * \"save\" or \"publish\"\n\t *\n\t * @return {string}\n\t */\n\tsaveButtonMessage: function () {\n\t\treturn mw.config.get( 'wgEditSubmitButtonLabelPublish' ) ?\n\t\t\tmw.msg( 'mobile-frontend-editor-publish' ) : mw.msg( 'mobile-frontend-editor-save' );\n\t},\n\t/**\n\t * Wrapper class for Promises\n\t *\n\t * @memberof util\n\t * @instance\n\t */\n\tPromise: {\n\t\t/**\n\t\t * Wrapper class for the $.when that is compatible with Promise.all\n\t\t *\n\t\t * @memberof util\n\t\t * @param {jQuery.Promise[]} promises\n\t\t * @instance\n\t\t * @return {jQuery.Promise}\n\t\t */\n\t\tall: function ( promises ) {\n\t\t\treturn $.when.apply( $, promises );\n\t\t}\n\t},\n\t/**\n\t * Escape a string for use as a css selector\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {string} selector\n\t * @return {string}\n\t */\n\tescapeSelector: function ( selector ) {\n\t\treturn $.escapeSelector( selector );\n\t},\n\t/**\n\t * Wrapper class for the $.grep\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\tgrep: function () {\n\t\treturn $.grep.apply( $, arguments );\n\t},\n\t/**\n\t * Run method when document is ready.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {Function} fn\n\t * @return {jQuery.Object}\n\t */\n\tdocReady: function ( fn ) {\n\t\treturn $( fn );\n\t},\n\t/**\n\t * Wrapper class for the Deferred method\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Deferred}\n\t */\n\tDeferred: function () {\n\t\treturn $.Deferred();\n\t},\n\t/**\n\t * Adds a class to the document\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Object} element representing the documentElement\n\t */\n\tgetDocument: function () {\n\t\treturn $( document.documentElement );\n\t},\n\t/**\n\t * Get the window object\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {jQuery.Object}\n\t */\n\tgetWindow: function () {\n\t\treturn $( window );\n\t},\n\t/**\n\t * Given some html, create new element(s).\n\t * Unlike jQuery.parseHTML this will return a jQuery object\n\t * not an array.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {string} html\n\t * @param {Element} [ctx] Document element to serve as the context\n\t *  in which the HTML fragment will be created\n\t * @return {jQuery.Object}\n\t */\n\tparseHTML: function ( html, ctx ) {\n\t\tctx = ctx || document;\n\t\treturn $( $.parseHTML( html, ctx ) );\n\t},\n\t/**\n\t * wrapper for jQuery util function to check if something is numeric\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {boolean}\n\t */\n\tisNumeric: function () {\n\t\treturn $.isNumeric.apply( $, arguments );\n\t},\n\t/**\n\t * Wrapper for jQuery.extend method. In future this can be bound to Object.assign\n\t * when support allows.\n\t *\n\t * Warning: if only one argument is supplied to util.extend(), this means the target argument\n\t * was omitted. In this case, the jQuery object itself is assumed to be the target.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @return {Object}\n\t */\n\textend: function () {\n\t\treturn $.extend.apply( $, arguments );\n\t},\n\t/**\n\t * Escape dots and colons in a hash, jQuery doesn't like them because they\n\t * look like CSS classes and pseudoclasses. See\n\t * http://bugs.jquery.com/ticket/5241\n\t * http://stackoverflow.com/questions/350292/how-do-i-get-jquery-to-select-elements-with-a-period-in-their-id\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {string} hash A hash to escape\n\t * @return {string}\n\t */\n\tescapeHash: function ( hash ) {\n\t\treturn hash.replace( /(:|\\.)/g, '\\\\$1' );\n\t},\n\n\t/**\n\t * Heuristic for determining whether an Event should be handled by\n\t * MobileFrontend or allowed to bubble to the browser.\n\t *\n\t * @memberof util\n\t * @instance\n\t * @param {Event} ev\n\t * @return {boolean} True if event is modified with control, alt, meta, or\n\t *                   shift keys and should probably be handled by the\n\t *                   browser.\n\t *\n\t * todo: move this function to a ClickUtil file once bundling and code\n\t * splitting is supported.\n\t */\n\tisModifiedEvent: function ( ev ) {\n\t\treturn ev.altKey || ev.ctrlKey || ev.metaKey || ev.shiftKey;\n\t},\n\n\t/**\n\t * Pipe event emitted by source through proxy. Subscribers to proxy will receive the event as\n\t * though proxy was the originator.\n\t *\n\t * @param {OO.EventEmitter} src\n\t * @param {OO.EventEmitter} proxy\n\t * @param {string} event Event type to listen for.\n\t * @param {any[]} [args] Arguments to pass to\n\t *  subscribers, will be prepended to emitted arguments.\n\t * @return {OO.EventEmitter} The source.\n\t */\n\trepeatEvent: function ( src, proxy, event, args ) {\n\t\treturn src.on( event, function ( args ) {\n\t\t\treturn proxy.emit( event, args );\n\t\t}, args );\n\t},\n\n\t/**\n\t * @typedef {Object} Template\n\t * @property {Function} render returning string of rendered HTML\n\t *\n\t * Centralised place for template rendering.\n\t *\n\t * T223927: We depend on the global Mustache brought in by the\n\t * mediawiki.template.mustache module but do not delegate to\n\t * mediawiki.template.mustache.js because its render method returns a jQuery\n\t * object, but our MobileFrontend code depends on .render returning a string.\n\t *\n\t * @param {string} source code of template that is Mustache compatible.\n\t * @return {Template}\n\t */\n\ttemplate: function ( source ) {\n\t\treturn {\n\t\t\t/**\n\t\t\t * @ignore\n\t\t\t * @return {string} The raw source code of the template\n\t\t\t */\n\t\t\tgetSource: function () {\n\t\t\t\treturn source;\n\t\t\t},\n\t\t\t/**\n\t\t\t * @ignore\n\t\t\t * @param {Object} data Data to render\n\t\t\t * @param {Object} partials Map partial names to Mustache template objects\n\t\t\t * @return {string} Rendered HTML\n\t\t\t */\n\t\t\trender: function ( data, partials ) {\n\t\t\t\tconst partialSource = {};\n\t\t\t\t// Map MobileFrontend templates to partial strings\n\t\t\t\tObject.keys( partials || {} ).forEach( ( key ) => {\n\t\t\t\t\tpartialSource[ key ] = partials[ key ].getSource();\n\t\t\t\t} );\n\n\t\t\t\t// Use global Mustache which is loaded by mediawiki.template.mustache (a\n\t\t\t\t// dependency of the mobile.startup module)\n\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\treturn Mustache.render(\n\t\t\t\t\tsource.trim(),\n\t\t\t\t\tdata,\n\t\t\t\t\tpartialSource\n\t\t\t\t);\n\t\t\t}\n\t\t};\n\t}\n};\n","var util = require( '../util' ),\n\tactionParams = require( '../actionParams' );\n\n/**\n * @typedef {string|number} PageID Page ID. 0 / \"0\" is a special no-ID value.\n * {@link https://www.mediawiki.org/wiki/Manual:Page_table#page_id Page ID}\n *\n * @typedef {string} PageTitle Canonical page title.\n * {@link https://www.mediawiki.org/wiki/Manual:Title.php#Canonical_forms Canonical forms}\n *\n * @typedef {boolean} WatchStatus Page watch status; true if watched, false if\n *                                unwatched.\n * {@link https://www.mediawiki.org/wiki/API:Info API:Info} (see inprop.watched)\n * {@link https://www.mediawiki.org/wiki/API:Watch API:Watch} (see unwatch)\n *\n * @typedef {Object.<PageTitle, WatchStatus>} WatchStatusMap\n */\n\n/**\n * API for retrieving and modifying page watch statuses. This module interacts\n * with two endpoints, API:Info for GETs and API:Watch and for POSTs.\n *\n * @class WatchstarGateway\n * @param {mw.Api} api\n */\nfunction WatchstarGateway( api ) {\n\tthis.api = api;\n}\n\nWatchstarGateway.prototype = {\n\t/**\n\t * Issues zero to two asynchronous HTTP requests for the watch status of\n\t * each page ID and title passed.\n\t *\n\t * Every watch entry has a title but not necessarily a page ID. Entries\n\t * without IDs are missing pages, i.e., pages that do not exist. These\n\t * entries are used to observe when a page with a given title is created.\n\t * Although it is convenient to use titles because they're always present,\n\t * IDs are preferred since they're far less likely to exceed the URL length\n\t * limit.\n\t *\n\t * No request is issued when no IDs and no titles are passed. Given that the\n\t * server state does not change between the two requests, overlapping title\n\t * and ID members will behave as expected but there is no reason to issue\n\t * such a request.\n\t *\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageID[]} ids\n\t * @param {PageTitle[]} titles\n\t * @return {jQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetStatuses: function ( ids, titles ) {\n\t\t// Issue two requests and coalesce the results.\n\t\treturn util.Promise.all( [\n\t\t\tthis.getStatusesByID( ids ),\n\t\t\tthis.getStatusesByTitle( titles )\n\t\t] ).then( function () { return util.extend.apply( util, arguments ); } );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageID[]} ids\n\t * @return {jQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetStatusesByID: function ( ids ) {\n\t\tvar self = this;\n\t\tif ( !ids.length ) {\n\t\t\treturn util.Deferred().resolve( {} );\n\t\t}\n\n\t\treturn this.api.get( {\n\t\t\tformatversion: 2,\n\t\t\taction: 'query',\n\t\t\tprop: 'info',\n\t\t\tinprop: 'watched',\n\t\t\tpageids: ids\n\t\t} ).then( function ( rsp ) {\n\t\t\treturn self._unmarshalGetResponse( rsp );\n\t\t} );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageTitle[]} titles\n\t * @return {jQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetStatusesByTitle: function ( titles ) {\n\t\tvar self = this;\n\t\tif ( !titles.length ) {\n\t\t\treturn util.Deferred().resolve( {} );\n\t\t}\n\n\t\treturn this.api.get( actionParams( {\n\t\t\tprop: 'info',\n\t\t\tinprop: 'watched',\n\t\t\ttitles: titles\n\t\t} ) ).then( function ( rsp ) {\n\t\t\treturn self._unmarshalGetResponse( rsp );\n\t\t} );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {PageTitle[]} titles\n\t * @param {WatchStatus} watched\n\t * @return {jQuery.Deferred}\n\t */\n\tpostStatusesByTitle: function ( titles, watched ) {\n\t\tvar params = {\n\t\t\taction: 'watch',\n\t\t\ttitles: titles\n\t\t};\n\t\tif ( !watched ) {\n\t\t\tparams.unwatch = !watched;\n\t\t}\n\t\treturn this.api.postWithToken( 'watch', params );\n\t},\n\n\t/**\n\t * @memberof WatchstarGateway\n\t * @instance\n\t * @param {Object} rsp The API:Info response.\n\t * @return {jQuery.Deferred<WatchStatusMap>}\n\t * @see getStatusesByID\n\t * @see getStatusesByTitle\n\t */\n\t_unmarshalGetResponse: function ( rsp ) {\n\t\tvar pages = rsp && rsp.query && rsp.query.pages || [];\n\t\treturn pages.reduce( function ( statuses, page ) {\n\t\t\tstatuses[page.title] = page.watched;\n\t\t\treturn statuses;\n\t\t}, {} );\n\t}\n};\n\nmodule.exports = WatchstarGateway;\n","var PageList = require( '../PageList' ),\n\twatchstar = require( './watchstar' ),\n\tuser = mw.user,\n\tutil = require( '../util' ),\n\tPage = require( '../Page' ),\n\tmfExtend = require( '../mfExtend' ),\n\tWatchstarGateway = require( './WatchstarGateway' );\n\n/**\n * @typedef {Object.<PageTitle, PageID>} PageTitleToPageIDMap\n */\n\n/**\n * List of items page view\n *\n * @class WatchstarPageList\n * @uses Page\n * @uses WatchstarGateway\n * @uses Watchstar\n * @extends PageList\n *\n * @fires WatchstarPageList#unwatch\n * @fires WatchstarPageList#watch\n * @param {Object} options Configuration options\n */\nfunction WatchstarPageList( options ) {\n\tthis.wsGateway = new WatchstarGateway( options.api );\n\tPageList.apply( this, arguments );\n}\n\nmfExtend( WatchstarPageList, PageList, {\n\t/**\n\t * @memberof WatchstarPageList\n\t * @instance\n\t * @mixes PageList#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {mw.Api} defaults.api\n\t */\n\n\tpostRender: function () {\n\t\tvar\n\t\t\tself = this,\n\t\t\t$items,\n\t\t\tpages,\n\t\t\tids = [],\n\t\t\ttitles = [];\n\n\t\tPageList.prototype.postRender.apply( this );\n\n\t\t$items = this.queryUnitializedItems();\n\t\tpages = this.parsePagesFromItems( $items );\n\n\t\tObject.keys( pages ).forEach( function ( title ) {\n\t\t\tvar id = pages[title];\n\t\t\t// Favor IDs since they're short and unlikely to exceed URL length\n\t\t\t// limits when batched.\n\t\t\tif ( id && id !== '0' ) {\n\t\t\t\t// ID is present and valid.\n\t\t\t\tids.push( id );\n\t\t\t} else {\n\t\t\t\t// Only titles are available for missing pages.\n\t\t\t\ttitles.push( title );\n\t\t\t}\n\t\t} );\n\n\t\treturn this.getPages( ids, titles ).then( function ( statuses ) {\n\t\t\tself.renderItems( $items, statuses );\n\t\t} );\n\t},\n\n\t/**\n\t * @param {jQuery.Element} $items\n\t * @param {WatchStatusMap} statuses\n\t * @return {void}\n\t */\n\tqueryUnitializedItems: function () {\n\t\treturn this.$el.find( 'li:not(.with-watchstar)' );\n\t},\n\n\t/**\n\t * Retrieve pages\n\t *\n\t * @memberof WatchstarPageList\n\t * @instance\n\t * @param {PageID[]} ids\n\t * @param {PageTitle[]} titles\n\t * @return {jQuery.Deferred<WatchStatusMap>}\n\t */\n\tgetPages: function ( ids, titles ) {\n\t\t// Rendering Watchstars for anonymous users is not useful. Short-circuit\n\t\t// the request.\n\t\tif ( user.isAnon() ) {\n\t\t\treturn util.Deferred().resolve( {} );\n\t\t}\n\n\t\treturn this.wsGateway.getStatuses( ids, titles );\n\t},\n\n\t/**\n\t * @param {jQuery.Element} $items\n\t * @return {PageTitleToPageIDMap}\n\t * @memberof WatchstarPageList\n\t * @instance\n\t */\n\tparsePagesFromItems: function ( $items ) {\n\t\tvar\n\t\t\tself = this,\n\t\t\tpages = {};\n\t\t$items.each( function ( _, item ) {\n\t\t\tvar $item = self.$el.find( item );\n\t\t\tpages[ $item.attr( 'title' ) ] = $item.data( 'id' );\n\t\t} );\n\t\treturn pages;\n\t},\n\n\t/**\n\t * @param {jQuery.Element} $items\n\t * @param {WatchStatusMap} statuses\n\t * @return {void}\n\t */\n\trenderItems: function ( $items, statuses ) {\n\t\tvar self = this;\n\n\t\t// Rendering Watchstars for anonymous users is not useful. Nothing to do.\n\t\tif ( user.isAnon() ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Create watch stars for each entry in list\n\t\t$items.each( function ( _, item ) {\n\t\t\tvar\n\t\t\t\t$item = self.$el.find( item ),\n\t\t\t\tpage = new Page( {\n\t\t\t\t\t// FIXME: Set sections so we don't hit the api (hacky)\n\t\t\t\t\tsections: [],\n\t\t\t\t\ttitle: $item.attr( 'title' ),\n\t\t\t\t\tid: $item.data( 'id' )\n\t\t\t\t} ),\n\t\t\t\twatched = statuses[ page.getTitle() ];\n\n\t\t\tself._appendWatchstar( $item, page, watched );\n\t\t\t$item.addClass( 'with-watchstar' );\n\t\t} );\n\t},\n\n\t/**\n\t * @param {jQuery.Object} $item\n\t * @param {Page} page\n\t * @param {WatchStatus} watched\n\t */\n\t_appendWatchstar: function ( $item, page, watched ) {\n\t\twatchstar( {\n\t\t\t// WatchstarPageList.getPages() already retrieved the status of\n\t\t\t// each page. Explicitly set the watch state so another request\n\t\t\t// will not be issued by the Watchstar.\n\t\t\tisWatched: watched,\n\t\t\tpage: page\n\t\t} ).appendTo( $item );\n\t}\n} );\n\nmodule.exports = WatchstarPageList;\n","var icons = require( '../icons' );\n\n/**\n * A clickable watchstar for logged in users.\n * Should not be used for anonymous users.\n *\n * @param {Object} options Configuration options\n * @param {Page} options.page\n * @param {boolean} options.isWatched is the article watched?\n * @return {Icon}\n */\nmodule.exports = function ( options ) {\n\tconst isWatched = options.isWatched,\n\t\t// FIXME: mw.loader.require is not a public function (T235198)\n\t\twatchstar = mw.loader.require( 'mediawiki.page.watch.ajax' ).watchstar,\n\t\taction = isWatched ? 'unwatch' : 'watch',\n\t\ticonProps = {\n\t\t\thref: mw.Title.newFromText( options.page.title ).getUrl( { action } )\n\t\t},\n\t\twatchIcon = icons.watchIcon( iconProps ),\n\t\twatchedIcon = icons.watchedIcon( iconProps ),\n\t\tWATCH_CLASS = watchIcon.$el.attr( 'class' ),\n\t\tWATCHED_CLASS = watchedIcon.$el.attr( 'class' ),\n\t\tactiveIcon = isWatched ? watchedIcon : watchIcon,\n\t\tcallback = ( $link, isWatched ) => {\n\t\t\t$link.attr( 'class', isWatched ?\n\t\t\t\tWATCHED_CLASS : WATCH_CLASS );\n\t\t};\n\n\twatchstar( activeIcon.$el, options.page.title, callback );\n\treturn activeIcon;\n};\n","const\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tView = require( '../mobile.startup/View' ),\n\tutil = require( '../mobile.startup/util' );\n\n/**\n * Create a panel with a child\n *\n * @param {jQuery.Object} $child\n * @return {Panel}\n */\nfunction makePanel( $child ) {\n\tconst panel = new View( { className: 'panel' } );\n\tpanel.$el.append( $child );\n\treturn panel;\n}\n\n/**\n * Form for adding a talk section\n *\n * @class AddTopicForm\n * @extends View\n *\n * @param {Object} options Configuration options\n * @param {string} options.licenseMsg license text (HTML strings accepted)\n * @param {Function} options.onTextInput callback for when text changes\n * @param {string} options.subject to prefill form with\n * @param {string} options.body to prefill form with\n * @param {boolean} options.disabled to mark the form inputs as disabled\n */\nfunction AddTopicForm( options ) {\n\tView.call( this,\n\t\tutil.extend( options, {\n\t\t\t// Template properties\n\t\t\ttopicTitlePlaceHolder: mw.msg( 'mobile-frontend-talk-add-overlay-subject-placeholder' ),\n\t\t\ttopicContentPlaceHolder: mw.msg( 'mobile-frontend-talk-add-overlay-content-placeholder' ),\n\n\t\t\t// Additional data\n\t\t\tclassName: 'add-topic-form',\n\t\t\tevents: {\n\t\t\t\t'input .wikitext-editor, input': 'onTextInput',\n\t\t\t\t'change .wikitext-editor, input': 'onTextInput'\n\t\t\t}\n\t\t} )\n\t);\n}\n\nmfExtend( AddTopicForm, View, {\n\t/**\n\t * @inheritdoc\n\t * @memberof AddTopicForm\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tconst options = this.options,\n\t\t\tdisabled = options.disabled,\n\t\t\t$subject = util.parseHTML( '<input>' ).attr( {\n\t\t\t\tclass: 'mw-ui-input',\n\t\t\t\ttype: 'text',\n\t\t\t\tdisabled,\n\t\t\t\tvalue: options.subject,\n\t\t\t\tplaceholder: options.topicTitlePlaceHolder\n\t\t\t} ),\n\t\t\t$body = util.parseHTML( '<textarea>' ).attr( {\n\t\t\t\tclass: 'wikitext-editor mw-ui-input',\n\t\t\t\tcols: 40,\n\t\t\t\trows: 10,\n\t\t\t\tdisabled,\n\t\t\t\tplaceholder: options.topicContentPlaceHolder\n\t\t\t} ).val( options.body ),\n\t\t\tpanels = [\n\t\t\t\tmakePanel( util.parseHTML( '<p>' ).addClass( 'license' ).html( options.licenseMsg ) ),\n\t\t\t\tmakePanel( $subject ),\n\t\t\t\tmakePanel( $body )\n\t\t\t];\n\n\t\tthis.$el.append(\n\t\t\tpanels.map( function ( panel ) {\n\t\t\t\treturn panel.$el;\n\t\t\t} )\n\t\t);\n\t\tthis.$subject = $subject;\n\t\tthis.$messageBody = $body;\n\t\tView.prototype.postRender.apply( this, arguments );\n\t},\n\t/**\n\t * Handles an input into a textarea and enables or disables the submit button\n\t *\n\t * @memberof AddTopicForm\n\t * @instance\n\t */\n\tonTextInput: function () {\n\t\tif ( this.options.onTextInput ) {\n\t\t\tthis.options.onTextInput( this.$subject.val().trim(), this.$messageBody.val().trim() );\n\t\t}\n\t}\n} );\n\nAddTopicForm.test = {\n\tmakePanel\n};\n\nmodule.exports = AddTopicForm;\n","var\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\theaders = require( '../mobile.startup/headers' ),\n\tOverlay = require( '../mobile.startup/Overlay' ),\n\tPageGateway = require( '../mobile.startup/PageGateway' ),\n\tutil = require( '../mobile.startup/util' ),\n\tmakeAddTopicForm = require( './makeAddTopicForm' );\n\n/**\n * Overlay for adding a talk section\n *\n * @class TalkSectionAddOverlay\n * @extends Overlay\n *\n * @param {Object} options Configuration options\n * @param {mw.Api} options.api\n * @param {Object} options.title Title of the talk page being modified\n * @param {string} options.licenseMsg\n * @param {Object} options.currentPageTitle Title of the page before the overlay appears\n * @param {Function} [options.onSaveComplete] executed when a save has completed\n * and talk-discussion-added events\n */\nfunction TalkSectionAddOverlay( options ) {\n\tthis.editorApi = options.api;\n\tthis.pageGateway = new PageGateway( options.api );\n\tOverlay.call( this,\n\t\tutil.extend( options, {\n\t\t\tclassName: 'talk-overlay overlay',\n\t\t\tonBeforeExit: this.onBeforeExit.bind( this ),\n\t\t\tevents: {\n\t\t\t\t'click .save': 'onSaveClick'\n\t\t\t}\n\t\t} )\n\t);\n\tthis.onSaveComplete = options.onSaveComplete;\n\tthis.title = options.title;\n\tthis.currentPageTitle = options.currentPageTitle;\n\t// Variable to indicate, if the overlay will be closed by the save function\n\t// or by the user. If this is false and there is content in the input fields,\n\t// the user will be asked, if he want to abandon his changes before we close\n\t// the Overlay, otherwise the Overlay will be closed without any question.\n\tthis._saveHit = false;\n}\n\nmfExtend( TalkSectionAddOverlay, Overlay, {\n\tpreRender: function () {\n\t\tthis.options.headers = [\n\t\t\t// contentHeader\n\t\t\theaders.saveHeader(\n\t\t\t\tmw.msg( 'mobile-frontend-talk-add-overlay-submit' ),\n\t\t\t\t'initial-header save-header'\n\t\t\t),\n\t\t\theaders.savingHeader( mw.msg( 'mobile-frontend-talk-topic-wait' ) )\n\t\t];\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof TalkSectionAddOverlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tOverlay.prototype.postRender.call( this );\n\t\tconst topicForm = makeAddTopicForm( {\n\t\t\tsubject: '',\n\t\t\tbody: '',\n\t\t\tdisabled: false,\n\t\t\tlicenseMsg: this.options.licenseMsg,\n\t\t\tonTextInput: this.onTextInput.bind( this )\n\t\t} );\n\t\tthis.showHidden( '.initial-header' );\n\t\tthis.$confirm = this.$el.find( 'button.save' );\n\t\tthis.$el.find( '.overlay-content' ).append( topicForm.$el );\n\t\tthis.$subject = topicForm.$el.find( 'input' );\n\t\tthis.$ta = topicForm.$el.find( '.wikitext-editor' );\n\t},\n\t/**\n\t * @inheritdoc\n\t * @memberof TalkSectionAddOverlay\n\t * @instance\n\t */\n\tonBeforeExit: function ( exit ) {\n\t\tvar empty,\n\t\t\tconfirmMessage = mw.msg( 'mobile-frontend-editor-cancel-confirm' );\n\n\t\tempty = ( !this.$subject.val() && !this.$ta.val() );\n\t\t// TODO: Replace with an OOUI dialog\n\t\t// eslint-disable-next-line no-alert\n\t\tif ( this._saveHit || empty || window.confirm( confirmMessage ) ) {\n\t\t\texit();\n\t\t}\n\t},\n\t/**\n\t * Handles an input into a textarea and enables or disables the submit button\n\t *\n\t * @memberof TalkSectionAddOverlay\n\t * @param {string} subject\n\t * @param {string} body\n\t * @instance\n\t */\n\tonTextInput: function ( subject, body ) {\n\t\tthis.subject = subject;\n\t\tthis.body = body;\n\n\t\tclearTimeout( this.timer );\n\t\tthis.timer = setTimeout( function () {\n\t\t\tif ( !body || !subject ) {\n\t\t\t\tthis.$confirm.prop( 'disabled', true );\n\t\t\t} else {\n\t\t\t\tthis.$confirm.prop( 'disabled', false );\n\t\t\t}\n\t\t}.bind( this ), 250 );\n\t},\n\t/**\n\t * Handles a click on the save button\n\t *\n\t * @memberof TalkSectionAddOverlay\n\t * @instance\n\t */\n\tonSaveClick: function () {\n\t\tthis.showHidden( '.saving-header' );\n\t\tthis.save().then( function ( status ) {\n\t\t\tif ( status === 'ok' && this.options.onSaveComplete ) {\n\t\t\t\tthis.onSaveComplete();\n\t\t\t}\n\t\t}.bind( this ), function ( error ) {\n\t\t\tvar editMsg = mw.msg( 'mobile-frontend-talk-topic-error' );\n\n\t\t\tthis.$confirm.prop( 'disabled', false );\n\t\t\tswitch ( error.details ) {\n\t\t\t\tcase 'protectedpage':\n\t\t\t\t\teditMsg = mw.msg( 'mobile-frontend-talk-topic-error-protected' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'noedit':\n\t\t\t\tcase 'blocked':\n\t\t\t\t\teditMsg = mw.msg( 'mobile-frontend-talk-topic-error-permission' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'spamdetected':\n\t\t\t\t\teditMsg = mw.msg( 'mobile-frontend-talk-topic-error-spam' );\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'badtoken':\n\t\t\t\t\teditMsg = mw.msg( 'mobile-frontend-talk-topic-error-badtoken' );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\teditMsg = mw.msg( 'mobile-frontend-talk-topic-error' );\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tmw.notify( editMsg, { type: 'error' } );\n\t\t\tthis.showHidden( '.save-header, .save-panel' );\n\t\t}.bind( this ) );\n\t},\n\t/**\n\t * Save new talk section\n\t *\n\t * @memberof TalkSectionAddOverlay\n\t * @instance\n\t * @return {jQuery.Deferred} Object that either will be resolved with ok parameter\n\t * or rejected with type error.\n\t */\n\tsave: function () {\n\t\tvar heading = this.subject,\n\t\t\td = util.Deferred();\n\n\t\tthis.$ta.removeClass( 'error' );\n\t\tthis.$subject.removeClass( 'error' );\n\n\t\t// propagate, that we save an edit and want to close the Overlay without\n\t\t// any interruption (user questions e.g.)\n\t\tthis._saveHit = true;\n\n\t\tthis.$el.find( '.content' ).empty().addClass( 'loading' );\n\t\t// FIXME: while saving: a spinner would be nice\n\t\t// FIXME: This should be using a gateway e.g. TalkGateway, PageGateway or EditorGateway\n\t\treturn this.editorApi.postWithToken( 'csrf', {\n\t\t\taction: 'edit',\n\t\t\tsection: 'new',\n\t\t\tsectiontitle: heading,\n\t\t\ttitle: this.title,\n\t\t\tsummary: mw.msg( 'newsectionsummary', heading ),\n\t\t\ttext: this.body\n\t\t} ).then( function () {\n\t\t\treturn 'ok';\n\t\t}, function ( msg ) {\n\t\t\t// FIXME: Throw an Error\n\t\t\treturn d.reject( {\n\t\t\t\ttype: 'error',\n\t\t\t\tdetails: msg\n\t\t\t} );\n\t\t} );\n\t}\n} );\n\nmodule.exports = TalkSectionAddOverlay;\n","var\n\tuser = mw.user,\n\ticons = require( '../mobile.startup/icons' ),\n\t$spinner = icons.spinner().$el,\n\tmfExtend = require( '../mobile.startup/mfExtend' ),\n\tOverlay = require( '../mobile.startup/Overlay' ),\n\theader = require( '../mobile.startup/headers' ).header,\n\tutil = require( '../mobile.startup/util' ),\n\tautosign = require( './autosign' ),\n\tButton = require( '../mobile.startup/Button' ),\n\tlazyImageLoader = require( '../mobile.startup/lazyImages/lazyImageLoader' );\n\n/**\n * Callback executed when a save has successfully completed.\n *\n * @callback onSaveComplete\n */\n\n/**\n * Overlay for showing talk page section\n *\n * @class TalkSectionOverlay\n * @extends Overlay\n * @param {Object} options\n * @param {number} options.id Section ID\n * @param {Section} options.section\n * @param {mw.Api} options.api\n * @param {string} options.title\n * @param {string} options.licenseMsg\n * @param {onSaveComplete} [options.onSaveComplete]\n */\nfunction TalkSectionOverlay( options ) {\n\tconst onBeforeExit = this.onBeforeExit.bind( this );\n\n\tthis.editorApi = options.api;\n\tthis.state = {\n\t\t// current value of the textarea\n\t\ttext: ''\n\t};\n\tOverlay.call( this,\n\t\tutil.extend( true, options, {\n\t\t\tclassName: 'talk-overlay overlay',\n\t\t\tonBeforeExit,\n\t\t\tevents: {\n\t\t\t\tclick: function ( ev ) {\n\t\t\t\t\t// If a link has been clicked (that's not the save button)\n\t\t\t\t\t// check that it's okay to exit\n\t\t\t\t\tif ( ev.target.tagName === 'BUTTON' &&\n\t\t\t\t\t\tev.target.className.indexOf( 'save-button' ) === -1\n\t\t\t\t\t) {\n\t\t\t\t\t\t// If the user says okay, do nothing, continuing as if normal link\n\t\t\t\t\t\tonBeforeExit( () => {}, function () {\n\t\t\t\t\t\t\t// if the user says no, prevent the default behaviour\n\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'input textarea': 'onInputTextarea',\n\t\t\t\t'click .save-button': 'onSaveClick'\n\t\t\t}\n\t\t} )\n\t);\n}\n\nmfExtend( TalkSectionOverlay, Overlay, {\n\ttemplatePartials: util.extend( {}, Overlay.prototype.templatePartials, {\n\t\tcontent: util.template( `\n<div class=\"content talk-section mw-parser-output\">\n\t{{{section.text}}}\n\t<div class=\"comment\">\n\t\t<div class=\"list-header\">{{reply}}</div>\n\t\t<div class=\"comment-content\">\n\t\t\t<textarea class=\"wikitext-editor\"></textarea>\n\t\t\t<p class=\"license\">\n\t\t\t\t{{info}}\n\t\t\t\t{{{licenseMsg}}}\n\t\t\t</p>\n\t\t</div>\n\t</div>\n</div>\n\t\t` )\n\t} ),\n\t/**\n\t * @memberof TalkSectionOverlay\n\t * @instance\n\t * @mixes Overlay#defaults\n\t * @property {Object} defaults Default options hash.\n\t * @property {string} defaults.title Title.\n\t * @property {Section} defaults.section that is currently being viewed in overlay.\n\t * @property {string} defaults.reply Reply heading.\n\t * @property {Button} defaults.saveButton\n\t * @property {string} defaults.info Message that informs the user their talk reply will be\n\t * automatically signed.\n\t */\n\tdefaults: util.extend( {}, Overlay.prototype.defaults, {\n\t\tsaveButton: new Button( {\n\t\t\tblock: true,\n\t\t\ttagName: 'button',\n\t\t\tdisabled: true,\n\t\t\tadditionalClassNames: 'save-button',\n\t\t\tprogressive: true,\n\t\t\tlabel: util.saveButtonMessage()\n\t\t} ),\n\t\ttitle: undefined,\n\t\tsection: undefined,\n\t\treply: mw.msg( 'mobile-frontend-talk-reply' ),\n\t\tinfo: mw.msg( 'mobile-frontend-talk-reply-info' )\n\t} ),\n\t/**\n\t * A function to run before exiting the overlay\n\t *\n\t * @memberof TalkSectionOverlay\n\t * @instance\n\t * @param {Event} ev\n\t */\n\tonInputTextarea: function ( ev ) {\n\t\tvar value = ev.target.value;\n\t\tthis.state.text = value;\n\t\tif ( value ) {\n\t\t\tthis.$saveButton.prop( 'disabled', false );\n\t\t} else {\n\t\t\tthis.$saveButton.prop( 'disabled', true );\n\t\t}\n\t},\n\t/**\n\t * A function to run before exiting the overlay\n\t *\n\t * @memberof TalkSectionOverlay\n\t * @instance\n\t * @param {Function} exit\n\t * @param {Function} cancel\n\t */\n\tonBeforeExit: function ( exit, cancel ) {\n\t\tvar confirmMessage = mw.msg( 'mobile-frontend-editor-cancel-confirm' );\n\n\t\t// eslint-disable-next-line no-alert\n\t\tif ( !this.state.text || window.confirm( confirmMessage ) ) {\n\t\t\texit();\n\t\t} else {\n\t\t\tcancel();\n\t\t}\n\t},\n\t/**\n\t * Accounts for the fact sections are loaded asynchronously and sets the headers\n\t * for the overlay\n\t *\n\t * @inheritdoc\n\t */\n\tpreRender: function () {\n\t\tvar options = this.options;\n\t\tthis.options.headers = [\n\t\t\theader(\n\t\t\t\toptions.section ? options.section.line : '',\n\t\t\t\t[],\n\t\t\t\ticons.back(),\n\t\t\t\t'initial-header'\n\t\t\t)\n\t\t];\n\t},\n\t/**\n\t * Fetches the talk topics of the page specified in options.title\n\t * if options.section is not defined.\n\t *\n\t * @inheritdoc\n\t * @memberof TalkSectionOverlay\n\t * @instance\n\t */\n\tpostRender: function () {\n\t\tlazyImageLoader.loadImages(\n\t\t\tlazyImageLoader.queryPlaceholders( this.$el[0] )\n\t\t);\n\t\tOverlay.prototype.postRender.apply( this );\n\t\tthis.$el.find( '.talk-section' ).prepend( $spinner );\n\t\tthis.$saveButton = this.options.saveButton.$el;\n\t\tthis.$el.find( '.comment-content' ).append( this.$saveButton );\n\t\tthis.hideSpinner();\n\t\tthis._enableComments();\n\t},\n\t/**\n\t * Enables comments on the current rendered talk topic\n\t *\n\t * @memberof TalkSectionOverlay\n\t * @instance\n\t * @private\n\t */\n\t_enableComments: function () {\n\t\tthis.$commentBox = this.$el.find( '.comment' );\n\t\tif ( user.isAnon() ) {\n\t\t\tthis.$commentBox.remove();\n\t\t} else {\n\t\t\tthis.$textarea = this.$commentBox.find( 'textarea' );\n\t\t}\n\t},\n\t/**\n\t * Handle a click on the save button\n\t *\n\t * @memberof TalkSectionOverlay\n\t * @instance\n\t */\n\tonSaveClick: function () {\n\t\tvar val = this.state.text,\n\t\t\tself = this;\n\n\t\tfunction enableSaveButton() {\n\t\t\tself.$saveButton.prop( 'disabled', false );\n\t\t}\n\t\tif ( val ) {\n\t\t\t// show a spinner\n\t\t\tthis.showSpinner();\n\t\t\tthis.$saveButton.prop( 'disabled', true );\n\t\t\t// sign and add newline to front\n\t\t\tval = '\\n\\n' + autosign( val );\n\t\t\t// FIXME: This should be using a gateway\n\t\t\t// e.g. TalkGateway, PageGateway or EditorGateway\n\t\t\tthis.editorApi.postWithToken( 'csrf', {\n\t\t\t\taction: 'edit',\n\t\t\t\ttitle: this.options.title,\n\t\t\t\tsection: this.options.id,\n\t\t\t\tappendtext: val,\n\t\t\t\tredirect: true\n\t\t\t} ).then( function () {\n\t\t\t\tif ( self.options.onSaveComplete ) {\n\t\t\t\t\tself.options.onSaveComplete();\n\t\t\t\t}\n\t\t\t}, function ( data, response ) {\n\t\t\t\t// FIXME: Code sharing with SourceEditorOverlay?\n\t\t\t\tvar msg,\n\t\t\t\t\t// When save failed with one of these error codes, the returned\n\t\t\t\t\t// message in response.error.info will be forwarded to the user.\n\t\t\t\t\t// FIXME: This shouldn't be needed when info texts are all localized.\n\t\t\t\t\twhitelistedErrorInfo = [\n\t\t\t\t\t\t'readonly',\n\t\t\t\t\t\t'blocked',\n\t\t\t\t\t\t'autoblocked'\n\t\t\t\t\t];\n\n\t\t\t\tif (\n\t\t\t\t\tresponse.error &&\n\t\t\t\t\twhitelistedErrorInfo.indexOf( response.error.code ) > -1\n\t\t\t\t) {\n\t\t\t\t\tmsg = response.error.info;\n\t\t\t\t} else {\n\t\t\t\t\tmsg = mw.msg( 'mobile-frontend-editor-error' );\n\t\t\t\t}\n\n\t\t\t\tself.hideSpinner();\n\t\t\t\tmw.notify( msg, { type: 'error' } );\n\t\t\t\tenableSaveButton();\n\t\t\t} );\n\t\t}\n\t}\n} );\n\nmodule.exports = TalkSectionOverlay;\n","/**\n * Autosign a block of text if necessary\n *\n * @instance\n * @param {string} text\n * @return {string} text with an autosign (\"~~~~\") if necessary\n */\nfunction autosign( text ) {\n\treturn /~{3,5}/.test( text ) ? text : text + ' ~~~~';\n}\n\nmodule.exports = autosign;\n","const AddTopicForm = require( './AddTopicForm' ),\n\tautosign = require( './autosign' );\n\n/**\n * Backwards compatible method for obtaining a TalkOverlay\n * used by Minerva until it updates itself.\n *\n * @param {Object} options Configuration options\n * @param {string} options.licenseMsg license text (HTML strings accepted)\n * @param {Function} [options.onTextInput] callback for when text changes\n * @param {string} options.subject to prefill form with\n * @param {string} options.body to prefill form with\n * @param {boolean} options.disabled to mark the form inputs as disabled\n * @return {AddTopicForm}\n */\nfunction makeAddTopicForm( { licenseMsg, onTextInput, subject, body, disabled } ) {\n\tconst form = new AddTopicForm( {\n\t\tlicenseMsg,\n\t\tdisabled,\n\t\tsubject,\n\t\tbody,\n\t\tonTextInput: onTextInput ? function ( subject, body ) {\n\t\t\t// if the body has content, autosign it!\n\t\t\tif ( body ) {\n\t\t\t\tbody = autosign( body );\n\t\t\t}\n\t\t\t// propagate up the autosigned content\n\t\t\tonTextInput.call( this, subject, body );\n\t\t} : undefined\n\t} );\n\treturn form;\n}\n\nmodule.exports = makeAddTopicForm;\n","let\n\tutil,\n\tCategoryGateway,\n\tsandbox;\nconst\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend CategoryGateway.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\t\tCategoryGateway = require( '../../../src/mobile.categories.overlays/CategoryGateway' );\n\n\t\tthis.getSpy = {\n\t\t\tget: sandbox.stub().returns( util.Deferred().resolve( {\n\t\t\t\tbatchcomplete: true,\n\t\t\t\tquery: {\n\t\t\t\t\tpages: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageid: 5,\n\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\ttitle: 'HelloWorld',\n\t\t\t\t\t\t\tcategories: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tns: 14,\n\t\t\t\t\t\t\t\t\ttitle: 'Category:Hello'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t} ) )\n\t\t};\n\t\tthis.postSpy = {\n\t\t\tpostWithToken: sandbox.stub().returns( util.Deferred().resolve() )\n\t\t};\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'getCategories()', function ( assert ) {\n\tconst self = this,\n\t\tgateway = new CategoryGateway( this.getSpy ),\n\t\tresult = gateway.getCategories( 'HelloWorld' );\n\n\tassert.notStrictEqual( result, false, 'result should not return false' );\n\n\treturn result.then( function () {\n\t\tassert.strictEqual( gateway.canContinue, false, 'gateway should not continue' );\n\t\tassert.ok( self.getSpy.get.calledWith( {\n\t\t\taction: 'query',\n\t\t\tprop: 'categories',\n\t\t\ttitles: 'HelloWorld',\n\t\t\tclprop: 'hidden',\n\t\t\tcllimit: 50,\n\t\t\tformatversion: 2\n\t\t} ), 'invalid data passed to get api request' );\n\t} );\n\n} );\n\nQUnit.test( 'save()', function ( assert ) {\n\tconst\n\t\tself = this,\n\t\tgateway = new CategoryGateway( this.postSpy ),\n\t\ttitle = 'HelloWorld',\n\t\tcategories = '[[Category:World]]';\n\n\treturn gateway.save( title, categories ).then( function () {\n\t\tassert.ok( self.postSpy.postWithToken.calledWith( 'csrf', {\n\t\t\taction: 'edit',\n\t\t\ttitle: title,\n\t\t\tappendtext: categories,\n\t\t\tsummary: mw.msg( 'mobile-frontend-categories-summary' )\n\t\t} ), 'invalid data passed to post api request' );\n\t} );\n} );\n","let sandbox, EditorGateway, spy, postStub, apiReject, apiHappy, apiRvNoSection,\n\tapiCaptchaFail, apiAbuseFilterDisallow, apiAbuseFilterWarning, apiAbuseFilterOther,\n\tapiTestError, apiReadOnly, apiExpiredToken, apiWithSectionLine, apiHappyTestContent,\n\tapiEmptySuccessResponse, apiNoSectionLine, apiRejectHttp,\n\thappyResponse;\nconst\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tAPI_REQUEST_DATA = {\n\t\ttitle: 'test',\n\t\taction: 'edit',\n\t\terrorformat: 'html',\n\t\terrorlang: undefined,\n\t\terrorsuselocal: 1,\n\t\tformatversion: 2,\n\t\tsummary: 'summary',\n\t\tcaptchaid: undefined,\n\t\tcaptchaword: undefined\n\t},\n\tcaptcha = {\n\t\ttype: 'image',\n\t\tmime: 'image/png',\n\t\tid: '1852528679',\n\t\turl: '/w/index.php?title=Especial:Captcha/image&wpCaptchaId=1852528679'\n\t},\n\tapiReadOnlyResponse = {\n\t\terror: {\n\t\t\tcode: 'readonly',\n\t\t\tinfo: 'The wiki is currently in read-only mode.',\n\t\t\treadonlyreason: 'This wiki is currently being upgraded to a newer software version.'\n\t\t}\n\t},\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tsinon = require( 'sinon' ),\n\too = require( '../utils/oo' ),\n\tmediaWiki = require( '../utils/mw' );\n\nQUnit.module( 'MobileFrontend mobile.editor.overlay/EditorGateway', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tEditorGateway = require( '../../../src/mobile.editor.overlay/EditorGateway' );\n\t\thappyResponse = util.Deferred().resolve( {\n\t\t\tquery: {\n\t\t\t\tpages: [\n\t\t\t\t\t{\n\t\t\t\t\t\trevisions: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttimestamp: '2013-05-15T00:30:26Z',\n\t\t\t\t\t\t\t\tcontent: 'section'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t} );\n\t\tapiHappy = new mw.Api();\n\t\tapiReject = new mw.Api();\n\t\tapiRvNoSection = new mw.Api();\n\t\tapiCaptchaFail = new mw.Api();\n\t\tapiAbuseFilterDisallow = new mw.Api();\n\t\tapiAbuseFilterWarning = new mw.Api();\n\t\tapiAbuseFilterOther = new mw.Api();\n\t\tapiTestError = new mw.Api();\n\t\tapiReadOnly = new mw.Api();\n\t\tapiExpiredToken = new mw.Api();\n\t\tapiWithSectionLine = new mw.Api();\n\t\tapiHappyTestContent = new mw.Api();\n\t\tapiRejectHttp = new mw.Api();\n\t\tapiEmptySuccessResponse = new mw.Api();\n\t\tapiNoSectionLine = new mw.Api();\n\t\tsandbox.stub( apiCaptchaFail, 'postWithToken' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tresult: 'Failure',\n\t\t\t\t\tcaptcha: captcha\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tspy = sandbox.stub( apiHappy, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiReject, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiRejectHttp, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiHappyTestContent, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiEmptySuccessResponse, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiAbuseFilterDisallow, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiAbuseFilterOther, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiTestError, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiExpiredToken, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiWithSectionLine, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiReadOnly, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiAbuseFilterWarning, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiCaptchaFail, 'get' ).returns( happyResponse );\n\t\tsandbox.stub( apiRvNoSection, 'get' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\terror: {\n\t\t\t\t\tcode: 'rvnosuchsection'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tsandbox.stub( apiReject, 'postWithToken' ).returns( util.Deferred().resolve(\n\t\t\t{\n\t\t\t\terror: {\n\t\t\t\t\tcode: 'error code'\n\t\t\t\t}\n\t\t\t}\n\t\t) );\n\t\tsandbox.stub( apiRejectHttp, 'postWithToken' ).returns( util.Deferred().reject() );\n\t\tpostStub = sandbox.stub( apiHappy, 'postWithToken' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tresult: 'Success'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tsandbox.stub( apiEmptySuccessResponse, 'postWithToken' ).returns( util.Deferred().resolve( {} ) );\n\t\tsandbox.stub( apiHappyTestContent, 'post' ).returns( util.Deferred().resolve( {\n\t\t\tparse: {\n\t\t\t\ttitle: 'test',\n\t\t\t\ttext: {\n\t\t\t\t\t'*': '<h1>Heading 1</h1><h2>Heading 2</h2><p>test content</p>'\n\t\t\t\t},\n\t\t\t\tsections: {}\n\t\t\t}\n\t\t} ) );\n\t\tsandbox.stub( apiNoSectionLine, 'post' ).returns( util.Deferred().resolve( {\n\t\t\tparse: {\n\t\t\t\ttitle: 'test',\n\t\t\t\ttext: {\n\t\t\t\t\t'*': 'test content'\n\t\t\t\t},\n\t\t\t\tsections: {}\n\t\t\t}\n\t\t} ) );\n\t\tsandbox.stub( apiWithSectionLine, 'post' ).returns( util.Deferred().resolve( {\n\t\t\tparse: {\n\t\t\t\ttitle: 'test',\n\t\t\t\ttext: {\n\t\t\t\t\t'*': 'test content'\n\t\t\t\t},\n\t\t\t\tsections: {\n\t\t\t\t\t0: {\n\t\t\t\t\t\tline: 'Test section',\n\t\t\t\t\t\tanchor: 'Test_section'\n\t\t\t\t\t},\n\t\t\t\t\t1: {\n\t\t\t\t\t\tline: 'Test section2',\n\t\t\t\t\t\tanchor: 'Test_section2'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} ) );\n\t\tsandbox.stub( apiExpiredToken, 'postWithToken' )\n\t\t\t.onFirstCall().returns( util.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tresult: 'Success'\n\t\t\t\t}\n\t\t\t} ) );\n\t\tsandbox.stub( apiAbuseFilterWarning, 'postWithToken' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'abusefilter-warning-usuwanie-tekstu',\n\t\t\t\t\tinfo: 'Hit AbuseFilter: Usuwanie du\\u017cej ilo\\u015bci tekstu',\n\t\t\t\t\twarning: 'horrible desktop-formatted message',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tsandbox.stub( apiAbuseFilterDisallow, 'postWithToken' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'abusefilter-disallow',\n\t\t\t\t\tinfo: 'Scary filter',\n\t\t\t\t\twarning: 'horrible desktop-formatted message',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tsandbox.stub( apiAbuseFilterOther, 'postWithToken' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'abusefilter-something',\n\t\t\t\t\tinfo: 'Scary filter',\n\t\t\t\t\twarning: 'horrible desktop-formatted message',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tsandbox.stub( apiTestError, 'postWithToken' ).returns(\n\t\t\tutil.Deferred().resolve( {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'testerror',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t} )\n\t\t);\n\t\tsandbox.stub( apiReadOnly, 'postWithToken' ).returns( util.Deferred().reject( 'readonly', apiReadOnlyResponse ) );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getContent (no section)', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'MediaWiki:Test.css'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tassert.ok( spy.calledWith( {\n\t\t\taction: 'query',\n\t\t\tprop: [ 'revisions', 'info' ],\n\t\t\trvprop: [ 'content', 'timestamp' ],\n\t\t\ttitles: 'MediaWiki:Test.css',\n\t\t\tintestactions: 'edit',\n\t\t\tintestactionsdetail: 'full',\n\t\t\tformatversion: 2\n\t\t} ), 'rvsection not passed to api request' );\n\t} );\n} );\n\nQUnit.test( '#getContent', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function ( resp ) {\n\t\tassert.strictEqual( resp.text, 'section', 'return section content' );\n\t\tassert.strictEqual( resp.blockinfo, null );\n\t\treturn gateway.getContent();\n\t} ).then( function () {\n\t\tassert.strictEqual( spy.callCount, 1, 'cache content' );\n\t} );\n} );\n\nQUnit.test( '#getContent, new page', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'test',\n\t\tisNewPage: true\n\t} );\n\n\treturn gateway.getContent().then( function ( resp ) {\n\t\tassert.strictEqual( resp.text, '', 'return empty section' );\n\t\tassert.strictEqual( resp.blockinfo, undefined );\n\t\tassert.notOk( spy.called, 'don\\'t try to retrieve content using API' );\n\t} );\n} );\n\nQUnit.test( '#getContent, missing section', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiRvNoSection,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\tassert.rejects( gateway.getContent(), /^rvnosuchsection$/, 'return error code' );\n} );\n\nQUnit.test( '#getBlockInfo', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\t\tapi: apiHappy,\n\t\t\ttitle: 'test'\n\t\t} ),\n\t\tblockinfo = {\n\t\t\tblockedby: 'Test'\n\t\t},\n\t\tpageObj = {\n\t\t\trevisions: [\n\t\t\t\t{}\n\t\t\t],\n\t\t\tactions: {\n\t\t\t\tedit: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'blocked',\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tblockinfo: blockinfo\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\n\tassert.strictEqual( blockinfo, gateway.getBlockInfo( pageObj ) );\n} );\n\nQUnit.test( '#save, success', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\t\tassert.strictEqual( gateway.hasChanged, true, 'hasChanged is true' );\n\t\treturn gateway.save( {\n\t\t\tsummary: 'summary'\n\t\t} );\n\t} ).then( function () {\n\t\tassert.strictEqual( gateway.hasChanged, false, 'reset hasChanged' );\n\t\tassert.strictEqual( postStub.calledWithMatch( 'csrf', util.extend( {}, API_REQUEST_DATA, {\n\t\t\tsection: '1',\n\t\t\ttext: 'section 1',\n\t\t\tbasetimestamp: '2013-05-15T00:30:26Z',\n\t\t\tstarttimestamp: '2013-05-15T00:30:26Z'\n\t\t} ) ), true, 'save first section' );\n\t} );\n} );\n\nQUnit.test( '#save, new page', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'Talk:test',\n\t\tisNewPage: true\n\t} );\n\n\tgateway.getContent();\n\tgateway.setContent( 'section 0' );\n\treturn gateway.save( {\n\t\tsummary: 'summary'\n\t} ).then( function () {\n\t\tassert.strictEqual( gateway.hasChanged, false, 'reset hasChanged' );\n\t\tassert.ok( postStub.calledWithMatch( 'csrf', util.extend( {}, API_REQUEST_DATA, {\n\t\t\ttitle: 'Talk:test',\n\t\t\ttext: 'section 0',\n\t\t\tsummary: 'summary',\n\t\t\tcaptchaid: undefined,\n\t\t\tcaptchaword: undefined,\n\t\t\tbasetimestamp: undefined,\n\t\t\tstarttimestamp: undefined\n\t\t} ) ), 'save lead section' );\n\t} );\n} );\n\nQUnit.test( '#save, after #setPrependText', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'test'\n\t} );\n\n\tgateway.setPrependText( 'abc' );\n\treturn gateway.save( {\n\t\tsummary: 'summary'\n\t} ).then( function () {\n\t\tassert.strictEqual( gateway.hasChanged, false, 'reset hasChanged' );\n\t\tassert.ok( postStub.calledWithMatch( 'csrf', util.extend( {}, API_REQUEST_DATA, {\n\t\t\tprependtext: 'abc'\n\t\t} ) ), 'prepend text' );\n\t} );\n} );\n\nQUnit.test( '#save, submit CAPTCHA', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\t} ).then( function () {\n\t\treturn gateway.save( {\n\t\t\tsummary: 'summary',\n\t\t\tcaptchaId: 123,\n\t\t\tcaptchaWord: 'abc'\n\t\t} );\n\t} ).then( function () {\n\t\tassert.strictEqual( gateway.hasChanged, false, 'reset hasChanged' );\n\t\tassert.ok( postStub.calledWithMatch( 'csrf', util.extend( {}, API_REQUEST_DATA, {\n\t\t\tsection: '1',\n\t\t\ttext: 'section 1',\n\t\t\tcaptchaid: 123,\n\t\t\tcaptchaword: 'abc',\n\t\t\tbasetimestamp: '2013-05-15T00:30:26Z',\n\t\t\tstarttimestamp: '2013-05-15T00:30:26Z'\n\t\t} ) ), 'save first section' );\n\t} );\n} );\n\nQUnit.test( '#save, request failure', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiRejectHttp,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, API failure', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiReject,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {\n\t\t\t\terror: { code: 'error code' }\n\t\t\t}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, CAPTCHA response with image URL', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiCaptchaFail,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {\n\t\t\t\tedit: {\n\t\t\t\t\tresult: 'Failure',\n\t\t\t\t\tcaptcha: {\n\t\t\t\t\t\ttype: 'image',\n\t\t\t\t\t\tmime: 'image/png',\n\t\t\t\t\t\tid: '1852528679',\n\t\t\t\t\t\turl: '/w/index.php?title=Especial:Captcha/image&wpCaptchaId=1852528679'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, AbuseFilter warning', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiAbuseFilterWarning,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'abusefilter-warning-usuwanie-tekstu',\n\t\t\t\t\tinfo: 'Hit AbuseFilter: Usuwanie duej iloci tekstu',\n\t\t\t\t\twarning: 'horrible desktop-formatted message',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, AbuseFilter disallow', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiAbuseFilterDisallow,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'abusefilter-disallow',\n\t\t\t\t\tinfo: 'Scary filter',\n\t\t\t\t\twarning: 'horrible desktop-formatted message',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, AbuseFilter other', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiAbuseFilterOther,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'abusefilter-something',\n\t\t\t\t\tinfo: 'Scary filter',\n\t\t\t\t\twarning: 'horrible desktop-formatted message',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, extension errors', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiTestError,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {\n\t\t\t\tedit: {\n\t\t\t\t\tcode: 'testerror',\n\t\t\t\t\tresult: 'Failure'\n\t\t\t\t}\n\t\t\t}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\nQUnit.test( '#save, read-only error', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\t\tapi: apiReadOnly,\n\t\t\ttitle: 'test',\n\t\t\tsectionId: '1'\n\t\t} ),\n\t\tresolveSpy = sandbox.spy(),\n\t\trejectSpy = sandbox.spy(),\n\t\tdone = assert.async(),\n\t\texpectedReturnValue = {\n\t\t\terror: {\n\t\t\t\tcode: 'readonly',\n\t\t\t\tinfo: 'The wiki is currently in read-only mode.',\n\t\t\t\treadonlyreason: 'This wiki is currently being upgraded to a newer software version.'\n\t\t\t}\n\t\t};\n\n\tgateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\t\treturn gateway.save();\n\t} ).then( resolveSpy, rejectSpy ).then( function () {\n\t\tassert.strictEqual( rejectSpy.calledWith( expectedReturnValue ), true );\n\t\tassert.strictEqual( resolveSpy.called, false, 'don\\'t call resolve' );\n\t\tdone();\n\t} );\n\n} );\n\nQUnit.test( '#save, unknown errors', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiEmptySuccessResponse,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\n\t\tassert.rejects( gateway.save(), function ( given ) {\n\t\t\tassert.propEqual( given, {}, 'called with correct arguments' );\n\n\t\t\treturn true;\n\t\t}, 'call fail' );\n\t} );\n} );\n\nQUnit.test( '#save, without changes', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiHappy,\n\t\ttitle: 'test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\treturn gateway.setContent( 'section' );\n\t} ).then( function () {\n\t\tassert.strictEqual( gateway.hasChanged, false, 'hasChanged is false' );\n\t\treturn gateway.save( {\n\t\t\tsummary: 'summary'\n\t\t} );\n\t} ).then( function () {\n\t\tassert.ok( apiHappy.postWithToken.calledWithMatch( 'csrf', util.extend( {}, API_REQUEST_DATA, {\n\t\t\tsection: '1',\n\t\t\ttext: 'section',\n\t\t\tbasetimestamp: '2013-05-15T00:30:26Z',\n\t\t\tstarttimestamp: '2013-05-15T00:30:26Z'\n\t\t} ) ), 'save first section' );\n\t} );\n} );\n\nQUnit.test( '#EditorGateway', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\t\tapi: apiHappyTestContent,\n\t\t\ttitle: 'Test',\n\t\t\tsectionId: '1'\n\t\t} ),\n\t\tresolveSpy = sandbox.spy();\n\n\treturn gateway.getPreview( { text: 'test content' } )\n\t\t.then( resolveSpy )\n\t\t.then( function () {\n\t\t\tassert.ok( apiHappyTestContent.post.calledWithMatch( {\n\t\t\t\ttext: 'test content'\n\t\t\t} ) );\n\t\t\tassert.ok( resolveSpy.calledWith( {\n\t\t\t\tline: '',\n\t\t\t\tid: '',\n\t\t\t\ttext: '<h1>Heading 1</h1><h2>Heading 2</h2><p>test content</p>'\n\t\t\t} ) );\n\t\t} );\n\n} );\n\nQUnit.test( '#EditorGateway, check without sectionLine', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiNoSectionLine,\n\t\ttitle: 'Test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getPreview( {\n\t\ttext: 'test content'\n\t} ).then( function ( section ) {\n\t\tassert.strictEqual( section.line, '', 'Ok, no section line returned' );\n\t} );\n} );\n\nQUnit.test( '#EditorGateway, check with sectionLine', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiWithSectionLine,\n\t\ttitle: 'Test',\n\t\tsectionId: '1'\n\t} );\n\n\treturn gateway.getPreview( {\n\t\ttext: 'test content'\n\t} ).then( function ( section ) {\n\t\tassert.strictEqual( section.line, 'Test section', 'Ok, section line returned' );\n\t\tassert.strictEqual( section.id, 'Test_section', 'Ok, section ID returned' );\n\t} );\n} );\n\nQUnit.test( '#save, when token has expired', function ( assert ) {\n\tconst gateway = new EditorGateway( {\n\t\tapi: apiExpiredToken,\n\t\ttitle: 'MediaWiki:Test.css'\n\t} );\n\n\treturn gateway.getContent().then( function () {\n\t\tgateway.setContent( 'section 1' );\n\n\t\treturn gateway.save().then( function () {\n\t\t\tassert.strictEqual( apiExpiredToken.postWithToken.callCount, 1, 'check the spy was called twice' );\n\t\t} );\n\t} );\n} );\n","let sandbox, messageStub, getContentStub, previewResolve,\n\tBlockMessageDetails,\n\tEditorGateway, SourceEditorOverlay;\nconst\n\ttestUrl = '/w/index.php?title=User:Test',\n\tjQuery = require( '../utils/jQuery' ),\n\tsinon = require( 'sinon' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\too = require( '../utils/oo' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' );\n\nQUnit.module( 'MobileFrontend mobile.editor.overlay/SourceEditorOverlay', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tsandbox.stub( mw, 'msg' ).withArgs( 'mobile-frontend-editor-continue' ).returns( 'Continue' )\n\t\t\t.withArgs( 'mobile-frontend-editor-save' ).returns( 'Save' )\n\t\t\t.withArgs( 'mobile-frontend-editor-publish' ).returns( 'Publish' );\n\n\t\tEditorGateway = require( '../../../src/mobile.editor.overlay/EditorGateway' );\n\t\tSourceEditorOverlay = require( '../../../src/mobile.editor.overlay/SourceEditorOverlay' );\n\t\tBlockMessageDetails = require( '../../../src/mobile.editor.overlay/BlockMessageDetails' );\n\n\t\t// prevent event logging requests\n\t\tsandbox.stub( SourceEditorOverlay.prototype, 'log' ).returns( util.Deferred().resolve() );\n\t\tmessageStub = sandbox.stub( BlockMessageDetails.prototype, 'initialize' );\n\t\tgetContentStub = sandbox.stub( EditorGateway.prototype, 'getContent' );\n\t\t// avoid waiting to load 'moment',\n\t\t// using `expiry: 'infinity'` below ensures we don't need it\n\t\tsandbox.stub( mw.loader, 'using' ).withArgs( 'moment' ).returns( util.Deferred().resolve() );\n\t\tsandbox.stub( mw, 'confirmCloseWindow' ).returns( {\n\t\t\trelease: function () {}\n\t\t} );\n\t\tsandbox.stub( window, 'scrollTo' );\n\t\tsandbox.stub( mw.util, 'getUrl' ).returns( '/w/index.php?title=User:Test' );\n\t\tsandbox.stub( mw.config, 'get' )\n\t\t\t.withArgs( 'wgFormattedNamespaces' ).returns( { 2: 'User' } )\n\t\t\t.withArgs( 'wgNamespaceIds' ).returns( { user: 2 } );\n\t\tsandbox.stub( mw.Title, 'makeTitle' ).returns( {\n\t\t\tgetUrl: function () {\n\t\t\t\treturn '/w/index.php?title=User:Test';\n\t\t\t}\n\t\t} );\n\t\tgetContentStub.returns( util.Deferred().resolve( {\n\t\t\ttext: 'section 0',\n\t\t\tblockinfo: null\n\t\t} ) );\n\t\tpreviewResolve = util.Deferred().resolve( { text: '\\npreviewtest' } );\n\t\tsandbox.stub( EditorGateway.prototype, 'getPreview' )\n\t\t\t.returns( previewResolve );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#initialize, blocked user', function ( assert ) {\n\tconst dBlockedContent = util.Deferred().resolve( {\n\t\t\ttext: 'section 0',\n\t\t\tblockinfo: {\n\t\t\t\tblockedby: 'Test',\n\t\t\t\tblockexpiry: 'infinity',\n\t\t\t\tblockreason: 'Testreason'\n\t\t\t}\n\t\t} ),\n\t\tdone = assert.async();\n\n\tsandbox.stub( mw.Api.prototype, 'get' ).returns(\n\t\tutil.Deferred().resolve( {\n\t\t\tparse: {\n\t\t\t\ttext: 'Testreason'\n\t\t\t}\n\t\t} )\n\t);\n\n\tnew SourceEditorOverlay( {\n\t\ttitle: 'test.css'\n\t}, dBlockedContent ).getLoadingPromise().then( () => {}, function () {\n\t\tdone();\n\t\tassert.ok(\n\t\t\tmessageStub.calledWithMatch( {\n\t\t\t\tpartial: false,\n\t\t\t\tcreator: {\n\t\t\t\t\tname: 'Test',\n\t\t\t\t\turl: testUrl\n\t\t\t\t},\n\t\t\t\texpiry: null,\n\t\t\t\tduration: null,\n\t\t\t\treason: 'Testreason'\n\t\t\t} ),\n\t\t\t'There is a drawer notice, that i am blocked from editing'\n\t\t);\n\t} );\n} );\n\nQUnit.test( '#initialize, with given page and section', function ( assert ) {\n\tconst editorOverlay = new SourceEditorOverlay( {\n\t\ttitle: 'test',\n\t\tsectionId: '0'\n\t} );\n\n\t// The gateway is initialized with the correct properties,\n\t// particularly the correct section ID.\n\tassert.strictEqual( editorOverlay.gateway.title, 'test' );\n\tassert.strictEqual( editorOverlay.gateway.isNewPage, undefined );\n\tassert.strictEqual( editorOverlay.gateway.oldId, undefined );\n\tassert.strictEqual( editorOverlay.gateway.sectionId, '0' );\n\n\treturn editorOverlay.getLoadingPromise().then( function () {\n\t\tassert.strictEqual( editorOverlay.$content.val(), 'section 0', 'load correct section' );\n\t} );\n} );\n\nQUnit.test( '#initialize, without a section', function ( assert ) {\n\tconst editorOverlay = new SourceEditorOverlay( {\n\t\ttitle: 'test.css'\n\t} );\n\n\treturn getContentStub().then( function () {\n\t\tassert.strictEqual( editorOverlay.gateway.title, 'test.css' );\n\t\tassert.strictEqual( editorOverlay.gateway.isNewPage, undefined );\n\t\tassert.strictEqual( editorOverlay.gateway.oldId, undefined );\n\t\tassert.strictEqual( editorOverlay.gateway.sectionId, undefined );\n\t} );\n} );\n\nQUnit.test( '#preview', function ( assert ) {\n\tconst editorOverlay = new SourceEditorOverlay( {\n\t\ttitle: 'test',\n\t\tsectionId: '0'\n\t} );\n\n\teditorOverlay.onStageChanges();\n\n\treturn previewResolve.then( function () {\n\t\tassert.strictEqual( editorOverlay.$preview.text(), '\\n\\npreviewtest', 'preview loaded correctly' );\n\t} );\n} );\n\nQUnit.test( '#initialize, as anonymous', function ( assert ) {\n\tconst editorOverlay = new SourceEditorOverlay( {\n\t\ttitle: 'Main_page',\n\t\tisAnon: true\n\t} );\n\n\t// SourceEditorOverlay triggers a call to _loadContent so will always start an async request.\n\t// Make this test async to ensure it finishes and doesn't cause side effects to other functions.\n\treturn getContentStub().then( function () {\n\t\tassert.ok( editorOverlay.$anonWarning.length > 0, 'Editorwarning (IP will be saved) visible.' );\n\t\tassert.ok( editorOverlay.$el.find( '.anonymous' ).length > 0, 'Continue login has a second class.' );\n\t} );\n} );\n","/* global $ */\nconst\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tsinon = require( 'sinon' );\nlet\n\tsandbox,\n\tidentifyLeadParagraph;\n\nQUnit.module( 'MobileFrontend mobile.editor.overlay/identifyLeadParagraph', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tidentifyLeadParagraph = require( '../../../src/mobile.editor.overlay/identifyLeadParagraph' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\n// Keep in sync with MoveLeadParagraphTransformTest::provideTransform()\nfunction provideCases() {\n\tconst\n\t\tinfobox = '<table class=\"infobox\">1</table>',\n\t\tcoordinates = '<span id=\"coordinates\"><span>0;0</span></span>',\n\t\tanotherInfobox = '<table class=\"infobox\">2</table>',\n\t\tstackInfobox = `<div class=\"mw-stack\">${infobox}</div>`,\n\t\temptyStack = '<div class=\"mw-stack\">Empty</div>',\n\t\tmultiStackInfobox = `<div class=\"mw-stack\">${infobox}${anotherInfobox}</div>`,\n\t\tparagraph = '<p><b>First paragraph</b> <span> with info that links to a ' +\n\t\t\t'\\n <a href=\"\">Page</a></span> and some more content</p>',\n\t\temptyP = '<p></p>',\n\t\t// The paragraphWithWhitespacesOnly has not only whitespaces (space,new line,tab)\n\t\t// , but also contains a span with whitespaces\n\t\tparagraphWithWhitespacesOnly = '<p class=\"someParagraphClass\">  \\t' +\n\t\t\t'\\n<span> \\t\\r\\n</span></p>',\n\t\tcollapsibleInfobox = '<table class=\"collapsible\"><table class=\"infobox\"></table></table>',\n\t\tcollapsibleNotInfobox = '<table class=\"collapsible\">' +\n\t\t\t'<table class=\"mf-test-infobox\"></table></table>';\n\n\treturn [\n\t\t[\n\t\t\t`${collapsibleNotInfobox}<p>one</p>`,\n\t\t\t'p',\n\t\t\t'Collapsible mf-infoboxes are not moved.'\n\t\t],\n\t\t[\n\t\t\t`${collapsibleInfobox}<p>one</p>`,\n\t\t\t'p',\n\t\t\t'Collapsible infoboxes are moved.'\n\t\t],\n\t\t[\n\t\t\t'<div><table class=\"mf-infobox\"></table></div><p>one</p>',\n\t\t\t'p'\n\t\t],\n\t\t[\n\t\t\t`${infobox}${paragraph}`,\n\t\t\t'p'\n\t\t],\n\t\t[\n\t\t\t`${emptyP}${emptyP}${infobox}${paragraph}`,\n\t\t\t'p:last-of-type',\n\t\t\t'Empty paragraphs are ignored'\n\t\t],\n\t\t[\n\t\t\t`${paragraphWithWhitespacesOnly}${infobox}${paragraph}`,\n\t\t\t'p:last-of-type',\n\t\t\t'T199282: lead paragraph should move when there is empty paragraph before infobox'\n\t\t],\n\t\t[\n\t\t\t`${infobox}${paragraphWithWhitespacesOnly}`,\n\t\t\tnull,\n\t\t\t'T199282: the empty paragraph should not be treated as lead paragraph'\n\t\t],\n\t\t[\n\t\t\t`${paragraph}${emptyP}${infobox}${paragraph}`,\n\t\t\t'p:first-of-type',\n\t\t\t'T188825: Infobox has to be first non-empty element'\n\t\t],\n\t\t[\n\t\t\t`${stackInfobox}${paragraph}`,\n\t\t\t'p',\n\t\t\t'T170006: If the infobox is wrapped in a known container it can be moved'\n\t\t],\n\t\t[\n\t\t\t`${emptyStack}${paragraph}`,\n\t\t\t'p',\n\t\t\t'T170006: However if no infobox inside don\\'t move.'\n\t\t],\n\t\t[\n\t\t\t`${infobox}${emptyStack}${paragraph}`,\n\t\t\t'p',\n\t\t\t'T170006: When a stack and an infobox, ignore mw-stack'\n\t\t],\n\t\t[\n\t\t\t`${multiStackInfobox}${paragraph}`,\n\t\t\t'p',\n\t\t\t'T170006: Multiple infoboxes will also be moved'\n\t\t],\n\t\t[\n\t\t\t`${infobox}<p>${coordinates}</p><p>First paragraph</p>`,\n\t\t\t'p:last-of-type',\n\t\t\t'Paragraph with just coordinates in it is ignored'\n\t\t],\n\t\t[\n\t\t\t`${infobox}<p>First paragraph with ${coordinates}</p><p>Second paragraph</p>`,\n\t\t\t'p:first-of-type',\n\t\t\t'Paragraph with coordinates in it is still the first paragraph'\n\t\t],\n\t\t[\n\t\t\t`${infobox}<p><span>foo</span>${coordinates}</p><p>Second paragraph</p>`,\n\t\t\t'p:first-of-type',\n\t\t\t'Paragraph with non-empty nested child and coordinates in it is still the first paragraph'\n\t\t],\n\t\t[\n\t\t\t`${infobox}<p>Lead <span>${coordinates}</span> para</p><p>Not lead</p>`,\n\t\t\t'p:first-of-type',\n\t\t\t'Paragraph with nested coordinates is still the first paragraph'\n\t\t]\n\t];\n}\n\nQUnit.test( 'identifyLeadParagraph', function ( assert ) {\n\tconst cases = provideCases();\n\n\tfor ( let i = 0; i < cases.length; i++ ) {\n\t\tconst [ html, expectedSel, message ] = cases[i];\n\t\tconst $dom = $( '<section>' ).html( html );\n\t\tconst expectedNode = expectedSel ? $dom.find( expectedSel )[0] : null;\n\n\t\tassert.strictEqual(\n\t\t\texpectedNode,\n\t\t\tidentifyLeadParagraph( $dom ),\n\t\t\tmessage\n\t\t);\n\t}\n} );\n","let\n\tsandbox,\n\tblockInfo,\n\tblockinfo,\n\tParseBlockInfo;\n\nconst\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tmw = require( '../utils/mw' );\n\nQUnit.module( 'MobileFrontend mobile.editor.overlay/parseBlockInfo', {\n\tbeforeEach: function () {\n\t\tconst moment = function ( expiry ) {\n\t\t\treturn {\n\t\t\t\tto: ( arg ) => arg,\n\t\t\t\tformat: ( str ) => str === 'LL' ? '30 June 2020, 12:00 AM' :\n\t\t\t\t\t'3 September 2020',\n\t\t\t\tdiff: () => expiry === '2020-06-30' ? 86900 : 4\n\t\t\t};\n\t\t};\n\t\tsandbox = sinon.sandbox.create();\n\t\tmw.setUp( sandbox, global );\n\t\tdom.setUp( sandbox, global );\n\t\tglobal.window.moment = moment;\n\n\t\tsandbox.stub( global.mw, 'message' ).callsFake(\n\t\t\t( arg, value ) => {\n\t\t\t\treturn {\n\t\t\t\t\tescaped: () => `(${arg}: ${value})`\n\t\t\t\t};\n\t\t\t}\n\t\t);\n\t\tParseBlockInfo = require( '../../../src/mobile.editor.overlay/parseBlockInfo' );\n\t\tblockinfo = {\n\t\t\tblockid: 123,\n\t\t\tblockedbyid: 0\n\t\t};\n\t},\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'blockInfo', function ( assert ) {\n\tblockinfo.blockexpiry = '2020-06-30';\n\tblockInfo = new ParseBlockInfo( blockinfo );\n\n\tassert.strictEqual(\n\t\tblockInfo.expiry,\n\t\t'(parentheses: 30 June 2020, 12:00 AM)',\n\t\t'Short blocks should have date and time in expiry message'\n\t);\n} );\n\nQUnit.test( 'blockInfo2', function ( assert ) {\n\tblockinfo.blockexpiry = '2020-09-03';\n\tblockInfo = new ParseBlockInfo( blockinfo );\n\n\tassert.strictEqual(\n\t\tblockInfo.expiry,\n\t\t'(parentheses: 3 September 2020)',\n\t\t'Long blocks should have only date in expiry message'\n\t);\n\n} );\n","const\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' );\nlet\n\teditorLoadingOverlay, OverlayManager,\n\tsandbox, fakeRouter, overlayManager;\n\nQUnit.module( 'MobileFrontend editorLoadingOverlay.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// window.scrollTo\n\t\tsandbox.stub( global.window, 'scrollTo' );\n\n\t\t// These must be loaded here and not earlier because they depend on the globals we fake\n\t\teditorLoadingOverlay = require( '../../../src/mobile.init/editorLoadingOverlay' );\n\t\tOverlayManager = require( '../../../src/mobile.startup/OverlayManager' );\n\n\t\tfakeRouter = new OO.EventEmitter();\n\t\tfakeRouter.getPath = sandbox.stub().returns( '' );\n\t\tfakeRouter.back = sandbox.spy();\n\t\tsandbox.stub( mw.loader, 'require' ).withArgs( 'mediawiki.router' ).returns( fakeRouter );\n\t\toverlayManager = new OverlayManager( fakeRouter, document.body );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'editorLoadingOverlay calls the callbacks', function ( assert ) {\n\tconst\n\t\tafterShow = sandbox.spy(),\n\t\tafterHide = sandbox.spy(),\n\t\toverlay = editorLoadingOverlay( afterShow, afterHide );\n\n\toverlayManager.add( /^test$/, function () {\n\t\treturn overlay;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test'\n\t} );\n\n\tassert.strictEqual( afterShow.callCount, 1, 'afterShow called' );\n\tassert.strictEqual( afterHide.callCount, 0, 'afterHide not called yet' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: ''\n\t} );\n\n\tassert.strictEqual( afterShow.callCount, 1, 'afterShow called only once' );\n\tassert.strictEqual( afterHide.callCount, 1, 'afterHide called' );\n} );\n","let\n\tLanguageSearcher,\n\tsandbox;\nconst\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tapiLanguages = [\n\t\t{\n\t\t\tlang: 'ar',\n\t\t\turl: 'https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7',\n\t\t\ttitle: ' ',\n\t\t\tautonym: ''\n\t\t}, {\n\t\t\tlang: 'be',\n\t\t\turl: 'https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\ttitle: ' ',\n\t\t\tautonym: ''\n\t\t}, {\n\t\t\tlang: 'be-x-old',\n\t\t\turl: 'https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\ttitle: ' ',\n\t\t\tautonym: ' ()'\n\t\t}, {\n\t\t\tlang: 'ko',\n\t\t\turl: 'https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88',\n\t\t\ttitle: ' ',\n\t\t\tautonym: ''\n\t\t}, {\n\t\t\tlang: 'ru',\n\t\t\turl: 'https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA',\n\t\t\ttitle: ', ',\n\t\t\tautonym: ''\n\t\t}, {\n\t\t\tlang: 'uz',\n\t\t\turl: 'https://uz.wikipedia.org/wiki/Barak_Obama',\n\t\t\ttitle: 'Barak Obama',\n\t\t\tautonym: 'ozbekcha/'\n\t\t}, {\n\t\t\tlang: 'zh',\n\t\t\turl: 'https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC',\n\t\t\ttitle: '',\n\t\t\tautonym: ''\n\t\t}, {\n\t\t\tlang: 'zh-min-nan',\n\t\t\turl: 'https://zh-min-nan.wikipedia.org/wiki/Barack_Obama',\n\t\t\ttitle: 'Barack Obama',\n\t\t\tlangname: 'Chinese',\n\t\t\tautonym: 'Bn-lm-g'\n\t\t}, {\n\t\t\tlang: 'zh-yue',\n\t\t\turl: 'https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC',\n\t\t\ttitle: '',\n\t\t\tautonym: ''\n\t\t}, {\n\t\t\tlang: 'zu',\n\t\t\turl: 'https://zu.wikipedia.org/wiki/Barack_Obama',\n\t\t\ttitle: 'Barack Obama',\n\t\t\tautonym: 'isiZulu'\n\t\t}\n\t],\n\tdeviceLanguage = 'en-us',\n\tvariants = [\n\t\t{\n\t\t\tlang: 'foo',\n\t\t\turl: '/w/index.php?title=Barack_Obama&variant=foo',\n\t\t\tautonym: 'Foo'\n\t\t},\n\t\t{\n\t\t\tlang: 'foo-x-piglatin',\n\t\t\turl: '/w/index.php?title=Barack_Obama&variant=foo-x-piglatin',\n\t\t\tautonym: 'Igpay Atinlay'\n\t\t}\n\t],\n\tfrequentlyUsedLanguages = {\n\t\t'zh-min-nan': 1,\n\t\tzh: 2,\n\t\ten: 10,\n\t\tko: 1\n\t};\n\nfunction enterText( searcher, text ) {\n\tsearcher.$el.find( 'input[type=search]' ).val( text ).trigger( 'input' );\n}\n\nQUnit.module( 'MobileFrontend LanguageSearcher.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tLanguageSearcher = require( '../../../src/mobile.languages.structured/LanguageSearcher' );\n\n\t\tsandbox.stub( mw.storage, 'get' ).withArgs( 'langMap' )\n\t\t\t.returns( JSON.stringify( frequentlyUsedLanguages ) );\n\n\t\tthis.languageSearcher = new LanguageSearcher( {\n\t\t\tlanguages: apiLanguages,\n\t\t\tvariants: variants,\n\t\t\tshowSuggestedLanguages: true,\n\t\t\tdeviceLanguage: deviceLanguage\n\t\t} );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'renders output', function ( assert ) {\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list.suggested-languages a' ).length,\n\t\t5,\n\t\t'There are 5 suggested languages including variants.'\n\t);\n\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list.all-languages a' ).length,\n\t\t7,\n\t\t'Seven languages are non-suggested.'\n\t);\n} );\n\nQUnit.test( 'saves the language count when link is clicked', function ( assert ) {\n\tconst stub = sandbox.stub( mw.storage, 'set' );\n\n\tthis.languageSearcher.$el.find( '[lang=foo-x-piglatin]' ).trigger( 'click' );\n\n\tassert.strictEqual( stub.callCount, 1, 'mw.storage.set is called once' );\n\tassert.deepEqual(\n\t\tstub.getCall( 0 ).args,\n\t\t[ 'langMap', '{\"zh-min-nan\":1,\"zh\":2,\"en\":10,\"ko\":1,\"foo-x-piglatin\":1}' ],\n\t\t'mw.storage.set is called with correct args'\n\t);\n} );\n\nQUnit.test( 'without variants, input event filters languages', function ( assert ) {\n\tconst languageSearcher = new LanguageSearcher( {\n\t\tlanguages: apiLanguages,\n\t\tvariants: false,\n\t\tshowSuggestedLanguages: true,\n\t\tdeviceLanguage: deviceLanguage\n\t} );\n\n\tenterText( languageSearcher, '' );\n\tassert.strictEqual(\n\t\tlanguageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t10,\n\t\t'The search filter has been cleared. All 10 languages (including variants) are visible.'\n\t);\n\n\tenterText( languageSearcher, 'abcdefghij' );\n\tassert.strictEqual(\n\t\tlanguageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t0,\n\t\t'No languages match \"abcdefghij\"'\n\t);\n\n\tenterText( languageSearcher, 'chin' );\n\tassert.ok(\n\t\tlanguageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length === 1 &&\n\t\tlanguageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).hasClass( 'zh-min-nan' ),\n\t\t'One language (zh-min-nan) matches \"Chin\" (langname) and only that language is visible.'\n\t);\n} );\n\nQUnit.test( 'with variants, input event filters languages', function ( assert ) {\n\tenterText( this.languageSearcher, '' );\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t12,\n\t\t'The search filter has been cleared. All 12 languages (including variants) are visible.'\n\t);\n\n\tenterText( this.languageSearcher, 'abcdefghij' );\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t0,\n\t\t'No languages match \"abcdefghij\"'\n\t);\n\n\tenterText( this.languageSearcher, 'zh' );\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t3,\n\t\t'Three languages match \"zh\" and only those languages are visible.'\n\t);\n\n\tenterText( this.languageSearcher, 'ol' );\n\tassert.ok(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length === 1 &&\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).hasClass( 'be-x-old' ),\n\t\t'One language (be-x-old) matches \"ol\" and only that language is visible.'\n\t);\n\n\tenterText( this.languageSearcher, 'chin' );\n\tassert.ok(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length === 1 &&\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).hasClass( 'zh-min-nan' ),\n\t\t'One language (zh-min-nan) matches \"Chin\" (langname) and only that language is visible.'\n\t);\n\n\tenterText( this.languageSearcher, '' );\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t1,\n\t\t'One language matches \"\" and only that language is visible.'\n\t);\n\n\tenterText( this.languageSearcher, 'foo' );\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t2,\n\t\t'Two languages match \"foo\" and only those languages are visible.'\n\t);\n\n\tenterText( this.languageSearcher, 'igpay' );\n\tassert.strictEqual(\n\t\tthis.languageSearcher.$el.find( '.site-link-list a:not(.hidden)' ).length,\n\t\t1,\n\t\t'One language matches \"igpay\" and only that language is visible.'\n\t);\n} );\n","const\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tsinon = require( 'sinon' );\nlet\n\tutil,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend mobile.languages.structured/util.test.js', {\n\tbeforeEach: function () {\n\t\tthis.apiLanguages = [\n\t\t\t{\n\t\t\t\tlang: 'ar',\n\t\t\t\turl: 'https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7',\n\t\t\t\ttitle: ' ',\n\t\t\t\tdir: 'rtl',\n\t\t\t\tautonym: ''\n\t\t\t}, {\n\t\t\t\tlang: 'be',\n\t\t\t\turl: 'https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\t\ttitle: ' ',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: ''\n\t\t\t}, {\n\t\t\t\tlang: 'be-x-old',\n\t\t\t\turl: 'https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0',\n\t\t\t\ttitle: ' ',\n\t\t\t\tautonym: ' ()'\n\t\t\t}, {\n\t\t\t\tlang: 'es',\n\t\t\t\turl: 'https://en.wikipedia.org/wiki/Barack_Obama',\n\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'Spanish'\n\t\t\t}, {\n\t\t\t\tlang: 'ko',\n\t\t\t\turl: 'https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88',\n\t\t\t\ttitle: ' ',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: ''\n\t\t\t}, {\n\t\t\t\tlang: 'ru',\n\t\t\t\turl: 'https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA',\n\t\t\t\ttitle: ', ',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: ''\n\t\t\t}, {\n\t\t\t\tlang: 'uz',\n\t\t\t\turl: 'https://uz.wikipedia.org/wiki/Barak_Obama',\n\t\t\t\ttitle: 'Barak Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'ozbekcha/'\n\t\t\t}, {\n\t\t\t\tlang: 'zh',\n\t\t\t\turl: 'https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC',\n\t\t\t\ttitle: '',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: ''\n\t\t\t}, {\n\t\t\t\tlang: 'zh-min-nan',\n\t\t\t\turl: 'https://zh-min-nan.wikipedia.org/wiki/Barack_Obama',\n\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'Bn-lm-g'\n\t\t\t}, {\n\t\t\t\tlang: 'zh-yue',\n\t\t\t\turl: 'https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC',\n\t\t\t\ttitle: '',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: ''\n\t\t\t}, {\n\t\t\t\tlang: 'zu',\n\t\t\t\turl: 'https://zu.wikipedia.org/wiki/Barack_Obama',\n\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\tdir: 'ltr',\n\t\t\t\tautonym: 'isiZulu'\n\t\t\t}\n\t\t];\n\t\tthis.apiVariants = [ {\n\t\t\tautonym: '',\n\t\t\tlang: 'zh',\n\t\t\turl: '/~bmansurov/mediawiki/index.php/3?variant=zh'\n\t\t}, {\n\t\t\tautonym: '',\n\t\t\tlang: 'zh-hans',\n\t\t\turl: '/~bmansurov/mediawiki/index.php/3?variant=zh-hans'\n\t\t} ];\n\n\t\tthis.deviceLanguage = 'en-us';\n\n\t\tthis.frequentlyUsedLanguages = {\n\t\t\tzh: 2,\n\t\t\tko: 1\n\t\t};\n\n\t\tthis.structuredLanguages = {\n\t\t\tall: [\n\t\t\t\t{\n\t\t\t\t\tlang: 'zh-min-nan',\n\t\t\t\t\tautonym: 'Bn-lm-g',\n\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zh-min-nan.wikipedia.org/wiki/Barack_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'zu',\n\t\t\t\t\tautonym: 'isiZulu',\n\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zu.wikipedia.org/wiki/Barack_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'uz',\n\t\t\t\t\tautonym: 'ozbekcha/',\n\t\t\t\t\ttitle: 'Barak Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://uz.wikipedia.org/wiki/Barak_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'es',\n\t\t\t\t\tautonym: 'Spanish',\n\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://en.wikipedia.org/wiki/Barack_Obama'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'be',\n\t\t\t\t\tautonym: '',\n\t\t\t\t\ttitle: ' ',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'be-x-old',\n\t\t\t\t\tautonym: ' ()',\n\t\t\t\t\ttitle: ' ',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'ru',\n\t\t\t\t\tautonym: '',\n\t\t\t\t\ttitle: ', ',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'ar',\n\t\t\t\t\tautonym: '',\n\t\t\t\t\ttitle: ' ',\n\t\t\t\t\tdir: 'rtl',\n\t\t\t\t\turl: 'https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'zh-yue',\n\t\t\t\t\tautonym: '',\n\t\t\t\t\ttitle: '',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC'\n\t\t\t\t}\n\t\t\t],\n\t\t\tsuggested: [\n\t\t\t\t{\n\t\t\t\t\tfrequency: 2,\n\t\t\t\t\tlang: 'zh',\n\t\t\t\t\tautonym: '',\n\t\t\t\t\ttitle: '',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfrequency: 1,\n\t\t\t\t\tlang: 'ko',\n\t\t\t\t\tautonym: '',\n\t\t\t\t\ttitle: ' ',\n\t\t\t\t\tdir: 'ltr',\n\t\t\t\t\turl: 'https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88'\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tsandbox.stub( mw.storage, 'get' ).withArgs( 'langMap' )\n\t\t\t.returns( JSON.stringify( this.frequentlyUsedLanguages ) );\n\n\t\tutil = require( '../../../src/mobile.languages.structured/util' );\n\n\t\tthis.saveSpy = sandbox.stub( util, 'saveFrequentlyUsedLanguages' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getFrequentlyUsedLanguages', function ( assert ) {\n\n\tassert.propEqual( util.getFrequentlyUsedLanguages(), this.frequentlyUsedLanguages,\n\t\t'Frequently used languages is correct.' );\n} );\n\nQUnit.test( '#saveLanguageUsageCount', function ( assert ) {\n\tutil.saveLanguageUsageCount( 'ko', util.getFrequentlyUsedLanguages() );\n\tassert.ok( this.saveSpy.calledWith( {\n\t\tzh: 2,\n\t\tko: 2\n\t} ), 'Frequently used language is correctly saved.' );\n} );\n\nQUnit.test( '#getStructuredLanguages', function ( assert ) {\n\tconst result = util.getStructuredLanguages(\n\t\tthis.apiLanguages, false, this.frequentlyUsedLanguages, true, this.deviceLanguage\n\t);\n\n\tassert.propEqual(\n\t\tresult,\n\t\tthis.structuredLanguages,\n\t\t'Structured languages are correct, including sort order.'\n\t);\n} );\n\nQUnit.test( '#getStructuredLanguages device language', function ( assert ) {\n\tconst result =\n\t\tutil.getStructuredLanguages( this.apiLanguages, false, {}, true, 'es-lx' ).suggested[0].lang;\n\n\t// device language is a variant and only the parent language is available\n\tassert.strictEqual(\n\t\tresult,\n\t\t'es',\n\t\t'\"es\" is correctly selected as a suggested language even though the device language is \"es-lx\".'\n\t);\n} );\n\nQUnit.test( '#getStructuredLanguages variants', function ( assert ) {\n\tconst variantsMap = {};\n\n\tconst suggestedLanguages = util.getStructuredLanguages(\n\t\tthis.apiLanguages, this.apiVariants, {}, true, this.deviceLanguage\n\t).suggested;\n\tthis.apiVariants.forEach( function ( variant ) {\n\t\tvariantsMap[ variant.lang ] = variant;\n\t} );\n\tsuggestedLanguages.forEach( function ( suggestedLanguage ) {\n\t\tassert.ok(\n\t\t\tObject.prototype.hasOwnProperty.call( variantsMap, suggestedLanguage.lang ),\n\t\t\t'Variant \"' + suggestedLanguage.lang + '\" is in the list of suggested languages.'\n\t\t);\n\t} );\n} );\n","let sandbox, ImageOverlay;\nconst\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tmustache = require( '../utils/mustache' );\n\nQUnit.module( 'MobileFrontend mobile.mediaViewer/ImageCarousel.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tImageOverlay = require( '../../../src/mobile.mediaViewer/ImageCarousel' );\n\n\t\tthis.image = {\n\t\t\tdescriptionurl: 'https://commons.wikimedia.org/wiki/File:The_Montgomery,_San_Francisco.jpg',\n\t\t\tthumbheight: 1024,\n\t\t\tthumburl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/676px-The_Montgomery%2C_San_Francisco.jpg',\n\t\t\tthumbwidth: 676,\n\t\t\turl: 'https://upload.wikimedia.org/wikipedia/commons/b/b1/The_Montgomery%2C_San_Francisco.jpg'\n\t\t};\n\t\tthis.imageGateway = {\n\t\t\tgetThumb: function () {\n\t\t\t\treturn util.Deferred().resolve( {\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tpages: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\timageinfo: [ this.image ]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t};\n\t\tthis.router = {\n\t\t\tgetPath: function () {\n\t\t\t\treturn '/media/File%3AA_cursiva.gif';\n\t\t\t}\n\t\t};\n\t\tthis.thumbnails = [\n\t\t\t{\n\t\t\t\tfilename: 'foo',\n\t\t\t\tgetFileName: function () { return ''; },\n\t\t\t\tgetPath: function () { return ''; },\n\t\t\t\tgetDescription: function () { return ''; }\n\t\t\t},\n\t\t\t{\n\t\t\t\tfilename: 'bar',\n\t\t\t\tgetFileName: function () { return ''; },\n\t\t\t\tgetPath: function () { return ''; },\n\t\t\t\tgetDescription: function () { return ''; }\n\t\t\t}\n\t\t];\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Shows details bar and image with successful api response', function ( assert ) {\n\tconst overlay = new ImageOverlay( {\n\t\tgateway: this.imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn this.imageGateway.getThumb().then( function () {\n\t\tassert.strictEqual( overlay.$el.find( 'img' ).length, 1, 'Image is present.' );\n\t\tassert.strictEqual( overlay.$el.find( '.load-fail-msg' ).length, 0, 'Load error msg is not visible' );\n\t\tassert.strictEqual( overlay.$el.find( '.image-details.is-visible' ).length, 1, 'Details bar present' );\n\t} );\n} );\n\nQUnit.test( 'Shows error message with failed api response', function ( assert ) {\n\tconst imageGateway = {\n\t\tgetThumb: function () {\n\t\t\treturn util.Deferred().reject( 'Load Error' );\n\t\t}\n\t};\n\n\tconst overlay = new ImageOverlay( {\n\t\tgateway: imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn imageGateway.getThumb().catch( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.load-fail-msg' ).length, 1, 'Load error msg is visible' );\n\t\tassert.strictEqual( overlay.$el.find( '.image-details.is-visible' ).length, 0, 'Details bar is hidden' );\n\t} );\n} );\n\nQUnit.test( 'Toggling of details is disabled when overlay has load failure', function ( assert ) {\n\tconst imageGateway = {\n\t\tgetThumb: function () {\n\t\t\treturn util.Deferred().reject( 'Load Error' );\n\t\t}\n\t};\n\n\tconst overlay = new ImageOverlay( {\n\t\tgateway: imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\tthumbnails: this.thumbnails,\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn imageGateway.getThumb().catch( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.image-details.is-visible' ).length, 0, 'Details bar is hidden' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.image-details' ), 'none', 'Slider buttons are shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.prev' ), 'none', 'Slider buttons are still shown' );\n\n\t\toverlay.$el.find( '.image-wrapper' ).trigger( 'click' );\n\n\t\t// Assert that toggle didn't occur (would add display: none)\n\t\tassert.notStrictEqual( overlay.$el.find( '.image-details' ), 'none', 'Slider buttons are shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.prev' ), 'none', 'Slider buttons are still shown' );\n\t} );\n} );\n\nQUnit.test( 'Toggling of details is enabled when overlay loads successfully', function ( assert ) {\n\tconst overlay = new ImageOverlay( {\n\t\tgateway: this.imageGateway,\n\t\ttitle: decodeURIComponent( this.image.url ),\n\t\tcaption: 'The Montgomery in 2012.',\n\t\tthumbnails: this.thumbnails,\n\t\trouter: this.router,\n\t\teventBus: {\n\t\t\ton: function () {}\n\t\t}\n\t} );\n\n\treturn this.imageGateway.getThumb().then( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.image-details.is-visible' ).length, 1, 'Details bar is shown' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.image-details' ).css( 'display' ), 'none', 'Ensure display none rule is not set' );\n\t\tassert.notStrictEqual( overlay.$el.find( '.prev' ).css( 'display' ), 'none', 'Slider buttons are shown' );\n\n\t\toverlay.$el.find( '.image-wrapper' ).trigger( 'click' );\n\n\t\tassert.strictEqual( overlay.$el.find( '.image-details' ).css( 'display' ), 'none', 'Details bar is hidden' );\n\t\tassert.strictEqual( overlay.$el.find( '.slider-button' ).css( 'display' ), 'none', 'Slider buttons are hidden' );\n\t} );\n} );\n","let sandbox, ImageGateway, findSizeBucket;\nconst\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tutil = require( '../../../src/mobile.startup/util' );\n\nQUnit.module( 'MobileFrontend mobile.mediaViewer/ImageGateway', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tImageGateway = require( '../../../src/mobile.mediaViewer/ImageGateway' );\n\t\tfindSizeBucket = ImageGateway._findSizeBucket;\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#findSizeBucket', function ( assert ) {\n\tassert.strictEqual( findSizeBucket( 300 ), 320, 'value lower than bucket' );\n\tassert.strictEqual( findSizeBucket( 800 ), 800, 'exact value' );\n\tassert.strictEqual( findSizeBucket( 9999 ), 2880, 'value greater than last bucket' );\n} );\n\nQUnit.test( 'ImageGateway#getThumb (missing page)', function ( assert ) {\n\tconst api = {\n\t\t\tget: function () {\n\t\t\t\treturn util.Deferred().resolve( {\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tpages: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttitle: 'Hello',\n\t\t\t\t\t\t\t\tmissing: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t}\n\t\t},\n\t\tgateway = new ImageGateway( { api: api } );\n\tassert.rejects(\n\t\tgateway.getThumb( 'Missing' ),\n\t\tfunction ( err ) {\n\t\t\treturn err.message.indexOf( 'The API failed' ) !== -1;\n\t\t},\n\t\t'A missing page throws an error which the client must handle'\n\t);\n} );\n","let\n\tsandbox,\n\tNearbyGateway,\n\tutil;\nconst\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend NearbyGateway.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\t// needed for extendSearchParams to not throw exception about feature not\n\t\t// supporting wikibase descriptions in headless tests\n\t\tsandbox.stub( mw.config, 'get' )\n\t\t\t.withArgs( 'wgArticlePath' ).returns( '/w/' )\n\t\t\t.withArgs( 'wgMFDisplayWikibaseDescriptions' )\n\t\t\t.returns( {\n\t\t\t\tnearby: true\n\t\t\t} )\n\t\t\t// needed bc Page.js expects this call to return an array\n\t\t\t.withArgs( 'wgMFMobileFormatterHeadings', [ 'h1', 'h2', 'h3', 'h4', 'h5' ] )\n\t\t\t.returns( [ 'h1', 'h2', 'h3', 'h4', 'h5' ] );\n\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\t\tNearbyGateway = require( '../../../src/mobile.special.nearby.scripts/NearbyGateway' );\n\n\t\tconst api = {\n\t\t\tajax: function () {}\n\t\t};\n\n\t\tsandbox.stub( mw, 'msg' ).returns( '$1' );\n\n\t\tthis.nearbyGateway = new NearbyGateway( { api: api } );\n\n\t\t// stub mw.language behavior so we don't have to bring in the real thing\n\t\tsandbox.stub( mw.language, 'convertNumber' ).callsFake( function ( arg ) {\n\t\t\treturn arg === '1.20' ? '1.2' : String( arg );\n\t\t} );\n\n\t\tsandbox.stub( api, 'ajax' ).callsFake( function () {\n\t\t\treturn util.Deferred().resolve( {\n\t\t\t\tquery: {\n\t\t\t\t\tpages: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageid: 20004112,\n\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\ttitle: 'The Montgomery (San Francisco)',\n\t\t\t\t\t\t\tthumbnail: {\n\t\t\t\t\t\t\t\tsource: 'https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/119px-The_Montgomery%2C_San_Francisco.jpg',\n\t\t\t\t\t\t\t\twidth: 119,\n\t\t\t\t\t\t\t\theight: 180\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpageimage: 'The_Montgomery,_San_Francisco.jpg',\n\t\t\t\t\t\t\tcoordinates: [ {\n\t\t\t\t\t\t\t\tlat: 37.787,\n\t\t\t\t\t\t\t\tlon: -122.41,\n\t\t\t\t\t\t\t\tprimary: '',\n\t\t\t\t\t\t\t\tglobe: 'earth',\n\t\t\t\t\t\t\t\tdist: 120200\n\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageid: 18618509,\n\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\ttitle: 'Wikimedia Foundation',\n\t\t\t\t\t\t\tthumbnail: {\n\t\t\t\t\t\t\t\tsource: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Wikimedia_Foundation_RGB_logo_with_text.svg/180px-Wikimedia_Foundation_RGB_logo_with_text.svg.png',\n\t\t\t\t\t\t\t\twidth: 180,\n\t\t\t\t\t\t\t\theight: 180\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tpageimage: 'Wikimedia_Foundation_RGB_logo_with_text.svg',\n\t\t\t\t\t\t\tcoordinates: [ {\n\t\t\t\t\t\t\t\tlat: 37.787,\n\t\t\t\t\t\t\t\tlon: -122.51,\n\t\t\t\t\t\t\t\tprimary: '',\n\t\t\t\t\t\t\t\tglobe: 'earth',\n\t\t\t\t\t\t\t\tdist: 0\n\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tpageid: 9297443,\n\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\ttitle: 'W San Francisco',\n\t\t\t\t\t\t\tcoordinates: [ {\n\t\t\t\t\t\t\t\tlat: 37.7854,\n\t\t\t\t\t\t\t\tlon: -122.61,\n\t\t\t\t\t\t\t\tprimary: '',\n\t\t\t\t\t\t\t\tglobe: 'earth',\n\t\t\t\t\t\t\t\tdist: 177400\n\t\t\t\t\t\t\t} ]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '_distanceMessage()', function ( assert ) {\n\tconst\n\t\tself = this,\n\t\tmsgKm = 'mobile-frontend-nearby-distance',\n\t\tmsgM = 'mobile-frontend-nearby-distance-meters',\n\t\ttests = [\n\t\t\t[ 0.4834, msgM, '490' ],\n\t\t\t[ 0.5, msgM, '500' ],\n\t\t\t[ 0.723, msgM, '730' ],\n\t\t\t[ 0.999, msgKm, '1' ],\n\t\t\t[ 1.2, msgKm, '1.2' ],\n\t\t\t[ 1.588, msgKm, '1.59' ],\n\t\t\t[ 1.123, msgKm, '1.13' ],\n\t\t\t[ 2.561, msgKm, '2.6' ],\n\t\t\t[ 10.8334, msgKm, '10.9' ]\n\t\t];\n\n\ttests.forEach( function ( test, i ) {\n\t\tself.nearbyGateway._distanceMessage( test[ 0 ] );\n\n\t\tassert.propEqual(\n\t\t\tmw.msg.getCall( i ).args,\n\t\t\t[\n\t\t\t\ttest[ 1 ], test[ 2 ]\n\t\t\t]\n\t\t);\n\t} );\n} );\n\nQUnit.test( 'getPages()', function ( assert ) {\n\treturn this.nearbyGateway.getPages( {\n\t\tlatitude: 37.787,\n\t\tlongitude: -122.51\n\t} ).then( function ( pages ) {\n\t\tassert.strictEqual( pages.length, 3 );\n\t\tassert.strictEqual( pages[ 0 ].title, 'Wikimedia Foundation' );\n\t\tassert.strictEqual( pages[ 0 ].thumbnail.isLandscape, false );\n\t\tassert.strictEqual( pages[ 2 ].title, 'W San Francisco' );\n\t\tassert.strictEqual( pages[ 2 ].thumbnail, false );\n\t\tassert.strictEqual( pages[ 2 ].dist.toPrecision( 6 ), '177.400' );\n\t} );\n} );\n\nQUnit.test( 'getPagesAroundPage()', function ( assert ) {\n\treturn this.nearbyGateway.getPagesAroundPage( 'Wikimedia Foundation' ).then( function ( pages ) {\n\t\tassert.strictEqual( pages.length, 2 );\n\t\tassert.strictEqual( pages[ 1 ].title, 'W San Francisco' );\n\t\tassert.strictEqual( pages[ 1 ].thumbnail, false );\n\t\tassert.strictEqual( pages[ 1 ].dist.toPrecision( 6 ), '177.400' );\n\t} );\n} );\n","const\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tmustache = require( '../utils/mustache' );\nlet\n\tWatchList,\n\tIcon,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend WatchList.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tsandbox.stub( global.mw.Title, 'newFromText' ).returns(\n\t\t\t{ getUrl: function () {} }\n\t\t);\n\t\tsandbox.stub( mw.user, 'isAnon' ).returns( false );\n\t\tsandbox.stub( mw.loader, 'require' ).withArgs( 'mediawiki.page.watch.ajax' ).returns( {\n\t\t\twatchstar: () => {}\n\t\t} );\n\n\t\tWatchList = require( '../../../src/mobile.special.watchlist.scripts/WatchList' );\n\t\tIcon = require( '../../../src/mobile.startup/Icon' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'In watched mode', function ( assert ) {\n\tconst\n\t\tstub = {\n\t\t\tget: sandbox.stub()\n\t\t},\n\t\tpl = new WatchList( {\n\t\t\teventBus: {\n\t\t\t\ton: function () {},\n\t\t\t\toff: function () {}\n\t\t\t},\n\t\t\tapi: stub,\n\t\t\tpages: [\n\t\t\t\t{ title: 'Title 30' },\n\t\t\t\t{ title: 'Title 50' },\n\t\t\t\t{\n\t\t\t\t\ttitle: 'Title 60',\n\t\t\t\t\twatched: true\n\t\t\t\t}\n\t\t\t]\n\t\t} ),\n\t\twatchIconName = new Icon( {\n\t\t\tglyphPrefix: 'wikimedia',\n\t\t\tname: 'unStar-progressive'\n\t\t} ).getGlyphClassName();\n\n\t// Avoid API requests due to scroll events (https://phabricator.wikimedia.org/T116258)\n\tpl.scrollEndEventEmitter.disable();\n\n\tassert.ok( stub.get.notCalled, 'Callback avoided' );\n\tassert.strictEqual( pl.$el.find( '.watch-this-article' ).length, 3, '3 articles have watch stars...' );\n\tassert.strictEqual( pl.$el.find( '.' + watchIconName ).length, 3, '...and all are marked as watched.' );\n} );\n","let\n\tWatchListGateway,\n\tsandbox;\nconst\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tresponse = {\n\t\tcontinue: {\n\t\t\tpageimages: {\n\t\t\t\tpicontinue: 9\n\t\t\t}\n\t\t},\n\t\twarnings: {\n\t\t\tquery: {\n\t\t\t\t'*': 'Formatting of continuation data will be changing soon. To continue using the current formatting, use the \\'rawcontinue\\' parameter. To begin using the new format, pass an empty string for \\'continue\\' in the initial query.'\n\t\t\t}\n\t\t},\n\t\tquery: {\n\t\t\tpages: [\n\t\t\t\t{\n\t\t\t\t\tpageid: 2,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Burrito',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-17T10:06:49Z',\n\t\t\t\t\tlastrevid: 552,\n\t\t\t\t\tlength: 33534\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 3,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Albert Einstein',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-16T17:33:22Z',\n\t\t\t\t\tlastrevid: 4,\n\t\t\t\t\tlength: 19\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 9,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Anne Dallas Dudley',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-17T10:00:13Z',\n\t\t\t\t\tlastrevid: 18,\n\t\t\t\t\tlength: 12663\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 10,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2014-12-17T10:04:55Z',\n\t\t\t\t\tlastrevid: 546,\n\t\t\t\t\tlength: 373791\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 708,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Functional logic programming',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2015-01-12T13:04:23Z',\n\t\t\t\t\tlastrevid: 1307,\n\t\t\t\t\tlength: 1392,\n\t\t\t\t\tnew: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tpageid: 720,\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'Functional programming',\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en',\n\t\t\t\t\ttouched: '2015-01-12T13:04:35Z',\n\t\t\t\t\tlastrevid: 1319,\n\t\t\t\t\tlength: 54839,\n\t\t\t\t\tnew: ''\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tns: 0,\n\t\t\t\t\ttitle: 'zzzz',\n\t\t\t\t\tmissing: true,\n\t\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\t\tpagelanguage: 'en'\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t};\n\nQUnit.module( 'MobileFrontend WatchListGateway.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\n\t\t// needed for extendSearchParams to not throw exception about feature not\n\t\t// supporting wikibase descriptions in headless tests\n\t\tsandbox.stub( mw.config, 'get' )\n\t\t\t.withArgs( 'wgMFDisplayWikibaseDescriptions' )\n\t\t\t.returns( {\n\t\t\t\twatchlist: true\n\t\t\t} )\n\t\t\t// needed bc Page.js expects this call to return an array\n\t\t\t.withArgs( 'wgMFMobileFormatterHeadings', [ 'h1', 'h2', 'h3', 'h4', 'h5' ] )\n\t\t\t.returns( [ 'h1', 'h2', 'h3', 'h4', 'h5' ] );\n\t\t// needed for browser tests. If not stubbed, pageJSONParser.parse() will call\n\t\t// mw.util.getUrl which calls mw.config.get and expects back a value\n\t\tsandbox.stub( mw.util, 'getUrl' ).callsFake( function () {} );\n\n\t\tWatchListGateway = require( '../../../src/mobile.special.watchlist.scripts/WatchListGateway' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'loadWatchlist() loads results from the first page', function ( assert ) {\n\tconst gateway = new WatchListGateway( new mw.Api() );\n\n\tsandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( response ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tconst params = mw.Api.prototype.get.firstCall.args[0];\n\n\t\tassert.strictEqual( params.continue, '', 'It should set the continue parameter' );\n\n\t\tassert.strictEqual( pages.length, 7, 'Got all the results' );\n\t\tassert.strictEqual( pages[0].displayTitle, 'Albert Einstein', 'Sorted alphabetically' );\n\t} );\n} );\n\nQUnit.test( 'loadWatchlist() loads results from the second page from last item of first', function ( assert ) {\n\tconst lastTitle = 'Albert Einstein',\n\t\tgateway = new WatchListGateway( new mw.Api(), lastTitle ),\n\t\tresponse1 = util.extend( {}, response, {\n\t\t\tcontinue: {\n\t\t\t\twatchlistraw: {\n\t\t\t\t\tgwrcontinue: '0|Albert Einstein'\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\n\t// First time we call the API for the second page\n\tconst stub = sandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( response1 ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tconst params = mw.Api.prototype.get.firstCall.args[0];\n\n\t\tassert.strictEqual( params.continue, 'gwrcontinue||', 'It should set the continue parameter' );\n\t\tassert.strictEqual( params.gwrcontinue, '0|Albert_Einstein', 'It should set the watchlistraw-specific continue parameter' );\n\n\t\t// Albert Einstein should not be in the results since it was the last\n\t\t// item in the first page.\n\t\tassert.strictEqual( pages.length, 6, 'Should have Albert removed from the results' );\n\t\tassert.strictEqual( pages[0].displayTitle, 'Anne Dallas Dudley', 'First item should be Anne' );\n\n\t\t// Let's call for the next page\n\t\tstub.returns( util.Deferred().resolve( response ) );\n\n\t\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\t\t// Albert Einstein should be the first result of the next page (not removed)\n\t\t\tassert.strictEqual( pages.length, 7, 'Albert should be in the results' );\n\t\t\tassert.strictEqual( pages[0].displayTitle, 'Albert Einstein', 'First item should be Albert' );\n\t\t} );\n\t} );\n} );\n\nQUnit.test( 'loadWatchlist() doesn\\'t throw an error when no pages are returned', function ( assert ) {\n\tconst gateway = new WatchListGateway( new mw.Api() );\n\n\tsandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( {\n\t\t\tbatchcomplete: ''\n\t\t} ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tassert.propEqual( pages, [] );\n\t} );\n} );\n\nQUnit.test( 'loadWatchlist() marks pages as new if necessary', function ( assert ) {\n\tconst gateway = new WatchListGateway( new mw.Api() );\n\n\tsandbox.stub( mw.Api.prototype, 'get' )\n\t\t.returns( util.Deferred().resolve( response ) );\n\n\treturn gateway.loadWatchlist().then( function ( pages ) {\n\t\tassert.strictEqual( pages[0].isMissing, false, 'Albert Einstein page isn\\'t marked as new' );\n\t\tassert.strictEqual( pages[6].isMissing, true, 'zzzz page is marked as new' );\n\t} );\n} );\n","/* global $ */\nconst\n\tBrowser = require( '../../../src/mobile.startup/Browser' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tsinon = require( 'sinon' ),\n\tmediawiki = require( '../utils/mw' );\nlet\n\t$html;\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend Browser.js', {\n\tbeforeEach: function () {\n\t\tlet tmpDOM;\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\t$html = $( tmpDOM );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'isIos()', function ( assert ) {\n\tconst browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tbrowser4 = new Browser( 'Mozilla/5.0 (iPad; CPU OS 4_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tbrowser5 = new Browser( 'Mozilla/5.0 (iPad; CPU OS 5_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tbrowser2 = new Browser( 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53', $html );\n\n\tassert.strictEqual( browser.isIos(), true );\n\tassert.strictEqual( browser.isIos( 8 ), false );\n\tassert.strictEqual( browser.isIos( 4 ), false );\n\tassert.strictEqual( browser.isIos( 5 ), false );\n\tassert.strictEqual( browser2.isIos(), true );\n\tassert.strictEqual( browser2.isIos( 8 ), true );\n\tassert.strictEqual( browser4.isIos( 4 ), true );\n\tassert.strictEqual( browser5.isIos( 5 ), true );\n} );\n\nQUnit.test( 'Methods are cached', function ( assert ) {\n\tconst ipad = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html ),\n\t\tiphone = new Browser( 'Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53', $html ),\n\t\tandroid2 = new Browser( 'Android 2', $html );\n\n\tfunction cache( obj, method ) {\n\t\treturn obj[ '__cache' + obj[ method ].cacheId ];\n\t}\n\n\t// Check that the same methods across different instances have their own\n\t// cache and don't interfere with one another\n\tassert.strictEqual( ipad.isIos(), true );\n\tassert.strictEqual( ipad.isIos( 8 ), false );\n\tassert.strictEqual( android2.isIos( 8 ), false );\n\tassert.strictEqual( iphone.isIos(), true );\n\tassert.strictEqual( iphone.isIos( 8 ), true );\n\n\t// Check that the caches have been filled\n\tassert.strictEqual( Object.keys( cache( ipad, 'isIos' ) ).length, 2, 'isIos on ipad cached as expected' );\n\tassert.strictEqual( Object.keys( cache( android2, 'isIos' ) ).length, 1, 'isIos on android cached as expected' );\n\tassert.strictEqual( Object.keys( cache( iphone, 'isIos' ) ).length, 2, 'isIos on iphone cached as expected' );\n} );\n\nQUnit.test( 'isWideScreen()', function ( assert ) {\n\tconst browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html );\n\tsandbox.stub( mw.config, 'get' ).callsFake( function () {\n\t\treturn '720px';\n\t} );\n\tassert.strictEqual( browser.isWideScreen(), true );\n} );\n\nQUnit.test( 'supportsTouchEvents()', function ( assert ) {\n\tconst browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html );\n\twindow.ontouchstart = window.ontouchstart || undefined;\n\tassert.strictEqual( browser.supportsTouchEvents(), true );\n} );\n\nQUnit.test( 'supportsGeoLocation()', function ( assert ) {\n\tconst browser = new Browser( 'Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)', $html );\n\twindow.navigator.geolocation = window.navigator.geolocation || undefined;\n\tassert.strictEqual( browser.supportsGeoLocation(), true );\n} );\n","const\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' );\nlet\n\tButton,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend Button.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tButton = require( '../../../src/mobile.startup/Button' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'creates a link if passed href option', function ( assert ) {\n\tconst\n\t\turl = 'https://www.foo.com',\n\t\tbutton = new Button( {\n\t\t\thref: url\n\t\t} );\n\n\tassert.strictEqual( button.$el[0].tagName, 'A' );\n\tassert.strictEqual( button.$el[0].getAttribute( 'href' ), 'https://www.foo.com' );\n} );\n\nQUnit.test( 'does not add href attribute when not a link', function ( assert ) {\n\tconst button = new Button( {\n\t\ttagName: 'div'\n\t} );\n\n\tassert.strictEqual( button.$el[0].tagName, 'DIV' );\n\tassert.strictEqual( button.$el[0].href, undefined );\n} );\n","module.exports = {\n\tdefaultURLs: `\n\t\t<div class=\" drawer drawer-container__drawer position-fixed\">\n\t\t\t<div\n\t\t\t\tclass=\" mw-ui-icon mw-ui-icon-mf-expand mw-ui-icon-element cancel \"\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=\" logIn \" class=\" mw-ui-button mw-ui-progressive \">\n\t\t\t\tLog in\n\t\t\t</a>\n\t\t\t<div class=\"cta-drawer__anchors\">\n\t\t\t\t<a href=\" signUp \" class=\" mw-ui-anchor mw-ui-progressive \">\n\t\t\t\t\tSign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t`,\n\toverrideURLs: `\n\t\t<div class=\" drawer drawer-container__drawer position-fixed\">\n\t\t\t<div\n\t\t\t\tclass=\" mw-ui-icon mw-ui-icon-mf-expand mw-ui-icon-element cancel \"\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=\" customLogIn \" class=\" mw-ui-button mw-ui-progressive \">\n\t\t\t\tcustom log in\n\t\t\t</a>\n\t\t\t<div class=\"cta-drawer__anchors\">\n\t\t\t\t<a href=\" customSignUp \" class=\" mw-ui-anchor mw-ui-progressive \">\n\t\t\t\t\tcustom sign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t`\n};\n","const\n\t// Imports\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\nlet\n\tCtaDrawer,\n\tAnchor,\n\tButton,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend CtaDrawer.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\n\t\t// Set up required by all Views.\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\t// Additional CtaDrawer global dependency.\n\t\tmw.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\t// Force consistent messaging between Special:JavaScriptTest and Node.js.\n\t\tsandbox.stub( global.mw, 'msg' ).callsFake( function ( id ) {\n\t\t\tswitch ( id ) {\n\t\t\t\tcase 'mobile-frontend-watchlist-cta-button-login': return 'Log in';\n\t\t\t\tcase 'mobile-frontend-watchlist-cta-button-signup': return 'Sign up';\n\t\t\t}\n\t\t\treturn id;\n\t\t} );\n\t\tsandbox.stub( global.mw.util, 'getUrl' ).callsFake( function ( pageName, params ) {\n\t\t\treturn params.type ? 'signUp' : 'logIn';\n\t\t} );\n\n\t\t// Dynamically import Views to use fresh sandboxed dependencies.\n\t\tAnchor = require( '../../../src/mobile.startup/Anchor' );\n\t\tButton = require( '../../../src/mobile.startup/Button' );\n\t\tCtaDrawer = require( '../../../src/mobile.startup/CtaDrawer' );\n\t},\n\n\tafterEach: function () {\n\t\tCtaDrawer = undefined;\n\t\tButton = undefined;\n\t\tAnchor = undefined;\n\n\t\tjQuery.tearDown();\n\n\t\tsandbox.restore();\n\t}\n}, function () {\n\tQUnit.module( 'redirectParams()', function () {\n\t\tQUnit.test( 'empty props, default URL', function ( assert ) {\n\t\t\tconst subject = CtaDrawer.prototype.test.redirectParams;\n\t\t\tsandbox.stub( global.mw.config, 'get' ).callsFake( function () {\n\t\t\t\treturn 'pageName';\n\t\t\t} );\n\t\t\tassert.propEqual( subject( {} ), { returnto: 'pageName' } );\n\t\t} );\n\n\t\tQUnit.test( 'empty props, nondefault URL', function ( assert ) {\n\t\t\tconst subject = CtaDrawer.prototype.test.redirectParams;\n\t\t\tassert.propEqual( subject( {}, 'url' ), { returnto: 'url' } );\n\t\t} );\n\n\t\tQUnit.test( 'nonempty props', function ( assert ) {\n\t\t\tconst subject = CtaDrawer.prototype.test.redirectParams;\n\t\t\tassert.propEqual( subject( { key: 'val' }, 'url' ), {\n\t\t\t\tkey: 'val',\n\t\t\t\treturnto: 'url'\n\t\t\t} );\n\t\t} );\n\t} );\n\n\tQUnit.module( 'signUpParams()', function () {\n\t\tQUnit.test( 'empty props', function ( assert ) {\n\t\t\tconst subject = CtaDrawer.prototype.test.signUpParams;\n\t\t\tassert.propEqual( subject( {} ), { type: 'signup' } );\n\t\t} );\n\n\t\tQUnit.test( 'nonempty props', function ( assert ) {\n\t\t\tconst subject = CtaDrawer.prototype.test.signUpParams;\n\t\t\tassert.propEqual( subject( { key: 'val' } ), {\n\t\t\t\tkey: 'val',\n\t\t\t\ttype: 'signup'\n\t\t\t} );\n\t\t} );\n\t} );\n\n\tQUnit.module( 'HTML', function () {\n\t\tQUnit.test( 'defaults', function ( assert ) {\n\t\t\tconst\n\t\t\t\tsubject = new CtaDrawer(),\n\t\t\t\t// Import the expected HTML as a string and replace spaces with a \\s*. This allows\n\t\t\t\t// the HTML some flexibility in how it's rendered.\n\t\t\t\thtml = new RegExp( require( './CtaDrawer.test.html' ).defaultURLs\n\t\t\t\t\t.replace( /\\n/g, ' ' ).replace( /\\s+/g, '\\\\s*' ) );\n\n\t\t\tsinon.assert.match( subject.$el.find( '.drawer' ).get( 0 ).outerHTML.replace( /\\n/g, ' ' ), html );\n\t\t\tassert.ok( true );\n\t\t} );\n\n\t\tQUnit.test( 'overrides', function ( assert ) {\n\t\t\tconst\n\t\t\t\tsubject = new CtaDrawer( {\n\t\t\t\t\tprogressiveButton: new Button( {\n\t\t\t\t\t\tprogressive: true,\n\t\t\t\t\t\tlabel: 'custom log in',\n\t\t\t\t\t\thref: 'customLogIn'\n\t\t\t\t\t} ).options,\n\t\t\t\t\tactionAnchor: new Anchor( {\n\t\t\t\t\t\tprogressive: true,\n\t\t\t\t\t\tlabel: 'custom sign up',\n\t\t\t\t\t\thref: 'customSignUp'\n\t\t\t\t\t} ).options\n\t\t\t\t} ),\n\t\t\t\thtml = new RegExp( require( './CtaDrawer.test.html' )\n\t\t\t\t\t.overrideURLs.replace( /\\n/g, ' ' ).replace( /\\s+/g, '\\\\s*' ) );\n\n\t\t\tsinon.assert.match( subject.$el.find( '.drawer' ).get( 0 ).outerHTML.replace( /\\n/g, ' ' ), html );\n\t\t\tassert.ok( true );\n\t\t} );\n\t} );\n} );\n","const // Imports\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\nlet\n\tDrawer,\n\tsandbox;\n\n// util.docReady() usage appears to be necessary over\n// `document.addEventListener('DOMContentLoaded', ...)` as the latter fires before the subject's\n// internal usage of the former.\n\nQUnit.module( 'MobileFrontend Drawer.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\n\t\t// Set up required by all Views.\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\t// Additional Drawer global dependency.\n\t\tmw.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\t// Dynamically import Drawer to use fresh sandboxed dependencies.\n\t\tDrawer = require( '../../../src/mobile.startup/Drawer' );\n\t},\n\n\tafterEach: function () {\n\t\tDrawer = undefined;\n\n\t\tjQuery.tearDown();\n\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'visible on show()', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tonShow = () => {\n\t\t\tassertVisible( subject );\n\t\t\tassert.ok( true );\n\t\t\tdone();\n\t\t},\n\t\tsubject = new Drawer( {} );\n\n\tsubject.show().then( onShow ).then( () => {\n\t\t// show again and it's still visible./\n\t\tsubject.show().then( onShow );\n\t} );\n} );\n\nQUnit.test( 'accepts onShow and events', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tonShow = () => {\n\t\t\tassert.ok( true );\n\t\t\tdone();\n\t\t},\n\t\tsubject = new Drawer( {\n\t\t\tevents: {\n\t\t\t\t'click .button': () => {}\n\t\t\t},\n\t\t\tonShow\n\t\t} );\n\n\tsubject.show();\n} );\n\nQUnit.test( 'hidden on hide()', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tonBeforeHide = () => {\n\t\t\tassertHidden( subject );\n\t\t\tassert.ok( true );\n\t\t\tdone();\n\t\t},\n\t\tsubject = new Drawer( { onBeforeHide } );\n\n\tsubject.hide();\n} );\n\nQUnit.test( 'hidden on mask click', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tonBeforeHide = () => {\n\t\t\tassertHidden( subject );\n\t\t\tassert.ok( true );\n\t\t\tdone();\n\t\t},\n\t\tsubject = new Drawer( { onBeforeHide } );\n\n\tsubject.show();\n\tsubject.$el.find( '.drawer-container__mask' )[0].dispatchEvent( new window.Event( 'click', { bubbles: true } ) );\n} );\n\nQUnit.test( 'HTML is valid', function ( assert ) {\n\tconst subject = new Drawer( {} );\n\tassert.strictEqual(\n\t\tsubject.$el.find( '.drawer' ).get( 0 ).outerHTML,\n\t\t'<div class=\"drawer drawer-container__drawer position-fixed\"><div class=\"mw-ui-icon mw-ui-icon-mf-expand mw-ui-icon-element   cancel\"></div></div>'\n\t);\n} );\n\nfunction assertVisible( drawer ) {\n\tsinon.assert.match( drawer.$el.find( '.drawer' )[ 0 ].className, /.*\\bvisible\\b.*/ );\n}\n\nfunction assertHidden( drawer ) {\n\tsinon.assert.match( drawer.$el.find( '.drawer' )[ 0 ].className, /^((?!\\bvisible\\b).)*$/ );\n}\n","const\n\tsinon = require( 'sinon' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmfExtend = require( '../../../src/mobile.startup/mfExtend' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tutil = require( '../../../src/mobile.startup/util' );\nlet\n\tOverlay,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend: Overlay.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tOverlay = require( '../../../src/mobile.startup/Overlay' );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// window.scrollTo\n\t\tsandbox.stub( global.window, 'scrollTo' );\n\n\t\t// Create a dummy mw-mf-viewport if none exists\n\t\tif ( !util.getDocument().find( '#mw-mf-viewport' ).length ) {\n\t\t\tthis.$viewport = util.parseHTML( '<div>' ).attr( 'id', 'mw-mf-viewport' ).appendTo( 'body' );\n\t\t}\n\t},\n\tafterEach: function () {\n\t\tif ( this.$viewport ) {\n\t\t\tthis.$viewport.remove();\n\t\t}\n\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Simple overlay', function ( assert ) {\n\tconst overlay = new Overlay( {\n\t\theading: '<h2>Overlay Title</h2>'\n\t} );\n\n\tconst $headingNode = overlay.$el.find( 'h2:contains(\"Overlay Title\")' );\n\n\tassert.strictEqual( $headingNode.length, 1 );\n} );\n\nQUnit.test( '#make', function ( assert ) {\n\tconst overlay = Overlay.make( {\n\t\theading: 'Fresh from factory'\n\t}, new Overlay( {\n\t\tclassName: 'overlay-child',\n\t\theading: 'overlay in overlay'\n\t} ) );\n\n\tassert.strictEqual( overlay.$el.find( '.overlay-child' ).length, 1, 'there is an overlay in the overlay!' );\n\tassert.strictEqual(\n\t\toverlay.$el.find( '.overlay-title' ).eq( 0 ).text().trim(),\n\t\t'Fresh from factory',\n\t\t'First heading found'\n\t);\n\tassert.strictEqual(\n\t\toverlay.$el.find( '.overlay-content .overlay-title' ).text().trim(),\n\t\t'overlay in overlay',\n\t\t'Second heading found in overlay-content'\n\t);\n} );\n\nQUnit.test( 'HTML overlay', function ( assert ) {\n\tfunction TestOverlay() {\n\t\tOverlay.apply( this, arguments );\n\t}\n\n\tmfExtend( TestOverlay, Overlay, {\n\t\ttemplatePartials: util.extend( {}, Overlay.prototype.templatePartials, {\n\t\t\tcontent: util.template( '<div class=\"content\">YO</div>' )\n\t\t} )\n\t} );\n\tconst overlay = new TestOverlay( {\n\t\theading: 'Awesome'\n\t} );\n\n\tassert.strictEqual( overlay.$el.find( 'h2' ).html(), 'Awesome' );\n\tassert.strictEqual( overlay.$el.find( '.content' ).text(), 'YO' );\n} );\n\nQUnit.test( 'headerActions property', function ( assert ) {\n\tconst overlays = [\n\t\tnew Overlay( {} ),\n\t\tnew Overlay( {\n\t\t\theaderActions: [\n\t\t\t\t{ $el: util.parseHTML( '<div>' ) }\n\t\t\t]\n\t\t} )\n\t];\n\tassert.strictEqual( overlays[0].$el.find( '.header-action' ).length, 0,\n\t\t'Overlays do not have header actions by default' );\n\tassert.strictEqual( overlays[1].$el.find( '.header-action > *' ).length, 1,\n\t\t'headerActions will be inserted into the header-action container' );\n} );\n\nQUnit.test( 'onBeforeExit', function ( assert ) {\n\tconst spies = [],\n\t\toverlays = [\n\t\t\tnew Overlay( {} ),\n\t\t\tnew Overlay( {\n\t\t\t\tonBeforeExit: function () {}\n\t\t\t} ),\n\t\t\tnew Overlay( {\n\t\t\t\tonBeforeExit: function ( exit ) {\n\t\t\t\t\texit();\n\t\t\t\t}\n\t\t\t} )\n\t\t];\n\toverlays.forEach( function ( overlay ) {\n\t\tspies.push( sandbox.spy( overlay, 'hide' ) );\n\t\toverlay.onExitClick( new Event( 'click' ) );\n\t} );\n\tassert.strictEqual( spies[0].calledOnce, true, 'Overlay 1 hide method called' );\n\tassert.strictEqual( spies[1].calledOnce, false, 'Overlay 2 does not call the exit function' );\n\tassert.strictEqual( spies[2].calledOnce, true, 'Overlay 3 calls the exit function' );\n} );\n\nQUnit.test( 'Close overlay', function ( assert ) {\n\tconst overlay = new Overlay( {\n\t\theading: '<h2>Title</h2>',\n\t\tcontent: 'Text'\n\t} );\n\n\toverlay.show();\n\toverlay.hide();\n\n\tassert.strictEqual( overlay.$el[ 0 ].parentNode, null, 'No longer in DOM' );\n} );\n","/* global $ */\nconst\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' );\nlet\n\tOverlayManager, Overlay,\n\tfakeRouter,\n\toverlayManager,\n\trouteEvent,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend mobile.startup/OverlayManager', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// window.scrollTo\n\t\tsandbox.stub( global.window, 'scrollTo' );\n\n\t\tOverlayManager = require( '../../../src/mobile.startup/OverlayManager' );\n\t\tOverlay = require( '../../../src/mobile.startup/Overlay' );\n\t\trouteEvent = function ( data ) {\n\t\t\treturn $.Event( 'route', data );\n\t\t};\n\n\t\tthis.createFakeOverlay = function ( options ) {\n\t\t\tconst fakeOverlay = new OO.EventEmitter();\n\t\t\tfakeOverlay.show = sandbox.spy();\n\t\t\tfakeOverlay.hide = function () {\n\t\t\t\tthis.emit( 'hide' );\n\t\t\t\treturn true;\n\t\t\t};\n\t\t\tfakeOverlay.$el = util.parseHTML( '<div>' );\n\t\t\tsandbox.spy( fakeOverlay, 'hide' );\n\t\t\tutil.extend( fakeOverlay, options );\n\t\t\treturn fakeOverlay;\n\t\t};\n\n\t\tfakeRouter = new OO.EventEmitter();\n\t\tfakeRouter.getPath = () => '';\n\t\tfakeRouter.back = sandbox.spy();\n\t\tsandbox.stub( mw.loader, 'require' ).withArgs( 'mediawiki.router' ).returns( fakeRouter );\n\t\toverlayManager = new OverlayManager( fakeRouter, document.body );\n\t\tOverlayManager.test.__clearCache();\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getSingleton (hash present and overlay not managed)', function ( assert ) {\n\t// eslint-disable-next-line no-restricted-properties\n\tconst spy = sandbox.spy( window.history, 'replaceState' );\n\n\tsandbox.stub( fakeRouter, 'getPath' ).returns( '#/editor/0' );\n\tconst singleton = OverlayManager.getSingleton();\n\tassert.ok( singleton instanceof OverlayManager, 'singleton exists' );\n\tassert.strictEqual( spy.calledOnce, true,\n\t\t'If a page is loaded with a hash fragment a new entry is placed before it to allow the user to go back.' );\n} );\n\nQUnit.test( '#getSingleton (hash present and overlay managed)', function ( assert ) {\n\t// replace the current URL before the test\n\t// eslint-disable-next-line no-restricted-properties\n\twindow.history.replaceState( OverlayManager.test.MANAGED_STATE, null, window.location.href );\n\t// eslint-disable-next-line no-restricted-properties\n\tconst spy = sandbox.spy( window.history, 'replaceState' );\n\n\tsandbox.stub( fakeRouter, 'getPath' ).returns( '#/editor/0' );\n\tOverlayManager.getSingleton();\n\tassert.strictEqual( spy.calledOnce, false,\n\t\t'If the history entry was added/removed by overlay manager, no URI correct occurs.' );\n} );\n\nQUnit.test( '#getSingleton', function ( assert ) {\n\tconst singleton = OverlayManager.getSingleton();\n\tassert.ok( singleton instanceof OverlayManager, 'singleton exists' );\n\tassert.strictEqual( singleton, OverlayManager.getSingleton(), 'same object returned each time' );\n} );\n\nQUnit.test( '#add', function ( assert ) {\n\tconst fakeOverlay = this.createFakeOverlay();\n\n\toverlayManager.add( /^test$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test'\n\t} );\n\n\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show registered overlay' );\n} );\n\nQUnit.test( '#show', function ( assert ) {\n\tconst fakeOverlay = this.createFakeOverlay(),\n\t\tshowSpy = sandbox.spy( overlayManager, '_show' );\n\n\toverlayManager.add( /^showTest$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'showTest'\n\t} );\n\n\tassert.strictEqual( showSpy.callCount, 1, 'OverlayManager.show called on route change' );\n} );\n\nQUnit.test( '#add, with current path', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tdeferred = util.Deferred();\n\tfakeRouter.getPath = sandbox.stub().returns( 'baha' );\n\n\toverlayManager.add( /^baha$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\n\t// Wait for $.ready because OverlayManager#add() does\n\tutil.docReady( function () {\n\t\tdeferred.resolve();\n\t} );\n\n\treturn deferred.then( function () {\n\t\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show registered overlay' );\n\t} );\n} );\n\nQUnit.test( '#add, with string literal (matching)', function ( assert ) {\n\tconst deferred = util.Deferred(),\n\t\tfakeOverlay = this.createFakeOverlay();\n\tdeferred.show = sandbox.spy();\n\n\t// Note: In this test, we also test if OverlayManager will try to do regex\n\t// operations (e.g. ''.match()) on a string literal (which would cause an\n\t// error since this is an invalid regex (Unterminated character)\n\t// eslint-disable-next-line no-useless-escape\n\toverlayManager.add( '[.*+?^${}()|[\\][(foo)', function () {\n\t\treturn fakeOverlay;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\t// eslint-disable-next-line no-useless-escape\n\t\tpath: '[.*+?^${}()|[\\][(foo)'\n\t} );\n\tdeferred.resolve( fakeOverlay );\n\n\treturn deferred.then( function () {\n\t\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show called for string that matches' );\n\t} );\n} );\n\nQUnit.test( '#add, with string literal (not matching)', function ( assert ) {\n\tconst deferred = util.Deferred(),\n\t\tfakeOverlay = this.createFakeOverlay();\n\tdeferred.show = sandbox.spy();\n\n\t// eslint-disable-next-line no-useless-escape\n\toverlayManager.add( '[.*+?^${}()|[\\](foo)', function () {\n\t\treturn deferred;\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: '(bar)'\n\t} );\n\tdeferred.resolve( fakeOverlay );\n\n\treturn deferred.then( function () {\n\t\tassert.strictEqual( fakeOverlay.show.callCount, 0, 'show not called for string that doesn\\'t match' );\n\t} );\n} );\n\nQUnit.test( '#replaceCurrent', function ( assert ) {\n\tconst overlayManagerEmpty = new OverlayManager( fakeRouter, document.body ),\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tanotherFakeOverlay = this.createFakeOverlay();\n\n\tassert.throws( () => {\n\t\toverlayManagerEmpty.replaceCurrent( {} );\n\t}, 'throws exceptions if you replace an empty stack' );\n\n\toverlayManager.add( /^test$/, function () {\n\t\treturn fakeOverlay;\n\t} );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test'\n\t} );\n\toverlayManager.replaceCurrent( anotherFakeOverlay );\n\tassert.strictEqual( fakeOverlay.hide.callCount, 1, 'hide overlay' );\n\tassert.strictEqual( anotherFakeOverlay.show.callCount, 1, 'show another overlay' );\n\tfakeRouter.emit( 'route', {\n\t\tpath: ''\n\t} );\n\tassert.strictEqual( anotherFakeOverlay.hide.callCount, 1, 'hide another overlay' );\n} );\n\nQUnit.test( 'route with params', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^sam\\/(\\d+)$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'sam/123'\n\t} );\n\n\tassert.ok( factoryStub.calledWith( '123' ), 'pass params from the route' );\n} );\n\nQUnit.test( 'hide when route changes', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^jon$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'jon'\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: ''\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'jon'\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'other'\n\t} );\n\n\tassert.strictEqual( fakeOverlay.hide.callCount, 2, 'hide overlay' );\n\tassert.ok( fakeOverlay.hide.getCall( 0 ).notCalledWith( true ), 'don\\'t force hide (first)' );\n\tassert.ok( fakeOverlay.hide.getCall( 1 ).notCalledWith( true ), 'don\\'t force hide (second)' );\n} );\n\nQUnit.test( 'go back (change route) if overlay hidden but not by route change', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^joakino$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'joakino'\n\t} );\n\tsandbox.stub( fakeRouter, 'getPath' ).returns( 'joakino' );\n\n\t// Call hide outside OverlayManager\n\tfakeOverlay.hide();\n\n\tassert.strictEqual( fakeRouter.back.callCount, 1, 'route back is called' );\n} );\n\nQUnit.test( 'go back if overlayManager still matches', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^media\\/(.*)$/, factoryStub );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'media/foo'\n\t} );\n\t// Something updates the path e.g. history.replaceState - but it still matches\n\t// the current overlay pattern.\n\tsandbox.stub( fakeRouter, 'getPath' ).returns( 'media/bar' );\n\n\t// Call hide outside OverlayManager\n\tfakeOverlay.hide();\n\n\tassert.strictEqual( fakeRouter.back.callCount, 1, 'route back is called' );\n} );\n\nQUnit.test( 'go back if overlayManager still matches (non-regex)', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\t// Note ^foo$ is not a regex - it's a string. This is the important part of the test.\n\t// as String.match if passed a non-regex will turn it into a regex.\n\toverlayManager.add( '^foo$', factoryStub );\n\t// the overlay manager route is triggered and the factoryStub overlay is shown\n\tfakeRouter.emit( 'route', {\n\t\tpath: '^foo$'\n\t} );\n\t// Something updates the path e.g. history.replaceState - but it still matches\n\t// the current overlay pattern.\n\tsandbox.stub( fakeRouter, 'getPath' ).onCall( 0 ).returns( '^foo$' )\n\t\t// On 2nd case, pretend something called replaceState set #foo\n\t\t// if the overlayManager had defined a __regex__ route, this would match,\n\t\t// however the route is NOT a regex so the route has been changed.\n\t\t.onCall( 1 ).returns( 'foo' );\n\t// Call hide outside OverlayManager with route at #^foo$\n\tfakeOverlay.hide();\n\n\tassert.strictEqual( fakeRouter.back.callCount, 1, 'route back is called' );\n\n\t// load the overlay again via a URL change.\n\tfakeRouter.emit( 'route', {\n\t\tpath: '^foo$'\n\t} );\n\n\t// Call hide outside OverlayManager with route at #foo\n\tfakeOverlay.hide();\n\n\tassert.strictEqual( fakeRouter.back.callCount, 2, 'and route back is called again' );\n\n} );\n\nQUnit.test( 'do not go back (change route) if overlay hidden by change in route', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay );\n\n\toverlayManager.add( /^joakino$/, factoryStub );\n\t// set the router to joakino\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'joakino'\n\t} );\n\t// Let's pretend something outside the router sets the address bar to a #section_anchor...\n\t// now any calls to getPath will return section_anchor\n\tsandbox.stub( fakeRouter, 'getPath' ).returns( 'section_anchor' );\n\t// something outside the overlay manager calls hide.\n\tfakeOverlay.hide();\n\tassert.strictEqual( fakeRouter.back.callCount, 0,\n\t\t'route back is not called if the hash has already changed from what it was for the overlay' );\n} );\n\nQUnit.test( 'preventDefault called when you cancel an exit request', function ( assert ) {\n\tconst $container = util.parseHTML( '<div>' ),\n\t\tmanager = new OverlayManager( fakeRouter, $container[ 0 ] ),\n\t\tbackEvent = routeEvent( { path: '' } ),\n\t\tbackEventPreventDefaultSpy = sandbox.spy( backEvent, 'preventDefault' );\n\n\tmanager.add( /^canceloverlay$/, function () {\n\t\treturn new Overlay( {\n\t\t\tonBeforeExit: function ( _exit, cancel ) {\n\t\t\t\tcancel();\n\t\t\t}\n\t\t} );\n\t} );\n\tfakeRouter.emit( 'route', routeEvent( { path: 'canceloverlay' } ) );\n\t// try to go back.\n\tfakeRouter.emit( 'route', backEvent );\n\n\tassert.strictEqual( backEventPreventDefaultSpy.calledOnce, true,\n\t\t'Prevent default was called when the user attempted to go back, preventing an address bar change.' );\n} );\n\nQUnit.test( 'Browser back can be overidden', function ( assert ) {\n\tconst escapableOverlay = new Overlay( {} ),\n\t\tdone = assert.async(),\n\t\t$container = util.parseHTML( '<div>' ),\n\t\tcannotGoBackOverlay = new Overlay( {\n\t\t\tonBeforeExit: function () {}\n\t\t} ),\n\t\tmanager = new OverlayManager( fakeRouter, $container[ 0 ] );\n\n\t// define 2 routes\n\tmanager.add( /^proceed$/, function () {\n\t\treturn escapableOverlay;\n\t} );\n\tmanager.add( /^youcannotpass$/, function () {\n\t\treturn cannotGoBackOverlay;\n\t} );\n\tfakeRouter.emit( 'route', routeEvent( { path: 'proceed' } ) );\n\tassert.strictEqual( $container.find( escapableOverlay.$el ).length, 1,\n\t\t'escapable overlay is displayed' );\n\tfakeRouter.emit( 'route', routeEvent( { path: 'youcannotpass' } ) );\n\t// emitting route will trigger the display of an overlay associated with the path.\n\t// showing is an asynchronous process controlled via setTimeout\n\t// hence this is an asynchronous test.\n\tsetTimeout( () => {\n\t\tassert.strictEqual( $container.find( escapableOverlay.$el ).length, 0,\n\t\t\t'escapable overlay is no longer displayed' );\n\t\tassert.strictEqual( $container.find( cannotGoBackOverlay.$el ).length, 1,\n\t\t\t'cannot go back overlay is now the overlay on display' );\n\t\t// attempt to go back\n\t\tfakeRouter.emit( 'route', routeEvent( { path: 'proceed' } ) );\n\t\tsetTimeout( () => {\n\t\t\tassert.strictEqual( $container.find( cannotGoBackOverlay.$el ).length, 1,\n\t\t\t\t'cannot go back overlay is still the overlay on display (cannot exit!)' );\n\t\t\tassert.strictEqual( $container.find( escapableOverlay.$el ).length, 0,\n\t\t\t\t'Escapeable overlay is not displayed' );\n\t\t\tassert.strictEqual( manager.stack[0].overlay, cannotGoBackOverlay,\n\t\t\t\t'Cannot go back overlay remains on the top of the stack' );\n\t\t\tdone();\n\t\t}, 0 );\n\t}, 0 );\n} );\n\nQUnit.test( 'stacked overlays', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay(),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay ),\n\t\tparentFakeOverlay = this.createFakeOverlay(),\n\t\tparentFactoryStub = sandbox.stub().returns( parentFakeOverlay );\n\n\toverlayManager.add( /^parent$/, parentFactoryStub );\n\toverlayManager.add( /^child$/, factoryStub );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'parent'\n\t} );\n\tassert.strictEqual( parentFakeOverlay.show.callCount, 1, 'show parent' );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'child'\n\t} );\n\tassert.strictEqual( parentFakeOverlay.hide.callCount, 1, 'hide parent' );\n\tassert.strictEqual( fakeOverlay.show.callCount, 1, 'show child' );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'parent'\n\t} );\n\tassert.strictEqual( fakeOverlay.hide.callCount, 1, 'hide child' );\n\tassert.strictEqual( parentFakeOverlay.show.callCount, 2, 'show parent again' );\n\n\tassert.strictEqual( parentFactoryStub.callCount, 1, 'create parent only once' );\n} );\n\nQUnit.test( 'prevent route change', function ( assert ) {\n\tconst\n\t\tfakeOverlay = this.createFakeOverlay( {\n\t\t\thide: sandbox.stub().returns( false )\n\t\t} ),\n\t\tfactoryStub = sandbox.stub().returns( fakeOverlay ),\n\t\tev = {\n\t\t\tpath: '',\n\t\t\tpreventDefault: sandbox.spy()\n\t\t};\n\n\toverlayManager.add( /^rob$/, factoryStub );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'rob'\n\t} );\n\tfakeRouter.emit( 'route', ev );\n\tassert.strictEqual( ev.preventDefault.called, false,\n\t\t'Previously extending hide could prevent closes, this behaviour changed in I2668b6e54a6d54e820d60e4b56028338908ad55f' );\n} );\n\nQUnit.test( 'stack increases and decreases at right times', function ( assert ) {\n\tconst self = this;\n\n\toverlayManager.add( /^test\\/(\\d+)$/, function () {\n\t\treturn self.createFakeOverlay();\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack is correct size' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/1'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 2, 'stack is correct size' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack decreases when going back to already visited overlay' );\n} );\n\nQUnit.test( 'replace overlay when route event path is equal to current path', function ( assert ) {\n\tconst self = this;\n\n\toverlayManager.add( /^test\\/(\\d+)$/, function () {\n\t\treturn self.createFakeOverlay();\n\t} );\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack is correct size' );\n\n\tfakeRouter.emit( 'route', {\n\t\tpath: 'test/0'\n\t} );\n\n\tassert.strictEqual( overlayManager.stack.length, 1, 'stack is correct size (did not increase upon reload)' );\n} );\n","const\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\nlet\n\t// These both have heavy dependencies on jQuery so must be loaded later.\n\tPage;\n\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend Page.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\tPage = require( '../../../src/mobile.startup/Page' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#isMainPage', function ( assert ) {\n\tconst p = new Page( {\n\t\t\ttitle: 'Main Page',\n\t\t\tisMainPage: true\n\t\t} ),\n\t\tp2 = new Page( {\n\t\t\ttitle: 'Foo'\n\t\t} );\n\tassert.strictEqual( p.isMainPage(), true, 'check main page flag is updated' );\n\tassert.strictEqual( p2.isMainPage(), false, 'check not marked as main page' );\n} );\n","const\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tmediawiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tjQuery = require( '../utils/jQuery' ),\n\texamples = require( './../utils/PageInputs.html' ),\n\tpage = examples.page,\n\tpage2 = examples.page2,\n\ttestData = require( '../utils/PageGateway.responses' );\nlet\n\tutil,\n\tPageGateway,\n\tpageGateway,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend PageGateway', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\t\tPageGateway = require( '../../../src/mobile.startup/PageGateway' );\n\t\tthis.api = new mw.Api();\n\t\tpageGateway = new PageGateway( this.api );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#getPageLanguages (response)', function ( assert ) {\n\tsandbox.stub( this.api, 'get' ).returns( util.Deferred().resolve( testData.getPageLanguagesResponse.input ) );\n\n\treturn pageGateway.getPageLanguages( 'Test' ).then( function ( resp ) {\n\t\tassert.propEqual( resp.languages,\n\t\t\ttestData.getPageLanguagesResponse.output.languages,\n\t\t\t'return augmented language links' );\n\n\t\tassert.propEqual( resp.variants,\n\t\t\ttestData.getPageLanguagesResponse.output.variants,\n\t\t\t'return augmented language variant links' );\n\t} );\n} );\n\nQUnit.test( '#getPageLanguages (call)', function ( assert ) {\n\tconst spy = sandbox.stub( this.api, 'get' ).returns( util.Deferred().reject() );\n\t// prevent rogue ajax request\n\t/* global $ */\n\tsandbox.stub( $, 'ajax' ).returns( util.Deferred().resolve() );\n\tpageGateway.getPageLanguages( 'Title', 'fr' );\n\tassert.ok(\n\t\tspy.calledWith( testData.getPageLanguagesCall.output )\n\t);\n} );\n\nQUnit.test( '#_getAPIResponseFromHTML', function ( assert ) {\n\tconst resp = pageGateway._getAPIResponseFromHTML(\n\t\tutil.parseHTML( page )\n\t);\n\tassert.propEqual( testData.getAPIResponseFromHTML.input, resp );\n} );\n\nQUnit.test( '#getSectionsFromHTML malformed (h2 before h1)', function ( assert ) {\n\tconst resp = pageGateway.getSectionsFromHTML(\n\t\tutil.parseHTML( page2 )\n\t);\n\tassert.propEqual( resp, [\n\t\t{\n\t\t\tline: 'A1',\n\t\t\tlevel: '2',\n\t\t\tanchor: '1.0',\n\t\t\ttext: '<h3 id=\"\">A2.1</h3>\\n',\n\t\t\tsubsections: [ {\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '3',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: '',\n\t\t\t\tsubsections: []\n\t\t\t} ]\n\t\t},\n\t\t{\n\t\t\tline: 'A2.2',\n\t\t\tlevel: '2',\n\t\t\tanchor: '',\n\t\t\ttext: '',\n\t\t\tsubsections: []\n\t\t},\n\t\t{\n\t\t\tline: 'A2',\n\t\t\tlevel: '1',\n\t\t\tanchor: '',\n\t\t\ttext: '<h2 id=\"\">A2.1</h2>\\n',\n\t\t\tsubsections: [ {\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: '',\n\t\t\t\tsubsections: []\n\t\t\t} ]\n\t\t}\n\t] );\n} );\n","const\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmw = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\t// These both have heavy dependencies on jQuery so must be loaded later.\n\tsinon = require( 'sinon' ),\n\tPARSER_OUTPUT = '<div class=\"mw-parser-output\">';\nlet\n\tPageHTMLParser, util;\n\n/** @type {sinon.SinonSandbox} */ let sandbox;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ let stubPage;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ let mobileTocPage;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ let desktopPage;\n/** @type {typeof import('../../../src/mobile.startup/Page')} */ let sectionPage;\n\nQUnit.module( 'MobileFrontend PageHTMLParser.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\tPageHTMLParser = require( '../../../src/mobile.startup/PageHTMLParser' );\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\n\t\tstubPage = new PageHTMLParser(\n\t\t\tutil.parseHTML( PARSER_OUTPUT ).html(\n\t\t\t\t'<p>lead</p><div class=\"ambox\">a0</div>'\n\t\t\t)\n\t\t);\n\t\tmobileTocPage = new PageHTMLParser(\n\t\t\tutil.parseHTML( PARSER_OUTPUT ).html( `\n\t\t\t\t<div class=\"mf-section-0\">\n\t\t\t\t\t<div class=\"ambox\">a0</div>\n\t\t\t\t\t<p>lead</p>\n\t\t\t\t</div>\n\t\t\t\t<h2 class=\"section-heading\">1</h2>\n\t\t\t\t<div class=\"mf-section-1\">\n\t\t\t\t\t<div class=\"ambox\">a1</div>\n\t\t\t\t\t<h3>1.1</h3>\n\t\t\t\t\t<div class=\"ambox\">a1.1</div>\n\t\t\t\t</div>\n\t\t\t` )\n\t\t);\n\t\tdesktopPage = new PageHTMLParser(\n\t\t\tutil.parseHTML( PARSER_OUTPUT ).html( `\n\t\t\t\t<p>lead</p>\n\t\t\t\t<div class=\"ambox\">a0</div>\n\t\t\t\t<h2>1</h2>\n\t\t\t\t<div class=\"ambox\">a1</div>\n\t\t\t\t<h3>1.1</h3>\n\t\t\t\t<div class=\"ambox\">a1.1</div>\n\t\t\t` )\n\t\t);\n\t\tsectionPage = new PageHTMLParser(\n\t\t\tutil.parseHTML( PARSER_OUTPUT ).html( `\n\t\t\t\t<div class=\"mf-section-0\">\n\t\t\t\t\t<p>lead</p>\n\t\t\t\t\t<div class=\"ambox\">a0</div>\n\t\t\t\t</div>\n\n\t\t\t\t<h2 class=\"section-heading\">1</h2>\n\t\t\t\t<div class=\"mf-section-1\">\n\t\t\t\t\t<div class=\"ambox\">a1</div>\n\n\t\t\t\t\t<h3>1.1</h3>\n\t\t\t\t\t<div class=\"ambox\">a1.1</div>\n\n\t\t\t\t\t<h4>1.1.1</h4>\n\t\t\t\t\t<div class=\"ambox\">a1.1.1</div>\n\n\t\t\t\t\t<h4>1.1.2</h4>\n\t\t\t\t\t<div class=\"ambox\">a1.1.2</div>\n\n\t\t\t\t\t<h3>1.2</h3>\n\t\t\t\t\t<div class=\"ambox\">a1.1</div>\n\t\t\t\t</div>\n\n\t\t\t\t<h2 class=\"section-heading\">2</h2>\n\t\t\t\t<div class=\"mf-section-6\"><div class=\"ambox\">a2</div></div>\n\n\t\t\t\t<h2 class=\"section-heading\">3</h2>\n\t\t\t\t<div class=\"mf-section-7\"><div class=\"ambox\">a3</div></div>\n\n\t\t\t\t<h2 class=\"section-heading\">Section with nested Ambox</h2>\n\t\t\t\t<div class=\"mf-section-8\">\n\t\t\t\t\t<div class=\"ambox\">\n\t\t\t\t\t\t<p>nested-ambox-parent,</p>\n\t\t\t\t\t\t<div class=\"ambox\">nested-ambox-1,</div>\n\t\t\t\t\t\t<div class=\"ambox\">nested-ambox-2</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<h2 class=\"section-heading\">Sub-section with nested Ambox</h2>\n\t\t\t\t<div class=\"mf-section-9\">\n\t\t\t\t\t<div class=\"ambox\">\n\t\t\t\t\t\t<p>nested-ambox-parent,</p>\n\t\t\t\t\t\t<div class=\"ambox\">nested-ambox-1,</div>\n\t\t\t\t\t\t<div class=\"ambox\">nested-ambox-2</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<h3>subsection heading</h3>\n\n\t\t\t\t\t<h3>Another subsection heading</h3>\n\t\t\t\t</div>\n\t\t\t` ) // end .html()\n\t\t); // end new Page();\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#findInSectionLead', function ( assert ) {\n\t// check desktop page\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 1, 'a1', 'h2' ],\n\t\t[ 2, 'a1.1', 'h3' ],\n\t\t[ 3, '', 'h4', 'selector does not match', '.foo' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( params, i ) {\n\t\tconst\n\t\t\tsection = params[0],\n\t\t\texpect = params[1],\n\t\t\ttest = params[2],\n\t\t\tselector = params[3] || '.ambox';\n\t\tassert.strictEqual(\n\t\t\tdesktopPage.findChildInSectionLead( section, selector ).text(),\n\t\t\texpect,\n\t\t\t'Found correct text in desktop test ' + i + ' case: ' + test\n\t\t);\n\t} );\n\t// check stub\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 3, '', 'h4', 'selector does not match', '.foo' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( testcase ) {\n\t\tassert.strictEqual(\n\t\t\tstubPage.findChildInSectionLead( testcase[0], testcase[3] || '.ambox' ).text(),\n\t\t\ttestcase[1],\n\t\t\t'Stub: Found correct text in desktop test case:' + testcase[2]\n\t\t);\n\t} );\n\t// check mobile pages with section wrapping\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 1, 'a1', 'h2' ],\n\t\t[ 2, 'a1.1', 'h3' ],\n\t\t[ 3, 'a1.1.1', 'h4' ],\n\t\t[ 3, '', 'h4', 'selector does not match', '.foo' ],\n\t\t[ 7, 'a3', 'h2 later' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( testcase ) {\n\t\tassert.strictEqual(\n\t\t\tsectionPage.findChildInSectionLead( testcase[0], testcase[3] || '.ambox' ).text(),\n\t\t\ttestcase[1],\n\t\t\t'Mobile: Found correct text in test case:' + testcase[2]\n\t\t);\n\t} );\n\t[\n\t\t[ 0, 'a0', 'lead section' ],\n\t\t[ 1, 'a1', 'h2' ],\n\t\t[ 2, 'a1.1', 'h3' ],\n\t\t[ 111, '', 'Non-existent section' ]\n\t].forEach( function ( testcase ) {\n\t\tassert.strictEqual(\n\t\t\tmobileTocPage.findChildInSectionLead( testcase[0], testcase[3] || '.ambox' ).text(),\n\t\t\ttestcase[1],\n\t\t\t'Mobile with table of contents: Found correct text in test case:' + testcase[2]\n\t\t);\n\t} );\n\n\t[\n\t\t[ 8, '.ambox', /[\\s]*nested-ambox-parent,[\\s]*nested-ambox-1,\\s*nested-ambox-2[\\s]*/, 'Nested elements in section' ],\n\t\t[ 9, '.ambox', /[\\s]*nested-ambox-parent,[\\s]*nested-ambox-1,[\\s]*nested-ambox-2[\\s]*/, 'Nested elements in subsection' ]\n\t].forEach( function ( testcase ) {\n\t\tconst result = sectionPage.findChildInSectionLead( testcase[0], testcase[1] );\n\t\tsinon.assert.match(\n\t\t\tresult.not( result.children() ).text(),\n\t\t\ttestcase[2]\n\t\t);\n\t} );\n\n} );\n\nQUnit.test( '#getThumbnails', function ( assert ) {\n\tlet thumbs;\n\tconst p = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><a href=\"/wiki/File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t);\n\tconst textPage = new PageHTMLParser(\n\t\tutil.parseHTML( '<div></div>' )\n\t);\n\tconst pLegacyUrls = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t);\n\tthumbs = p.getThumbnails();\n\tconst pNoViewer = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box noviewer\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t);\n\tconst pMetadata = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" class=\"metadata\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t);\n\tconst pMetadataNested = new PageHTMLParser(\n\t\tutil.parseHTML( '<div class=\"noviewer\"><a href=\"/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" class=\"image view-border-box\"><img alt=\"Cyanolimnas cerverai by Allan Brooks cropped.jpg\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg\" width=\"300\" height=\"303\" data-file-width=\"454\" data-file-height=\"459\"></a></div>' )\n\t);\n\tconst pLazyImages = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><a href=\"/wiki/File:Design_portal_logo.jpg\" class=\"image\"><span class=\"lazy-image-placeholder\" style=\"width: 28px;height: 28px;\" data-src=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg\" data-alt=\"icon\" data-width=\"28\" data-height=\"28\" data-class=\"noviewer\">&nbsp;</span></a></div>' )\n\t);\n\tconst pLazyImagesTypo = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><a href=\"/wiki/File:Design_portal_logo.jpg\" class=\"image\"><span class=\"lazy-image-placeholder\" style=\"width: 28px;height: 28px;\" data-src=\"//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg\" data-alt=\"icon\" data-width=\"28\" data-height=\"28\" data-class=\"wot noviewerz bar\">&nbsp;</span></a></div>' )\n\t);\n\tconst metadataTable = new PageHTMLParser(\n\t\tutil.parseHTML( '<div><table class=\"plainlinks metadata ambox ambox-content ambox-Unreferenced\" role=\"presentation\"><tr><td class=\"mbox-image\"><div style=\"width:52px\"><a href=\"/wiki/File:Question_book-new.svg\" class=\"image\"><span class=\"lazy-image-placeholder\" style=\"width: 50px;height: 39px;\" data-src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/50px-Question_book-new.svg.png\" data-alt=\"\" data-width=\"50\" data-height=\"39\" data-srcset=\"https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/75px-Question_book-new.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/100px-Question_book-new.svg.png 2x\"> </span></a></div></td></tr></table>' )\n\t);\n\n\tassert.strictEqual( thumbs.length, 1, 'Found expected number of thumbnails.' );\n\tassert.strictEqual( thumbs[0].getFileName(), 'File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg',\n\t\t'Found expected filename.' );\n\n\tthumbs = textPage.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0, 'This page has no thumbnails.' );\n\n\tthumbs = pLegacyUrls.getThumbnails();\n\tassert.strictEqual( thumbs.length, 1, 'Found expected number of thumbnails.' );\n\tassert.strictEqual( thumbs[0].getFileName(), 'File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg',\n\t\t'Found expected filename.' );\n\n\tthumbs = pNoViewer.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0, 'This page has no thumbnails.' );\n\n\tthumbs = pMetadata.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0, 'This page has no thumbnails.' );\n\n\tthumbs = pMetadataNested.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0,\n\t\t'Images inside a container with the class are not included. Images inside tables for example.' );\n\n\tthumbs = pLazyImages.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0,\n\t\t'Consider whether the class is on an image which has not been lazy loaded.' );\n\n\tthumbs = metadataTable.getThumbnails();\n\tassert.strictEqual( thumbs.length, 0,\n\t\t'Consider whether the lazy loaded image is inside a .metadata container.' );\n\n\tthumbs = pLazyImagesTypo.getThumbnails();\n\tassert.strictEqual( thumbs.length, 1,\n\t\t'Thumbnail found if there is a typo.' );\n} );\n","const\n\tsinon = require( 'sinon' ),\n\too = require( '../utils/oo' );\nlet\n\tsandbox,\n\tScrollEndEventEmitter;\n\nQUnit.module( 'MobileFrontend ScrollEndEventEmitter.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\too.setUp( sandbox, global );\n\n\t\tScrollEndEventEmitter = require( '../../../src/mobile.startup/ScrollEndEventEmitter' );\n\t},\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'initializes properly', function ( assert ) {\n\tconst\n\t\teventBus = {\n\t\t\ton: sinon.spy()\n\t\t},\n\t\tis = new ScrollEndEventEmitter( eventBus, 500 ),\n\t\tis2 = new ScrollEndEventEmitter( eventBus );\n\n\tassert.strictEqual( is.enabled, true,\n\t\t'Emission is enabled by default' );\n\tassert.strictEqual( is.threshold, 500, 'Threshold is saved' );\n\tassert.strictEqual( is2.threshold, 100,\n\t\t'Without a threshold we get a default' );\n\tassert.strictEqual( eventBus.on.withArgs( 'scroll:throttled',\n\t\tis._scrollHandler ).calledOnce, true, 'Scrolling handler is bound' );\n} );\n\nQUnit.test( 'emits scroll end event', function ( assert ) {\n\tconst\n\t\teventBus = {\n\t\t\ton: function ( _, handler ) {\n\t\t\t\tthis.handler = handler;\n\t\t\t},\n\t\t\toff: function () {}\n\t\t},\n\t\tis = new ScrollEndEventEmitter( eventBus );\n\n\t// stub scrollNearEnd method because headless tests don't support scrolling\n\tsandbox.stub( is, 'scrollNearEnd' ).returns( true );\n\tis.setElement( {} );\n\n\tis.on( ScrollEndEventEmitter.EVENT_SCROLL_END, function () {\n\t\tassert.ok( true, 'scroll end event emitted' );\n\t} );\n\t// trigger stubbed 'scroll:throttled' event\n\teventBus.handler();\n} );\n\nQUnit.test( 'doesn\\'t emit when disabled', function ( assert ) {\n\tconst\n\t\temitSpy = sandbox.spy( ScrollEndEventEmitter.prototype, 'emit' ),\n\t\teventBus = {\n\t\t\ton: function ( _, handler ) {\n\t\t\t\tthis.handler = handler;\n\t\t\t},\n\t\t\toff: function () {}\n\t\t},\n\t\tis = new ScrollEndEventEmitter( eventBus );\n\tis.setElement( {} );\n\tis.disable();\n\n\t// trigger stubbed 'scroll:throttled' event\n\teventBus.handler();\n\tassert.strictEqual( emitSpy.called, false, 'emit should not be called' );\n} );\n","const\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' );\nlet\n\tSection,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend Section.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tSection = require( '../../../src/mobile.startup/Section' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'initialize with options', function ( assert ) {\n\tconst section = new Section( {\n\t\tlevel: '1',\n\t\tline: 'Line',\n\t\ttext: 'Text',\n\t\thasReferences: true,\n\t\tid: 'ID',\n\t\tanchor: 'Anchor'\n\t} );\n\n\tassert.strictEqual( section.line, 'Line', 'line is set' );\n\tassert.strictEqual( section.text, 'Text', 'text is set' );\n\tassert.strictEqual( section.hasReferences, true, 'hasReferences is set' );\n\tassert.strictEqual( section.id, 'ID', 'id is set' );\n\tassert.strictEqual( section.anchor, 'Anchor', 'anchor is set' );\n\tassert.strictEqual( section.subsections.length, 0, 'Subsections are empty' );\n} );\n\nQUnit.test( 'initialize with subsections', function ( assert ) {\n\tconst\n\t\tsection = new Section( {\n\t\t\tsubsections: [ {\n\t\t\t\tlevel: '',\n\t\t\t\tline: 'Line',\n\t\t\t\ttext: 'Text',\n\t\t\t\thasReferences: true,\n\t\t\t\tid: 'ID',\n\t\t\t\tanchor: 'Anchor'\n\t\t\t} ]\n\t\t} ),\n\t\tsubsection = section.subsections[ 0 ];\n\n\tassert.strictEqual( section.subsections.length, 1, 'Subsection is added to array' );\n\tassert.ok( subsection instanceof Section, 'Subsections are instances of Section' );\n\n\tassert.strictEqual( subsection.line, 'Line', 'line is set' );\n\tassert.strictEqual( subsection.text, 'Text', 'text is set' );\n\tassert.strictEqual( subsection.hasReferences, true, 'hasReferences is set' );\n\tassert.strictEqual( subsection.id, 'ID', 'id is set' );\n\tassert.strictEqual( subsection.anchor, 'Anchor', 'anchor is set' );\n\tassert.strictEqual( subsection.subsections.length, 0, 'Subsection children are empty' );\n} );\n","/* global $ */\nconst\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tmediawiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\tsectionTemplate = `\n\t\t<h2>\n\t\t\t<span class=\"mw-headline\" id=\"First_Section\">First Section</span>\n\t\t</h2>\n\t\t<section>\n\t\t\t<p>Text</p>\n\t\t</section>\n\t\t<h2 id=\"section_1\">\n\t\t\t<span class=\"mw-headline\"><a href=\"#foo\">Dummy Link</a></span>\n\t\t</h2>\n\t\t<section></section>\n\t\t<h2><span class=\"mw-headline\">References</span></h2>\n\t\t<section data-is-reference-section=\"1\">\n\t\t\t<ol class=\"references\">\n\t\t\t\t<li id=\"cite_note-1\">\n\t\t\t\t\t<span class=\"mw-cite-backlink\">\n\t\t\t\t\t\t<a href=\"#cite_ref-1\"></a>\n\t\t\t\t\t</span> <span class=\"reference-text\">hello</span>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</section>\n`;\nlet\n\tsandbox,\n\tbrowser,\n\tToggler;\n\n/**\n * Mobile toggling\n */\nQUnit.module( 'MobileFrontend Toggler.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tbrowser = require( '../../../src/mobile.startup/Browser' ).getSingleton();\n\t\tToggler = require( '../../../src/mobile.startup/Toggler' );\n\n\t\tsandbox.stub( mw.config, 'get' ).withArgs( 'wgMFCollapseSectionsByDefault' ).returns( true );\n\t\tsandbox.stub( browser, 'isWideScreen' ).returns( false );\n\n\t\tthis.page = { title: 'Toggle test' };\n\t\tthis.$container = $( '<section>' ).html( sectionTemplate );\n\t\tthis.$section0 = this.$container.find( 'h2' ).eq( 0 );\n\t\tthis.title = this.page.title;\n\t\tthis.headline = this.$section0.find( 'span' ).attr( 'id' );\n\t\tthis._session = mw.storage.session;\n\t\tmw.storage.session = {\n\t\t\tget: () => {},\n\t\t\tset: () => {},\n\t\t\tremove: () => {}\n\t\t};\n\t},\n\tafterEach: function () {\n\t\tmw.storage.remove( 'expandSections' );\n\t\tmw.storage.session.remove( 'expandedSections' );\n\t\tmw.storage.session = this._session;\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Mobile mode - Toggle section', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$section0,\n\t\t$content = this.$container.find( '.collapsible-block' ).eq( 0 );\n\n\ttoggle.toggle( $section, this.page );\n\n\tassert.strictEqual( $section.hasClass( 'open-block' ), true, 'open-block class present' );\n\n\ttoggle.toggle( $section, this.page );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content gets closed on a toggle' );\n\tassert.strictEqual( $section.hasClass( 'open-block' ), false, 'check section is closed' );\n\t// Perform second toggle\n\ttoggle.toggle( $section, this.page );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content reopened' );\n\tassert.strictEqual( $section.hasClass( 'open-block' ), true, 'check section has reopened' );\n} );\n\nQUnit.test( 'Mobile mode - Clicking a hash link to reveal an already open section', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} );\n\n\ttoggle.toggle( this.$section0, this.page );\n\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is open' );\n\ttoggle.reveal( 'First_Section', this.$container );\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is still open' );\n} );\n\nQUnit.test( 'Mobile mode - Reveal element', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} );\n\n\ttoggle.toggle( this.$section0, this.page );\n\n\ttoggle.reveal( 'First_Section' );\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 0 ).hasClass( 'open-block' ), true, 'check content is visible' );\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is open' );\n} );\n\nQUnit.test( 'Mobile mode - Clicking hash links', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} );\n\n\ttoggle.toggle( this.$section0, this.page );\n\n\tthis.$container.find( '[href=\"#First_Section\"]' ).trigger( 'click' );\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 0 ).hasClass( 'open-block' ), true, 'check content is visible' );\n\tassert.strictEqual( this.$section0.hasClass( 'open-block' ), true, 'check section is open' );\n} );\n\nQUnit.test( 'Mobile mode - Tap event toggles section', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$content = this.$container.find( '.collapsible-block' ).eq( 1 );\n\n\ttoggle.toggle( this.$section0, this.page );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\n\tthis.$container.find( '#section_1' ).trigger( 'click' );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content is shown on a toggle' );\n} );\n\nQUnit.test( 'Accessibility - Verify ARIA attributes', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$container.find( '#section_1' ),\n\t\t$headingLabel = this.$container.find( '.mw-headline' ).eq( 1 ),\n\t\t$content = this.$container.find( '.collapsible-block' ).eq( 1 );\n\n\ttoggle.toggle( this.$section0, this.page );\n\n\t// Test the initial state produced by the init function\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\tassert.strictEqual( $headingLabel.attr( 'aria-expanded' ), 'false', 'check aria-expanded is false at start' );\n\n\t// Test what the toggle() function gives us when hiding the section\n\t$section.trigger( 'click' );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content is visible after toggling' );\n\tassert.strictEqual( $headingLabel.attr( 'aria-expanded' ), 'true', 'check aria-expanded is true after toggling' );\n\n\t// Test what the toggle() function gives us when showing the section\n\t$section.trigger( 'click' );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden after toggling' );\n\tassert.strictEqual( $headingLabel.attr( 'aria-expanded' ), 'false', 'check aria-expanded is false after toggling' );\n} );\n\n/**\n * Tablet toggling\n */\nQUnit.test( 'Tablet mode - Open by default', function ( assert ) {\n\tbrowser.isWideScreen.returns( true );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 1 ).hasClass( 'open-block' ),\n\t\ttrue, 'check section is visible at start' );\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 2 ).hasClass( 'open-block' ),\n\t\tfalse, 'check reference section is hidden at start' );\n} );\n\n/**\n * Expand sections user setting\n */\nQUnit.test( 'Tablet mode - Open by default 2', function ( assert ) {\n\n\tmw.config.get.withArgs( 'wgMFCollapseSectionsByDefault' ).returns( false );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tassert.strictEqual( this.$container.find( '.collapsible-block' ).eq( 1 ).hasClass( 'open-block' ), true, 'check section is visible at start' );\n} );\n\n/**\n * Accessibility\n */\nQUnit.test( 'Accessibility - Pressing space/ enter toggles a heading', function ( assert ) {\n\tconst $section = this.$container.find( '#section_1' ),\n\t\tev = $.Event( 'keypress' );\n\n\tbrowser.isWideScreen.returns( false );\n\tmw.config.get.withArgs( 'wgMFCollapseSectionsByDefault' ).returns( true );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tconst $content = this.$container.find( '.collapsible-block' ).eq( 1 );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\n\t// Open the section with pressing space\n\tev.which = 32;\n\t$section.trigger( ev );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), true, 'check content is shown after pressing space' );\n\n\t// Enter should close the section again\n\tev.which = 13;\n\t$section.trigger( ev );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden after pressing enter' );\n} );\n\nQUnit.test( 'Clicking a link within a heading isn\\'t triggering a toggle', function ( assert ) {\n\n\tconst $section = $( '#section_1' ),\n\t\t$content = $( '.collapsible-block' ).eq( 1 );\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is hidden at start' );\n\n\t$section.find( '> a' ).eq( 0 ).trigger( 'mouseup' );\n\tassert.strictEqual( $content.hasClass( 'open-block' ), false, 'check content is still being hidden after clicking on the link' );\n} );\n\nQUnit.test( 'Toggling a section stores its state.', function ( assert ) {\n\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$container.find( 'h2' ),\n\t\texpandedSections = Toggler._getExpandedSections( this.page ),\n\t\tmwStorageSetSpy = sandbox.spy( mw.storage.session, 'set' );\n\n\tassert.strictEqual( $.isEmptyObject( expandedSections[ this.title ] ),\n\t\ttrue,\n\t\t'no user setting about an expanded section exists already'\n\t);\n\n\ttoggle.toggle( $section, this.page );\n\tconst mwStorageSetCall = JSON.parse( mwStorageSetSpy.getCall( 0 ).args[1] );\n\n\tassert.strictEqual( typeof mwStorageSetCall[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'the just toggled section state has been saved'\n\t);\n\n\ttoggle.toggle( $section, this.page );\n\tconst mwStorageSetCall2 = JSON.parse( mwStorageSetSpy.getCall( 1 ).args[1] );\n\n\tassert.strictEqual( mwStorageSetCall2[ this.title ][ this.headline ],\n\t\tundefined,\n\t\t'the just toggled section state has been removed'\n\t);\n\n} );\n\nQUnit.test( 'Check for and remove obsolete stored sections.', function ( assert ) {\n\tconst localStorageValue = {};\n\tlocalStorageValue[ this.title ] = {};\n\tlocalStorageValue[ this.title ][ this.headline ] = ( new Date( 1990, 1, 1 ) ).getTime();\n\n\tsandbox.stub( mw.storage.session, 'get' ).callsFake( function () {\n\t\treturn JSON.stringify( localStorageValue );\n\t} );\n\n\tconst expandedSections = Toggler._getExpandedSections( this.page );\n\tassert.strictEqual( typeof expandedSections[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'manually created section state has been saved correctly'\n\t);\n\n\tconst mwStorageSetSpy = sandbox.spy( mw.storage.session, 'set' );\n\n\tToggler._cleanObsoleteStoredSections( this.page );\n\tconst localStorageRemovalValue = JSON.stringify( [ 'expandedSections', '{\"Toggle test\":{}}' ] );\n\tassert.strictEqual(\n\t\tJSON.stringify( mwStorageSetSpy.getCall( 0 ).args ),\n\t\tlocalStorageRemovalValue,\n\t\t'section, whose store time is manually changed to an older date,' +\n\t\t\t'has been removed from storage correctly'\n\t);\n} );\n\nQUnit.test( 'Expanding already expanded section does not toggle it.', function ( assert ) {\n\tconst\n\t\ttoggle = new Toggler( {\n\t\t\teventBus: new OO.EventEmitter(),\n\t\t\t$container: this.$container,\n\t\t\tprefix: '',\n\t\t\tpage: this.page\n\t\t} ),\n\t\t$section = this.$container.find( 'h2' ),\n\t\texpandedSections = Toggler._getExpandedSections( this.page );\n\n\tassert.strictEqual( $.isEmptyObject( expandedSections[ this.title ] ),\n\t\ttrue,\n\t\t'no expanded sections are stored in localStorage yet'\n\t);\n\n\tassert.strictEqual(\n\t\t$section.hasClass( 'open-block' ),\n\t\tfalse,\n\t\t'section does not have open-block class'\n\t);\n\n\tconst mwStorageSetSpy = sandbox.spy( mw.storage.session, 'set' );\n\n\t// manually toggle the second section\n\ttoggle.toggle( $section, this.page );\n\n\tassert.strictEqual(\n\t\t$section.hasClass( 'open-block' ),\n\t\ttrue,\n\t\t'revealed section has open-block class'\n\t);\n\n\tToggler._getExpandedSections( this.page );\n\tconst mwStorageSetCall = JSON.parse( mwStorageSetSpy.getCall( 0 ).args[1] );\n\n\tassert.strictEqual( typeof mwStorageSetCall[this.title][ this.headline ],\n\t\t'number',\n\t\t'manually revealed section state has been correctly saved in localStorage'\n\t);\n\n\tToggler._expandStoredSections( toggle, this.$container, this.page );\n\n\tassert.strictEqual(\n\t\t$section.hasClass( 'open-block' ),\n\t\ttrue,\n\t\t'already revealed section still has open-block class after expanding sections'\n\t);\n} );\n\nQUnit.test( 'MobileFrontend toggle.js - Expand stored sections.', function ( assert ) {\n\n\tconst\n\t\t$section = this.$container.find( 'h2' ).eq( 0 ),\n\t\texpandedSections = Toggler._getExpandedSections( this.page );\n\n\t// Restore expanded sections only works on headings that are also section headings\n\tthis.$container.find( 'h2' ).addClass( 'section-heading' );\n\n\tassert.strictEqual( $section.hasClass( 'open-block' ), false, 'Section is collapsed.' );\n\n\tassert.strictEqual( $.isEmptyObject( expandedSections[ this.title ] ),\n\t\ttrue,\n\t\t'no user setting about an expanded section exists already'\n\t);\n\n\t// save a toggle state manually\n\texpandedSections[ this.title ][ this.headline ] = ( new Date() ).getTime();\n\n\tsandbox.stub( mw.storage.session, 'get' ).callsFake( function () {\n\t\treturn JSON.stringify( expandedSections );\n\t} );\n\tconst expandedSectionsFromToggle = Toggler._getExpandedSections( this.page );\n\tassert.strictEqual( typeof expandedSectionsFromToggle[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'manually created section state has been saved correctly'\n\t);\n\n\t/* eslint-disable-next-line no-new */\n\tnew Toggler( {\n\t\teventBus: new OO.EventEmitter(),\n\t\t$container: this.$container,\n\t\tprefix: '',\n\t\tpage: this.page\n\t} );\n\n\tconst expandedSections2 = Toggler._getExpandedSections( this.page );\n\tassert.strictEqual( typeof expandedSections2[ this.title ][ this.headline ],\n\t\t'number',\n\t\t'manually created section state is still active after toggle.init()'\n\t);\n\tassert.strictEqual( $section.hasClass( 'open-block' ), true,\n\t\t'Saved section has been auto expanded.' );\n\n} );\n","/* global $ */\nconst\n\tmw = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmfExtend = require( '../../../src/mobile.startup/mfExtend' ),\n\tutil = require( '../../../src/mobile.startup/util' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\nlet\n\tView;\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend mobile.startup/View', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tView = require( '../../../src/mobile.startup/View' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'View', function ( assert ) {\n\tconst el = document.createElement( 'div' ),\n\t\tview = new View( {\n\t\t\tel\n\t\t} );\n\tassert.strictEqual( view.$el[ 0 ].outerHTML, '<div class=\"view-border-box\"></div>',\n\t\t'Views use el and treat as CSS selector. view border box by default' );\n\tassert.strictEqual( view.$el[ 0 ].tagName.toUpperCase(), 'DIV', 'assign proper jQuery object to $el' );\n} );\n\nQUnit.test( 'View, jQuery proxy functions', function ( assert ) {\n\tconst view = new View( {\n\t\tel: 'body'\n\t} );\n\t[\n\t\t'append',\n\t\t'prepend',\n\t\t'appendTo',\n\t\t'prependTo',\n\t\t'after',\n\t\t'before',\n\t\t'insertAfter',\n\t\t'insertBefore',\n\t\t'remove',\n\t\t'detach'\n\t].forEach( function ( prop ) {\n\t\tconst stub = sandbox.stub( view.$el, prop );\n\t\tview[ prop ]( 'test', 1 );\n\t\tassert.ok( stub.calledWith( 'test', 1 ) );\n\t\tstub.restore();\n\t} );\n} );\n\nQUnit.test( 'View#preRender', function ( assert ) {\n\tfunction ChildView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( ChildView, View, {\n\t\ttemplate: util.template( '<p>{{text}}</p>' ),\n\t\tpreRender: function () {\n\t\t\tthis.options.text = 'hello';\n\t\t}\n\t} );\n\n\tconst view = new ChildView();\n\tassert.strictEqual( view.$el.html(), '<p>hello</p>', 'manipulate template data' );\n} );\n\nQUnit.test( 'View#postRender', function ( assert ) {\n\tconst spy = sandbox.spy();\n\tfunction ChildView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( ChildView, View, {\n\t\tpostRender: function () {\n\t\t\tspy();\n\t\t}\n\t} );\n\n\t// eslint-disable-next-line no-new\n\tnew ChildView();\n\tassert.strictEqual( spy.callCount, 1, 'invoke postRender' );\n} );\n\nQUnit.test( 'View#delegateEvents', function ( assert ) {\n\n\tfunction EventsView( props ) {\n\t\tView.call(\n\t\t\tthis,\n\t\t\tutil.extend(\n\t\t\t\t{\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'click p span': function ( ev ) {\n\t\t\t\t\t\t\tev.preventDefault();\n\t\t\t\t\t\t\tassert.ok( true, 'Span was clicked and handled' );\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'click p': 'onParagraphClick',\n\t\t\t\t\t\tclick: 'onClick'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tprops\n\t\t\t)\n\t\t);\n\t}\n\n\tmfExtend( EventsView, View, {\n\t\ttemplate: util.template( '<p><span>test</span></p>' ),\n\t\tonParagraphClick: function ( ev ) {\n\t\t\tev.preventDefault();\n\t\t\tassert.ok( true, 'Paragraph was clicked and handled' );\n\t\t},\n\t\tonClick: function ( ev ) {\n\t\t\tev.preventDefault();\n\t\t\tassert.ok( true, 'View was clicked and handled' );\n\t\t}\n\t} );\n\n\tconst view = new EventsView();\n\tview.appendTo( 'body' );\n\t// Check if events are set and handlers called\n\tview.$el.find( 'span' ).trigger( 'click' );\n\tview.$el.find( 'p' ).trigger( 'click' );\n\tview.$el.trigger( 'click' );\n\t// Check if events can be unset and handlers are not called\n\tview.undelegateEvents();\n\tview.$el.find( 'span' ).trigger( 'click' );\n\tview.$el.find( 'p' ).trigger( 'click' );\n\tview.$el.trigger( 'click' );\n} );\n\nQUnit.test( 'View#render (with isTemplateMode)', function ( assert ) {\n\tconst $parent = $( '<div>' );\n\tfunction TemplateModeView() {\n\t\tView.apply( this, arguments );\n\t}\n\n\tmfExtend( TemplateModeView, View, {\n\t\ttemplate: util.template( '<p class=\"foo\"><span>{{text}}</span></p>' ),\n\t\tisTemplateMode: true\n\t} );\n\n\tfunction ContainerView() {\n\t\tView.call( this, { className: 'bar' } );\n\t}\n\n\tmfExtend( ContainerView, View, {\n\t\ttemplate: util.template( '<p class=\"foo\"><span>test</span></p>' )\n\t} );\n\n\tconst view = new TemplateModeView();\n\tconst textFirstRun = view.$el.text();\n\tconst view2 = new ContainerView();\n\tview.render();\n\tview2.render();\n\t// attach to the DOM\n\tview.$el.appendTo( $parent );\n\t// and then do a second render...\n\tview.render( { text: 'hello' } );\n\tassert.ok( view.$el.hasClass( 'foo' ) );\n\tassert.ok( view2.$el.hasClass( 'bar' ) );\n\tassert.strictEqual( textFirstRun, '', 'first run, no text defined' );\n\tassert.strictEqual( view.$el.text(), 'hello', 'second run, text has been defined' );\n\tassert.strictEqual( view.$el.parent( $parent ).length, 1,\n\t\t'A re-rendered view thats attached to the DOM remains attached to the DOM' );\n} );\n\nQUnit.test( 'View#render events (with isTemplateMode)', function ( assert ) {\n\tfunction TemplateModeView( props ) {\n\t\tView.call(\n\t\t\tthis,\n\t\t\tutil.extend( { events: { 'click span': 'onClick' } }, props )\n\t\t);\n\t}\n\n\tmfExtend( TemplateModeView, View, {\n\t\tonClick: function () {\n\t\t\tthis.$el.empty().text( 'hello world' );\n\t\t},\n\t\ttemplate: util.template( '<p class=\"foo\"><span>test</span></p>' ),\n\t\tisTemplateMode: true\n\t} );\n\n\tconst view = new TemplateModeView();\n\t// trigger event\n\tview.$el.find( 'span' ).trigger( 'click' );\n\tassert.strictEqual( view.$el.text(), 'hello world', 'event was called' );\n\tassert.strictEqual( view.$el.find( 'span' ).length, 0, 'span disappeared' );\n\n\t// do same again but call render twice\n\tconst view2 = new TemplateModeView();\n\t// force a re-render\n\tview2.render();\n\t// trigger event to show events didn't get lost\n\tview2.$el.find( 'span' ).trigger( 'click' );\n\tassert.strictEqual( view2.$el.text(), 'hello world', 'event was called' );\n\tassert.strictEqual( view2.$el.find( 'span' ).length, 0, 'span disappeared' );\n} );\n\nQUnit.test( 'View with className option', function ( assert ) {\n\t[\n\t\t[\n\t\t\tnew View(),\n\t\t\t'view-border-box',\n\t\t\t'className not defined on a normal View without options and isBorderBox is default'\n\t\t],\n\t\t[\n\t\t\tnew View( {} ),\n\t\t\t'view-border-box',\n\t\t\t'className not defined on a normal View with empty options and isBorderBox is default'\n\t\t],\n\t\t[\n\t\t\tnew View( {\n\t\t\t\tclassName: 'banana'\n\t\t\t} ),\n\t\t\t'banana view-border-box',\n\t\t\t'option is passed to View (along with default isBorderBox property)'\n\t\t],\n\t\t[\n\t\t\tnew View( { isBorderBox: false } ),\n\t\t\tundefined,\n\t\t\t'Passing isBorderBox option removes default view-border-box class'\n\t\t],\n\t\t[\n\t\t\tnew View( { isBorderBox: true } ),\n\t\t\t'view-border-box',\n\t\t\t'Passing isBorderBox option as true retains default view-border-box class'\n\t\t]\n\t].forEach( function ( test ) {\n\t\tassert.strictEqual( test[0].$el.attr( 'class' ), test[1], test[2] );\n\t} );\n} );\n\nQUnit.test( 'View.make()', function ( assert ) {\n\tconst view = View.make( { className: 'foo' }, [ util.parseHTML( '<div>' ).text( 'hello' ) ] );\n\tassert.strictEqual( view.$el.find( '> div' ).text().trim(), 'hello', 'view created with element' );\n} );\n","let\n\tAmcEnableForm,\n\tsandbox;\nconst\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\too = require( '../../utils/oo' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend amcOutreach/AmcEnableForm.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tAmcEnableForm = require( '../../../../src/mobile.startup/amcOutreach/AmcEnableForm' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'renders correctly', function ( assert ) {\n\tconst subject = new AmcEnableForm( {\n\t\tpostUrl: 'https://foo.com',\n\t\tfields: [\n\t\t\t{\n\t\t\t\tname: 'f1name',\n\t\t\t\tvalue: 'f1value'\n\t\t\t},\n\t\t\t{\n\t\t\t\tname: 'f2name',\n\t\t\t\tvalue: 'f2value'\n\t\t\t}\n\t\t],\n\t\tbuttonLabel: 'Submit'\n\t} );\n\n\tassert.strictEqual( subject.$el.is( 'form' ), true, 'Form is rendered' );\n\tassert.strictEqual( subject.$el.attr( 'action' ), 'https://foo.com', 'Form action is passed in postUrl' );\n\tassert.strictEqual( subject.$el.attr( 'method' ), 'POST', 'Form method is POST' );\n\tassert.strictEqual( subject.$el.find( 'input[name=\\'f1name\\'][value=\\'f1value\\']' ).length, 1, 'Field 1 is rendered' );\n\tassert.strictEqual( subject.$el.find( 'input[name=\\'f2name\\'][value=\\'f2value\\']' ).length, 1, 'Field 2 is rendered' );\n\tassert.strictEqual( subject.$el.find( 'button' ).length, 1, 'Submit button is rendered' );\n\tassert.strictEqual( subject.$el.find( 'button' ).text(), 'Submit', 'Submit button has label' );\n} );\n","let\n\tamcOutreachDrawer,\n\tDrawer,\n\tsandbox;\nconst\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\too = require( '../../utils/oo' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend amcOutreachDrawer.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tamcOutreachDrawer = require( '../../../../src/mobile.startup/amcOutreach/amcOutreachDrawer' );\n\t\tDrawer = require( '../../../../src/mobile.startup/Drawer' );\n\n\t\t// jsdom will throw \"Not implemented\" errors if we don't stub\n\t\t// HTMLFormElement.prototypesubmit\n\t\tsandbox.stub( global.window.HTMLFormElement.prototype, 'submit' );\n\n\t\tthis.promoCampaign = {\n\t\t\tmakeActionIneligible: sinon.stub().returns( true )\n\t\t};\n\t\tthis.toast = {\n\t\t\tshowOnPageReload: sinon.stub(),\n\t\t\tshow: sinon.stub()\n\t\t};\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'returns a drawer', function ( assert ) {\n\tconst subject = amcOutreachDrawer(\n\t\t'onLoad',\n\t\tthis.promoCampaign,\n\t\t() => {\n\t\t\treturn {\n\t\t\t\tparse: () => 'parse',\n\t\t\t\ttext: () => ''\n\t\t\t};\n\t\t},\n\t\t{\n\t\t\tgetUrl: () => 'getUrl'\n\t\t},\n\t\tthis.toast,\n\t\t'token',\n\t\t() => {},\n\t\t''\n\t);\n\n\tassert.ok( subject instanceof Drawer, 'it initializes the correct class' );\n} );\n\nQUnit.test( 'calls promoCampaign.makeActionIneligible and onBeforeHide callback when dismissed', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tonBeforeHide = sinon.stub(),\n\t\tdrawer = amcOutreachDrawer(\n\t\t\t'onLoad',\n\t\t\tthis.promoCampaign,\n\t\t\t() => {\n\t\t\t\treturn {\n\t\t\t\t\tparse: () => 'parse',\n\t\t\t\t\ttext: () => ''\n\t\t\t\t};\n\t\t\t},\n\t\t\t{\n\t\t\t\tgetUrl: () => 'getUrl'\n\t\t\t},\n\t\t\tthis.toast,\n\t\t\t'token',\n\t\t\tonBeforeHide,\n\t\t\t''\n\t\t);\n\n\tassert.strictEqual( this.promoCampaign.makeActionIneligible.notCalled, true, 'not called before dismissal' );\n\tassert.strictEqual( onBeforeHide.notCalled, true, 'onBeforeHide not called before dismissal' );\n\tdrawer.$el.find( '.cancel' ).first().trigger( 'click' );\n\n\t// unfortunately, since Drawer's hide method is async, we need this test to be\n\t// async as well\n\tsetTimeout( () => {\n\t\tassert.strictEqual( this.promoCampaign.makeActionIneligible.calledWith(\n\t\t\t'onLoad' ), true, 'promoCampaign.makeActionIneligible after dismissal' );\n\t\tassert.strictEqual( onBeforeHide.called, true, 'onBeforeHide called after dismissal' );\n\t\tdone();\n\t}, Drawer.prototype.minHideDelay );\n} );\n\nQUnit.test( 'calls promoCampaign.makeActionIneligible and toast.showOnPageReload when user enables', function ( assert ) {\n\tconst\n\t\tonBeforeHide = sinon.stub(),\n\t\tdrawer = amcOutreachDrawer(\n\t\t\t'onLoad',\n\t\t\tthis.promoCampaign,\n\t\t\t() => {\n\t\t\t\treturn {\n\t\t\t\t\tparse: () => 'parse',\n\t\t\t\t\ttext: () => ''\n\t\t\t\t};\n\t\t\t},\n\t\t\t{\n\t\t\t\tgetUrl: () => 'getUrl'\n\t\t\t},\n\t\t\tthis.toast,\n\t\t\t'token',\n\t\t\tonBeforeHide,\n\t\t\t''\n\t\t);\n\n\tassert.strictEqual( this.promoCampaign.makeActionIneligible.notCalled, true,\n\t\t'promoCampaign.makeActionIneligible not called before form submission' );\n\tassert.strictEqual( this.toast.showOnPageReload.notCalled, true,\n\t\t'toast.showOnPageReload not called before form submission' );\n\tdrawer.$el.find( 'form' ).trigger( 'submit' );\n\n\tassert.strictEqual( this.promoCampaign.makeActionIneligible.calledWith( 'onLoad' ), true,\n\t\t'promoCampaign.makeActionIneligible called on form submission' );\n\n\tassert.strictEqual( this.toast.showOnPageReload.called, true,\n\t\t'toast.showOnPageReload called on form submission' );\n\tassert.strictEqual( onBeforeHide.notCalled, true,\n\t\t'onBeforeHide not called on form submission' );\n} );\n","const cache = require( '../../../src/mobile.startup/cache' ),\n\tMemoryCache = cache.MemoryCache,\n\tmemoryCache = new MemoryCache();\n\nQUnit.module( 'MobileFrontend cache.js' );\n\nQUnit.test( 'cache set() and get()', function ( assert ) {\n\tmemoryCache.set( 'key', 'value' );\n\tassert.strictEqual( memoryCache.get( 'key' ), 'value' );\n} );\n","let sandbox, extendSearchParams;\nconst\n\tjQuery = require( '../utils/jQuery' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tdom = require( '../utils/dom' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend extendSearchParams.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tsandbox.stub( mw.config, 'get' )\n\t\t\t.withArgs( 'wgMFSearchAPIParams' ).returns(\n\t\t\t\t{\n\t\t\t\t\tfoo: 'bar'\n\t\t\t\t}\n\t\t\t)\n\t\t\t.withArgs( 'wgMFDisplayWikibaseDescriptions' ).returns(\n\t\t\t\t{\n\t\t\t\t\tsearch: true,\n\t\t\t\t\tnearby: false\n\t\t\t\t}\n\t\t\t)\n\t\t\t.withArgs( 'wgMFQueryPropModules' ).returns( [ 'baz' ] );\n\t\textendSearchParams = require( '../../../src/mobile.startup/extendSearchParams' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'it throws if the feature is invalid', function ( assert ) {\n\tconst expectedError = new Error( '\"foo\" isn\\'t a feature that shows Wikibase descriptions.' );\n\n\tassert.throws( function () {\n\t\textendSearchParams( 'foo', {} );\n\t}, expectedError );\n} );\n\nQUnit.test( 'it extends the parameters', function ( assert ) {\n\tconst params = extendSearchParams( 'search', {\n\t\t\tqux: 'quux',\n\t\t\tprop: [ 'corge' ]\n\t\t} ),\n\t\texpectedParams = {\n\t\t\taction: 'query',\n\t\t\tformatversion: 2,\n\t\t\tqux: 'quux',\n\t\t\tfoo: 'bar', // from wgMFSearchAPIParams\n\t\t\tprop: [ 'corge', 'baz', 'description' ] // from wgMFQueryPropModules and Wikibase-specific\n\t\t};\n\n\tassert.propEqual( params, expectedParams );\n} );\n\nQUnit.test( 'it doesn\\'t include Wikibase-specific parameters if the feature is disabled', function ( assert ) {\n\tconst params = extendSearchParams( 'nearby', {\n\t\tqux: 'quux'\n\t} );\n\n\tassert.strictEqual( params.prop.indexOf( 'description' ), -1 );\n\tassert.strictEqual( params.wbptterms, undefined );\n} );\n\nQUnit.test( 'it adds the MobileFrontend configuration to given terms types', function ( assert ) {\n\tconst params = extendSearchParams( 'search', {\n\t\twbptterms: 'grault'\n\t} );\n\n\tassert.strictEqual(\n\t\tparams.wbptterms,\n\t\t'grault',\n\t\t'The given \"wbptterms\" is added to the default.'\n\t);\n} );\n\nQUnit.test( 'it prioritizes MobileFrontend configuration', function ( assert ) {\n\tconst params = extendSearchParams( 'search', {\n\t\t\tfoo: 'quux'\n\t\t} ),\n\t\texpectedParams = {\n\t\t\taction: 'query',\n\t\t\tformatversion: 2,\n\t\t\tfoo: 'bar',\n\t\t\tprop: [ 'baz', 'description' ]\n\t\t};\n\n\tassert.propEqual(\n\t\tparams,\n\t\texpectedParams,\n\t\t'The value of \"foo\" is overridden by the configuration.'\n\t);\n} );\n\nQUnit.test( 'it is variadic', function ( assert ) {\n\tconst params = extendSearchParams(\n\t\t\t'search',\n\t\t\t{\n\t\t\t\tbaz: 'qux'\n\t\t\t},\n\t\t\t{\n\t\t\t\tquux: 'corge'\n\t\t\t}\n\t\t),\n\t\texpectedParams = {\n\t\t\taction: 'query',\n\t\t\tformatversion: 2,\n\t\t\tfoo: 'bar',\n\t\t\tbaz: 'qux',\n\t\t\tquux: 'corge',\n\t\t\tprop: [ 'baz', 'description' ]\n\t\t};\n\n\tassert.propEqual( params, expectedParams );\n} );\n","let sandbox, icons, spy;\nconst\n\tsinon = require( 'sinon' ),\n\tdom = require( '../utils/dom' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' );\n\nQUnit.module( 'MobileFrontend icons.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\ticons = require( '../../../src/mobile.startup/icons' );\n\t\tspy = sandbox.spy( icons, 'Icon' );\n\t},\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t\tjQuery.tearDown();\n\t}\n} );\n\nQUnit.test( '#cancel()', function ( assert ) {\n\ticons.cancel();\n\tassert.propEqual( spy.getCall( 0 ).args[ 0 ], {\n\t\ttagName: 'button',\n\t\tname: icons.CANCEL_GLYPH + '-base20',\n\t\tadditionalClassNames: 'cancel',\n\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' ),\n\t\tisTypeButton: true\n\t}, 'Options are passed down' );\n} );\n\nQUnit.test( '#cancel(variant)', function ( assert ) {\n\ticons.cancel( 'gray' );\n\tassert.propEqual( spy.getCall( 0 ).args[ 0 ], {\n\t\ttagName: 'button',\n\t\tname: icons.CANCEL_GLYPH + '-gray',\n\t\tadditionalClassNames: 'cancel',\n\t\tlabel: mw.msg( 'mobile-frontend-overlay-close' ),\n\t\tisTypeButton: true\n\t}, 'Options are passed down' );\n} );\n\nQUnit.test( '#spinner()', function ( assert ) {\n\ticons.spinner( {\n\t\tfoo: 'will be passed down',\n\t\tadditionalClassNames: 'will-not-be-ignored'\n\t} );\n\tassert.propEqual( spy.getCall( 0 ).args[ 0 ], {\n\t\tfoo: 'will be passed down',\n\t\tadditionalClassNames: 'will-not-be-ignored',\n\t\tname: 'spinner',\n\t\tlabel: mw.msg( 'mobile-frontend-loading-message' )\n\t}, 'Options are passed down' );\n} );\n","let\n\tsandbox;\nconst\n\tgetDeviceLanguage = require( '../../../../src/mobile.startup/languageOverlay/getDeviceLanguage' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend getDeviceLanguage', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t},\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'returns language code of device in lowercase', function ( assert ) {\n\tconst cases = [\n\t\t[ {}, undefined ],\n\t\t[ { languages: [ 'en-US' ] }, 'en-us' ],\n\t\t[ { language: 'en-US' }, 'en-us' ],\n\t\t[ { userLanguage: 'en-US' }, 'en-us' ],\n\t\t[ { browserLanguage: 'en-US' }, 'en-us' ],\n\t\t[ { systemLanguage: 'en-US' }, 'en-us' ]\n\t];\n\n\tcases.forEach( function ( testCase ) {\n\t\tconst result = getDeviceLanguage( testCase[ 0 ] );\n\t\tassert.strictEqual( result, testCase[1], 'returns correct code' );\n\t} );\n} );\n","let\n\tlanguageOverlay,\n\tLanguageSearcher,\n\tsandbox;\nconst\n\theadless = typeof window !== 'object',\n\tm = require( '../../../../src/mobile.startup/moduleLoaderSingleton' ),\n\tutil = require( '../../../../src/mobile.startup/util' ),\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\too = require( '../../utils/oo' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend languageOverlay.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tLanguageSearcher = require( '../../../../src/mobile.languages.structured/LanguageSearcher' );\n\t\tlanguageOverlay = require( '../../../../src/mobile.startup/languageOverlay/languageOverlay' );\n\n\t\tsandbox.stub( mw, 'msg' )\n\t\t\t.withArgs( 'mobile-frontend-language-heading' ).returns( '' )\n\t\t\t.withArgs( 'mobile-frontend-loading-message' ).returns( '' )\n\t\t\t.withArgs( 'mobile-frontend-languages-structured-overlay-all-languages-header' ).returns( '' )\n\t\t\t.withArgs( 'mobile-frontend-languages-structured-overlay-suggested-languages-header' ).returns( '' );\n\t\tsandbox.stub( mw.loader, 'using' ).withArgs( 'mobile.languages.structured' ).returns( util.Deferred().resolve() );\n\n\t\t// languageOverlay uses a global navigator so we need to stub it for headless tests\n\t\tif ( headless ) {\n\t\t\tglobal.navigator = global.navigator || undefined;\n\t\t\tsandbox.stub( global, 'navigator' ).callsFake( () => {} );\n\t\t}\n\n\t\tsandbox.stub( m, 'require' ).withArgs( 'mobile.languages.structured/LanguageSearcher' ).returns( LanguageSearcher );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#constructor', function ( assert ) {\n\tconst\n\t\tgatewayDeferred = util.Deferred().resolve( {\n\t\t\tlanguages: [],\n\t\t\tvariants: []\n\t\t} ),\n\t\tgateway = {\n\t\t\tgetPageLanguages: function () {\n\t\t\t\treturn gatewayDeferred;\n\t\t\t}\n\t\t},\n\t\toverlay = languageOverlay( gateway );\n\n\tassert.strictEqual( overlay.$el.find( '.overlay-content > .promised-view' ).text(), '', 'loading view rendered in .overlay-content' );\n\n\treturn languageOverlay.test.loadLanguageSearcher( gateway ).then( function () {\n\t\tassert.strictEqual( overlay.$el.find( '.overlay-content > .promised-view' ).length, 0, 'promisedView has fulfilled its promise' );\n\t\tassert.strictEqual( overlay.$el.find( '.overlay-content > .language-searcher' ).length, 1, 'loaded view rendered in .overlay-content' );\n\t} );\n} );\n","const\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\tlazyImageLoader = require( '../../../../src/mobile.startup/lazyImages/lazyImageLoader' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tsinon = require( 'sinon' );\nlet\n\tsandbox;\n\nQUnit.module( 'MobileFrontend lazyImageLoader.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global ); // Needed for Deferreds.\n\t\tmediaWiki.setUp( sandbox, global ); // util.Deferred() uses mw.log().\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n}, function () {\n\tQUnit.test( '#queryPlaceholders() empty', function ( assert ) {\n\t\tconst\n\t\t\troot = document.createElement( 'div' ),\n\t\t\tactual = lazyImageLoader.queryPlaceholders( root );\n\t\tassert.propEqual( actual, [], 'The result is empty.' );\n\t} );\n\n\tQUnit.test( '#queryPlaceholders() nonempty', function ( assert ) {\n\t\tconst\n\t\t\troot = document.createElement( 'div' ),\n\t\t\tplaceholder = document.createElement( 'div' );\n\t\t// eslint-disable-next-line mediawiki/class-doc\n\t\tplaceholder.className = lazyImageLoader.test.placeholderClass;\n\t\troot.appendChild( placeholder );\n\n\t\tconst actual = lazyImageLoader.queryPlaceholders( root );\n\t\tassert.propEqual( actual, [ placeholder ], 'The result is nonempty.' );\n\t} );\n\n\tQUnit.test( '#loadImage() copy attributes', function ( assert ) {\n\t\tconst\n\t\t\tattrs = {\n\t\t\t\twidth: '1',\n\t\t\t\theight: '2',\n\t\t\t\tclass: 'class',\n\t\t\t\talt: 'alt',\n\t\t\t\tsrc: '/src',\n\t\t\t\tsrcset: '/srcset',\n\t\t\t\tusemap: '#map'\n\t\t\t},\n\t\t\tplaceholder = document.createElement( 'div' );\n\t\t// Placeholder className is not copied (class), style (not data-style) is.\n\t\t// eslint-disable-next-line mediawiki/class-doc\n\t\tplaceholder.className = lazyImageLoader.test.placeholderClass;\n\t\tplaceholder.style.width = '3px';\n\t\tObject.keys( attrs ).forEach( function ( name ) {\n\t\t\tplaceholder.setAttribute( 'data-' + name, attrs[name] );\n\t\t} );\n\n\t\tconst result = lazyImageLoader.loadImage( placeholder );\n\n\t\tObject.keys( attrs ).forEach( function ( name ) {\n\t\t\tassert.strictEqual( result.image.getAttribute( name ), attrs[name], name + ' is set.' );\n\t\t} );\n\t\tassert.strictEqual( result.image.style.width, '3px', 'Style from placeholder is set.' );\n\t} );\n\n\tQUnit.test( '#loadImage() loaded', function ( assert ) {\n\t\tconst\n\t\t\tplaceholder = document.createElement( 'div' );\n\n\t\tconst result = lazyImageLoader.loadImage( placeholder );\n\t\tresult.image.dispatchEvent( new Event( 'load' ) );\n\t\treturn result.promise.then( function ( status ) {\n\t\t\tassert.strictEqual( status, 'load', 'Promise resolves on load.' );\n\t\t} );\n\t} );\n\n\tQUnit.test( '#loadImage() load error', function ( assert ) {\n\t\tconst\n\t\t\tplaceholder = document.createElement( 'div' );\n\n\t\tconst result = lazyImageLoader.loadImage( placeholder );\n\t\tresult.image.dispatchEvent( new Event( 'error' ) );\n\t\treturn result.promise.then( function ( status ) {\n\t\t\tassert.strictEqual( status, 'error', 'Promise resolves even on error.' );\n\t\t} );\n\t} );\n\n\tQUnit.test( '#loadImages() empty', function ( assert ) {\n\t\treturn lazyImageLoader.loadImages( [] ).then( function () {\n\t\t\tassert.ok( true, 'Promise resolves.' );\n\t\t} );\n\t} );\n\n\tQUnit.test( '#loadImages() nonempty', function ( assert ) {\n\t\tconst\n\t\t\tplaceholder = document.createElement( 'div' ),\n\t\t\timage = new Image();\n\n\t\tsandbox.stub( global, 'Image' ).returns( image );\n\t\tconst deferred = lazyImageLoader.loadImages( [ placeholder ] ).then( function () {\n\t\t\tassert.ok( true, 'Promise resolves.' );\n\t\t} );\n\t\timage.dispatchEvent( new Event( 'load' ) );\n\n\t\treturn deferred;\n\t} );\n\n\tQUnit.test( '#loadImages() plural', function ( assert ) {\n\t\tconst\n\t\t\tplaceholder = document.createElement( 'div' ),\n\t\t\timage = new Image();\n\n\t\tsandbox.stub( global, 'Image' ).returns( image );\n\t\tconst deferred = lazyImageLoader.loadImages( [ placeholder, placeholder ] ).then(\n\t\t\tfunction () { assert.ok( true, 'Promise resolves.' ); }\n\t\t);\n\t\timage.dispatchEvent( new Event( 'load' ) );\n\n\t\treturn deferred;\n\t} );\n\n\tQUnit.test( '#loadImages() one fails to load, one succeeds', function ( assert ) {\n\t\tconst\n\t\t\tplaceholder = document.createElement( 'div' ),\n\t\t\tfailureImage = new Image(),\n\t\t\tsuccessImage = new Image();\n\n\t\tsandbox\n\t\t\t.stub( global, 'Image' )\n\t\t\t.onFirstCall().returns( failureImage )\n\t\t\t.onSecondCall().returns( successImage );\n\t\tconst deferred = lazyImageLoader.loadImages( [ placeholder, placeholder ] ).then(\n\t\t\tfunction () { assert.ok( true, 'Promise resolves.' ); }\n\t\t);\n\t\tfailureImage.dispatchEvent( new Event( 'error' ) );\n\t\tsuccessImage.dispatchEvent( new Event( 'load' ) );\n\n\t\treturn deferred;\n\t} );\n\n} );\n","let mfExtend;\nconst\n\tsinon = require( 'sinon' ),\n\too = require( '../utils/oo' );\n\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend mfExtend.test.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\too.setUp( sandbox, global );\n\t\tmfExtend = require( '../../../src/mobile.startup/mfExtend' );\n\t},\n\tafterEach: function () { sandbox.restore(); }\n} );\n\nQUnit.test( 'mfExtend() - extending from constructor', function ( assert ) {\n\tfunction TestChild() {}\n\tfunction TestPrototype() {}\n\tmfExtend( TestChild, TestPrototype, {} );\n\tassert.ok( TestChild.prototype instanceof TestPrototype );\n} );\n\nQUnit.test( 'mfExtend() - extending from object', function ( assert ) {\n\tconst testPrototype = new TestPrototype();\n\tfunction TestChild() {}\n\tfunction TestPrototype() {\n\t\tthis.protoMethod = function () {\n\t\t\treturn true;\n\t\t};\n\t}\n\tmfExtend( TestChild, testPrototype );\n\tconst testChild = new TestChild();\n\tassert.strictEqual( testChild.protoMethod(), true );\n} );\n\nQUnit.test( 'mfExtend() - extending from constructor with overrides', function ( assert ) {\n\tfunction TestChild() {}\n\tfunction TestPrototype() {\n\t\tthis.protoMethod = function () {\n\t\t\treturn true;\n\t\t};\n\t}\n\tmfExtend( TestChild, TestPrototype, {\n\t\tprotoMethod: function () {\n\t\t\treturn false;\n\t\t}\n\t} );\n\tconst testChild = new TestChild();\n\tassert.strictEqual( testChild.protoMethod(), false );\n} );\n","let\n\tModuleLoader;\nconst\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend ModuleLoader', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\too.setUp( sandbox, global );\n\n\t\tModuleLoader = require( '../../../src/mobile.startup/moduleLoader' );\n\t\tthis.loader = new ModuleLoader();\n\t},\n\tafterEach: function () { sandbox.restore(); }\n} );\n\nQUnit.test( '#require', function ( assert ) {\n\tthis.loader.define( 'foo', 1 );\n\tthis.loader.define( 'bar', 5 );\n\n\tassert.strictEqual( this.loader.require( 'foo' ), 1, 'Returns appropriate module' );\n\tassert.strictEqual( this.loader.require( 'bar' ), 5, 'Returns appropriate module' );\n\n\tassert.throws( function () {\n\t\tthis.loader.require( 'undefinedmodule' );\n\t}, 'Cannot require an undefined module.' );\n\tassert.throws( function () {\n\t\tthis.loader.require( 'mobile.modules/Foo' );\n\t}, 'Cannot require an undefined export on a known module.' );\n} );\n\nQUnit.test( '#define', function ( assert ) {\n\tconst loader = this.loader;\n\tloader.define( 'foo', 1 );\n\tloader.define( 'bar', 5 );\n\tassert.throws( function () {\n\t\tloader.define( 'bar', 50 );\n\t}, 'Cannot define two modules with the same name' );\n\tassert.strictEqual( this.loader.require( 'bar' ), 5, 'Returns first definition of module.' );\n} );\n","const dom = require( '../../utils/dom' );\nconst jQuery = require( '../../utils/jQuery' );\nconst mw = require( '../../utils/mw' );\nconst oo = require( '../../utils/oo' );\nlet Page;\nlet pageJSONParser;\nconst sinon = require( 'sinon' );\nlet sandbox;\n\nQUnit.module( 'MobileFrontend pageJSONParser', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\tPage = require( '../../../../src/mobile.startup/Page' );\n\t\tpageJSONParser = require( '../../../../src/mobile.startup/page/pageJSONParser' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '.parse()', function ( assert ) {\n\tconst p = new Page( {\n\t\t\ttitle: '<script>alert(\"oops, XSS possible!\");</script>'\n\t\t} ),\n\t\ttitleJSON = [\n\t\t\t{\n\t\t\t\tthumbnail: false,\n\t\t\t\ttitle: '<script>alert(\"oops, XSS possible!\");</script>',\n\t\t\t\tterms: false,\n\t\t\t\ttestDesc: 'Check against XSS in pageJSONParser.parse displaytitle (when title set)'\n\t\t\t},\n\t\t\t{\n\t\t\t\tthumbnail: false,\n\t\t\t\tpageprops: [],\n\t\t\t\tterms: {\n\t\t\t\t\tlabel: [\n\t\t\t\t\t\t'<script>alert(\"oops, XSS possible!\");</script>'\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\ttestDesc: 'Check against XSS in pageJSONParser.parse displaytitle (when Wikibase label set)'\n\t\t\t}\n\t\t];\n\n\tassert.strictEqual(\n\t\tp.getDisplayTitle(),\n\t\t'&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;',\n\t\t'Check against XSS in Page.js constructor displaytitle (when title set)'\n\t);\n\n\ttitleJSON.forEach( function ( json ) {\n\t\tconst p = pageJSONParser.parse( json );\n\n\t\tassert.strictEqual(\n\t\t\tp.getDisplayTitle(),\n\t\t\t'&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;',\n\t\t\tjson.testDesc\n\t\t);\n\t} );\n} );\n","let promisedView, View,\n\tsandbox, happyView;\nconst\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\too = require( '../utils/oo' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend promisedView.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tView = require( './../../../src/mobile.startup/View' );\n\t\tpromisedView = require( './../../../src/mobile.startup/promisedView' );\n\t\thappyView = new View( {\n\t\t\tisBorderBox: false,\n\t\t\tclassName: 'test'\n\t\t} );\n\t\thappyView.append( '' );\n\t\tsandbox.stub( mw, 'msg' ).withArgs( 'mobile-frontend-loading-message' ).returns( '' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#constructor happyView', function ( assert ) {\n\tconst promise = util.Deferred(),\n\t\tviewSuccess = promisedView( promise );\n\n\tassert.strictEqual( viewSuccess.$el.text(), '', 'the view is waiting to resolve' );\n\tassert.ok( viewSuccess.$el.hasClass( 'promised-view' ), 'parent element has loading class when loading' );\n\tpromise.resolve( happyView );\n\treturn promise.then( function () {\n\t\tassert.strictEqual( viewSuccess.$el.attr( 'class' ), 'test', 'fully replaces its parent element with happyView\\'s parent element' );\n\t\tassert.strictEqual( viewSuccess.$el.text(), '', 'the view resolved correctly' );\n\t} );\n} );\n\nQUnit.test( '#constructor when promise rejects but not to a sadView', function ( assert ) {\n\tconst\n\t\tpromise = util.Deferred().reject( new Error( 'fake test error' ) ),\n\t\tviewFailure = promisedView( promise );\n\n\tassert.strictEqual( viewFailure.$el.text(), '', 'the view is waiting to resolve' );\n\tassert.ok( viewFailure.$el.hasClass( 'promised-view' ), 'parent element has loading class when loading' );\n\n\treturn promise.catch( function () {\n\t\tassert.strictEqual( viewFailure.$el.text(), '', 'the view still shows the loading icon' );\n\t} );\n} );\n\nQUnit.test( '#constructor when promise rejects to a sadView', function ( assert ) {\n\tconst\n\t\tsadView = new View( {\n\t\t\tisBorderBox: false,\n\t\t\tclassName: 'error'\n\t\t} ),\n\t\tpromise = util.Deferred().reject( sadView ),\n\t\tviewFailure = promisedView( promise );\n\n\tsadView.append( '' );\n\n\tassert.strictEqual( viewFailure.$el.text(), '', 'the view is waiting to resolve' );\n\tassert.ok( viewFailure.$el.hasClass( 'promised-view' ), 'parent element has loading class when loading' );\n\n\treturn promise.catch( function () {\n\t\tassert.strictEqual( viewFailure.$el.attr( 'class' ), 'error', 'fully replaces its parent element with sadView\\'s parent element' );\n\t\tassert.strictEqual( viewFailure.$el.text(), '', 'the view resolved correctly' );\n\t} );\n} );\n","let\n\tpromoCampaign,\n\tsandbox;\nconst\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\too = require( '../../utils/oo' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tsinon = require( 'sinon' ),\n\tACTIONS = {\n\t\tonLoad: 'onLoad'\n\t},\n\tCAMPAIGN_NAME = 'campaign-name',\n\tON_LOAD_STORAGE_KEY = 'mobile-frontend-campaign-name-ineligible-onLoad';\n\nQUnit.module( 'MobileFrontend promoCampaign.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tpromoCampaign = require( '../../../../src/mobile.startup/promoCampaign/promoCampaign' );\n\t\tthis.onShow = sinon.stub();\n\t\tthis.storage = {\n\t\t\tget: sinon.stub(),\n\t\t\tset: sinon.stub()\n\t\t};\n\t},\n\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( '#showIfEligible throws when invalid', function ( assert ) {\n\tthis.storage.get.withArgs( ACTIONS.onLoad ).returns( null );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tassert.throws(\n\t\t() => {\n\t\t\tsubject.showIfEligible( 'not a valid action' );\n\t\t},\n\t\t'Throws when action not valid'\n\t);\n\tassert.strictEqual( this.onShow.called, false, 'onShow is not called' );\n} );\n\nQUnit.test( '#showIfEligible when campaign off', function ( assert ) {\n\tthis.storage.get.withArgs( ACTIONS.onLoad ).returns( null );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\tfalse,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tsubject.showIfEligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( this.onShow.called, false, 'onShow is not called' );\n} );\n\nQUnit.test( '#showIfEligible when user ineligible', function ( assert ) {\n\tthis.storage.get.withArgs( ACTIONS.onLoad ).returns( null );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\tfalse,\n\t\tthis.storage\n\t);\n\n\tsubject.showIfEligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( this.onShow.called, false, 'onShow is not called' );\n} );\n\nQUnit.test( '#showIfEligible when storage is not available', function ( assert ) {\n\tthis.storage.get.withArgs( ACTIONS.onLoad ).returns( false );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\tfalse,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tsubject.showIfEligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( this.onShow.called, false, 'onShow is not called' );\n} );\n\nQUnit.test( '#showIfEligible when storage key is ineligible', function ( assert ) {\n\tthis.storage.get.withArgs( ACTIONS.onLoad ).returns( '~' );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tsubject.showIfEligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( this.onShow.called, false, 'onShow is not called' );\n} );\n\nQUnit.test( '#showIfEligible when eligible', function ( assert ) {\n\tthis.storage.get.withArgs( ON_LOAD_STORAGE_KEY ).returns( null );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tsubject.showIfEligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( this.onShow.called, true, 'onShow' );\n\tassert.strictEqual( this.onShow.calledWithExactly( ACTIONS.onLoad ), true, 'onShow called with additional args' );\n} );\n\nQUnit.test( '#showIfEligible when eligible and passed additional args', function ( assert ) {\n\tthis.storage.get.withArgs( ON_LOAD_STORAGE_KEY ).returns( null );\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tsubject.showIfEligible( ACTIONS.onLoad, 1, 2, 3 );\n\n\tassert.strictEqual( this.onShow.called, true, 'onShow' );\n\tassert.strictEqual( this.onShow.calledWithExactly( ACTIONS.onLoad, 1, 2, 3 ), true, 'onShow called with additional args' );\n} );\n\nQUnit.test( '#makeActionIneligible when successful', function ( assert ) {\n\tthis.storage.get.withArgs( ON_LOAD_STORAGE_KEY ).returns( null );\n\tthis.storage.set.withArgs( ON_LOAD_STORAGE_KEY, '~' ).returns( true );\n\n\tconst subject = promoCampaign(\n\t\t\tthis.onShow,\n\t\t\tACTIONS,\n\t\t\tCAMPAIGN_NAME,\n\t\t\ttrue,\n\t\t\ttrue,\n\t\t\tthis.storage\n\t\t),\n\t\tresult = subject.makeActionIneligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( result, true, 'returns result from mw storage' );\n\tassert.strictEqual( this.storage.set.calledOnce, true, 'set called once' );\n\tassert.strictEqual( this.storage.set.calledWith( ON_LOAD_STORAGE_KEY, '~' ), true, 'set called with correct value' );\n} );\n\nQUnit.test( '#makeActionIneligible when unsuccessful', function ( assert ) {\n\tthis.storage.get.withArgs( ON_LOAD_STORAGE_KEY ).returns( null );\n\tthis.storage.set.withArgs( ON_LOAD_STORAGE_KEY ).returns( false );\n\n\tconst subject = promoCampaign(\n\t\t\tthis.onShow,\n\t\t\tACTIONS,\n\t\t\tCAMPAIGN_NAME,\n\t\t\ttrue,\n\t\t\ttrue,\n\t\t\tthis.storage\n\t\t),\n\t\tresult = subject.makeActionIneligible( ACTIONS.onLoad );\n\n\tassert.strictEqual( result, false, 'returns result from mw storage' );\n} );\n\nQUnit.test( '#makeActionIneligible when invalid action', function ( assert ) {\n\tthis.storage.get.withArgs( ON_LOAD_STORAGE_KEY ).returns( null );\n\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tassert.throws( () => {\n\t\tsubject.makeActionIneligible( 'not a valid action' );\n\t}, 'Throws when invalid action' );\n} );\n\nQUnit.test( '#makeAllActionsIneligible', function ( assert ) {\n\tthis.storage.get.withArgs( ON_LOAD_STORAGE_KEY ).returns( null );\n\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tsubject.makeAllActionsIneligible();\n\n\tassert.strictEqual( this.storage.set.calledOnce, true, 'set called once' );\n\tassert.strictEqual( this.storage.set.calledWith( ON_LOAD_STORAGE_KEY, '~' ), true, 'set called with correct value' );\n} );\n\nQUnit.test( '#isCampaignActive when true', function ( assert ) {\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\ttrue,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tassert.strictEqual( subject.isCampaignActive(), true, 'isCampaignActive returns true when true' );\n} );\n\nQUnit.test( '#isCampaignActive when false', function ( assert ) {\n\tconst subject = promoCampaign(\n\t\tthis.onShow,\n\t\tACTIONS,\n\t\tCAMPAIGN_NAME,\n\t\tfalse,\n\t\ttrue,\n\t\tthis.storage\n\t);\n\n\tassert.strictEqual( subject.isCampaignActive(), false, 'isCampaignActive returns false when false' );\n} );\n","let page, pageHTMLParser, referencesGateway,\n\tsandbox, Page, PageHTMLParser, ReferencesHtmlScraperGateway;\nconst\n\tsinon = require( 'sinon' ),\n\tReferencesGateway = require( './../../../../src/mobile.startup/references/ReferencesGateway' ),\n\treferencesPage = require( '../../utils/PageInputs.html' ).referencesPage,\n\tutil = require( '../../../../src/mobile.startup/util' ),\n\too = require( '../../utils/oo' ),\n\tdom = require( '../../utils/dom' ),\n\tjQuery = require( '../../utils/jQuery' ),\n\tmediaWiki = require( '../../utils/mw' );\n\nQUnit.module( 'MobileFrontend ReferencesHtmlScraperGateway.test.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tPage = require( '../../../../src/mobile.startup/Page' );\n\t\tPageHTMLParser = require( '../../../../src/mobile.startup/PageHTMLParser' );\n\t\tReferencesHtmlScraperGateway = require( './../../../../src/mobile.startup/references/ReferencesHtmlScraperGateway' );\n\t\tpage = new Page( {\n\t\t\ttitle: 'Reftest'\n\t\t} );\n\t\tpageHTMLParser = new PageHTMLParser(\n\t\t\tutil.parseHTML( '<div>' ).html( referencesPage )\n\t\t);\n\t\treferencesGateway = new ReferencesHtmlScraperGateway( new mw.Api() );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'getReference() checking good reference', function ( assert ) {\n\treturn referencesGateway.getReference( '#cite_note-1', page, pageHTMLParser ).then( function ( ref ) {\n\t\tassert.strictEqual( ref.text, 'hello' );\n\t} );\n} );\n\nQUnit.test( 'getReference() checking bad reference', function ( assert ) {\n\treturn referencesGateway.getReference( '#cite_note-bad', page, pageHTMLParser ).catch( function ( err ) {\n\t\tassert.strictEqual( err, ReferencesGateway.ERROR_NOT_EXIST, 'When bad id given false returned.' );\n\t} );\n} );\n\nQUnit.test( 'getReference() checking encoded reference', function ( assert ) {\n\tconst id = '#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11';\n\treturn referencesGateway.getReference( id, page, pageHTMLParser ).then( function ( ref ) {\n\t\tassert.strictEqual( ref.text, 'found',\n\t\t\t'If an encoded ID parameter is given it still resolves correctly.' );\n\t} );\n} );\n\nQUnit.test( 'getReference() adds an extra class for external links', function ( assert ) {\n\treturn referencesGateway.getReference( '#cite_note-2', page, pageHTMLParser ).then( function ( ref ) {\n\t\tassert.notStrictEqual( ref.text.indexOf( referencesGateway.EXTERNAL_LINK_CLASS ), -1 );\n\t} );\n} );\n","let sandbox, page, gateway, pageParser,\n\treferences, Drawer, Page, PageHTMLParser;\nconst\n\tsinon = require( 'sinon' ),\n\too = require( '../../utils/oo' ),\n\tdom = require( '../../utils/dom' ),\n\tjQuery = require( '../../utils/jQuery' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tutil = require( '../../../../src/mobile.startup/util' ),\n\tReferencesGateway = require( '../../../../src/mobile.startup/references/ReferencesGateway' );\n\nQUnit.module( 'MobileFrontend: references', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tPage = require( '../../../../src/mobile.startup/Page' );\n\t\tPageHTMLParser = require( '../../../../src/mobile.startup/PageHTMLParser' );\n\t\tDrawer = require( '../../../../src/mobile.startup/Drawer' );\n\t\treferences = require( '../../../../src/mobile.startup/references/references.js' );\n\t\tgateway = {\n\t\t\tgetReference: function () {}\n\t\t};\n\t\tpageParser = new PageHTMLParser( util.parseHTML( '<div>' ) );\n\t\tpage = new Page( { title: 'reference test' } );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Bad reference not shown', function ( assert ) {\n\tconst promise = util.Deferred().reject( ReferencesGateway.ERROR_NOT_EXIST ).promise(),\n\t\tshowSpy = sandbox.spy( Drawer.prototype, 'show' );\n\n\tsandbox.stub( gateway, 'getReference' ).returns( promise );\n\treferences.showReference( '#cite_note-bad', page, '1', pageParser, gateway );\n\n\treturn promise.catch( function () {\n\t\tassert.strictEqual( showSpy.callCount, 0, 'Show is not called.' );\n\t} );\n} );\n\nQUnit.test( 'Good reference causes render', function ( assert ) {\n\tconst promise = util.Deferred().resolve( {\n\t\t\ttext: 'I am a reference'\n\t\t} ).promise(),\n\t\trenderSpy = sandbox.spy( Drawer.prototype, 'render' ),\n\t\tdone = assert.async();\n\n\tsandbox.stub( gateway, 'getReference' ).returns( promise );\n\treferences.showReference( '#cite_note-good', page, '1', pageParser, gateway );\n\n\treturn promise.then( function () {\n\t\tassert.strictEqual( renderSpy.callCount, 1, 'Render is called.' );\n\t\tdone();\n\t} );\n} );\n\nQUnit.test( 'Reference failure renders error in drawer', function ( assert ) {\n\tconst promise = util.Deferred().reject( ReferencesGateway.ERROR_OTHER ).promise(),\n\t\trenderSpy = sandbox.spy( Drawer.prototype, 'render' ),\n\t\tdone = assert.async();\n\n\tsandbox.stub( gateway, 'getReference' ).returns( promise );\n\treferences.showReference( '#cite_note-bad', page, '1', pageParser, gateway );\n\n\treturn promise.catch( function () {\n\t\tassert.strictEqual( renderSpy.callCount, 1, 'Render is called.' );\n\t\tdone();\n\t} );\n} );\n\nQUnit.test( 'makeOnNestedReferenceClickHandler runs when associated with link', function ( assert ) {\n\tconst spy = sandbox.spy(),\n\t\tsup = document.createElement( 'sup' ),\n\t\tanchor = document.createElement( 'a' ),\n\t\teventWithAnchor = {\n\t\t\tcurrentTarget: sup\n\t\t},\n\t\teventWithDiv = {\n\t\t\tcurrentTarget: document.createElement( 'div' )\n\t\t},\n\t\tcallback = references.test.makeOnNestedReferenceClickHandler( spy );\n\n\tsup.appendChild( anchor );\n\tanchor.setAttribute( 'href', 'https://wikipedia.org' );\n\tanchor.textContent = 'hello';\n\tcallback( eventWithAnchor );\n\tassert.strictEqual( spy.calledOnce, true, 'The spy is called with a sup' );\n\tcallback( eventWithDiv );\n\tassert.strictEqual( spy.calledOnce, true, 'The spy was not called with a div' );\n} );\n","const\n\tsinon = require( 'sinon' ),\n\tmediawiki = require( '../../utils/mw' ),\n\tMobileWebSearchLogger = require( '../../../../src/mobile.startup/search/MobileWebSearchLogger' );\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend: MobileWebSearchLogger', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tmediawiki.setUp( sandbox, global );\n\n\t\tthis.logger = new MobileWebSearchLogger();\n\t\tthis.spy = sandbox.stub( mw, 'track' );\n\t},\n\n\tafterEach: function () {\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'it should log when the search is shown', function ( assert ) {\n\tconst self = this;\n\n\t// The user opens the search overlay.\n\tthis.logger.onSearchShow();\n\tthis.logger.onSearchStart();\n\n\tassert.ok( this.spy.calledWith( 'mf.schemaMobileWebSearch', {\n\t\taction: 'session-start',\n\t\tuserSessionToken: self.logger.userSessionToken,\n\t\tsearchSessionToken: self.logger.searchSessionToken,\n\t\ttimeOffsetSinceStart: 0\n\t} ), 'Search start is logged correctly.' );\n} );\n\nQUnit.test( 'it should log when the search API request completes', function ( assert ) {\n\t// The user opens the search overlay, searches for a term, and is shown\n\t// results.\n\tthis.logger.onSearchShow();\n\tthis.logger.onSearchStart();\n\tthis.logger.onSearchResults( {\n\t\tresults: [ 'result1', 'result2' ]\n\t} );\n\n\tconst data = mw.track.getCall( 1 ).args[1];\n\n\tassert.strictEqual( data.action, 'impression-results' );\n\tassert.strictEqual( data.resultSetType, 'prefix' );\n\tassert.strictEqual( data.numberOfResults, 2 );\n\tassert.strictEqual( data.userSessionToken, this.logger.userSessionToken );\n\tassert.strictEqual( data.searchSessionToken, this.logger.searchSessionToken );\n} );\n\nQUnit.test( 'it should refresh the user session token when the search is shown again', function ( assert ) {\n\t// The user opens the search overlay, searches for a term, closes the\n\t// search overlay, opens the search overlay, and searches for a term.\n\tthis.logger.onSearchShow();\n\tthis.logger.onSearchStart();\n\tthis.logger.onSearchShow();\n\tthis.logger.onSearchStart();\n\n\tassert.notStrictEqual(\n\t\tmw.track.getCall( 0 ).args[1].userSessionToken,\n\t\tmw.track.getCall( 1 ).args[1].userSessionToken\n\t);\n} );\n\nQUnit.test( 'it should log when the user clicks a result', function ( assert ) {\n\t// The user opens the search overlay, searches for a term, is shown\n\t// results, and clicks a result.\n\tthis.logger.onSearchShow();\n\tthis.logger.onSearchStart();\n\tthis.logger.onSearchResults( {\n\t\tresults: []\n\t} );\n\n\t// The user clicks the first result.\n\tthis.logger.onSearchResultClick( {\n\t\tresultIndex: 0\n\t} );\n\n\tconst data = mw.track.getCall( 2 ).args[1];\n\n\tassert.strictEqual( data.action, 'click-result' );\n\tassert.strictEqual( data.clickIndex, 1 );\n} );\n\nQUnit.test( 'it should refresh the search session token when the search API request completes again', function ( assert ) {\n\tconst event = {\n\t\tresults: []\n\t};\n\n\t// The user opens the search overlay, searches for a term, is shown\n\t// results, searches for another term, and is shown results.\n\tthis.logger.onSearchShow();\n\tthis.logger.onSearchStart();\n\tthis.logger.onSearchResults( event );\n\tthis.logger.onSearchStart();\n\tthis.logger.onSearchResults( event );\n\n\tassert.notStrictEqual(\n\t\tmw.track.getCall( 1 ).args[1].searchSessionToken,\n\t\tmw.track.getCall( 3 ).args[1].searchSessionToken\n\t);\n} );\n","const\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\too = require( '../../utils/oo' ),\n\tsinon = require( 'sinon' ),\n\tutil = require( '../../../../src/mobile.startup/util' );\nlet\n\tSearchGateway,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend: SearchGateway',\n\t{\n\t\tbeforeEach: function () {\n\t\t\tsandbox = sinon.sandbox.create();\n\t\t\tdom.setUp( sandbox, global );\n\t\t\tjQuery.setUp( sandbox, global );\n\t\t\too.setUp( sandbox, global );\n\n\t\t\t// Additional CtaDrawer global dependency.\n\t\t\tmediaWiki.setUp( sandbox, global );\n\n\t\t\tSearchGateway = require( '../../../../src/mobile.startup/search/SearchGateway' );\n\n\t\t\tsandbox.stub( mw.util, 'getUrl' ).returns( 'Title' );\n\t\t\tsandbox.stub( mw.config, 'get' ).callsFake( function ( name ) {\n\t\t\t\tswitch ( name ) {\n\t\t\t\t\tcase 'wgMFDisplayWikibaseDescriptions': return { search: '' };\n\t\t\t\t\tcase 'wgMFSearchGenerator': return { prefix: '' };\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\tthis.gateway = new SearchGateway( new mw.Api() );\n\t\t\tsandbox.stub( this.gateway.api, 'get' ).callsFake( function () {\n\t\t\t\treturn util.Deferred().resolve( {\n\t\t\t\t\twarnings: {\n\t\t\t\t\t\tquery: {\n\t\t\t\t\t\t\t'*': 'Formatting of continuation data will be changing soon. To continue using the current formatting, use the \"rawcontinue\" parameter. To begin using the new format, pass an empty string for \"continue\" in the initial query.'\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tpages: {\n\t\t\t\t\t\t\t2: {\n\t\t\t\t\t\t\t\tindex: 1,\n\t\t\t\t\t\t\t\tpageid: 2,\n\t\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\t\ttitle: 'Claude Monet',\n\t\t\t\t\t\t\t\tthumbnail: {\n\t\t\t\t\t\t\t\t\tsource: 'http://127.0.0.1:8080/images/thumb/5/54/Claude_Monet%2C_Impression%2C_soleil_levant.jpg/80px-Claude_Monet%2C_Impression%2C_soleil_levant.jpg',\n\t\t\t\t\t\t\t\t\twidth: 80,\n\t\t\t\t\t\t\t\t\theight: 62\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t60: {\n\t\t\t\t\t\t\t\tindex: 2,\n\t\t\t\t\t\t\t\tpageid: 60,\n\t\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\t\ttitle: 'Barack Obama',\n\t\t\t\t\t\t\t\tthumbnail: {\n\t\t\t\t\t\t\t\t\tsource: 'http://127.0.0.1:8080/images/thumb/8/8d/President_Barack_Obama.jpg/64px-President_Barack_Obama.jpg',\n\t\t\t\t\t\t\t\t\twidth: 64,\n\t\t\t\t\t\t\t\t\theight: 80\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t} );\n\t\t},\n\n\t\tafterEach: function () {\n\t\t\tSearchGateway = undefined;\n\t\t\tjQuery.tearDown();\n\t\t\tsandbox.restore();\n\t\t}\n\t},\n\tfunction () {\n\t\tQUnit.test( '._highlightSearchTerm', function ( assert ) {\n\t\t\tconst gateway = this.gateway;\n\n\t\t\tconst data = [\n\t\t\t\t[ 'Hello World', 'Hel', '<strong>Hel</strong>lo World' ],\n\t\t\t\t[ 'Hello kitty', 'el', 'Hello kitty' ], // not at start\n\t\t\t\t[ 'Hello worl', 'hel', '<strong>Hel</strong>lo worl' ],\n\t\t\t\t[ 'Belle & Sebastian', 'Belle & S', '<strong>Belle &amp; S</strong>ebastian' ],\n\t\t\t\t[ 'Belle & the Beast', 'Belle &amp;', 'Belle &amp; the Beast' ],\n\t\t\t\t[ 'with ? in it', 'with ?', '<strong>with ?</strong> in it' ], // not at start\n\t\t\t\t[ 'Title with ? in it', 'with ?', 'Title with ? in it' ], // not at start\n\t\t\t\t[ 'AT&T', 'a', '<strong>A</strong>T&amp;T' ],\n\t\t\t\t[ 'AT&T', 'at&', '<strong>AT&amp;</strong>T' ],\n\t\t\t\t[ '<tag', '&lt;tag', '&lt;tag' ],\n\t\t\t\t[ '& this is a weird title', '&', '<strong>&amp;</strong> this is a weird title' ],\n\t\t\t\t[ '& this is a weird title', '&a', '&amp; this is a weird title' ],\n\t\t\t\t[ '&lt;t', '<t', '&amp;lt;t' ],\n\t\t\t\t[ '<script>alert(\"FAIL\")</script> should be safe',\n\t\t\t\t\t'<script>alert(\"FAIL\"', '<strong>&lt;script&gt;alert(\"FAIL\"</strong>)&lt;/script&gt; should be safe' ]\n\t\t\t];\n\t\t\tdata.forEach( function ( item, i ) {\n\t\t\t\tassert.strictEqual( gateway._highlightSearchTerm( item[ 0 ], item[ 1 ] ), item[ 2 ], 'highlightSearchTerm test ' + i );\n\t\t\t} );\n\t\t} );\n\n\t\tQUnit.test( 'show redirect targets', function ( assert ) {\n\t\t\treturn this.gateway.search( 'barack' ).then( function ( response ) {\n\t\t\t\tassert.strictEqual( response.query, 'barack' );\n\t\t\t\tassert.strictEqual( response.results.length, 2 );\n\t\t\t\tassert.strictEqual( response.results[ 0 ].displayTitle, 'Claude Monet' );\n\t\t\t\tassert.strictEqual( response.results[ 0 ].thumbnail.width, 80 );\n\t\t\t\tassert.strictEqual( response.results[ 1 ].displayTitle, '<strong>Barack</strong> Obama' );\n\t\t\t\tassert.strictEqual( response.results[ 1 ].title, 'Barack Obama' );\n\t\t\t} );\n\t\t} );\n\n\t\tQUnit.module( 'MobileFrontend SearchGateway (Wikidata Descriptions)', {\n\t\t\tbeforeEach: function () {\n\t\t\t\tconst data = {\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tpages: {\n\t\t\t\t\t\t\t2: {\n\t\t\t\t\t\t\t\tpageid: 2,\n\t\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\t\ttitle: 'Brad Pitt',\n\t\t\t\t\t\t\t\tindex: 2,\n\t\t\t\t\t\t\t\tdescription: 'American actor'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t4: {\n\t\t\t\t\t\t\t\tpageid: 4,\n\t\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\t\ttitle: 'Bradley Cooper',\n\t\t\t\t\t\t\t\tindex: 3,\n\t\t\t\t\t\t\t\tdescription: 'American actor and film producer'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t5: {\n\t\t\t\t\t\t\t\tpageid: 5,\n\t\t\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\t\t\ttitle: 'Braddy',\n\t\t\t\t\t\t\t\tindex: 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tsandbox.stub( mw.Api.prototype, 'get' ).returns( util.Deferred().resolve( data ) );\n\t\t\t}\n\t\t} );\n\n\t\tQUnit.test( 'Wikidata Description in search results', function ( assert ) {\n\t\t\tconst searchApi = new SearchGateway( new mw.Api() );\n\t\t\treturn searchApi.search( 'brad' ).then( function ( resp ) {\n\t\t\t\tconst results = resp.results;\n\t\t\t\tassert.strictEqual(\n\t\t\t\t\tresults[0].wikidataDescription,\n\t\t\t\t\tundefined,\n\t\t\t\t\t'Braddy does not have a Wikidata description.'\n\t\t\t\t);\n\t\t\t\tassert.strictEqual(\n\t\t\t\t\tresults[1].wikidataDescription,\n\t\t\t\t\t'American actor',\n\t\t\t\t\t'Yes, Brad Pitt is an actor.'\n\t\t\t\t);\n\t\t\t\tassert.strictEqual(\n\t\t\t\t\tresults[2].wikidataDescription,\n\t\t\t\t\t'American actor and film producer',\n\t\t\t\t\t'Yes, Cooper is an actor.'\n\t\t\t\t);\n\t\t\t} );\n\t\t} );\n\t} );\n","let\n\tSearchOverlay, SearchGateway, onBeforeExitSpy,\n\tsandbox, api, overlayOptions;\nconst\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\too = require( '../../utils/oo' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend mobile.startup/SearchOverlay.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tapi = new mw.Api();\n\t\tsandbox.stub( global.window, 'scrollTo' ).callsFake( () => {} );\n\t\tSearchGateway = require( '../../../../src/mobile.startup/search/SearchGateway' );\n\t\tonBeforeExitSpy = sandbox.spy();\n\t\tSearchOverlay = require( '../../../../src/mobile.startup/search/SearchOverlay' );\n\t\toverlayOptions = {\n\t\t\tplaceholderMsg: 'Search for bananas',\n\t\t\tapi,\n\t\t\tonBeforeExit: onBeforeExitSpy,\n\t\t\tgateway: new SearchGateway(\n\t\t\t\tapi\n\t\t\t)\n\t\t};\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'renders correctly', function ( assert ) {\n\tconst overlay = new SearchOverlay( overlayOptions );\n\n\tassert.strictEqual( overlay.$el.find( '.overlay-title' ).length, 1, 'It contains an overlay title' );\n\tassert.strictEqual( overlay.$el.find( '.search-results-view' ).length, 1, 'It contains a SearchResultsView' );\n\tassert.strictEqual( overlay.$el.find( '.results-list-container' ).length, 1, 'Contains search results container' );\n} );\n\nQUnit.test( 'resetSearch', function ( assert ) {\n\tconst overlay = new SearchOverlay( overlayOptions );\n\toverlay.resetSearch();\n\tassert.strictEqual( overlay.$el.find( '.search-results-view' ).is( 'visible' ), false, 'All children are now hidden' );\n} );\n\nQUnit.test( 'onClickOverlayContent', function ( assert ) {\n\tconst overlay = new SearchOverlay( overlayOptions );\n\n\toverlay.onClickOverlayContent();\n\tassert.strictEqual( onBeforeExitSpy.called, true,\n\t\t'Click handler triggers close of overlay' );\n} );\n","let\n\tSearchResultsView, sandbox;\nconst FEEDBACK_LINK = 'https://wikipedia.org',\n\tjQuery = require( '../../utils/jQuery' ),\n\tdom = require( '../../utils/dom' ),\n\too = require( '../../utils/oo' ),\n\tmediaWiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend mobile.startup/SearchResultsView.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\tsandbox.stub( global.mw, 'msg' )\n\t\t\t.withArgs( 'mobile-frontend-search-feedback-prompt' )\n\t\t\t.returns( 'mobile-frontend-search-feedback-prompt' );\n\t\tsandbox.stub( global.mw.config, 'get' )\n\t\t\t.withArgs( 'wgCirrusSearchFeedbackLink' ).returns( FEEDBACK_LINK );\n\n\t\tSearchResultsView = require( '../../../../src/mobile.startup/search/SearchResultsView' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'renders correctly', function ( assert ) {\n\tconst overlay = new SearchResultsView( {\n\n\t} );\n\n\tassert.strictEqual( overlay.$el.find( '.overlay-header' ).length, 1, 'It contains an overlay title' );\n\tassert.strictEqual( overlay.$el.find( '.results' ).length, 1, 'It contains results' );\n\tassert.strictEqual(\n\t\toverlay.$el.find( '.search-feedback' ).text().trim()\n\t\t\t.indexOf( 'mobile-frontend-search-feedback-prompt' ),\n\t\t0,\n\t\t'It contains the feedback link'\n\t);\n\tassert.strictEqual(\n\t\toverlay.$el.find( '.search-feedback a' ).attr( 'href' ),\n\t\tFEEDBACK_LINK,\n\t\t'It links to the feedback link'\n\t);\n} );\n","const time = require( '../../../src/mobile.startup/time' );\n\nQUnit.module( 'MobileFrontend time.js' );\n\nQUnit.test( 'timeAgo()', function ( assert ) {\n\tassert.propEqual( time.timeAgo( 40 ), {\n\t\tvalue: 40,\n\t\tunit: 'seconds'\n\t} );\n\tassert.propEqual( time.timeAgo( 149 ), {\n\t\tvalue: 2,\n\t\tunit: 'minutes'\n\t} );\n\tassert.propEqual( time.timeAgo( 150 ), {\n\t\tvalue: 3,\n\t\tunit: 'minutes'\n\t} );\n\tassert.propEqual( time.timeAgo( 7500 ), {\n\t\tvalue: 2,\n\t\tunit: 'hours'\n\t} );\n\tassert.propEqual( time.timeAgo( 90000 ), {\n\t\tvalue: 1,\n\t\tunit: 'days'\n\t} );\n\tassert.propEqual( time.timeAgo( 9000000 ), {\n\t\tvalue: 3,\n\t\tunit: 'months'\n\t} );\n\tassert.propEqual( time.timeAgo( 32000000 ), {\n\t\tvalue: 1,\n\t\tunit: 'years'\n\t} );\n\tassert.propEqual( time.timeAgo( 102000000 ), {\n\t\tvalue: 3,\n\t\tunit: 'years'\n\t} );\n} );\n","let util;\nconst\n\tdom = require( '../utils/dom' ),\n\tmw = require( '../utils/mw' ),\n\tjQuery = require( '../utils/jQuery' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend util.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tmw.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tutil = require( '../../../src/mobile.startup/util' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Promise.all() success', function ( assert ) {\n\tconst p = util.Deferred(),\n\t\tp2 = util.Deferred();\n\n\tp.resolve( 'a' );\n\tp2.resolve( 'b' );\n\treturn util.Promise.all( [ p, p2 ] ).then( function ( result, result2 ) {\n\t\tassert.strictEqual( result, 'a', 'All promises resolved (yay)' );\n\t\tassert.strictEqual( result2, 'b', 'All promises resolved (yay)' );\n\t} );\n} );\n\nQUnit.test( 'Promise.all() reject', function ( assert ) {\n\tconst p = util.Deferred(),\n\t\tp2 = util.Deferred();\n\n\tp.resolve( 'a' );\n\tp2.reject( 'b' );\n\treturn util.Promise.all( [ p, p2 ] ).catch( function ( result ) {\n\t\tassert.strictEqual( result, 'b', 'The promise rejects' );\n\t} );\n} );\n\nQUnit.test( 'escapeSelector()', function ( assert ) {\n\tassert.strictEqual(\n\t\tutil.escapeSelector( '#selector-starts-with-hash' ),\n\t\t'\\\\#selector-starts-with-hash'\n\t);\n} );\n\nQUnit.test( 'grep()', function ( assert ) {\n\tassert.propEqual(\n\t\tutil.grep( [ 1, 2 ], function ( n ) {\n\t\t\treturn n > 1;\n\t\t} ),\n\t\t[ 2 ]\n\t);\n} );\n\nQUnit.test( 'docReady()', function ( assert ) {\n\tconst done = assert.async();\n\n\tutil.docReady( () => {\n\t\tassert.ok( 'docReady calls the callback eventually' );\n\t\tdone();\n\t} );\n} );\n\nQUnit.test( 'Deferred() - resolve', function ( assert ) {\n\tconst deferred = new util.Deferred(),\n\t\tresponse = 'response';\n\tdeferred.resolve( response );\n\treturn deferred.then( function ( res ) {\n\t\tassert.strictEqual( res, response );\n\t} );\n} );\n\nQUnit.test( 'Deferred() - reject', function ( assert ) {\n\tconst deferred = new util.Deferred(),\n\t\tresponse = 'response';\n\tdeferred.reject( response );\n\treturn deferred.catch( function ( error ) {\n\t\tassert.strictEqual( error, response );\n\t} );\n} );\nQUnit.test( 'getDocument()', function ( assert ) {\n\tassert.strictEqual( util.getDocument().length, 1 );\n} );\n\nQUnit.test( 'getWindow()', function ( assert ) {\n\tassert.strictEqual( util.getWindow().length, 1 );\n} );\n\nQUnit.test( 'parseHTML()', function ( assert ) {\n\tconst htmlFragment = util.parseHTML( '<p>element content</p>', document );\n\tassert.strictEqual( typeof htmlFragment, 'object' );\n\tassert.strictEqual( htmlFragment[ 0 ].innerHTML, 'element content' );\n} );\n\nQUnit.test( 'isNumeric()', function ( assert ) {\n\tassert.strictEqual( util.isNumeric( 123 ), true );\n\tassert.strictEqual( util.isNumeric( '123' ), true );\n\tassert.strictEqual( util.isNumeric( 'The string 123 is true? I don\\'t like it.' ), false );\n\tassert.strictEqual( util.isNumeric( NaN ), false );\n} );\n\nQUnit.test( 'extend()', function ( assert ) {\n\tconst a = { a: 'apple' },\n\t\tb = { b: 'banana' };\n\tutil.extend( a, b );\n\tassert.strictEqual( JSON.stringify( a ), '{\"a\":\"apple\",\"b\":\"banana\"}' );\n} );\n\nQUnit.test( 'escapeHash()', function ( assert ) {\n\tassert.strictEqual( util.escapeHash( '#escape:...hash' ), '#escape\\\\:\\\\.\\\\.\\\\.hash' );\n} );\n\nQUnit.test( 'isModifiedEvent() - true', function ( assert ) {\n\tconst testEl = document.createElement( 'div' );\n\n\ttestEl.addEventListener( 'click', function ( ev ) {\n\t\tassert.strictEqual( util.isModifiedEvent( ev ), true );\n\t} );\n\n\ttestEl.dispatchEvent( new window.MouseEvent( 'click', { ctrlKey: true } ) );\n} );\n\nQUnit.test( 'isModifiedEvent() - false', function ( assert ) {\n\tconst testEl = document.createElement( 'div' );\n\n\ttestEl.addEventListener( 'click', function ( ev ) {\n\t\tassert.strictEqual( util.isModifiedEvent( ev ), false );\n\t} );\n\n\ttestEl.dispatchEvent( new window.MouseEvent( 'click' ) );\n} );\n\nQUnit.test( 'repeatEvent', function ( assert ) {\n\tconst proxy = new OO.EventEmitter(),\n\t\tsrc = new OO.EventEmitter(),\n\t\tsrcEventData = 'test data';\n\n\tutil.repeatEvent( src, proxy, 'test' );\n\n\tproxy.on( 'test', function ( data ) {\n\t\tassert.strictEqual(\n\t\t\tdata,\n\t\t\tsrcEventData,\n\t\t\t'proxy responds to source events correctly' );\n\t} );\n\tsrc.emit( 'test', srcEventData );\n} );\n","let\n\t// feature dependencies\n\t// require OO or mw global\n\twatchstar, watchstarSpy;\nconst\n\t// setup dependencies\n\tdom = require( '../../utils/dom' ),\n\tjQuery = require( '../../utils/jQuery' ),\n\tsinon = require( 'sinon' ),\n\tmediawiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\too = require( '../../utils/oo' );\n\n/** @type {sinon.SinonSandbox} */ let sandbox;\n\nQUnit.module( 'MobileFrontend Watchstar.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\twatchstarSpy = sandbox.spy();\n\t\tsandbox.stub( global.mw.loader, 'require' ).withArgs( 'mediawiki.page.watch.ajax' ).returns( {\n\t\t\twatchstar: watchstarSpy\n\t\t} );\n\t\tsandbox.stub( global.mw.Title, 'newFromText' ).returns(\n\t\t\t{ getUrl: function () {} }\n\t\t);\n\n\t\t// requires OO global\n\t\twatchstar = require( '../../../../src/mobile.startup/watchstar/watchstar' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Render a watchstar', function ( assert ) {\n\tconst page = { title: 'Foo' },\n\t\twatchedStar = watchstar( {\n\t\t\tpage,\n\t\t\tisWatched: true\n\t\t} ),\n\t\tstar = watchstar( { page,\n\t\t\tisWatched: false } );\n\n\t// position-fixed class may not have loaded and without it the toast is not visible so use\n\t// a spy rather than directly testing toast element visibility\n\tassert.ok( watchstarSpy.calledTwice, 'The core function was called twice.' );\n\tassert.ok( watchedStar.$el.attr( 'class' ).indexOf( 'watched' ) > -1, 'Watched class is correct.' );\n\tassert.strictEqual( star.$el.attr( 'class' ).indexOf( 'watched' ), -1, 'Unwatched class is correct.' );\n} );\n","const\n\tWatchstarGateway = require( '../../../../src/mobile.startup/watchstar/WatchstarGateway' ),\n\t// setup dependencies\n\tdom = require( '../../utils/dom' ),\n\tjQuery = require( '../../utils/jQuery' ),\n\tsinon = require( 'sinon' ),\n\tmediawiki = require( '../../utils/mw' ),\n\tutil = require( '../../../../src/mobile.startup/util' ),\n\tGET_RESPONSE = {\n\t\tbatchcomplete: true,\n\t\tquery: {\n\t\t\tpages: [ {\n\t\t\t\tpageid: 123,\n\t\t\t\tns: 0,\n\t\t\t\ttitle: 'An unwatched page',\n\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\tpagelanguage: 'en',\n\t\t\t\tpagelanguagehtmlcode: 'en',\n\t\t\t\tpagelanguagedir: 'ltr',\n\t\t\t\ttouched: '2018-05-01T01:39:12Z',\n\t\t\t\tlastrevid: 10,\n\t\t\t\tlength: 3,\n\t\t\t\tnew: true,\n\t\t\t\twatched: false\n\t\t\t}, {\n\t\t\t\tpageid: 456,\n\t\t\t\tns: 0,\n\t\t\t\ttitle: 'A watched page',\n\t\t\t\tcontentmodel: 'wikitext',\n\t\t\t\tpagelanguage: 'en',\n\t\t\t\tpagelanguagehtmlcode: 'en',\n\t\t\t\tpagelanguagedir: 'ltr',\n\t\t\t\ttouched: '2018-05-01T01:43:31Z',\n\t\t\t\tlastrevid: 24,\n\t\t\t\tlength: 3,\n\t\t\t\tnew: true,\n\t\t\t\twatched: true\n\t\t\t} ]\n\t\t}\n\t};\nlet\n\tsandbox;\n\nQUnit.module( 'MobileFrontend: WatchstarGateway.js', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'getStatuses(nonempty)', function ( assert ) {\n\tconst api = { get: function () {} };\n\tconst mockAPI = sandbox.mock( api );\n\n\tmockAPI\n\t\t.expects( 'get' )\n\t\t.withArgs( sandbox.match.has( 'pageids' ) )\n\t\t.once()\n\t\t.returns( util.Deferred().resolve( {\n\t\t\tbatchcomplete: true,\n\t\t\tquery: { pages: [ GET_RESPONSE.query.pages[0] ] }\n\t\t} ) );\n\tmockAPI\n\t\t.expects( 'get' )\n\t\t.withArgs( sandbox.match.has( 'titles' ) )\n\t\t.once()\n\t\t.returns( util.Deferred().resolve( {\n\t\t\tbatchcomplete: true,\n\t\t\tquery: { pages: [ GET_RESPONSE.query.pages[1] ] }\n\t\t} ) );\n\n\tconst subject = new WatchstarGateway( api );\n\treturn subject.getStatuses(\n\t\t[ '123' ], [ 'A watched page' ]\n\t).then( function ( actual ) {\n\t\tconst expected = {\n\t\t\t'An unwatched page': false,\n\t\t\t'A watched page': true\n\t\t};\n\t\tassert.propEqual( actual, expected, 'The correct result is returned.' );\n\t\tmockAPI.verify();\n\t} );\n} );\n\nQUnit.test( 'getStatuses(empty)', function ( assert ) {\n\tconst api = { get: function () {} };\n\tconst mockAPI = sandbox.mock( api )\n\t\t.expects( 'get' )\n\t\t// No HTTP requests are issued.\n\t\t.never();\n\n\tconst subject = new WatchstarGateway( api );\n\treturn subject.getStatuses( [], [] ).then( function ( actual ) {\n\t\tconst expected = {};\n\t\tassert.propEqual( actual, expected, 'An empty result is returned.' );\n\t\tmockAPI.verify();\n\t} );\n} );\n\nQUnit.test( 'getStatusesByID(nonempty)', function ( assert ) {\n\tconst api = { get: function () {} };\n\tconst mockAPI = sandbox.mock( api )\n\t\t.expects( 'get' )\n\t\t.once()\n\t\t// One HTTP request is issued.\n\t\t.returns( util.Deferred().resolve( GET_RESPONSE ) );\n\n\tconst subject = new WatchstarGateway( api );\n\treturn subject.getStatusesByID( [ '123', 456 ] ).then( function ( actual ) {\n\t\tconst expected = {\n\t\t\t'An unwatched page': false,\n\t\t\t'A watched page': true\n\t\t};\n\t\tassert.propEqual( actual, expected, 'The correct result is returned.' );\n\t\tmockAPI.verify();\n\t} );\n} );\n\nQUnit.test( 'getStatusesByID(empty)', function ( assert ) {\n\tconst api = { get: function () {} };\n\tconst mockAPI = sandbox.mock( api )\n\t\t.expects( 'get' )\n\t\t// No HTTP requests are issued.\n\t\t.never();\n\n\tconst subject = new WatchstarGateway( api );\n\treturn subject.getStatusesByID( [] ).then( function ( actual ) {\n\t\tconst expected = {};\n\t\tassert.propEqual( actual, expected, 'An empty result is returned.' );\n\t\tmockAPI.verify();\n\t} );\n} );\n\nQUnit.test( 'getStatusesByTitle(nonempty)', function ( assert ) {\n\tconst api = { get: function () {} };\n\tconst mockAPI = sandbox.mock( api )\n\t\t.expects( 'get' )\n\t\t.once()\n\t\t// One HTTP request is issued.\n\t\t.returns( util.Deferred().resolve( GET_RESPONSE ) );\n\n\tconst subject = new WatchstarGateway( api );\n\treturn subject.getStatusesByTitle( [\n\t\t'An unwatched page', 'An unwatched page'\n\t] ).then( function ( actual ) {\n\t\tconst expected = {\n\t\t\t'An unwatched page': false,\n\t\t\t'A watched page': true\n\t\t};\n\t\tassert.propEqual( actual, expected, 'The correct result is returned.' );\n\t\tmockAPI.verify();\n\t} );\n} );\n\nQUnit.test( 'getStatusesByTitle(empty)', function ( assert ) {\n\tconst api = { get: function () {} };\n\tconst mockAPI = sandbox.mock( api )\n\t\t.expects( 'get' )\n\t\t// No HTTP requests are issued.\n\t\t.never();\n\n\tconst subject = new WatchstarGateway( api );\n\treturn subject.getStatusesByTitle( [] ).then( function ( actual ) {\n\t\tconst expected = {};\n\t\tassert.propEqual( actual, expected, 'An empty result is returned.' );\n\t\tmockAPI.verify();\n\t} );\n} );\n\nQUnit.test( '_unmarshalGetResponse(nonempty)', function ( assert ) {\n\tconst subject = new WatchstarGateway( new mw.Api() );\n\tconst actual = subject._unmarshalGetResponse( GET_RESPONSE );\n\tconst expected = {\n\t\t'An unwatched page': false,\n\t\t'A watched page': true\n\t};\n\tassert.propEqual(\n\t\tactual,\n\t\texpected,\n\t\t'GET API:Info nonempty responses are unmarshalled correctly.'\n\t);\n} );\n\nQUnit.test( '_unmarshalGetResponse(empty)', function ( assert ) {\n\tconst subject = new WatchstarGateway( new mw.Api() );\n\tconst actual = subject._unmarshalGetResponse( {} );\n\tconst expected = {};\n\tassert.propEqual(\n\t\tactual,\n\t\texpected,\n\t\t'GET API:Info empty responses are unmarshalled correctly.'\n\t);\n} );\n","const\n\tutil = require( '../../../../src/mobile.startup/util' ),\n\tdom = require( '../../utils/dom' ),\n\tjQuery = require( '../../utils/jQuery' ),\n\tsinon = require( 'sinon' ),\n\tmediawiki = require( '../../utils/mw' ),\n\tmustache = require( '../../utils/mustache' ),\n\too = require( '../../utils/oo' ),\n\tapiResp = {\n\t\tquery: {\n\t\t\tpages: [ {\n\t\t\t\tpageid: 30,\n\t\t\t\ttitle: 'Title 30',\n\t\t\t\twatched: true\n\t\t\t}, {\n\t\t\t\tpageid: 50,\n\t\t\t\ttitle: 'Title 50',\n\t\t\t\twatched: false\n\t\t\t} ]\n\t\t}\n\t};\nlet\n\tuser,\n\tIcon,\n\tWatchstarPageList,\n\twatchIconName,\n\tsandbox;\n\nQUnit.module( 'MobileFrontend mobile.startup/WatchstarPageList', {\n\tbeforeEach: function () {\n\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\tmediawiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\n\t\t// loaded after globals\n\t\tsandbox.stub( global.mw.loader, 'require' ).withArgs( 'mediawiki.page.watch.ajax' ).returns( {\n\t\t\twatchstar: () => {}\n\t\t} );\n\t\tsandbox.stub( global.mw.Title, 'newFromText' ).returns(\n\t\t\t{ getUrl: function () {} }\n\t\t);\n\t\tWatchstarPageList = require( '../../../../src/mobile.startup/watchstar/WatchstarPageList' );\n\t\tuser = mw.user;\n\t\tIcon = require( '../../../../src/mobile.startup/Icon' );\n\n\t\twatchIconName = new Icon( {\n\t\t\tglyphPrefix: 'wikimedia',\n\t\t\tname: 'unStar-progressive'\n\t\t} ).getGlyphClassName();\n\t\tsandbox.stub( user, 'isAnon' ).returns( false );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Watchlist status check if no ids', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tmwApi = new mw.Api(),\n\t\tapiSpy = sandbox.stub( mwApi, 'get' ).returns( util.Deferred().resolve( apiResp ) ),\n\t\tpageList = new WatchstarPageList( {\n\t\t\tapi: mwApi,\n\t\t\tpages: [\n\t\t\t\t{ title: 'Title 0' },\n\t\t\t\t{ title: 'Title 1' }\n\t\t\t]\n\t\t} );\n\n\t// Wait for an internal API call to happen as a side-effect of construction.\n\twindow.setTimeout( function () {\n\t\tpageList.getPages( [], [] ).then( function () {\n\t\t\tassert.ok( apiSpy.calledWith( {\n\t\t\t\tformatversion: 2,\n\t\t\t\taction: 'query',\n\t\t\t\tprop: 'info',\n\t\t\t\tinprop: 'watched',\n\t\t\t\ttitles: [ 'Title 0', 'Title 1' ]\n\t\t\t} ), 'A request to API was made to retrieve the statuses' );\n\t\t\tassert.strictEqual( pageList.$el.find( '.watch-this-article' ).length, 2, '2 articles have watch stars' );\n\t\t\tdone();\n\t\t} );\n\t}, 0 );\n} );\n\nQUnit.test( 'Checks watchlist status once', function ( assert ) {\n\tconst\n\t\tdone = assert.async(),\n\t\tmwApi = new mw.Api(),\n\t\tapiSpy = sandbox.stub( mwApi, 'get' ).returns( util.Deferred().resolve( apiResp ) ),\n\t\tpl = new WatchstarPageList( {\n\t\t\tapi: mwApi,\n\t\t\tpages: [ {\n\t\t\t\tid: 30,\n\t\t\t\ttitle: 'Title 30'\n\t\t\t}, {\n\t\t\t\tid: 50,\n\t\t\t\ttitle: 'Title 50'\n\t\t\t} ]\n\t\t} );\n\n\t// Wait for an internal API call to happen as a side-effect of construction.\n\twindow.setTimeout( function () {\n\t\tpl.getPages( [ 30, 50 ], [] ).then( function () {\n\t\t\tassert.strictEqual( apiSpy.callCount, 2,\n\t\t\t\t'run callback twice (inside postRender and this call) - no caching occurs' );\n\t\t\tassert.ok( apiSpy.calledWith( {\n\t\t\t\tformatversion: 2,\n\t\t\t\taction: 'query',\n\t\t\t\tprop: 'info',\n\t\t\t\tinprop: 'watched',\n\t\t\t\tpageids: [ 30, 50 ]\n\t\t\t} ), 'A request to API was made to retrieve the statuses' );\n\t\t\tassert.strictEqual( pl.$el.find( '.watch-this-article' ).length, 2, '2 articles have watch stars' );\n\t\t\tassert.strictEqual( pl.$el.find( '.' + watchIconName ).length, 1, '1 article is marked as watched' );\n\t\t\tdone();\n\t\t} );\n\t}, 0 );\n} );\n","let\n\tAddTopicForm,\n\tsandbox;\nconst util = require( '../../../src/mobile.startup/util' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend AddTopicForm', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tAddTopicForm = require( '../../../src/mobile.talk.overlays/AddTopicForm' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'makePanel()', function ( assert ) {\n\tconst text = 'Hello world',\n\t\tpanel = AddTopicForm.test.makePanel( util.parseHTML( '<span>' ).text( text ) );\n\n\tassert.strictEqual( panel.$el.hasClass( 'panel' ), true, 'A Panel is created' );\n\tassert.strictEqual( panel.$el.find( 'span' ).text(),\n\t\ttext, 'The panel has he element inside' );\n} );\n\nQUnit.test( 'AddTopicForm', function ( assert ) {\n\tconst spy = sandbox.spy(),\n\t\tformNoInputEvent = new AddTopicForm( {\n\t\t\tsubject: ' Subject',\n\t\t\tbody: 'Body',\n\t\t\tdisabled: false,\n\t\t\tlicenseMsg: 'MobileFrontend <strong>fun</strong> license'\n\t\t} ),\n\t\tform = new AddTopicForm( {\n\t\t\tsubject: ' Subject',\n\t\t\tbody: 'Body',\n\t\t\tdisabled: false,\n\t\t\tlicenseMsg: 'MobileFrontend <strong>fun</strong> license',\n\t\t\tonTextInput: function ( subject, body ) {\n\t\t\t\tspy( subject, body );\n\t\t\t}\n\t\t} );\n\n\t// form without an input\n\ttry {\n\t\tformNoInputEvent.$el.find( 'textarea' ).trigger( 'input' );\n\t\tassert.ok( true, 'If form has no onTextInput event handler does not execute' );\n\t} catch ( e ) {\n\t\tassert.ok( false, 'If form has no onTextInput no exception is meant to be thrown' );\n\t}\n\tassert.strictEqual( form.$el.find( 'input' ).val(), ' Subject', 'Subject input created' );\n\tassert.strictEqual( form.$el.find( 'textarea' ).val(), 'Body', 'textarea created' );\n\tassert.strictEqual( form.$el.find( 'p strong' ).text(), 'fun', 'licenseMsg accepts HTML' );\n\tassert.strictEqual( spy.calledOnce, false, 'Spy not called to begin with' );\n\tform.$el.find( 'textarea' ).trigger( 'input' );\n\tassert.strictEqual( spy.calledOnce, true, 'Spy got called after textarea input' );\n\tassert.propEqual( spy.args[0], [ 'Subject', 'Body' ],\n\t\t'Spy got called with expected (and trimmed arguments)' );\n\n} );\n","let\n\tTalkSectionAddOverlay,\n\tsandbox;\nconst\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend TalkSectionAddOverlay', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tTalkSectionAddOverlay = require( '../../../src/mobile.talk.overlays/TalkSectionAddOverlay' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'save()', function ( assert ) {\n\tconst overlay = new TalkSectionAddOverlay( {\n\t\tapi: {\n\t\t\tpostWithToken: sandbox.stub().returns(\n\t\t\t\tutil.Deferred().resolve()\n\t\t\t)\n\t\t},\n\t\ttitle: 'Talk:No exist'\n\t} );\n\t// set the content of the new discussion\n\toverlay.$el.find( 'input' ).val( 'Testtitle' );\n\toverlay.$el.find( 'textarea' ).val( 'Testcontent' );\n\t// Check the values\n\tassert.strictEqual( overlay.$el.find( 'input' ).val(), 'Testtitle', 'Testtitle set' );\n\tassert.strictEqual( overlay.$el.find( 'textarea' ).val(), 'Testcontent', 'Testcontent set' );\n\t// Test the save of the new dicsussion\n\treturn overlay.save().then( function ( status ) {\n\t\tassert.strictEqual( status, 'ok', 'The new discussion was saved' );\n\t\t// check, if the save was recognized\n\t\t// (so the overlay can hide without confirmation of the user)\n\t\tassert.strictEqual( overlay._saveHit, true, 'The save was recognized' );\n\t} );\n} );\n","let\n\tTalkSectionOverlay,\n\tsandbox;\nconst\n\tutil = require( '../../../src/mobile.startup/util' ),\n\tjQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\tmustache = require( '../utils/mustache' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend TalkSectionOverlay.js - logged in', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tTalkSectionOverlay = require( '../../../src/mobile.talk.overlays/TalkSectionOverlay' );\n\n\t\t// don't create toasts in test environment\n\t\tthis.toastStub = sandbox.stub( mw, 'notify' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Check comment box for logged in users', function ( assert ) {\n\tconst overlay = new TalkSectionOverlay( {\n\t\tapi: {},\n\t\tsection: 'Test'\n\t} );\n\n\tassert.ok( overlay.$el.find( '.comment' ).length > 0, 'There is a visible comment box' );\n} );\n\nQUnit.test( 'Check disabled property on textarea', function ( assert ) {\n\tconst overlay = new TalkSectionOverlay( {\n\t\tapi: {},\n\t\tsection: 'Test'\n\t} );\n\n\tassert.strictEqual( overlay.$saveButton.prop( 'disabled' ), true, '`disabled` at start.' );\n\toverlay.onInputTextarea( {\n\t\ttarget: {\n\t\t\tvalue: 'Test'\n\t\t}\n\t} );\n\tassert.strictEqual( overlay.$saveButton.prop( 'disabled' ), false, '`disabled` removed after comment box gets input value.' );\n} );\n\nQUnit.test( 'Check api request on save', function ( assert ) {\n\tconst\n\t\tdeferred = util.Deferred().resolve(),\n\t\tspy = sandbox.stub().returns( deferred ),\n\t\toverlay = new TalkSectionOverlay( {\n\t\t\tapi: {\n\t\t\t\tpostWithToken: spy\n\t\t\t},\n\t\t\ttitle: 'Talk:Test',\n\t\t\tid: 1,\n\t\t\tsection: 'Test'\n\t\t} );\n\n\toverlay.state.text = 'Testcomment';\n\toverlay.onSaveClick();\n\n\treturn deferred.then( function () {\n\t\tassert.ok( spy.calledWith( 'csrf', {\n\t\t\taction: 'edit',\n\t\t\ttitle: 'Talk:Test',\n\t\t\tsection: 1,\n\t\t\tappendtext: '\\n\\nTestcomment ~~~~',\n\t\t\tredirect: true\n\t\t} ), 'Save request passes!' );\n\t} );\n} );\n\nQUnit.module( 'MobileFrontend TalkSectionOverlay.js - anonymous (logged out)', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmustache.setUp( sandbox, global );\n\n\t\tTalkSectionOverlay = require( '../../../src/mobile.talk.overlays/TalkSectionOverlay' );\n\n\t\tsandbox.stub( mw.user, 'isAnon' ).returns( false );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'Check comment box for logged out users', function ( assert ) {\n\tconst overlay = new TalkSectionOverlay( {\n\t\tapi: {},\n\t\tsection: 'Test'\n\t} );\n\n\tassert.ok( overlay.$el.find( '.comment' ).length > 0, 'There is a visible comment box' );\n} );\n","const autosign = require( '../../../src/mobile.talk.overlays/autosign' );\n\nQUnit.module( 'MobileFrontend autosign.js' );\n\nQUnit.test( '#autosign', function ( assert ) {\n\t[\n\t\t// Forgot to sign\n\t\t[ 'foo', 'foo ~~~~' ],\n\t\t// 3 tildes signing (no date)\n\t\t[ 'foo ~~~', 'foo ~~~' ],\n\t\t// 5 tildes (no name)\n\t\t[ 'foo ~~~~~', 'foo ~~~~~' ],\n\t\t// No double signing\n\t\t[ 'foo ~~~~', 'foo ~~~~' ],\n\t\t// Unconventional signing1\n\t\t[ 'foo ~~~~ yolo', 'foo ~~~~ yolo' ],\n\t\t// Unconventional signing 2\n\t\t[ '~~~~ yolo', '~~~~ yolo' ]\n\t].forEach( function ( testCase ) {\n\t\tassert.strictEqual( autosign( testCase[0] ), testCase[1], 'Autosigning works as expected' );\n\t} );\n} );\n","let makeAddTopicForm, sandbox;\nconst jQuery = require( '../utils/jQuery' ),\n\tdom = require( '../utils/dom' ),\n\tmediaWiki = require( '../utils/mw' ),\n\too = require( '../utils/oo' ),\n\tsinon = require( 'sinon' );\n\nQUnit.module( 'MobileFrontend makeAddTopicForm', {\n\tbeforeEach: function () {\n\t\tsandbox = sinon.sandbox.create();\n\t\tdom.setUp( sandbox, global );\n\t\tjQuery.setUp( sandbox, global );\n\t\too.setUp( sandbox, global );\n\t\tmediaWiki.setUp( sandbox, global );\n\t\tmakeAddTopicForm = require( '../../../src/mobile.talk.overlays/makeAddTopicForm' );\n\t},\n\tafterEach: function () {\n\t\tjQuery.tearDown();\n\t\tsandbox.restore();\n\t}\n} );\n\nQUnit.test( 'makeAddTopicForm', function ( assert ) {\n\tconst spy = sandbox.spy(),\n\t\tformNoHandler = makeAddTopicForm( {\n\t\t\tlicenseMsg: 'foo',\n\t\t\tdisabled: false,\n\t\t\tsubject: 'sub',\n\t\t\tbody: 'body'\n\t\t} ),\n\t\tform = makeAddTopicForm( {\n\t\t\tlicenseMsg: 'foo',\n\t\t\tdisabled: false,\n\t\t\tsubject: 'sub',\n\t\t\tbody: 'body',\n\t\t\tonTextInput: function ( _, val ) {\n\t\t\t\tspy( val );\n\t\t\t}\n\t\t} );\n\tassert.strictEqual( formNoHandler.$el.hasClass( 'add-topic-form' ), true,\n\t\t'The onTextInput parameter is optional' );\n\tformNoHandler.$el.find( 'textarea' ).trigger( 'input' );\n\tform.$el.find( 'textarea' ).trigger( 'input' );\n\tform.$el.find( 'textarea' ).val( '' );\n\tform.$el.find( 'textarea' ).trigger( 'input' );\n\tassert.strictEqual( form.$el.hasClass( 'add-topic-form' ), true,\n\t\t'Form has the expected class name' );\n\tassert.strictEqual( spy.args[0][0], 'body ~~~~',\n\t\t'Check onTextInput is executed and signed when callback is run.' );\n\tassert.strictEqual( spy.args[1][0], '',\n\t\t'Check onTextInput does not autosign if body empty.' );\n} );\n","module.exports = {\n\tgetPageHeadings: {\n\t\tinput: {\n\t\t\tmobileview: {\n\t\t\t\tid: -1,\n\t\t\t\tdisplaytitle: 'Test',\n\t\t\t\trevId: 42,\n\t\t\t\tlastmodifiedby: {\n\t\t\t\t\tname: 'bob',\n\t\t\t\t\tgender: 'unknown'\n\t\t\t\t},\n\t\t\t\tprotection: [],\n\t\t\t\tlastmodified: '2013-10-28T18:49:56Z',\n\t\t\t\tlanguagecount: 10,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 0,\n\t\t\t\t\t\ttext: ''\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '1',\n\t\t\t\t\t\tline: '1',\n\t\t\t\t\t\tanchor: '1',\n\t\t\t\t\t\tid: 1,\n\t\t\t\t\t\ttext: '<p>Text of 1\\n</p>'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: '<i>1.1</i>',\n\t\t\t\t\t\tanchor: '1.1',\n\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\ttext: '<p>Text of 1.1\\n</p>'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '1',\n\t\t\t\t\t\tline: '2',\n\t\t\t\t\t\tanchor: '2',\n\t\t\t\t\t\tid: 3,\n\t\t\t\t\t\ttext: '<p>Text of 2\\n</p>'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\tline: '2.1',\n\t\t\t\t\t\tanchor: '2.1',\n\t\t\t\t\t\tid: 4,\n\t\t\t\t\t\ttext: '<p>Text of 2.1\\n</p>'\n\t\t\t\t\t} ]\n\t\t\t}\n\t\t},\n\t\toutput: {\n\t\t\thistoryUrl: 'Test:History',\n\t\t\tlastModifiedUserName: 'bob',\n\t\t\tlastModifiedUserGender: 'unknown',\n\t\t\tlastModifiedTimestamp: 1382986196,\n\t\t\ttitle: 'Test',\n\t\t\trevId: 42,\n\t\t\tdisplayTitle: 'Test',\n\t\t\tid: -1,\n\t\t\tprotection: {\n\t\t\t\tedit: [ '*' ]\n\t\t\t},\n\t\t\tisMainPage: false,\n\t\t\tlanguageCount: 10,\n\t\t\thasVariants: false,\n\t\t\tlead: '',\n\t\t\tsections: [\n\t\t\t\t{\n\t\t\t\t\tlevel: '1',\n\t\t\t\t\tline: '1',\n\t\t\t\t\tanchor: '1',\n\t\t\t\t\tid: 1,\n\t\t\t\t\ttext: '<p>Text of 1\\n</p><h2 id=\"1.1\"><i>1.1</i></h2>\\n<p>Text of 1.1\\n</p>',\n\t\t\t\t\tsubsections: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\t\tline: '<i>1.1</i>',\n\t\t\t\t\t\t\tanchor: '1.1',\n\t\t\t\t\t\t\tid: 2,\n\t\t\t\t\t\t\ttext: '<p>Text of 1.1\\n</p>',\n\t\t\t\t\t\t\tsubsections: []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlevel: '1',\n\t\t\t\t\tline: '2',\n\t\t\t\t\tanchor: '2',\n\t\t\t\t\tid: 3,\n\t\t\t\t\ttext: '<p>Text of 2\\n</p><h2 id=\"2.1\">2.1</h2>\\n<p>Text of 2.1\\n</p>',\n\t\t\t\t\tsubsections: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlevel: '2',\n\t\t\t\t\t\t\tline: '2.1',\n\t\t\t\t\t\t\tanchor: '2.1',\n\t\t\t\t\t\t\tid: 4,\n\t\t\t\t\t\t\ttext: '<p>Text of 2.1\\n</p>',\n\t\t\t\t\t\t\tsubsections: []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t},\n\tgetPageLanguagesResponse: {\n\t\tinput: {\n\t\t\tquery: {\n\t\t\t\tpages: [\n\t\t\t\t\t{\n\t\t\t\t\t\tpageid: 94,\n\t\t\t\t\t\tns: 0,\n\t\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\t\tlanglinks: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlang: 'es',\n\t\t\t\t\t\t\t\turl: 'http://es.wikipedia.org/wiki/San_Francisco_(California)',\n\t\t\t\t\t\t\t\ttitle: 'San Francisco (California)',\n\t\t\t\t\t\t\t\tautonym: 'espa\\u00f1ol'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlang: 'pl',\n\t\t\t\t\t\t\t\turl: 'http://pl.wikipedia.org/wiki/San_Francisco',\n\t\t\t\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\t\t\t\tautonym: 'polski'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlang: 'sr',\n\t\t\t\t\t\t\t\turl: 'http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE',\n\t\t\t\t\t\t\t\ttitle: '\\u0421\\u0430\\u043d \\u0424\\u0440\\u0430\\u043d\\u0446\\u0438\\u0441\\u043a\\u043e',\n\t\t\t\t\t\t\t\tautonym: '\\u0441\\u0440\\u043f\\u0441\\u043a\\u0438 / srpski'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tgeneral: {\n\t\t\t\t\tvariants: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: 'sr',\n\t\t\t\t\t\t\tname: 'sr'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: 'sr-ec',\n\t\t\t\t\t\t\tname: '\\u040b\\u0438\\u0440\\u0438\\u043b\\u0438\\u0446\\u0430'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcode: 'sr-el',\n\t\t\t\t\t\t\tname: 'Latinica'\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tvariantarticlepath: '/$2/$1'\n\t\t\t\t},\n\t\t\t\tlanguages: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'sr',\n\t\t\t\t\t\tname: ' / srpski'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'sr-ec',\n\t\t\t\t\t\tname: ' ()'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'sr-el',\n\t\t\t\t\t\tname: 'srpski (latinica)'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'es',\n\t\t\t\t\t\tname: 'espaol'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: 'pl',\n\t\t\t\t\t\tname: 'polski'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tlimits: {\n\t\t\t\tlanglinks: 500\n\t\t\t}\n\t\t},\n\t\toutput: {\n\t\t\tlanguages: [\n\t\t\t\t{\n\t\t\t\t\tlang: 'es',\n\t\t\t\t\turl: 'http://es.wikipedia.org/wiki/San_Francisco_(California)',\n\t\t\t\t\ttitle: 'San Francisco (California)',\n\t\t\t\t\tautonym: 'espa\\u00f1ol'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'pl',\n\t\t\t\t\turl: 'http://pl.wikipedia.org/wiki/San_Francisco',\n\t\t\t\t\ttitle: 'San Francisco',\n\t\t\t\t\tautonym: 'polski'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr',\n\t\t\t\t\turl: 'http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE',\n\t\t\t\t\ttitle: '\\u0421\\u0430\\u043d \\u0424\\u0440\\u0430\\u043d\\u0446\\u0438\\u0441\\u043a\\u043e',\n\t\t\t\t\tautonym: '\\u0441\\u0440\\u043f\\u0441\\u043a\\u0438 / srpski'\n\t\t\t\t}\n\t\t\t],\n\t\t\tvariants: [\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr',\n\t\t\t\t\tautonym: 'sr',\n\t\t\t\t\turl: '/sr/Test'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr-ec',\n\t\t\t\t\tautonym: '\\u040b\\u0438\\u0440\\u0438\\u043b\\u0438\\u0446\\u0430',\n\t\t\t\t\turl: '/sr-ec/Test'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlang: 'sr-el',\n\t\t\t\t\tautonym: 'Latinica',\n\t\t\t\t\turl: '/sr-el/Test'\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t},\n\tgetPageLanguagesCall: {\n\t\toutput: {\n\t\t\taction: 'query',\n\t\t\tmeta: 'siteinfo',\n\t\t\tsiprop: 'general',\n\t\t\tprop: 'langlinks',\n\t\t\tllprop: 'url|autonym|langname',\n\t\t\tllinlanguagecode: 'fr',\n\t\t\tlllimit: 'max',\n\t\t\ttitles: 'Title',\n\t\t\tformatversion: 2\n\t\t}\n\t},\n\tgetAPIResponseFromHTML: {\n\t\tinput: [\n\t\t\t{\n\t\t\t\tline: 'A1',\n\t\t\t\tlevel: '1',\n\t\t\t\tanchor: '1.0',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2.2',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2',\n\t\t\t\tlevel: '1',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t},\n\t\t\t{\n\t\t\t\tline: 'A2.1',\n\t\t\t\tlevel: '2',\n\t\t\t\tanchor: '',\n\t\t\t\ttext: ''\n\t\t\t}\n\t\t]\n\t}\n\n};\n","/* eslint-env es6 */\nconst page = `<div>\n\t<h1><span class=\"mw-headline\" id=\"1.0\">A1</span></h1>\n\t<h2><span class=\"mw-headline\">A2.1</span></h2>\n\t<h2><span class=\"mw-headline\">A2.2</span></h2>\n\t<h1><span class=\"mw-headline\">A2</span></h1>\n\t<h2><span class=\"mw-headline\">A2.1</span><span>[<a href=\"#\">edit</a>]</span></h2>\n\t<h1>Not to be shown in the TOC<span class=\"placeholder\"></span></h1>\n</div>`;\n\nconst page2 = `<div>\n<h2><span class=\"mw-headline\" id=\"1.0\">A1</span></h2>\n<h3><span class=\"mw-headline\">A2.1</span></h3>\n<h2><span class=\"mw-headline\">A2.2</span></h2>\n<h1><span class=\"mw-headline\">A2</span></h1>\n<h2><span class=\"mw-headline\">A2.1</span></h2>\n</div>`;\n\nconst referencesPage = `<div id=\"mfe-test-references\">\n<sup id=\"cite_ref-1\" class=\"reference\">\n\t<a href=\"#cite_note-1\">[1]</a>\n</sup>\n<p>\n\tsup with encoded href attribute\n\t<sup id=\"cite_ref-Obama_1995,_2004,_pp._910_11-0\" class=\"reference\">\n\t\t<a href=\"#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11\">[11]</a>\n\t</sup>\n</p>\n<ol class=\"references\">\n\t<li id=\"cite_note-1\">\n\t\t<span class=\"mw-cite-backlink\">\n\t\t\t<a href=\"#cite_ref-1\"></a>\n\t\t</span> <span class=\"reference-text\">hello</span>\n\t</li>\n\t<li id=\"cite_note-Obama_1995,_2004,_pp._910-11\">\n\t\t<span class=\"mw-cite-backlink\">\n\t\t\t<a href=\"#cite_ref-1\"></a>\n\t\t</span> <span class=\"reference-text\">found</span>\n\t</li>\n\t<li id=\"cite_note-2\">\n\t\t<span class=\"mw-cite-backlink\">\n\t\t\t<a href=\"#cite_ref-1\">^</a>\n\t\t</span>\n\t\t<span class=\"reference-text\">\n\t\t\t<a class=\"external text\" href=\"\">Hi there</a>\n\t\t</span>\n\t</li>\n</ol>\n</div>`;\n\nmodule.exports = {\n\t// A page with references mirroring PHP Parser output\n\treferencesPage: referencesPage,\n\tpage: page,\n\tpage2: page2\n};\n","// This file is loaded instead of mockMediaWiki.js when using MW test runner\nmodule.exports = function () {\n};\n","module.exports = require( '@wikimedia/mw-node-qunit' ).dom;\n","module.exports = require( '@wikimedia/mw-node-qunit' ).jQuery;\n","module.exports = require( '@wikimedia/mw-node-qunit' ).mustache;\n","module.exports = require( '@wikimedia/mw-node-qunit' ).mw;\n","module.exports = require( '@wikimedia/mw-node-qunit' ).oojs;\n","(function() { module.exports = this[\"jquery\"]; }());","(function() { module.exports = this[\"jsdom\"]; }());","(function() { module.exports = this[\"oojs\"]; }());"],"sourceRoot":""}