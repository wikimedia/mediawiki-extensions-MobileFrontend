this.mfModules=this.mfModules||{},this.mfModules["tests.mobilefrontend"]=(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"./node_modules/hogan.js/lib/compiler.js":function(e,t,i){!function(e){var t=/\S/,i=/\"/g,n=/\n/g,s=/\r/g,a=/\\/g,o={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};function r(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function l(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function c(e,t,i){if(t.charAt(i)!=e.charAt(0))return!1;for(var n=1,s=e.length;n<s;n++)if(t.charAt(i+n)!=e.charAt(n))return!1;return!0}function u(e,t){for(var i=0,n=t.length;i<n;i++)if(t[i].o==e.n)return e.tag="#",!0}function d(e,t,i){for(var n=0,s=i.length;n<s;n++)if(i[n].c==e&&i[n].o==t)return!0}function h(e){return e.replace(a,"\\\\").replace(i,'\\"').replace(n,"\\n").replace(s,"\\r")}function p(e){return~e.indexOf(".")?"d":"f"}function m(e){for(var t="",i=0,n=e.length;i<n;i++){var s=e[i].tag;"#"==s?t+=g(e[i].nodes,e[i].n,p(e[i].n),e[i].i,e[i].end,e[i].otag+" "+e[i].ctag):"^"==s?t+=f(e[i].nodes,e[i].n,p(e[i].n)):"<"==s||">"==s?t+=b(e[i]):"{"==s||"&"==s?t+=w(e[i].n,p(e[i].n)):"\n"==s?t+=y('"\\n"'+(e.length-1==i?"":" + i")):"_v"==s?t+=v(e[i].n,p(e[i].n)):void 0===s&&(t+=y('"'+h(e[i])+'"'))}return t}function g(e,t,i,n,s,a){return"if(_.s(_."+i+'("'+h(t)+'",c,p,1),c,p,0,'+n+","+s+',"'+a+'")){_.rs(c,p,function(c,p,_){'+m(e)+"});c.pop();}"}function f(e,t,i){return"if(!_.s(_."+i+'("'+h(t)+'",c,p,1),c,p,1,0,0,"")){'+m(e)+"};"}function b(e){return'_.b(_.rp("'+h(e.n)+'",c,p,"'+(e.indent||"")+'"));'}function w(e,t){return"_.b(_.t(_."+t+'("'+h(e)+'",c,p,0)));'}function v(e,t){return"_.b(_.v(_."+t+'("'+h(e)+'",c,p,0)));'}function y(e){return"_.b("+e+");"}e.scan=function(e,i){var n=e.length,s=0,a=null,u=null,d="",h=[],p=!1,m=0,g=0,f="{{",b="}}";function w(){d.length>0&&(h.push(new String(d)),d="")}function v(e,i){if(w(),e&&function(){for(var e=!0,i=g;i<h.length;i++)if(!(e=h[i].tag&&o[h[i].tag]<o._v||!h[i].tag&&null===h[i].match(t)))return!1;return e}())for(var n,s=g;s<h.length;s++)h[s].tag||((n=h[s+1])&&">"==n.tag&&(n.indent=h[s].toString()),h.splice(s,1));else i||h.push({tag:"\n"});p=!1,g=h.length}function y(e,t){var i="="+b,n=e.indexOf(i,t),s=l(e.substring(e.indexOf("=",t)+1,n)).split(" ");return f=s[0],b=s[1],n+i.length-1}for(i&&(i=i.split(" "),f=i[0],b=i[1]),m=0;m<n;m++)0==s?c(f,e,m)?(--m,w(),s=1):"\n"==e.charAt(m)?v(p):d+=e.charAt(m):1==s?(m+=f.length-1,"="==(a=(u=o[e.charAt(m+1)])?e.charAt(m+1):"_v")?(m=y(e,m),s=0):(u&&m++,s=2),p=m):c(b,e,m)?(h.push({tag:a,n:l(d),otag:f,ctag:b,i:"/"==a?p-b.length:m+f.length}),d="",m+=b.length-1,s=0,"{"==a&&("}}"==b?m++:r(h[h.length-1]))):d+=e.charAt(m);return v(p,!0),h},e.generate=function(t,i,n){var s='var _=this;_.b(i=i||"");'+m(t)+"return _.fl();";return n.asString?"function(c,p,i){"+s+";}":new e.Template(new Function("c","p","i",s),i,e,n)},e.parse=function(e,t,i){return function e(t,i,n,s){for(var a=[],o=null,r=null;t.length>0;)if("#"==(r=t.shift()).tag||"^"==r.tag||u(r,s))n.push(r),r.nodes=e(t,r.tag,n,s),a.push(r);else{if("/"==r.tag){if(0===n.length)throw new Error("Closing tag without opener: /"+r.n);if(o=n.pop(),r.n!=o.n&&!d(r.n,o.n,s))throw new Error("Nesting error: "+o.n+" vs. "+r.n);return o.end=r.i,a}a.push(r)}if(n.length>0)throw new Error("missing closing tag: "+n.pop().n);return a}(e,0,[],(i=i||{}).sectionTags||[])},e.cache={},e.compile=function(e,t){var i=e+"||"+!!(t=t||{}).asString,n=this.cache[i];return n||(n=this.generate(this.parse(this.scan(e,t.delimiters),e,t),e,t),this.cache[i]=n)}}(t)},"./node_modules/hogan.js/lib/hogan.js":function(e,t,i){var n=i("./node_modules/hogan.js/lib/compiler.js");n.Template=i("./node_modules/hogan.js/lib/template.js").Template,e.exports=n},"./node_modules/hogan.js/lib/template.js":function(e,t,i){!function(e,t){e.Template=function(e,t,i,n){this.r=e||this.r,this.c=i,this.options=n,this.text=t||"",this.buf=""},e.Template.prototype={r:function(e,t,i){return""},v:function(e){return e=l(e),r.test(e)?e.replace(i,"&amp;").replace(n,"&lt;").replace(s,"&gt;").replace(a,"&#39;").replace(o,"&quot;"):e},t:l,render:function(e,t,i){return this.ri([e],t||{},i)},ri:function(e,t,i){return this.r(e,t,i)},rp:function(e,t,i,n){var s=i[e];return s?(this.c&&"string"==typeof s&&(s=this.c.compile(s,this.options)),s.ri(t,i,n)):""},rs:function(e,t,i){var n=e[e.length-1];if(c(n))for(var s=0;s<n.length;s++)e.push(n[s]),i(e,t,this),e.pop();else i(e,t,this)},s:function(e,t,i,n,s,a,o){var r;return(!c(e)||0!==e.length)&&("function"==typeof e&&(e=this.ls(e,t,i,n,s,a,o)),r=""===e||!!e,!n&&r&&t&&t.push("object"==typeof e?e:t[t.length-1]),r)},d:function(e,t,i,n){var s=e.split("."),a=this.f(s[0],t,i,n),o=null;if("."===e&&c(t[t.length-2]))return t[t.length-1];for(var r=1;r<s.length;r++)a&&"object"==typeof a&&s[r]in a?(o=a,a=a[s[r]]):a="";return!(n&&!a)&&(n||"function"!=typeof a||(t.push(o),a=this.lv(a,t,i),t.pop()),a)},f:function(e,t,i,n){for(var s=!1,a=null,o=!1,r=t.length-1;r>=0;r--)if((a=t[r])&&"object"==typeof a&&e in a){s=a[e],o=!0;break}return o?(n||"function"!=typeof s||(s=this.lv(s,t,i)),s):!n&&""},ho:function(e,t,i,n,s){var a=this.c,o=this.options;return o.delimiters=s,n=null==(n=e.call(t,n))?String(n):n.toString(),this.b(a.compile(n,o).render(t,i)),!1},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ls:function(e,t,i,n,s,a,o){var r,l=t[t.length-1];if(!n&&this.c&&e.length>0)return this.ho(e,l,i,this.text.substring(s,a),o);if("function"==typeof(r=e.call(l))){if(n)return!0;if(this.c)return this.ho(r,l,i,this.text.substring(s,a),o)}return r},lv:function(e,t,i){var n=t[t.length-1],s=e.call(n);return"function"==typeof s&&(s=l(s.call(n)),this.c&&~s.indexOf("{{"))?this.c.compile(s,this.options).render(n,i):l(s)}};var i=/&/g,n=/</g,s=/>/g,a=/\'/g,o=/\"/g,r=/[&<>\"\']/;function l(e){return String(null===e||void 0===e?"":e)}var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}(t)},"./node_modules/webpack/buildin/global.js":function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(i=window)}e.exports=i},"./src/mobile.categories.overlays/CategoryGateway.js":function(e,t,i){var n,s=i("./src/mobile.startup/actionParams.js"),a=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/search/SearchGateway.js");function r(){r.parent.apply(this,arguments)}n={continueParams:{},canContinue:!0,searchNamespace:14,save:function(e,t){return this.api.postWithToken("csrf",{action:"edit",title:e,appendtext:t,summary:mw.msg("mobile-frontend-categories-summary")})},getCategories:function(e){var t,i=this;return!1!==this.canContinue&&(t=a.extend({},{prop:"categories",titles:e,clprop:"hidden",cllimit:50},this.continueParams),this.api.get(s(t)).then(function(e){return void 0!==e.continue?i.continueParams=e.continue:i.canContinue=!1,e}))}},OO.inheritClass(r,o),a.extend(r.prototype,n),e.exports=r},"./src/mobile.editor.overlay/AbuseFilterOverlay.js":function(e,t,i){var n=i("./src/mobile.startup/Button.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/mfExtend.js"),o=i("./src/mobile.startup/Overlay.js");function r(e){o.call(this,s.extend({className:"overlay abusefilter-overlay"},e))}a(r,o,{defaults:s.extend({},o.prototype.defaults,{confirmButton:new n({additionalClassNames:"cancel",progressive:!0}).options}),templatePartials:s.extend({},o.prototype.templatePartials,{button:n.prototype.template,content:mw.template.get("mobile.editor.overlay","AbuseFilterOverlay.hogan")}),postRender:function(){o.prototype.postRender.apply(this),this.$el.find("a").attr("target","_blank")}}),e.exports=r},"./src/mobile.editor.overlay/AbuseFilterPanel.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/View.js"),a=i("./src/mobile.startup/mfExtend.js"),o=i("./src/mobile.editor.overlay/AbuseFilterOverlay.js");function r(e){this.isDisallowed=!1,this.overlayManager=e.overlayManager,s.call(this,n.extend({className:"panel hidden"},e))}a(r,s,{defaults:{readMoreMsg:mw.msg("mobile-frontend-editor-abusefilter-read-more")},template:mw.template.get("mobile.editor.overlay","AbuseFilterPanel.hogan"),show:function(e,t){var i;this.overlayManager.add(/^\/abusefilter$/,function(){return new o({message:t})}),"warning"===e?i=mw.msg("mobile-frontend-editor-abusefilter-warning"):"disallow"===e&&(i=mw.msg("mobile-frontend-editor-abusefilter-disallow"),this.isDisallowed=!0),this.$el.find(".message p").text(i),this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}),e.exports=r},"./src/mobile.editor.overlay/BlockMessage.js":function(e,t,i){"use strict";var n=i("./src/mobile.startup/Drawer.js"),s=i("./src/mobile.startup/Button.js"),a=i("./src/mobile.startup/mfExtend.js"),o=i("./src/mobile.startup/Icon.js"),r=i("./src/mobile.startup/util.js");function l(){n.apply(this,arguments)}a(l,n,{defaults:r.extend({},n.prototype.defaults,{stopHandIcon:new o({name:"stop-hand"}).options,userIcon:new o({tagName:"span",name:"profile"}).options,okButton:new s({label:mw.msg("ok"),tagName:"button",progressive:!0,additionalClassNames:"cancel"}).options,createDetailsAnchorHref:function(){return mw.util.getUrl("Special:BlockList",{wpTarget:"#"+this.blockId})},createDetailsAnchorLabel:function(){return mw.msg("mobile-frontend-editor-blocked-drawer-help")},createTitle:function(){return this.partial?mw.msg("mobile-frontend-editor-blocked-drawer-title-partial"):mw.msg("mobile-frontend-editor-blocked-drawer-title")},reasonHeader:mw.msg("mobile-frontend-editor-blocked-drawer-reason-header"),creatorHeader:function(){return mw.msg("mobile-frontend-editor-blocked-drawer-creator-header",this.user.options.gender||"unknown")},expiryHeader:mw.msg("mobile-frontend-editor-blocked-drawer-expiry-header")}),templatePartials:r.extend({},n.prototype.templatePartials,{button:s.prototype.template,icon:o.prototype.template}),onShowDrawer:function(){var e=mw.config.get("wgDBname");n.prototype.onShowDrawer.apply(this),mw.config.get("wgEnableBlockNoticeStats")&&mw.track("counter.MediaWiki.BlockNotices."+e+".MobileFrontend.shown",1)},template:mw.template.get("mobile.editor.overlay","BlockMessage.hogan")}),e.exports=l},"./src/mobile.editor.overlay/EditorGateway.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.editor.overlay/parseSaveError.js"),a=i("./src/mobile.startup/actionParams.js");function o(e){this.api=e.api,this.title=e.title,this.sectionId=e.sectionId,this.oldId=e.oldId,this.content=e.isNewPage?"":void 0,this.hasChanged=!1}o.prototype={getBlockInfo:function(e){var t;return e.actions&&e.actions.edit&&Array.isArray(e.actions.edit)&&(e.actions.edit.some(function(e){return-1!==["blocked","autoblocked"].indexOf(e.code)&&(t=e,!0)}),t&&t.data&&t.data.blockinfo)?(mw.loader.load("moment"),t.data.blockinfo):null},getContent:function(){var e,t=this;function i(){return n.Deferred().resolve({text:t.content||"",blockinfo:t.blockinfo,userinfo:t.userinfo})}return void 0!==this.content?i():(e=a({prop:["revisions","info"],meta:"userinfo",rvprop:["content","timestamp"],titles:t.title,intestactions:"edit",intestactionsdetail:"full",uiprop:"options"}),this.oldId&&(e.rvstartid=this.oldId),n.isNumeric(this.sectionId)&&(e.rvsection=this.sectionId),this.api.get(e).then(function(e){var s,a;return e.error?n.Deferred().reject(e.error.code):(void 0!==(a=e.query.pages[0]).missing?t.content="":(s=a.revisions[0],t.content=s.content,t.timestamp=s.timestamp),t.userinfo=e.query.userinfo,t.originalContent=t.content,t.blockinfo=t.getBlockInfo(a),i())}))},setContent:function(e){this.originalContent!==e?this.hasChanged=!0:this.hasChanged=!1,this.content=e},setPrependText:function(e){this.prependtext=e,this.hasChanged=!0},save:function(e){var t=this,i=n.Deferred();return e=e||{},function(){var a={action:"edit",title:t.title,summary:e.summary,captchaid:e.captchaId,captchaword:e.captchaWord,basetimestamp:t.timestamp,starttimestamp:t.timestamp};return void 0!==t.content?a.text=t.content:t.prependtext&&(a.prependtext=t.prependtext),n.isNumeric(t.sectionId)&&(a.section=t.sectionId),t.api.postWithToken("csrf",a).then(function(e){e&&e.edit&&"Success"===e.edit.result?(t.hasChanged=!1,i.resolve()):i.reject(s(e))},function(e,t){i.reject(s(t,e||"unknown"))}),i}()},abortPreview:function(){this._pending&&this._pending.abort()},getPreview:function(e){var t,i=n.Deferred(),s="",a=this;return n.extend(e,{action:"parse",sectionpreview:!0,pst:!0,mobileformat:!0,title:this.title,prop:["text","sections"]}),this.abortPreview(),t=this.api.post(e),this._pending=t.then(function(e){e&&e.parse&&e.parse.text?(0!==a.sectionId&&void 0!==e.parse.sections&&void 0!==e.parse.sections[0]&&void 0!==e.parse.sections[0].line&&(s=e.parse.sections[0].line),i.resolve({text:e.parse.text["*"],line:s})):i.reject()},function(){i.reject()}).promise({abort:function(){t.abort()}}),i}},e.exports=o},"./src/mobile.editor.overlay/EditorOverlay.js":function(e,t,i){var n=i("./src/mobile.editor.overlay/EditorOverlayBase.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/Section.js"),o=i("./src/mobile.editor.overlay/saveFailureMessage.js"),r=i("./src/mobile.editor.overlay/EditorGateway.js"),l=i("./src/mobile.editor.overlay/AbuseFilterPanel.js"),c=i("./src/mobile.startup/Button.js"),u=i("./src/mobile.startup/mfExtend.js"),d=i("./src/mobile.editor.overlay/BlockMessage.js"),h=i("./src/mobile.editor.overlay/VisualEditorOverlay.js"),p=i("./src/mobile.startup/MessageBox.js");function m(e){this.gateway=new r({api:e.api,title:e.title,sectionId:e.sectionId,oldId:e.oldId,isNewPage:e.isNewPage}),this.readOnly=!!e.oldId,this.isVisualEditorEnabled()&&(e.editSwitcher=!0),this.readOnly?(e.readOnly=!0,e.editingMsg=mw.msg("mobile-frontend-editor-viewing-source-page",e.title)):e.editingMsg=mw.msg("mobile-frontend-editor-editing-page",e.title),e.isAnon&&(e=this._prepareAnonWarning(e)),e.isVisualEditor=!1,e.previewingMsg=mw.msg("mobile-frontend-editor-previewing-page",e.title),n.call(this,s.extend({events:{"input .wikitext-editor":"onInputWikitextEditor"}},e))}u(m,n,{templatePartials:s.extend({},n.prototype.templatePartials,{content:mw.template.get("mobile.editor.overlay","content.hogan"),messageBox:p.prototype.template,anonWarning:mw.template.get("mobile.editor.overlay","EditorOverlayAnonWarning.hogan")}),defaults:s.extend({},n.prototype.defaults,{loginButton:new c({block:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,signupButton:new c({block:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options,anonButton:new c({label:mw.msg("mobile-frontend-editor-anon"),block:!0,additionalClassNames:"continue anonymous",progressive:!0}).options,warningOptions:{className:"warningbox anon-msg",msg:mw.msg("mobile-frontend-editor-anonwarning")}}),editor:"wikitext",sectionLine:"",isVisualEditorEnabled:function(){var e=mw.config.get("wgVisualEditorConfig")&&mw.config.get("wgVisualEditorConfig").namespaces;return e&&e.indexOf(mw.config.get("wgNamespaceNumber"))>-1&&"translation"!==mw.config.get("wgTranslatePageTranslation")&&"wikitext"===mw.config.get("wgPageContentModel")},onInputWikitextEditor:function(){this.gateway.setContent(this.$el.find(".wikitext-editor").val()),this.$el.find(".continue, .submit").prop("disabled",!1)},onClickContinue:function(e){if(this.options.isAnon&&this.$el.find(e.target).hasClass("anonymous"))return this._showEditorAfterWarning(),!1;n.prototype.onClickContinue.apply(this,arguments)},onClickBack:function(){n.prototype.onClickBack.apply(this,arguments),this._hidePreview()},postRender:function(){var e=this;this.isVisualEditorEnabled()&&mw.loader.using("ext.visualEditor.switching").then(function(){var t,i=new OO.ui.ToolFactory,n=new OO.ui.ToolGroupFactory;i.register(mw.libs.ve.MWEditModeVisualTool),i.register(mw.libs.ve.MWEditModeSourceTool),(t=new OO.ui.Toolbar(i,n,{classes:["editor-switcher"]})).on("switchEditor",function(t){"visual"===t&&(e.gateway.hasChanged?window.confirm(mw.msg("mobile-frontend-editor-switch-confirm"))&&e.onStageChanges():e._switchToVisualEditor(e.options))}),t.setup([{name:"editMode",type:"list",icon:"edit",title:mw.msg("visualeditor-mweditmode-tooltip"),include:["editModeVisual","editModeSource"]}]),e.$el.find(".switcher-container").html(t.$element),t.emit("updateState")}),n.prototype.postRender.apply(this),this.$preview=this.$el.find(".preview"),this.$content=this.$el.find(".wikitext-editor"),this.$content.addClass("mw-editfont-"+mw.user.options.get("editfont")),e.options.isAnon&&(this.$anonWarning=this.$el.find(".anonwarning"),this.$content.hide(),this.$anonHiddenButtons=this.$el.find(".overlay-header .continue, .editor-switcher").hide(),this.hideSpinner()),this.$el.find(".license a").attr("target","_blank"),this.abuseFilterPanel=new l({overlayManager:this.overlayManager}).appendTo(this.$el.find(".panels")),this.readOnly&&this.$content.prop("readonly",!0),this.$content.on("input",this._resizeEditor.bind(this)),e.options.isAnon||this._loadContent()},_prepareAnonWarning:function(e){var t=s.extend({returnto:e.returnTo||mw.config.get("wgPageName"),returntoquery:"action=edit&section="+e.sectionId,warning:"mobile-frontend-edit-login-action"},e.queryParams),i=s.extend({type:"signup",warning:"mobile-frontend-edit-signup-action"},e.signupQueryParams);return e.loginButton=s.extend({href:mw.util.getUrl("Special:UserLogin",t)},this.defaults.loginButton),e.signupButton=s.extend({href:mw.util.getUrl("Special:UserLogin",s.extend(t,i))},this.defaults.signupButton),e},_showEditorAfterWarning:function(){this.showSpinner(),this.$anonWarning.hide(),this.$anonHiddenButtons.show(),this._loadContent()},onStageChanges:function(){var e=this,t={text:this.getContent()};function i(){e.hideSpinner(),e.$preview.show()}this.scrollTop=s.getDocument().find("body").scrollTop(),this.$content.hide(),this.showSpinner(),mw.config.get("wgIsMainPage")&&(t.mainpage=1),this.gateway.getPreview(t).then(function(t){var n=t.text,s=t.line;e.sectionLine=e.parseHTML("<div>").html(s).text(),new a({el:e.$preview,text:n}).$el.find("a").on("click",!1),i()},function(){e.$preview.addClass("error").text(mw.msg("mobile-frontend-editor-error-preview")),i()}),n.prototype.onStageChanges.apply(this,arguments)},_hidePreview:function(){this.gateway.abortPreview(),this.hideSpinner(),this.$preview.removeClass("error").hide(),this.$content.show(),window.scrollTo(0,this.scrollTop),this.showHidden(".initial-header"),this.abuseFilterPanel.hide()},_resizeEditor:function(){var e,t,i;this.$scrollContainer?i=this.$scrollContainer:(t=OO.ui.Element.static.getClosestScrollableContainer(this.$content[0]),i=this.$el.find(t).length?this.$el.find(t):s.getDocument(),this.$scrollContainer=i,this.$content.css("padding-bottom",.6*this.$scrollContainer.height())),this.$content.prop("scrollHeight")&&i.length&&(e=i.scrollTop(),this.$content.css("height","auto").css("height",this.$content.prop("scrollHeight")+2+"px"),i.scrollTop(e))},setContent:function(e){this.$content.show().val(e),this._resizeEditor()},getContent:function(){return this.$content.val()},_parseBlockInfo:function(e){var t,i,n,s=window.moment;return t={partial:e.blockinfo.blockpartial||!1,user:e.userinfo,creator:{name:e.blockinfo.blockedby,url:mw.util.getUrl(mw.config.get("wgFormattedNamespaces")[2]+":"+e.blockinfo.blockedby)},expiry:null,duration:null,reason:"",blockId:e.blockinfo.blockid},i=e.blockinfo.blockexpiry,-1===["infinite","indefinite","infinity","never"].indexOf(i)&&(t.expiry=s(i).format("LLL"),t.duration=s().to(i,!0)),n=e.blockinfo.blockreason,t.reason=n?function(e){var t,i;t=new mw.jqueryMsg.parser;try{return i=t.wikiTextToAst(e),t.emitter.emit(i).html()}catch(e){return!1}}(n)||mw.html.escape(n):mw.message("mobile-frontend-editor-generic-block-reason").escaped(),t},_loadContent:function(){var e=this,t=this.$el;this.$content.hide(),this.showSpinner(),t.addClass("overlay-loading"),this.gateway.getContent().then(function(i){var n,s=i.text;e.setContent(s),i.blockinfo?mw.loader.using("moment").then(function(){n=e._parseBlockInfo(i),new d(n).toggle(),e.hide(),e.hideSpinner(),t.removeClass("overlay-loading")}):(e.hideSpinner(),t.removeClass("overlay-loading"))},function(){e.reportError(mw.msg("mobile-frontend-editor-error-loading")),t.removeClass("overlay-loading")})},_switchToVisualEditor:function(e){var t=this;this.log({action:"abort",type:"switchnochange",mechanism:"navigate"}),mw.storage.set("preferredEditor","VisualEditor"),this.showSpinner(),this.$content.hide(),mw.loader.using("ext.visualEditor.targetLoader").then(function(){return mw.libs.ve.targetLoader.addPlugin("mobile.editor.ve"),mw.libs.ve.targetLoader.loadModules("visual")}).then(function(){e.EditorOverlay=m,t.hideSpinner(),delete e.className,t.switching=!0,t.overlayManager.replaceCurrent(new h(e)),t.switching=!1},function(){t.hideSpinner(),t.$content.show()})},_showAbuseFilter:function(e,t){this.abuseFilterPanel.show(e,t),this.showHidden(".save-header"),this.$el.find(".continue, .submit").prop("disabled",this.abuseFilterPanel.isDisallowed)},onSaveBegin:function(){var e=this,t={summary:this.$el.find(".summary").val()};""!==e.sectionLine&&(t.summary="/* "+e.sectionLine+" */"+t.summary),n.prototype.onSaveBegin.apply(this,arguments),this.confirmAborted||(this.captchaId&&(t.captchaId=this.captchaId,t.captchaWord=this.$el.find(".captcha-word").val()),this.showHidden(".saving-header"),this.gateway.save(t).then(function(){var t=e.options.title;mw.config.get("wgIsMainPage")?window.location=mw.util.getUrl(t):e.onSaveComplete()},function(t){e.onSaveFailure(t)}))},onSaveFailure:function(e){var t,i;"captcha"===e.type?(this.captchaId=e.details.id,this.handleCaptcha(e.details)):"abusefilter"===e.type?this._showAbuseFilter(e.details.type,e.details.message):(i=o(e),"readonly"===e.type&&(t=mw.msg("apierror-readonly")),(i||t)&&(this.reportError(i,t),this.showHidden(".save-header, .save-panel"))),n.prototype.onSaveFailure.apply(this,arguments)},hasChanged:function(){return this.gateway.hasChanged}}),e.exports=m},"./src/mobile.editor.overlay/EditorOverlayBase.js":function(e,t,i){var n=i("./src/mobile.startup/Overlay.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/PageGateway.js"),o=i("./src/mobile.startup/Icon.js"),r=i("./src/mobile.startup/toast.js"),l=i("./src/mobile.editor.overlay/saveFailureMessage.js"),c=i("./src/mobile.startup/mfExtend.js"),u=i("./src/mobile.startup/MessageBox.js"),d=mw.user;function h(e,t){(t=t||{}).classes=["visual-editor"],h.super.call(this,e,t)}function p(e){var t=this,i=s.extend({className:"overlay editor-overlay",isBorderBox:!1},e,{events:s.extend({"click .back":"onClickBack","click .continue":"onClickContinue","click .submit":"onClickSubmit"},e.events)});i.isNewPage&&(i.placeholder=mw.msg("mobile-frontend-editor-placeholder-new-page",d)),0!==mw.config.get("wgNamespaceNumber")&&(i.summaryRequestMsg=mw.msg("mobile-frontend-editor-summary")),this.pageGateway=new a(i.api),this.editCount=i.editCount,this.isNewPage=i.isNewPage,this.isNewEditor=0===i.editCount,this.sectionId=i.sectionId,this.config=mw.config.get("wgMFEditorOptions"),this.sessionId=i.sessionId,this.overlayManager=i.overlayManager,this.allowCloseWindow=mw.confirmCloseWindow({test:function(){return t.hasChanged()},message:mw.msg("mobile-frontend-editor-cancel-confirm"),namespace:"editwarning"}),n.call(this,i)}OO.inheritClass(h,OO.ui.Tool),h.static.name="editVe",h.static.icon="edit",h.static.group="editorSwitcher",h.static.title=mw.msg("mobile-frontend-editor-switch-visual-editor"),h.prototype.onSelect=function(){},h.prototype.onUpdateState=function(){},c(p,n,{defaults:s.extend({},n.prototype.defaults,{hasToolbar:!1,continueMsg:mw.msg("mobile-frontend-editor-continue"),cancelMsg:mw.msg("mobile-frontend-editor-cancel"),closeMsg:mw.msg("mobile-frontend-editor-keep-editing"),summaryRequestMsg:mw.msg("mobile-frontend-editor-summary-request"),summaryMsg:mw.msg("mobile-frontend-editor-summary-placeholder"),placeholder:mw.msg("mobile-frontend-editor-placeholder"),waitMsg:mw.msg("mobile-frontend-editor-wait"),waitIcon:new o({name:"spinner",additionalClassNames:"savespinner loading"}).toHtmlString(),captchaMsg:mw.msg("mobile-frontend-account-create-captcha-placeholder"),captchaTryAgainMsg:mw.msg("mobile-frontend-editor-captcha-try-again"),switchMsg:mw.msg("mobile-frontend-editor-switch-editor"),confirmMsg:mw.msg("mobile-frontend-editor-cancel-confirm"),licenseMsg:void 0}),templatePartials:s.extend({},n.prototype.templatePartials,{editHeader:mw.template.get("mobile.editor.overlay","editHeader.hogan"),previewHeader:mw.template.get("mobile.editor.overlay","previewHeader.hogan"),saveHeader:mw.template.get("mobile.editor.overlay","saveHeader.hogan")}),template:mw.template.get("mobile.editor.overlay","EditorOverlayBase.hogan"),log:function(e){mw.track("mf.schemaEditAttemptStep",s.extend(e,{editor_interface:this.editor,editing_session_id:this.sessionId}))},confirmSave:function(){return!(this.isNewPage&&!window.confirm(mw.msg("mobile-frontend-editor-new-page-confirm",d)))},onSaveComplete:function(){var e,t=s.getWindow(),i=this.options.title;this.saved=!0,this.pageGateway.invalidatePage(i),e=this.isNewPage?mw.msg("mobile-frontend-editor-success-new-page"):this.isNewEditor?mw.msg("mobile-frontend-editor-success-landmark-1"):mw.msg("mobile-frontend-editor-success"),r.showOnPageReload(e,{type:"success"}),this.log({action:"saveSuccess"}),this.sectionLine?window.location.hash=this.sectionLine:window.location.hash="#",t.off("beforeunload.mfeditorwarning"),window.location.reload()},onSaveFailure:function(e){var t=e&&e.details&&e.details.code;"captcha"===e.type&&(t="captcha"),this.log({action:"saveFailure",message:l(e),type:{editconflict:"editConflict",wasdeleted:"editPageDeleted","abusefilter-disallowed":"extensionAbuseFilter",captcha:"extensionCaptcha",spamprotectiontext:"extensionSpamBlacklist","titleblacklist-forbidden-edit":"extensionTitleBlacklist"}[t]||"responseUnknown"})},reportError:function(e,t){var i=new u({className:"errorbox",msg:e,heading:t});this.$errorNoticeContainer.html(i.$el)},hideErrorNotice:function(){this.$errorNoticeContainer.empty()},onStageChanges:function(){this.showHidden(".save-header, .save-panel"),this.log({action:"saveIntent"}),window.scrollTo(0,1)},onSaveBegin:function(){this.confirmAborted=!1,this.hideErrorNotice(),this.confirmSave()?this.log({action:"saveAttempt"}):this.confirmAborted=!0},postRender:function(){this.log({action:"ready"}),this.log({action:"loaded"}),this.config.skipPreview?(this.nextStep="onSaveBegin",this.$el.find(".continue").text(this.defaults.saveMsg)):this.nextStep="onStageChanges",this.$errorNoticeContainer=this.$el.find("#error-notice-container"),n.prototype.postRender.apply(this),this.showHidden(".initial-header")},show:function(){this.saved=!1,n.prototype.show.call(this),mw.hook("mobileFrontend.editorOpened").fire(this.editor)},onClickBack:function(){},onClickSubmit:function(){this.onSaveBegin()},onClickContinue:function(){this[this.nextStep]()},hide:function(){var e,t=this;return this.hasChanged()?((e=OO.ui.getWindowManager()).addWindows([new mw.widgets.AbandonEditDialog]),e.openWindow("abandonedit").closed.then(function(e){e&&"discard"===e.action&&(t.log({action:"abort",mechanism:"cancel",type:"abandon"}),t.allowCloseWindow.release(),mw.hook("mobileFrontend.editorClosed").fire(),n.prototype.hide.call(t))})):(this.switching||this.saved||this.log({action:"abort",mechanism:"cancel",type:this.target&&this.target.edited?"abandon":"nochange"}),this.allowCloseWindow.release(),mw.hook("mobileFrontend.editorClosed").fire(),n.prototype.hide.call(t))},shouldConfirmLeave:function(e){return!(e||!this.hasChanged())},hasChanged:function(){},handleCaptcha:function(e){var t=this,i=this.$el.find(".captcha-word");this.captchaShown&&(i.val(""),i.attr("placeholder",this.options.captchaTryAgainMsg),setTimeout(function(){i.attr("placeholder",t.options.captchaMsg)},2e3)),0===e.mime.indexOf("image/")?(this.$el.find(".captcha-panel#question").detach(),this.$el.find(".captcha-panel img").attr("src",e.url)):(this.$el.find(".captcha-panel #image").detach(),0===e.mime.indexOf("text/html")?this.$el.find(".captcha-panel #question").html(e.question):this.$el.find(".captcha-panel #question").text(e.question)),this.showHidden(".save-header, .captcha-panel"),this.captchaShown=!0}}),e.exports=p},"./src/mobile.editor.overlay/VisualEditorOverlay.js":function(e,t,i){var n=i("./src/mobile.editor.overlay/EditorOverlayBase.js"),s=i("./src/mobile.editor.overlay/EditorGateway.js"),a=i("./src/mobile.startup/mfExtend.js"),o=i("./src/mobile.startup/util.js");function r(e){this.applyHeaderOptions(e,!0),n.call(this,o.extend({isBorderBox:!1,className:"overlay editor-overlay editor-overlay-ve"},e)),this.EditorOverlay=e.EditorOverlay,this.isNewPage=e.isNewPage,this.gateway=new s({api:e.api,title:e.title,sectionId:e.sectionId,oldId:e.oldId,isNewPage:e.isNewPage})}a(r,n,{templatePartials:o.extend({},n.prototype.templatePartials,{editHeader:mw.template.get("mobile.editor.overlay","toolbarVE.hogan"),content:mw.template.get("mobile.editor.overlay","contentVE.hogan")}),editor:"visualeditor",applyHeaderOptions:function(e,t){e.hasToolbar=t,e.isVisualEditor=t},destroyTarget:function(){this.target&&(this.target.destroy(),this.target=null)},show:function(){n.prototype.show.apply(this,arguments),this.target=ve.init.mw.targetFactory.create("article",this,{$element:this.$el,section:this.options.sectionId||null}),this.target.load(this.options.dataPromise)},hide:function(){var e=this,t=n.prototype.hide.apply(this,arguments);return!0===t?this.destroyTarget():t&&t.then&&t.then(function(t){t&&e.destroyTarget()}),t},onClickBack:function(){n.prototype.onClickBack.apply(this,arguments),this.switchToEditor()},switchToEditor:function(){this.showHidden(".initial-header")},switchToSourceEditor:function(){var e=this.EditorOverlay;this.log({action:"abort",type:"switchnochange",mechanism:"navigate"}),mw.storage.set("preferredEditor","SourceEditor"),this.showSpinner(),this.$el.find(".surface").hide(),this.hideSpinner(),this.applyHeaderOptions(this.options,!1),delete this.options.className,this.switching=!0,this.overlayManager.replaceCurrent(new e(this.options)),this.switching=!1},onSaveComplete:function(){n.prototype.onSaveComplete.apply(this,arguments),this.destroyTarget()},hasChanged:function(){return this.target&&this.target.getSurface()&&this.target.getSurface().getModel().hasBeenModified()&&!this.saved}}),e.exports=r},"./src/mobile.editor.overlay/parseSaveError.js":function(e,t){e.exports=function(e,t){var i;if(t)switch(t){case"readonly":return{type:"readonly",details:e.error};case"editconflict":return{type:"editconflict",details:e.error};default:return{type:"error",details:"http"}}if(e){if(e.error)return{type:"error",details:e.error.code};if(e.edit&&e.edit.captcha)return{type:"captcha",details:e.edit.captcha};if(e.edit&&e.edit.code)return t=e.edit.code,i=e.edit.warning,/^abusefilter-warning/.test(t)?{type:"abusefilter",details:{type:"warning",message:i}}:/^abusefilter-disallow/.test(t)?{type:"abusefilter",details:{type:"disallow",message:i}}:/^abusefilter/.test(t)?{type:"abusefilter",details:{type:"other",message:i}}:{type:"error",details:t}}return{type:"error",details:"unknown"}}},"./src/mobile.editor.overlay/saveFailureMessage.js":function(e,t){e.exports=function(e){var t=e&&e.details&&e.details.code;return"readonly"===e.type?e.details.readonlyreason:"editconflict"===t?mw.msg("mobile-frontend-editor-error-conflict"):["blocked","autoblocked"].indexOf(t)>-1?e.error.info:mw.msg("mobile-frontend-editor-error")}},"./src/mobile.languages.structured/LanguageSearcher.js":function(e,t,i){var n=i("./src/mobile.startup/View.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.languages.structured/util.js");function o(e){var t=a.getStructuredLanguages(e.languages,e.variants,a.getFrequentlyUsedLanguages(),e.deviceLanguage);n.call(this,s.extend({className:"language-searcher",events:{"click a":"onLinkClick","input .search":"onSearchInput"},inputPlaceholder:mw.msg("mobile-frontend-languages-structured-overlay-search-input-placeholder"),allLanguagesHeader:mw.msg("mobile-frontend-languages-structured-overlay-all-languages-header").toLocaleUpperCase(),suggestedLanguagesHeader:mw.msg("mobile-frontend-languages-structured-overlay-suggested-languages-header").toLocaleUpperCase(),allLanguages:t.all,allLanguagesCount:t.all.length,suggestedLanguages:t.suggested,suggestedLanguagesCount:t.suggested.length},e))}i("./src/mobile.startup/mfExtend.js")(o,n,{template:mw.template.get("mobile.languages.structured","LanguageSearcher.hogan"),postRender:function(){this.$siteLinksList=this.$el.find(".site-link-list"),this.$languageItems=this.$siteLinksList.find("a"),this.$subheaders=this.$el.find("h3")},onLinkClick:function(e){var t=this.$el.find(e.currentTarget).attr("lang"),i=this,n=this.$languageItems.filter(":visible");a.saveLanguageUsageCount(t,a.getFrequentlyUsedLanguages()),n.each(function(e,n){if(i.$el.find(n).hasClass(t))return!1})},onSearchInput:function(e){this.filterLanguages(this.$el.find(e.target).val().toLowerCase())},filterLanguages:function(e){var t=[];e?(this.options.languages.forEach(function(i){var n=i.langname;(i.autonym.toLowerCase().indexOf(e)>-1||n&&n.toLowerCase().indexOf(e)>-1||i.lang.toLowerCase().indexOf(e)>-1)&&t.push(i.lang)}),this.options.variants&&this.options.variants.forEach(function(i){(i.autonym.toLowerCase().indexOf(e)>-1||i.lang.toLowerCase().indexOf(e)>-1)&&t.push(i.lang)}),this.$languageItems.addClass("hidden"),t.length&&this.$siteLinksList.find("."+t.join(",.")).removeClass("hidden"),this.$siteLinksList.addClass("filtered"),this.$subheaders.addClass("hidden")):(this.$languageItems.removeClass("hidden"),this.$siteLinksList.removeClass("filtered"),this.$subheaders.removeClass("hidden"))}}),e.exports=o},"./src/mobile.languages.structured/rtlLanguages.js":function(e,t){e.exports=["aeb","aeb-arab","ar","arc","arq","arz","azb","bcc","bgn","bqi","ckb","dv","fa","glk","he","khw","kk-arab","kk-cn","ks","ks-arab","ku-arab","lki","lrc","luz","mzn","pnb","ps","sd","sdh","skr","skr-arab","ug","ug-arab","ur","yi"]},"./src/mobile.languages.structured/util.js":function(e,t,i){var n=mw.log,s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.languages.structured/rtlLanguages.js");e.exports={getDir:function(e){var t=a.indexOf(e.lang)>-1?"rtl":"ltr";return s.extend({},e,{dir:t})},getStructuredLanguages:function(e,t,i,s){var a=Object.prototype.hasOwnProperty,o=0,r=0,l=0,c=[],u=[],d=this;function h(e){return e.dir?e:(l++,d.getDir(e))}return(s=function(e,t){var i,n,s=Object.prototype.hasOwnProperty,a={};if(t)return-1!==(n=t.indexOf("-"))&&(i=t.slice(0,n)),e.forEach(function(e){e.lang!==i&&e.lang!==t||(a[e.lang]=!0)}),s.call(a,t)?t:s.call(a,i)?i:void 0}(e,s))&&(Object.keys(i).forEach(function(e){var t=i[e];o=o<t?t:o,r=r>t?t:r}),i[s]=o+1),e.map(h).forEach(function(e){a.call(i,e.lang)?(e.frequency=i[e.lang],c.push(e)):u.push(e)}),t&&t.map(h).forEach(function(e){a.call(i,e.lang)?e.frequency=i[e.lang]:e.frequency=r-1,c.push(e)}),c=c.sort(function(e,t){return t.frequency-e.frequency}),u=u.sort(function(e,t){return e.autonym.toLocaleLowerCase()<t.autonym.toLocaleLowerCase()?-1:1}),n.warn(0===l?"Direction is provided. Please remove handling in getStructuredLanguages":"`dir` attribute was missing from languages. Is T74153 resolved?"),{suggested:c,all:u}},getFrequentlyUsedLanguages:function(){var e=mw.storage.get("langMap");return e?JSON.parse(e):{}},saveFrequentlyUsedLanguages:function(e){mw.storage.set("langMap",JSON.stringify(e))},saveLanguageUsageCount:function(e,t){var i=t[e]||0;i+=1,t[e]=i>100?100:i,this.saveFrequentlyUsedLanguages(t)}}},"./src/mobile.mediaViewer/ImageGateway.js":function(e,t,i){var n=[320,640,800,1024,1280,1920,2560,2880],s=i("./src/mobile.startup/actionParams.js"),a=i("./src/mobile.startup/util.js");function o(e){for(var t=0;e>n[t]&&t<n.length-1;)++t;return n[t]}function r(e){this._cache={},this.api=e.api}r.prototype.getThumb=function(e){var t=this._cache[e],i=a.getWindow(),n=window.devicePixelRatio&&window.devicePixelRatio>1?window.devicePixelRatio:1;return t||(this._cache[e]=this.api.get(s({prop:"imageinfo",titles:e,iiprop:["url","extmetadata"],iiurlwidth:o(i.width()*n),iiurlheight:o(i.height()*n)})).then(function(e){if(e.query&&e.query.pages&&e.query.pages[0]&&e.query.pages[0].imageinfo)return e.query.pages[0].imageinfo[0];throw new Error("The API failed to return any pages matching the titles.")})),this._cache[e]},r._findSizeBucket=o,e.exports=r},"./src/mobile.mediaViewer/ImageOverlay.js":function(e,t,i){var n=i("./src/mobile.startup/Overlay.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/mfExtend.js"),o=i("./src/mobile.startup/Icon.js"),r=i("./src/mobile.startup/icons.js"),l=i("./src/mobile.startup/Button.js"),c=r.cancel("gray"),u=new l({label:mw.msg("mobile-frontend-media-details"),additionalClassNames:"button",progressive:!0}),d=new o({rotation:90,name:"arrow-invert"}),h=new o({rotation:-90,name:"arrow-invert"}),p=i("./src/mobile.mediaViewer/LoadErrorMessage.js"),m=i("./src/mobile.mediaViewer/ImageGateway.js"),g=mw.loader.require("mediawiki.router");function f(e){this.gateway=e.gateway||new m({api:e.api}),this.router=e.router||g,this.eventBus=e.eventBus,n.call(this,s.extend({className:"overlay media-viewer",events:{"click .image-wrapper":"onToggleDetails","click .slider-button":"onSlide"}},e))}a(f,n,{hasFixedHeader:!1,hideOnExitClick:!1,template:mw.template.get("mobile.mediaViewer","Overlay.hogan"),defaults:s.extend({},n.prototype.defaults,{licenseLinkMsg:mw.msg("mobile-frontend-media-license-link"),thumbnails:[]}),onSlide:function(e){var t=this.$el.find(e.target).closest(".slider-button").data("thumbnail");this.emit(f.EVENT_SLIDE,t)},preRender:function(){var e=this;this.options.thumbnails.forEach(function(t,i){t.getFileName()===e.options.title&&(e.options.caption=t.getDescription(),e.galleryOffset=i)})},_enableArrowImages:function(e){var t,i,n=this.galleryOffset;void 0===this.galleryOffset?(t=e[e.length-1],i=e[0]):(t=e[0===n?e.length-1:n-1],i=e[n===e.length-1?0:n+1]),this.$el.find(".prev").data("thumbnail",t),this.$el.find(".next").data("thumbnail",i)},_disableArrowImages:function(){this.$el.find(".prev, .next").remove()},_handleRetry:function(){this.router.emit("hashchange")},postRender:function(){var e,t=r.spinner().$el,i=this.options.thumbnails||[],s=this;function a(){s.hasLoadError=!0,t.hide(),s.$el.find(".image img").hide(),0===s.$el.find(".load-fail-msg").length&&new p({retryPath:s.router.getPath()}).on("retry",s._handleRetry.bind(s)).prependTo(s.$el.find(".image"))}function o(){e.addClass("image-loaded")}i.length<2?this._disableArrowImages():this._enableArrowImages(i),this.$details=this.$el.find(".details"),this.$el.find(".image").append(t),n.prototype.postRender.apply(this),this.$details.prepend(u.$el),this.gateway.getThumb(s.options.title).then(function(i){var n,r=i.descriptionurl+"#mw-jump-to-license";t.hide(),s.thumbWidth=i.thumbwidth,s.thumbHeight=i.thumbheight,s.imgRatio=i.thumbwidth/i.thumbheight,(e=s.parseHTML("<img>",document)).on("load",o).on("error",a),e.attr("src",i.thumburl).attr("alt",s.options.caption),s.$el.find(".image").append(e),s.$details.addClass("is-visible"),s._positionImage(),s.$el.find(".details a").attr("href",r),i.extmetadata&&(i.extmetadata.LicenseShortName&&s.$el.find(".license a").text(i.extmetadata.LicenseShortName.value).attr("href",r),i.extmetadata.Artist&&(n=i.extmetadata.Artist.value.replace(/<.*?>/g,""),s.$el.find(".license").prepend(n+" &bull; "))),s.adjustDetails()},function(){a()}),this.eventBus.on("resize:throttled",this._positionImage.bind(this))},onToggleDetails:function(){this.hasLoadError||(this.$el.find(".cancel, .slider-button").toggle(),this.$details.toggle(),this._positionImage())},onExitClick:function(e){n.prototype.onExitClick.apply(this,arguments),this.emit(f.EVENT_EXIT,e)},show:function(){n.prototype.show.apply(this,arguments),this._positionImage()},_positionImage:function(){var e,t,i,n,a,o=s.getWindow();this.adjustDetails(),e=this.$details.is(":visible")?this.$details.outerHeight():0,n=(t=o.width())/(i=o.height()-e),a=this.$el.find("img"),this.imgRatio>n?t<this.thumbWidth&&a.css({width:t,height:"auto"}):i<this.thumbHeight&&a.css({width:"auto",height:i}),this.$el.find(".image-wrapper").css("bottom",e),this.$el.find(".slider-button.prev").append(d.$el),this.$el.find(".slider-button.next").append(h.$el),c.$el.insertBefore(this.$details)},adjustDetails:function(){var e=s.getWindow().height();this.$el.find(".details").height()>.5*e&&this.$el.find(".details").css("max-height",.5*e)}}),f.EVENT_EXIT="ImageOverlay-exit",f.EVENT_SLIDE="ImageOverlay-slide",e.exports=f},"./src/mobile.mediaViewer/LoadErrorMessage.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js"),a=i("./src/mobile.startup/Icon.js"),o=i("./src/mobile.startup/View.js");function r(e){if(!e.retryPath)throw new Error("'retryPath' must be set in options param. Received: "+e.retryPath);o.call(this,{events:{"click .load-fail-msg-link a":"onRetry"}},e)}s(r,o,{template:mw.template.get("mobile.mediaViewer","LoadErrorMessage.hogan"),isTemplateMode:!0,defaults:n.extend({},r.prototype.defaults,{icon:new a({name:"alert-invert",additionalClassNames:"load-fail-msg-icon"}).toHtmlString(),msgToUser:mw.msg("mobile-frontend-media-load-fail-message"),retryTxt:mw.msg("mobile-frontend-media-load-fail-retry")}),postRender:function(){this.$el.find(".load-fail-msg-link a").attr("href","#"+this.options.retryPath)},onRetry:function(){return this.emit("retry"),!1}}),e.exports=r},"./src/mobile.special.nearby.scripts/Nearby.js":function(e,t,i){var n=i("./src/mobile.startup/MessageBox.js"),s=i("./src/mobile.special.nearby.scripts/NearbyGateway.js"),a=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/watchstar/WatchstarPageList.js");function r(e){var t=o;this.range=e.range||mw.config.get("wgMFNearbyRange")||1e3,this.source=e.source||"nearby",this.nearbyApi=new s({api:e.api}),this.eventBus=e.eventBus,e.errorType&&(e.errorOptions=this._errorOptions(e.errorType)),this.onItemClick=e.onItemClick,t.apply(this,arguments)}i("./src/mobile.startup/mfExtend.js")(r,o,{errorMessages:{empty:{heading:mw.msg("mobile-frontend-nearby-noresults"),hasHeading:!0,msg:mw.msg("mobile-frontend-nearby-noresults-guidance")},http:{heading:mw.msg("mobile-frontend-nearby-error"),hasHeading:!0,msg:mw.msg("mobile-frontend-nearby-error-guidance")},incompatible:{heading:mw.msg("mobile-frontend-nearby-requirements"),hasHeading:!0,msg:mw.msg("mobile-frontend-nearby-requirements-guidance")}},templatePartials:a.extend({},o.prototype.templatePartials,{pageList:o.prototype.template,messageBox:n.prototype.template}),template:mw.template.get("mobile.special.nearby.scripts","Nearby.hogan"),defaults:a.extend({},o.prototype.defaults,{errorOptions:void 0}),_find:function(e){var t=a.Deferred(),i=this;function n(n){e.pages=n,n&&0===n.length&&(e.errorOptions=i._errorOptions("empty")),i._isLoading=!1,t.resolve(e)}function s(n){i._isLoading=!1,e.errorOptions=i._errorOptions(n),t.resolve(e)}return e.latitude&&e.longitude?this.nearbyApi.getPages({latitude:e.latitude,longitude:e.longitude},this.range,e.exclude).then(n,s):e.pageTitle?this.nearbyApi.getPagesAroundPage(e.pageTitle,this.range).then(n,s):(e.errorType&&(e.errorOptions=this._errorOptions(e.errorType)),t.resolve(e)),t},_errorOptions:function(e){var t=this.errorMessages[e]||this.errorMessages.http;return a.extend({className:"errorbox"},t)},postRender:function(){var e=this;this._isLoading||this.$el.find(".page-list").removeClass("hidden"),o.prototype.postRender.apply(this),this._postRenderLinks(),this.$el.find(function(){e.eventBus.emit("Nearby-postRender")})},_postRenderLinks:function(){var e=this;this.$el.find("a").each(function(t){e.$el.find(this).attr("id","nearby-page-list-item-"+t)}).on("click",this.onItemClick)},refresh:function(e){var t=this,i=o;if(this.$el.find(".page-list").addClass("hidden"),this._isLoading=!0,e.latitude&&e.longitude||e.pageTitle)return e.pages=[],this._find(e).then(function(e){i.call(t,e)},function(n){e.errorOptions=t._errorOptions(n),t._isLoading=!1,i.call(t,e)});throw new Error("No title or longitude, latitude options have been passed")}}),e.exports=r},"./src/mobile.special.nearby.scripts/NearbyGateway.js":function(e,t,i){var n=i("./src/mobile.startup/Page.js"),s=mw.config.get("wgContentNamespaces"),a=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/extendSearchParams.js");function r(e){this.api=e.api}r.prototype={_distanceMessage:function(e){if(e<1){if(e*=100,1e3!==(e=10*Math.ceil(e)))return mw.msg("mobile-frontend-nearby-distance-meters",mw.language.convertNumber(e));e=1}else e>2?(e*=10,e=(e=Math.ceil(e)/10).toFixed(1)):(e*=100,e=(e=Math.ceil(e)/100).toFixed(2));return mw.msg("mobile-frontend-nearby-distance",mw.language.convertNumber(e))},getPages:function(e,t,i){return this._search({ggscoord:[e.latitude,e.longitude]},t,i)},getPagesAroundPage:function(e,t){return this._search({ggspage:e},t,e)},_search:function(e,t,i){var r,l=a.Deferred(),c=this;return r=o("nearby",{colimit:"max",prop:["coordinates"],generator:"geosearch",ggsradius:t,ggsnamespace:s,ggslimit:50},e),e.ggscoord?r.codistancefrompoint=e.ggscoord:e.ggspage&&(r.codistancefrompage=e.ggspage),this.api.ajax(r).then(function(e){var t;(t=(t=e.query&&e.query.pages||[]).map(function(e,t){var s,a;return(a=n.newFromJSON(e)).anchor="item_"+t,e.coordinates?(s=e.coordinates[0],a.dist=s.dist/1e3,a.latitude=s.lat,a.longitude=s.lon,a.proximity=c._distanceMessage(a.dist)):a.dist=0,i!==e.title?a:null}).filter(function(e){return!!e})).sort(function(e,t){return e.dist>t.dist?1:-1}),l.resolve(t)},function(e){l.reject(e)}),l}},e.exports=r},"./src/mobile.special.uploads.scripts/PhotoListGateway.js":function(e,t,i){var n=i("./src/mobile.startup/util.js");function s(e){this.api=e.api,this.url=e.url,this.username=e.username,this.category=e.category,this.limit=10,this.continueParams={continue:""},this.canContinue=!0}function a(e){return(e=e.replace(/\.[^. ]+$/,"")).replace(/^[^:]*:/,"").replace(/ \d{4}-\d{1,2}-\d{1,2} \d{1,2}-\d{1,2}$/,"")}s.prototype={getWidth:function(){return mw.config.get("wgMFThumbnailSizes").small},_getImageDataFromPage:function(e){var t=e.imageinfo[0];return{url:t.thumburl,title:e.title,timestamp:t.timestamp,description:a(e.title),descriptionUrl:t.descriptionurl}},getQuery:function(){var e=n.extend({action:"query",prop:"imageinfo",iiprop:"url|timestamp",iiurlwidth:this.getWidth()},this.continueParams);return this.username?n.extend(e,{generator:"allimages",gaiuser:this.username,gaisort:"timestamp",gaidir:"descending",gailimit:this.limit}):this.category&&n.extend(e,{generator:"categorymembers",gcmtitle:"Category:"+this.category,gcmtype:"file",gcmdir:"descending",gcmlimit:this.limit}),this.url&&(e.origin="*"),e},getPhotos:function(){var e=this;return this.api.ajax(this.getQuery(),{url:this.url}).then(function(t){var i=[];return t.query&&t.query.pages&&(i=Object.keys(t.query.pages).map(function(i){return e._getImageDataFromPage(t.query.pages[i])}).sort(function(e,t){return e.timestamp<t.timestamp?1:-1})),void 0!==t.continue?e.continueParams=t.continue:e.canContinue=!1,{canContinue:e.canContinue,photos:i}})}},s.test={getDescription:a},e.exports=s},"./src/mobile.special.watchlist.scripts/WatchList.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/PageList.js"),a=i("./src/mobile.startup/watchstar/WatchstarPageList.js"),o=i("./src/mobile.startup/ScrollEndEventEmitter.js"),r=i("./src/mobile.startup/util.js"),l=i("./src/mobile.special.watchlist.scripts/WatchListGateway.js");function c(e){var t,i=r.extend({},{isBorderBox:!1},e);this.scrollEndEventEmitter=new o(i.eventBus),this.scrollEndEventEmitter.on(o.EVENT_SCROLL_END,this._loadPages.bind(this)),i.el&&(t=this.getLastTitle(i.el)),this.gateway=new l(i.api,t),a.call(this,i)}n(c,a,{preRender:function(){this.scrollEndEventEmitter.disable(),this.scrollEndEventEmitter.setElement(this.$el)},postRender:function(){var e,t;s.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=Object.keys(this.parsePagesFromItems(e)).reduce(function(e,t){return e[t]=!0,e},{}),this.renderItems(e,t),this.scrollEndEventEmitter.enable()},_loadPages:function(){this.gateway.loadWatchlist().then(function(e){e.forEach(function(e){this.appendPage(e)}.bind(this)),this.render()}.bind(this))},appendPage:function(e){var t=r.extend({},e.options,{wikidataDescription:void 0});this.$el.append(this.templatePartials.item.render(t))},getLastTitle:function(e){return e.find("li:last").attr("title")}}),e.exports=c},"./src/mobile.special.watchlist.scripts/WatchListGateway.js":function(e,t,i){var n=i("./src/mobile.startup/Page.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/extendSearchParams.js");function o(e,t){this.api=e,this.limit=50,t?(this.continueParams={continue:"gwrcontinue||",gwrcontinue:"0|"+t.replace(/ /g,"_")},this.shouldSkipFirstTitle=!0):(this.continueParams={continue:""},this.shouldSkipFirstTitle=!1),this.canContinue=!0}o.prototype={loadWatchlist:function(){var e=this,t=a("watchlist",{prop:["info","revisions"],rvprop:"timestamp|user",generator:"watchlistraw",gwrnamespace:"0",gwrlimit:this.limit},this.continueParams);return!1===this.canContinue?s.Deferred().resolve([]):this.api.get(t,{url:this.apiUrl}).then(function(t){return void 0!==t.continue?e.continueParams=t.continue:e.canContinue=!1,e.parseData(t)})},parseData:function(e){var t;return e.query&&e.query.pages?((t=e.query.pages).sort(function(e,t){return e.title===t.title?0:e.title<t.title?-1:1}),this.shouldSkipFirstTitle&&(t=t.slice(1),this.shouldSkipFirstTitle=!1),t.map(n.newFromJSON)):[]}},e.exports=o},"./src/mobile.startup/Anchor.js":function(e,t,i){var n=i("./src/mobile.startup/View.js");function s(){n.apply(this,arguments)}i("./src/mobile.startup/mfExtend.js")(s,n,{isTemplateMode:!0,defaults:{progressive:void 0,destructive:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","anchor.hogan")}),e.exports=s},"./src/mobile.startup/Browser.js":function(e,t,i){var n,s=i("./src/mobile.startup/util.js");function a(e){var t=function t(){var i=this["__cache"+t.cacheId]||(this["__cache"+t.cacheId]={}),n=[].join.call(arguments,"|");return Object.prototype.hasOwnProperty.call(i,n)?i[n]:i[n]=e.apply(this,arguments)};return t.cacheId=Date.now().toString()+Math.random().toString(),t}function o(e,t){this.userAgent=e,this.$el=t,this._fixIosLandscapeBug()}o.prototype={_fixIosLandscapeBug:function(){var e=this;this.$el.find('meta[name="viewport"]')[0]&&(this.isIos(4)||this.isIos(5))&&(this.lockViewport(),document.addEventListener("gesturestart",function(){e.lockViewport()},!1))},isIos:a(function(e){var t=this.userAgent,i=/ipad|iphone|ipod/i.test(t);if(!i||!e)return i;switch(e){case 8:return/OS 8_/.test(t)||/Version\/8/.test(t);case 4:return/OS 4_/.test(t);case 5:return/OS 5_/.test(t);default:return!1}}),lockViewport:function(){this.$el&&this.$el.find('meta[name="viewport"]').attr("content","initial-scale=1.0, maximum-scale=1.0, user-scalable=no")},isWideScreen:a(function(){var e=parseInt(mw.config.get("wgMFDeviceWidthTablet"),10);return window.innerWidth>=e||window.innerHeight>=e}),supportsAnimations:a(function(){var e=document.createElement("foo").style;function t(t){return t in e||"webkit"+t[0].toUpperCase()+t.slice(1)in e}return t("animationName")&&t("transform")&&t("transition")}),supportsTouchEvents:a(function(){return"ontouchstart"in window}),supportsGeoLocation:a(function(){return"geolocation"in window.navigator})},o.getSingleton=function(){var e;return n||(e=s.getDocument(),n=new o(window.navigator.userAgent,e)),n},e.exports=o},"./src/mobile.startup/Button.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/View.js");function a(e){e.href&&(e.tagName="a"),s.call(this,e)}n(a,s,{isTemplateMode:!0,defaults:{tagName:"a",block:void 0,progressive:void 0,destructive:void 0,quiet:void 0,additionalClassNames:"",href:void 0,label:void 0},template:mw.template.get("mobile.startup","button.hogan")}),e.exports=a},"./src/mobile.startup/CtaDrawer.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/Drawer.js"),a=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/Button.js"),r=i("./src/mobile.startup/Anchor.js");function l(e){s.call(this,a.extend({},s.prototype.defaults,{progressiveButton:new o({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-login")}).options,actionAnchor:new r({progressive:!0,label:mw.msg("mobile-frontend-watchlist-cta-button-signup")}).options},e))}function c(e,t){return a.extend({returnto:t||mw.config.get("wgPageName")},e)}function u(){return[].push.call(arguments,{type:"signup"}),a.extend.apply(a,arguments)}n(l,s,{templatePartials:a.extend({},s.prototype.templatePartials,{button:o.prototype.template,anchor:r.prototype.template}),template:mw.template.get("mobile.startup","CtaDrawer.hogan"),preRender:function(){var e=c(this.options.queryParams,this.options.returnTo);this.options.progressiveButton.href||(this.options.progressiveButton.href=mw.util.getUrl("Special:UserLogin",e)),this.options.actionAnchor.href||(this.options.actionAnchor.href=mw.util.getUrl("Special:UserLogin",u(e,this.options.signupQueryParams)))}}),l.prototype.test={redirectParams:c,signUpParams:u},e.exports=l},"./src/mobile.startup/Drawer.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/Panel.js"),a=i("./src/mobile.startup/util.js"),o=i("./src/mobile.startup/Icon.js");function r(e){s.call(this,a.extend({className:"drawer position-fixed"},e,{events:a.extend({click:"stopPropagation"},(e||{}).events)}))}n(r,s,{defaults:a.extend({},s.prototype.defaults,{collapseIcon:new o({name:"arrow",additionalClassNames:"cancel"}).options}),templatePartials:a.extend({},s.prototype.templatePartials,{icon:o.prototype.template}),appendToElement:"body",closeOnScroll:!0,postRender:function(){var e=this;a.docReady(function(){e.appendTo(e.appendToElement),e.$el.parent().addClass("has-drawer")}),this.on("show",this.onShowDrawer.bind(this)),this.on("hide",this.onHideDrawer.bind(this))},stopPropagation:function(e){e.stopPropagation()},onShowDrawer:function(){var e=this;this.$el.parent().addClass("drawer-visible"),setTimeout(function(){var t=a.getWindow();t.one("click.drawer",e.hide.bind(e)),e.closeOnScroll&&t.one("scroll.drawer",e.hide.bind(e))},e.minHideDelay)},onHideDrawer:function(){this.$el.parent().removeClass("drawer-visible"),a.getWindow().off(".drawer")}}),e.exports=r},"./src/mobile.startup/Icon.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/View.js");function a(e){e.hasText&&(e.modifier="mw-ui-icon-before"),e.href&&(e.tagName="a"),s.call(this,e)}n(a,s,{preRender:function(){this.setRotationClass()},setRotationClass:function(){var e=this.options;if(e.rotation)switch(e.rotation){case-180:case 180:e._rotationClass="mf-mw-ui-icon-rotate-flip";break;case-90:e._rotationClass="mf-mw-ui-icon-rotate-anti-clockwise";break;case 90:e._rotationClass="mf-mw-ui-icon-rotate-clockwise";break;case 0:break;default:throw new Error("Bad value for rotation given. Must be 90, 0 or 180.")}},isTemplateMode:!0,defaults:{rotation:0,hasText:!1,href:void 0,glyphPrefix:"mf",tagName:"div",isSmall:!1,base:"mw-ui-icon",name:"",modifier:"mw-ui-icon-element",title:""},getClassName:function(){return this.$el.attr("class")},getGlyphClassName:function(){return this.options.base+"-"+this.options.glyphPrefix+"-"+this.options.name},toHtmlString:function(){return this.parseHTML("<div>").append(this.$el).html()},template:mw.template.get("mobile.startup","icon.hogan")}),e.exports=a},"./src/mobile.startup/MessageBox.js":function(e,t,i){var n=i("./src/mobile.startup/View.js");function s(){n.apply(this,arguments)}i("./src/mobile.startup/mfExtend.js")(s,n,{isTemplateMode:!0,defaults:{},template:mw.template.get("mobile.startup","MessageBox.hogan")}),e.exports=s},"./src/mobile.startup/Overlay.js":function(e,t,i){var n,s,a,o=i("./src/mobile.startup/View.js"),r=i("./src/mobile.startup/Icon.js"),l=i("./src/mobile.startup/Button.js"),c=i("./src/mobile.startup/Anchor.js"),u=i("./src/mobile.startup/icons.js"),d=i("./src/mobile.startup/util.js"),h=i("./src/mobile.startup/Browser.js").getSingleton(),p=i("./src/mobile.startup/mfExtend.js");try{s=!1,n=Object.defineProperty({},"passive",{get:function(){return s=!0,!0}}),window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n),a=!!s&&{passive:!1}}catch(e){}function m(e){this.isIos=h.isIos(),this.hasLoadError=!1,o.call(this,d.extend({className:"overlay"},e,{events:d.extend({"click .cancel, .confirm, .initial-header .back":"onExitClick",click:"stopPropagation"},e.events)}))}p(m,o,{hasFixedHeader:!0,fullScreen:!0,hideOnExitClick:!0,templatePartials:{header:mw.template.get("mobile.startup","header.hogan"),anchor:c.prototype.template,button:l.prototype.template},template:mw.template.get("mobile.startup","Overlay.hogan"),defaults:{saveMsg:mw.msg("mobile-frontend-editor-save"),cancelButton:u.cancel().toHtmlString(),backButton:new r({tagName:"button",name:"back",additionalClassNames:"back",label:mw.msg("mobile-frontend-overlay-close")}).toHtmlString(),headerButtonsListClassName:"",headerChrome:!1,spinner:u.spinner().toHtmlString()},closeOnContentTap:!1,showSpinner:function(){this.$spinner.removeClass("hidden")},hideSpinner:function(){this.$spinner.addClass("hidden")},postRender:function(){this.$overlayContent=this.$el.find(".overlay-content"),this.$spinner=this.$el.find(".spinner"),this.isIos&&this.$el.addClass("overlay-ios"),this.$el.find(".overlay-header h2 span").addClass("truncated-text"),this.setupEmulatedIosOverlayScrolling()},setupEmulatedIosOverlayScrolling:function(){var e=this,t=this.$el.find(".overlay-content");this.isIos&&this.hasFixedHeader&&(t[0].addEventListener("touchstart",this.onTouchStart.bind(this),a),t[0].addEventListener("touchmove",this.onTouchMove.bind(this),a),setTimeout(function(){var t=d.getWindow();e._resizeContent(t.height())},0))},onExitClick:function(e){e.preventDefault(),e.stopPropagation(),this.hideOnExitClick&&this.hide(),this.emit(m.EVENT_EXIT)},onTouchStart:function(e){this.startY=e.touches[0].pageY},onTouchMove:function(e){var t=e.touches[0].pageY,i=this.$overlayContent.outerHeight(),n=this.$overlayContent.prop("scrollHeight")-i;e.stopPropagation(),(0===this.$overlayContent.scrollTop()&&this.startY<t||this.$overlayContent.scrollTop()===n&&this.startY>t)&&e.preventDefault()},stopPropagation:function(e){e.stopPropagation()},show:function(){var e=this,t=d.getDocument(),i=d.getWindow();this.scrollTop=window.pageYOffset,this.fullScreen&&(t.addClass("overlay-enabled"),window.scrollTo(0,1)),this.closeOnContentTap&&t.find("#mw-mf-page-center").one("click",this.hide.bind(this)),this.isIos&&this.hasFixedHeader&&(this.iosTouchmoveHandler=function(e){e.preventDefault()},this.iosResizeHandler=function(){e._resizeContent(i.height())},i[0].addEventListener("touchmove",this.iosTouchmoveHandler,a),i.on("resize",this.iosResizeHandler)),this.$el.addClass("visible")},hide:function(){var e=d.getWindow(),t=d.getDocument();return this.fullScreen&&(t.removeClass("overlay-enabled"),window.scrollTo(window.pageXOffset,this.scrollTop)),this.$el.detach(),this.isIos&&(e[0].removeEventListener("touchmove",this.iosTouchmoveHandler,a),e.off("resize",this.iosResizeHandler)),this.emit("hide"),!0},_resizeContent:function(e){this.$overlayContent.height(e-this.$el.find(".overlay-header-container").outerHeight()-this.$el.find(".overlay-footer-container").outerHeight())},showHidden:function(e){this.$el.find(".hideable").addClass("hidden"),this.$el.find(e).removeClass("hidden")}}),m.EVENT_EXIT="Overlay-exit",m.make=function(e,t){var i=new m(e);return i.$el.find(".overlay-content").append(t.$el),i},e.exports=m},"./src/mobile.startup/OverlayManager.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=null;function a(e,t){e.on("route",this._checkRoute.bind(this)),this.router=e,this.entries={},this.stack=[],this.hideCurrent=!0,t||mw.log.warn("appendToSelector will soon be a required parameter to OverlayManager"),this.appendToSelector=t||"body"}function o(e){e.on("hide",function(){e.emit("_om_hide")})}i("./src/mobile.startup/mfExtend.js")(a,{_onHideOverlay:function(){this.hideCurrent=!1,this.router.back()},_attachOverlay:function(e){e.$el.parents().length||$(this.appendToSelector).append(e.$el)},_show:function(e){e.once("_om_hide",this._onHideOverlay.bind(this)),this._attachOverlay(e),e.show()},_hideOverlay:function(e){var t;return e.off("_om_hide"),(t=e.hide(this.stack.length>1))||e.once("_om_hide",this._onHideOverlay.bind(this)),t},_processMatch:function(e){var t,i=this;e&&(e.overlay?i._show(e.overlay):"function"==typeof(t=e.factoryResult).promise?t.then(function(t){e.overlay=t,o(t),i._show(t)}):(e.overlay=t,o(e.overlay),i._show(t)))},_checkRoute:function(e){var t,i=this.stack[0];i||(this.scrollTop=window.pageYOffset),t=Object.keys(this.entries).reduce(function(t,i){return t||this._matchRoute(e.path,this.entries[i])}.bind(this),null),i&&void 0!==i.overlay&&this.hideCurrent&&!this._hideOverlay(i.overlay)?e.preventDefault():t||(this.stack=[],window.scrollTo(window.pageXOffset,this.scrollTop)),this.hideCurrent=!0,this._processMatch(t)},_matchRoute:function(e,t){var i,n=e.match(t.route),s=this.stack[1],a=this;function o(){return{path:e,factoryResult:t.factory.apply(a,n.slice(1))}}return n?s&&s.path===e?s.overlay&&s.overlay.hasLoadError?(a.stack.shift(),a.stack[0]=o(),a.stack[0]):(a.stack.shift(),s):(i=o(),this.stack[0]&&i.path===this.stack[0].path?a.stack[0]=i:a.stack.unshift(i),i):null},add:function(e,t){var i=this,s={route:e,factory:t};this.entries[e]=s,n.docReady(function(){i._processMatch(i._matchRoute(i.router.getPath(),s))})},replaceCurrent:function(e){if(0===this.stack.length)throw new Error("Trying to replace OverlayManager's current overlay, but stack is empty");this._hideOverlay(this.stack[0].overlay),this.stack[0].overlay=e,o(e),this._show(e)}}),a.getSingleton=function(){return s||(s=new a(mw.loader.require("mediawiki.router"),"body")),s},e.exports=a},"./src/mobile.startup/Page.js":function(e,t,i){var n=mw.html,s=i("./src/mobile.startup/mfExtend.js"),a=i("./src/mobile.startup/time.js"),o=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/Section.js"),l=i("./src/mobile.startup/Thumbnail.js"),c=i("./src/mobile.startup/View.js"),u=mw.config.get("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).join(","),d=["noviewer","metadata"];function h(e){o.extend(this,{options:e,title:e.title,displayTitle:e.displayTitle,url:e.url||mw.util.getUrl(e.title),id:e.id,wikidataDescription:e.wikidataDescription,thumbnail:!!Object.prototype.hasOwnProperty.call(e,"thumbnail")&&e.thumbnail,isMissing:void 0!==e.isMissing?e.isMissing:0===e.id}),this.options.isBorderBox=!1,this.options.languageUrl=mw.util.getUrl("Special:MobileLanguages/"+this.title),c.call(this,this.options),this.displayTitle||(this.displayTitle=this.getDisplayTitle()),this.thumbnail&&this.thumbnail.width&&(this.thumbnail.isLandscape=this.thumbnail.width>this.thumbnail.height)}s(h,c,{defaults:{id:0,title:"",displayTitle:"",namespaceNumber:0,protection:{edit:["*"]},sections:[],isMissing:!1,isMainPage:!1,url:void 0,thumbnail:{isLandscape:void 0,source:void 0,width:void 0,height:void 0}},getDisplayTitle:function(){return this.options.displayTitle||n.escape(this.options.title)},inNamespace:function(e){return this.options.namespaceNumber===mw.config.get("wgNamespaceIds")[e]},findSectionHeadingByIndex:function(e){return e<1?this.$el.find():this.$el.find(u).filter('.mw-parser-output > *, [class^="mf-section-"] > *').eq(e-1)},findChildInSectionLead:function(e,t){var i,n,s,a,o=u;function r(e){return e.find(t).addBack()}return 0===e?(a=this.getLeadSectionElement())&&a.length?r(a.children(t)):(i=this.findSectionHeadingByIndex(1)).length?r(i.prevAll(t)):this.$el.find(t):(i=this.findSectionHeadingByIndex(e)).hasClass("section-heading")?(n=(s=i.next()).find(o).eq(0)).length?r(n.prevAll(t)):r(s.children(t)):(n=i.eq(0).nextAll(o).eq(0),i.nextUntil(n,t))},getLeadSectionElement:function(){return this.$el.find(".mf-section-0").length?this.$el.find(".mf-section-0"):null},isWikiText:function(){return"wikitext"===mw.config.get("wgPageContentModel")},isMainPage:function(){return this.options.isMainPage},isWatched:function(){return this.options.isWatched},getRevisionId:function(){return this.options.revId},getTitle:function(){return this.options.title},getId:function(){return this.options.id},getNamespaceId:function(){var e=this.options.title.split(":");return e[1]&&mw.config.get("wgNamespaceIds")[e[0].toLowerCase().replace(" ","_")]||0},isTalkPage:function(){var e=this.getNamespaceId();return e>0&&e%2==1},preRender:function(){this.sections=[],this._sectionLookup={},this.title=this.options.title,this.options.sections.forEach(function(e){var t=new r(e);this.sections.push(t),this._sectionLookup[t.id]=t}.bind(this))},getThumbnails:function(){var e=this.$el,t="."+d.join(",."),i=[];return this._thumbs||(e.find("a.image, a.thumbimage").not(t).each(function(){var n=e.find(this),s=n.find(".lazy-image-placeholder"),a=0===n.parents(t).length&&0===n.find(t).length,o=n.attr("href").match(/title=([^/&]+)/),r=n.attr("href").match(/[^/]+$/);s.length&&a&&(a=!new RegExp("\\b("+d.join("|")+")\\b").test(s.data("class"))),a&&(o||r)&&i.push(new l({el:n,filename:decodeURIComponent(o?o[1]:r[0])}))}),this._thumbs=i),this._thumbs},getSection:function(e){return this._sectionLookup[e]},getSections:function(){return this.sections},getRedLinks:function(){return this.$el.find(".new")}}),h.newFromJSON=function(e){var t,i,s=e.thumbnail,r=e.pageprops||{displaytitle:n.escape(e.title)},l=e.terms;return(r||l)&&(i=l&&l.label?n.escape(l.label[0]):r.displaytitle),e.wikidataDescription=e.description||void 0,s&&(e.thumbnail.isLandscape=s.width>s.height),e.revisions&&e.revisions[0]&&(t=e.revisions[0],e.lastModified=a.getLastModifiedMessage(new Date(t.timestamp).getTime()/1e3,t.user)),new h(o.extend(e,{id:e.pageid,isMissing:!!e.missing,url:mw.util.getUrl(e.title),displayTitle:i}))},h.HEADING_SELECTOR=u,e.exports=h},"./src/mobile.startup/PageGateway.js":function(e,t,i){var n=mw.template.get("mobile.startup","Section.hogan"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/Page.js"),o=i("./src/mobile.startup/actionParams.js"),r={};function l(e){var t,i=e.map(function(e){return e.level}).filter(function(e){return!!e}),s=Math.min.apply(this,i).toString(),a=[];return e.forEach(function(e){void 0!==e.line&&(e.line=e.line.replace(/<\/?a\b[^>]*>/g,"")),e.subsections=[],!t||!e.level||e.level===s||t.subsections.length&&t.subsections[0].level>e.level||t.level&&t.level>=e.level?(a.push(e),t=e):(!function e(t,i){var n;0===t.length?t.push(i):(n=t[t.length-1],parseInt(n.level,10)===parseInt(i.level,10)?t.push(i):e(n.subsections,i))}(t.subsections,e),t.text+=n.render(e))}),a}function c(e){this.api=e}c.prototype={getSections:function(e){var t=s.Deferred();return this.getPage(e).then(function(e){var i=new a(e);t.resolve(i.getSections())},function(e){"missingtitle"===e?t.resolve([]):t.reject()}),t.promise()},getPage:function(e,t,i){var n,a=s.Deferred(),c=t?{url:t,dataType:"jsonp"}:{},u={edit:["*"]};return s.extend(c,o({action:"mobileview",page:e,variant:mw.config.get("wgPageContentLanguage"),redirect:"yes",prop:"id|sections|text|lastmodified|lastmodifiedby|languagecount|hasvariants|protection|displaytitle|revision",noheadings:"yes",sectionprop:"level|line|anchor",sections:i?0:"all"})),r[e]||(r[e]=this.api.get(c).then(function(t){var i,o,r,c;return t.error?a.reject(t.error):t.mobileview.sections?(i=l((c=t.mobileview).sections),n=new Date(c.lastmodified).getTime()/1e3,o=c.lastmodifiedby,u=Array.isArray(c.protection)?u:s.extend(u,c.protection),r={title:e,id:c.id,revId:c.revId,protection:u,lead:i[0].text,sections:i.slice(1),isMainPage:void 0!==c.mainpage,historyUrl:mw.util.getUrl(e,{action:"history"}),lastModifiedTimestamp:n,languageCount:c.languagecount,hasVariants:void 0!==c.hasvariants,displayTitle:c.displaytitle},o&&s.extend(r,{lastModifiedUserName:o.name,lastModifiedUserGender:o.gender}),r):a.reject("No sections")},function(e){return a.reject(e)})),r[e]},invalidatePage:function(e){delete r[e]},_getLanguageVariantsFromApiResponse:function(e,t){var i=t.query.general,n=i.variantarticlepath,s=[];return!!i.variants&&(Object.keys(i.variants).forEach(function(t){var a=i.variants[t],o={autonym:a.name,lang:a.code};o.url=n?n.replace("$1",e).replace("$2",a.code):mw.util.getUrl(e,{variant:a.code}),s.push(o)}),s)},getPageLanguages:function(e,t){var i=this,n=o({meta:"siteinfo",siprop:"general",prop:"langlinks",lllimit:"max",titles:e});return t?(n.llprop="url|autonym|langname",n.llinlanguagecode=t):n.llprop="url|autonym",this.api.get(n).then(function(t){return{languages:t.query.pages[0].langlinks||[],variants:i._getLanguageVariantsFromApiResponse(e,t)}},function(){return s.Deferred().reject()})},_getAPIResponseFromHTML:function(e){var t=[];return e.find("h1,h2,h3,h4,h5,h6").each(function(){var i=this.tagName.substr(1),n=e.find(this).find(".mw-headline");n.length&&t.push({level:i,line:n.html(),anchor:n.attr("id")||"",text:""})}),t},getSectionsFromHTML:function(e){return l(this._getAPIResponseFromHTML(e))}},e.exports=c},"./src/mobile.startup/PageList.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/View.js"),a=i("./src/mobile.startup/Browser.js").getSingleton();function o(){s.apply(this,arguments)}n(o,s,{defaults:{pages:[]},renderPageImages:function(){var e=this;setTimeout(function(){e.$el.find(".list-thumb").each(function(){var t=e.$el.find(this).data("style");e.$el.find(this).attr("style",t)})},a.isWideScreen()?0:1e3)},postRender:function(){this.renderPageImages()},template:mw.template.get("mobile.startup","PageList.hogan"),templatePartials:{item:mw.template.get("mobile.startup","PageListItem.hogan")}}),e.exports=o},"./src/mobile.startup/Panel.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/View.js");function o(e){a.call(this,s.extend({className:"panel"},e,{events:s.extend({"click .cancel":"onCancel"},(e||{}).events)}))}n(o,a,{minHideDelay:10,onCancel:function(e){e.preventDefault(),this.hide()},show:function(){var e=this;e.isVisible()||setTimeout(function(){e.$el.addClass("visible animated"),e.emit("show")},e.minHideDelay)},hide:function(){var e=this;setTimeout(function(){e.$el.removeClass("visible"),e.emit("hide")},e.minHideDelay)},isVisible:function(){return this.$el.hasClass("visible")},toggle:function(){this.isVisible()?this.hide():this.show()}}),e.exports=o},"./src/mobile.startup/ScrollEndEventEmitter.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js");function a(e,t){this.threshold=t||100,this.eventBus=e,this.enable(),OO.EventEmitter.call(this)}OO.mixinClass(a,OO.EventEmitter),a.EVENT_SCROLL_END="ScrollEndEventEmitter-scrollEnd",s(a,{_bindScroll:function(){this._scrollHandler||(this._scrollHandler=this._onScroll.bind(this),this.eventBus.on("scroll:throttled",this._scrollHandler))},_unbindScroll:function(){this._scrollHandler&&(this.eventBus.off("scroll:throttled",this._scrollHandler),this._scrollHandler=null)},_onScroll:function(){this.$el&&this.enabled&&this.scrollNearEnd()&&(this.disable(),this.emit(a.EVENT_SCROLL_END))},scrollNearEnd:function(){var e=n.getWindow(),t=e.scrollTop()+e.height(),i=this.$el.offset().top+this.$el.outerHeight();return t+this.threshold>i},enable:function(){this.enabled=!0,this._bindScroll()},disable:function(){this.enabled=!1,this._unbindScroll()},setElement:function(e){this.$el=e}}),e.exports=a},"./src/mobile.startup/Section.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/icons.js"),a=i("./src/mobile.startup/View.js");function o(e){var t=this;e.tag="h"+e.level,this.line=e.line,this.text=e.text,this.hasReferences=e.hasReferences||!1,this.id=e.id||null,this.anchor=e.anchor,this.subsections=[],(e.subsections||[]).forEach(function(e){t.subsections.push(new o(e))}),a.call(this,e)}n(o,a,{template:mw.template.get("mobile.startup","Section.hogan"),defaults:{line:void 0,text:"",spinner:s.spinner().toHtmlString()}}),e.exports=o},"./src/mobile.startup/Thumbnail.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/View.js");function o(e){a.call(this,s.extend({isBorderBox:!1},e))}n(o,a,{defaults:{filename:void 0},postRender:function(){this.options.description=this.$el.siblings(".thumbcaption").text()},getDescription:function(){return this.options.description},getFileName:function(){return this.options.filename}}),e.exports=o},"./src/mobile.startup/Toggler.js":function(e,t,i){var n=i("./src/mobile.startup/Browser.js").getSingleton(),s=i("./src/mobile.startup/util.js"),a=s.escapeHash,o={name:"arrow",additionalClassNames:"indicator"},r=i("./src/mobile.startup/Icon.js");function l(e){this.eventBus=e.eventBus,this._enable(e.$container,e.prefix,e.page,e.isClosed)}function c(e){var t=JSON.parse(mw.storage.get("expandedSections")||"{}");return t[e.title]=t[e.title]||{},t}function u(e){mw.storage.set("expandedSections",JSON.stringify(e))}function d(e,t,i){var n,s,a=c(i);t.find(".section-heading span").each(function(){s=t.find(this),n=s.parents(".section-heading"),a[i.title][s.attr("id")]&&!n.hasClass("open-block")&&e.toggle(n,i)})}function h(e){var t=(new Date).getTime(),i=c(e);Object.keys(i).forEach(function(e){var n=i[e];Object.keys(n).forEach(function(s){var a=n[s];Math.floor((t-a)/1e3/60/60/24)>=1&&delete i[e][s]})}),u(i)}l.prototype.toggle=function(e){var t,i=e.is(".open-block"),s=e.data("page"),a=e.next();e.toggleClass("open-block"),e.data("indicator").remove(),o.rotation=i?0:180,t=new r(o).prependTo(e),e.data("indicator",t),a.toggleClass("open-block").attr({"aria-pressed":!i,"aria-expanded":!i}),this.eventBus.emit("section-toggled",{expanded:i,page:s,isReferenceSection:Boolean(a.attr("data-is-reference-section")),$heading:e}),n.isWideScreen()||function(e,t){var i=e.find("span").attr("id"),n=e.hasClass("open-block"),s=c(t);i&&(n?s[t.title][i]=(new Date).getTime():delete s[t.title][i],u(s))}(e,s)},l.prototype.reveal=function(e,t){var i,n;try{(n=(i=t.find(a(e))).parents(".collapsible-heading")).length||(n=i.parents(".collapsible-block").prev(".collapsible-heading")),n.length&&!n.hasClass("open-block")&&this.toggle(n),n.length&&window.scrollTo(0,i.offset().top)}catch(e){}},l.prototype._enable=function(e,t,i,a){var l,c,u,p,m,g=this,f=mw.config.get("wgMFCollapseSectionsByDefault");function b(){var t=window.location.hash;0===t.indexOf("#")&&g.reveal(t,e)}l=e.find("> h1,> h2,> h3,> h4,> h5,> h6,.section-heading").eq(0).prop("tagName")||"H1",void 0===f&&(f=!0),c=!f||"true"===mw.storage.get("expandSections"),e.children(l).each(function(s){var l,d=e.find(this),h=d.find(".indicator"),m=t+"collapsible-block-"+s;d.next().is("div")&&(p=d.next("div"),l=Boolean(p.attr("data-is-reference-section")),d.addClass("collapsible-heading ").data("section-number",s).data("page",i).attr({tabindex:0,"aria-haspopup":"true","aria-controls":m}).on("click",function(e){e.target.href||(e.preventDefault(),g.toggle(d))}),o.rotation=c?180:0,u=new r(o),h.length?h.replaceWith(u.$el):u.prependTo(d),d.data("indicator",u.$el),p.addClass("collapsible-block").eq(0).attr({id:m,"aria-pressed":"false","aria-expanded":"false"}),function(e,t){t.on("keypress",function(i){13!==i.which&&32!==i.which||e.toggle(t)}).find("a").on("keypress mouseup",function(e){e.stopPropagation()})}(g,d),!l&&(!a&&n.isWideScreen()||c)&&g.toggle(d))}),function(){var t=mw.config.get("wgInternalRedirectTargetUrl"),i=!!t&&t.split("#")[1];i&&(window.location.hash=i,g.reveal(i,e))}(),b(),(m=e.find("a:not(.reference a)")).on("click",function(){void 0!==m.attr("href")&&m.attr("href").indexOf("#")>-1&&b()}),s.getWindow().on("hashchange",function(){b()}),!n.isWideScreen()&&i&&(d(this,e,i),h(i))},l._getExpandedSections=c,l._expandStoredSections=d,l._cleanObsoleteStoredSections=h,e.exports=l},"./src/mobile.startup/View.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/mfExtend.js"),a=/^(\S+)\s*(.*)$/,o=0;function r(){this.initialize.apply(this,arguments)}OO.mixinClass(r,OO.EventEmitter),s(r,{tagName:"div",isTemplateMode:!1,template:void 0,templatePartials:{},defaults:{},initialize:function(e){var t=this;OO.EventEmitter.call(this),e=n.extend({},this.defaults,e),this.options=e,this.cid=function(e){var t=(++o).toString();return e?e+t:t}("view"),"string"==typeof this.template&&(this.template=mw.template.compile(this.template)),e.el?this.$el=$(e.el):this.$el=this.parseHTML("<"+this.tagName+">"),this.$el.length?this._postInitialize(e):n.docReady(function(){t.$el=$(e.el),t._postInitialize(e)})},_postInitialize:function(e){var t=e.className;this.$el.addClass(t),!1!==e.isBorderBox&&this.$el.addClass("view-border-box"),this.render({})},preRender:function(){},postRender:function(){},render:function(e){var t,i;return n.extend(this.options,e),this.preRender(),this.undelegateEvents(),this.template&&!this.options.skipTemplateRender&&(i=this.template.render(this.options,this.templatePartials),this.isTemplateMode?(t=$(i),this.$el.replaceWith(t),this.$el=t):this.$el.html(i)),this.postRender(),this.delegateEvents(),this},$:function(e){return mw.log.warn("Use of View.$ is deprecated. Use View.$el.find instead."),this.$el.find(e)},delegateEvents:function(e){var t,i,n;if(e=e||this.options.events)for(i in this.undelegateEvents(),e)"function"!=typeof(n=e[i])&&(n=this[e[i]]),n&&(t=i.match(a),this.delegate(t[1],t[2],n.bind(this)))},delegate:function(e,t,i){this.$el.on(e+".delegateEvents"+this.cid,t,i)},undelegateEvents:function(){this.$el&&this.$el.off(".delegateEvents"+this.cid)},undelegate:function(e,t,i){this.$el.off(e+".delegateEvents"+this.cid,t,i)},parseHTML:function(e){return n.parseHTML(e,document)}}),["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(e){r.prototype[e]=function(){return this.$el[e].apply(this.$el,arguments),this}}),e.exports=r},"./src/mobile.startup/actionParams.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s={action:"query",formatversion:2};e.exports=function(e){var t=mw.config.get("wgMFContentProviderScriptPath");return n.extend({},s,{origin:t?"*":void 0},e)}},"./src/mobile.startup/cache.js":function(e,t){function i(){this._cache={}}function n(){}i.prototype.get=function(e){return this._cache[e]},i.prototype.set=function(e,t){this._cache[e]=t},n.prototype.get=function(){},n.prototype.set=function(){},e.exports={MemoryCache:i,NoCache:n}},"./src/mobile.startup/context.js":function(e,t){e.exports={getMode:function(){return mw.config.get("wgMFMode")}}},"./src/mobile.startup/extendSearchParams.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/actionParams.js");e.exports=function(e){var t,i,a=mw.config.get("wgMFDisplayWikibaseDescriptions",{}),o=mw.config.get("wgMFContentProviderScriptPath");if(!Object.prototype.hasOwnProperty.call(a,e))throw new Error('"'+e+"\" isn't a feature that shows Wikibase descriptions.");return(t=Array.prototype.slice.call(arguments,1)).unshift({prop:[]}),t.push(mw.config.get("wgMFSearchAPIParams")),(i=n.extend.apply({},t)).prop=i.prop.concat(mw.config.get("wgMFQueryPropModules")),a[e]&&-1===i.prop.indexOf("description")&&i.prop.push("description"),o&&(i.origin="*"),s(i)}},"./src/mobile.startup/icons.js":function(e,t,i){var n=i("./src/mobile.startup/Icon.js"),s=i("./src/mobile.startup/util.js");e.exports={CANCEL_GLYPH:"overlay-close",Icon:n,cancel:function(e){var t=e?"overlay-close-"+e:"overlay-close";return new this.Icon({tagName:"button",name:t,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")})},spinner:function(e){return e=e||{},new this.Icon(s.extend(e,{name:"spinner",label:mw.msg("mobile-frontend-loading-message"),additionalClassNames:"spinner loading"}))},watchIcon:function(){return new this.Icon({name:"watch",additionalClassNames:"watch-this-article"})},watchedIcon:function(){return new this.Icon({name:"watched",additionalClassNames:"watch-this-article watched"})}}},"./src/mobile.startup/lazyImages/lazyImageLoader.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s="lazy-image-placeholder";e.exports={queryPlaceholders:function(e){return Array.prototype.slice.call(e.getElementsByClassName(s))},loadImages:function(t){return n.when.apply(n,t.map(function(t){return e.exports.loadImage(t).promise}))},loadImage:function(e){var t=n.Deferred(),i=e.dataset.width||"0",s=e.dataset.height||"0",a=new Image(parseInt(i,10),parseInt(s,10));return a.className=e.dataset.class||"",a.alt=e.dataset.alt||"",a.style.cssText=e.style.cssText||"",a.addEventListener("load",function(){a.classList.add("image-lazy-loaded"),e.parentNode&&e.parentNode.replaceChild(a,e),t.resolve("load")},{once:!0}),a.addEventListener("error",function(){t.resolve("error")},{once:!0}),a.src=e.dataset.src||"",a.srcset=e.dataset.srcset||"",{promise:t,image:a}},test:{placeholderClass:s}}},"./src/mobile.startup/lazyReferencesLoader.js":function(e,t,i){var n=i("./src/mobile.startup/lazyImages/lazyImageLoader.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/Page.js"),o=s.Deferred,r=i("./src/mobile.startup/icons.js").spinner();function l(e){var t,i=a.HEADING_SELECTOR,n=e.parent(),s=e.prevAll(i).eq(0);return s.length&&(t=s.find(".mw-headline").attr("id"))?t:n.length?l(n):null}e.exports={loadReferences:function(e,t,i,s){var a,c;if(!t.expanded&&t.isReferenceSection)return(a=t.$heading.next()).data("are-references-loaded")?o().reject().promise():(a.children().addClass("hidden"),c=r.$el.prependTo(a),i.getReferencesLists(t.page).then(function(){var n;a.find(".mf-lazy-references-placeholder").each(function(){var e=0,s=a.find(this),o=l(s);n!==o?(e=0,n=o):e++,o&&i.getReferencesList(t.page,o).then(function(t){t&&t[e]&&s.replaceWith(t[e])})}),c.remove(),a.children().removeClass("hidden"),e.emit("references-loaded",s),u()},function(){c.remove(),a.children().removeClass("hidden"),u()}));function u(){n.loadImages(n.queryPlaceholders(a[0])),a.data("are-references-loaded",1)}},test:{getSectionId:l}}},"./src/mobile.startup/loadingOverlay.js":function(e,t,i){var n=i("./src/mobile.startup/icons.js"),s=i("./src/mobile.startup/Overlay.js");e.exports=function(){var e=new s({className:"overlay overlay-loading",noHeader:!0});return n.spinner().$el.appendTo(e.$el.find(".overlay-content")),e}},"./src/mobile.startup/mfExtend.js":function(e,t){e.exports=function(e,t,i){var n;for(n in i?OO.inheritClass(e,t):(OO.initClass(e),i=t),i)e.prototype[n]=i[n]}},"./src/mobile.startup/moduleLoader.js":function(e,t){function i(){this._register={}}i.prototype={require:function(e){var t,i,n=this._register;function s(){if(!Object.hasOwnProperty.call(n,e))throw new Error("MobileFrontend Module not found: "+e);return n[e]}i=e.split("/");try{return(t=mw.loader.require(i[0]))[i[1]]?t[i[1]]:s()}catch(e){return s()}},define:function(e,t){var i=this;if(Object.hasOwnProperty.call(this._register,e))throw new Error("Module already exists: "+e);return this._register[e]=t,{deprecate:function(n){i.deprecate(n,t,e)}}},deprecate:function(e,t,i){var n;i&&(n="Use "+i+" instead."),mw.log.deprecate(this._register,e,t,n)}},e.exports=i},"./src/mobile.startup/promisedView.js":function(e,t,i){var n=i("./src/mobile.startup/icons.js"),s=i("./src/mobile.startup/View.js");e.exports=function(e){var t=new s({className:"promised-view"});return t.$el.append(n.spinner().$el),e.then(function(e){t.$el.replaceWith(e.$el),t.$el=e.$el}),t}},"./src/mobile.startup/rlModuleLoader.js":function(e,t,i){var n=i("./src/mobile.startup/loadingOverlay.js"),s=i("./src/mobile.startup/util.js");e.exports={newLoadingOverlay:function(){return n()},loadModule:function(e,t,i){var n=this.newLoadingOverlay();function a(){!t&&i&&n.hide()}return(i=void 0===i||i)&&(n.appendTo(document.body),n.show()),mw.loader.using(e).then(function(){return a(),n},function(){return a(),s.Deferred().reject().promise()})}}},"./src/mobile.startup/search/SearchGateway.js":function(e,t,i){var n=i("./src/mobile.startup/Page.js"),s=i("./src/mobile.startup/util.js"),a=i("./src/mobile.startup/extendSearchParams.js");function o(e){this.api=e,this.searchCache={},this.generator=mw.config.get("wgMFSearchGenerator")}o.prototype={searchNamespace:0,getApiData:function(e){var t=this.generator.prefix,i=a("search",{generator:this.generator.name});return i.redirects="",i["g"+t+"search"]=e,i["g"+t+"namespace"]=this.searchNamespace,i["g"+t+"limit"]=15,i.pilimit&&(i.pilimit=15,i.pithumbsize=mw.config.get("wgMFThumbnailSizes").tiny),i},_createSearchRegEx:function(e){return e=e.replace(/[-\[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),new RegExp("^("+e+")","ig")},_highlightSearchTerm:function(e,t){return e=s.parseHTML("<span>").text(e).html(),t=s.parseHTML("<span>").text(t).html(),e.replace(this._createSearchRegEx(t),"<strong>$1</strong>")},_getPage:function(e,t){var i=n.newFromJSON(t);return i.displayTitle=this._highlightSearchTerm(t.displaytext?t.displaytext:i.title,e),i.index=t.index,i},_processData:function(e,t){var i=this,n=[];return t.query&&(n=t.query.pages||{},(n=Object.keys(n).map(function(t){return i._getPage(e,n[t])})).sort(function(e,t){return e.index<t.index?-1:1})),n},search:function(e){var t,i,n=this;return this.isCached(e)||(i=(t=this.api.get(this.getApiData(e))).then(function(t){return{query:e,results:n._processData(e,t)}},function(){n.searchCache[e]=void 0}),this.searchCache[e]=i.promise({abort:function(){t.abort()}})),this.searchCache[e]},isCached:function(e){return Boolean(this.searchCache[e])}},e.exports=o},"./src/mobile.startup/time.js":function(e,t,i){var n=["seconds","minutes","hours","days","months","years"],s=i("./src/mobile.startup/util.js"),a=[1,60,3600,86400,2592e3,31536e3];function o(e){for(var t=0;t<a.length&&e>a[t+1];)++t;return{value:Math.round(e/a[t]),unit:n[t]}}function r(e){return o(Math.round((new Date).getTime()/1e3)-e)}function l(e){return"seconds"===e.unit&&e.value<10}e.exports={getLastModifiedMessage:function(e,t,i,n){var a,o,c=[];return i=i||"unknown",l(a=r(e))?c.push("mobile-frontend-last-modified-with-user-just-now",i,t):c.push({seconds:"mobile-frontend-last-modified-with-user-seconds",minutes:"mobile-frontend-last-modified-with-user-minutes",hours:"mobile-frontend-last-modified-with-user-hours",days:"mobile-frontend-last-modified-with-user-days",months:"mobile-frontend-last-modified-with-user-months",years:"mobile-frontend-last-modified-with-user-years"}[a.unit],i,t,mw.language.convertNumber(a.value)),c.push(n||"#",mw.language.convertNumber(t?1:0),t?mw.util.getUrl("User:"+t):""),o=mw.message.apply(this,c).parse(),n?o:s.parseHTML("<div>").html(o).text()},getRegistrationMessage:function(e,t){var i,n=[];return t=t||"unknown",l(i=r(parseInt(e,10)))?n.push("mobile-frontend-joined-just-now",t):n.push({seconds:"mobile-frontend-joined-seconds",minutes:"mobile-frontend-joined-minutes",hours:"mobile-frontend-joined-hours",days:"mobile-frontend-joined-days",months:"mobile-frontend-joined-months",years:"mobile-frontend-joined-years"}[i.unit],t,mw.language.convertNumber(i.value)),mw.message.apply(this,n).parse()},timeAgo:o,getTimeAgoDelta:r,isNow:l,isRecent:function(e){return["seconds","minutes","hours"].indexOf(e.unit)>-1}}},"./src/mobile.startup/toast.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s="mobileFrontend/toast";function a(){mw.requestIdleCallback(this._showPending.bind(this))}a.prototype.show=function(e,t){"string"==typeof t&&(mw.log.warn("The use of the cssClass parameter of Toast.show is deprecated, please convert it to an options object."),t={type:t}),t=n.extend({tag:"toast"},t),this.notification=mw.notify(e,t)},a.prototype.hide=function(){void 0!==this.notification&&this.notification.then(function(e){e.close()})},a.prototype.showOnPageReload=function(e,t){mw.storage.get(s)?mw.log.warn("A pending toast message already exits. The page should have been reloaded by now."):mw.storage.set(s,JSON.stringify({content:e,options:t}))},a.prototype._showPending=function(){var e=mw.storage.get(s);e&&(e=JSON.parse(e),this.show(e.content,e.options),mw.storage.remove(s))},e.exports=new a},"./src/mobile.startup/util.js":function(e,t){e.exports={escapeSelector:function(e){return $.escapeSelector(e)},grep:function(){return $.grep.apply($,arguments)},docReady:function(e){return $(e)},when:function(){return $.when.apply($,arguments)},Deferred:function(){return $.Deferred()},getDocument:function(){return $(document.documentElement)},getWindow:function(){return $(window)},parseHTML:function(e,t){return t=t||document,$($.parseHTML(e,t))},isNumeric:function(){return $.isNumeric.apply($,arguments)},extend:function(){return $.extend.apply($,arguments)},escapeHash:function(e){return e.replace(/(:|\.)/g,"\\$1")},isModifiedEvent:function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},repeatEvent:function(e,t,i,n){return e.on(i,function(e){return t.emit(i,e)},n)}}},"./src/mobile.startup/watchstar/Watchstar.js":function(e,t,i){var n=i("./src/mobile.startup/View.js"),s=i("./src/mobile.startup/watchstar/WatchstarGateway.js"),a=i("./src/mobile.startup/icons.js"),o=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/mfExtend.js"),l=i("./src/mobile.startup/toast.js"),c=i("./src/mobile.startup/CtaDrawer.js");function u(e){n.call(this,o.extend({className:a.watchIcon().getClassName(),events:{"click a":"onLinksClick",click:"onStatusToggle"}},e))}r(u,n,{defaults:{page:void 0,funnel:"unknown"},ctaDrawerOptions:{content:mw.msg("mobile-frontend-watchlist-cta"),queryParams:{warning:"mobile-frontend-watchlist-purpose",campaign:"mobile_watchPageActionCta",returntoquery:"article_action=watch"},signupQueryParams:{warning:"mobile-frontend-watchlist-signup-action"}},template:mw.template.compile('<a role="button">{{tooltip}}</a>',"hogan"),initialize:function(e){var t=n.prototype.initialize;this._watched=e.isWatched,this.gateway=new s(e.api),t.call(this,e)},preRender:function(){this.options.tooltip=this._watched?mw.msg("unwatchthispage"):mw.msg("watchthispage")},postRender:function(){var e=a.watchIcon().getGlyphClassName(),t=a.watchedIcon().getGlyphClassName()+" watched";this.$el.attr("title",this.options.tooltip),!mw.user.isAnon()&&this._watched?this.$el.addClass(t).removeClass(e):this.$el.addClass(e).removeClass(t),this.$el.removeClass("hidden")},onLinksClick:function(e){e.preventDefault()},onStatusToggleAnon:function(){this.drawer||(this.drawer=new c(this.ctaDrawerOptions)),this.drawer.show()},onStatusToggleUser:function(){var e,t=this,i=this.gateway,n=this.options.page,s=!this._watched;function a(){clearInterval(e)}e=setInterval(function(){l.show(mw.msg("mobile-frontend-watchlist-please-wait"))},1e3),i.postStatusesByTitle([n.getTitle()],s).then(function(){a(),t._watched=s,s?(t.render(),t.emit("watch"),l.show(mw.msg("mobile-frontend-watchlist-add",n.title))):(t.emit("unwatch"),t.render(),l.show(mw.msg("mobile-frontend-watchlist-removed",n.title)))},function(){a(),l.show(mw.msg("mobile-frontend-watchlist-error"),{type:"error"})})},onStatusToggle:function(){mw.user.isAnon()?this.onStatusToggleAnon.apply(this,arguments):this.onStatusToggleUser.apply(this,arguments)}}),e.exports=u},"./src/mobile.startup/watchstar/WatchstarGateway.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/actionParams.js");function a(e){this.api=e}a.prototype={getStatuses:function(e,t){return n.when(this.getStatusesByID(e),this.getStatusesByTitle(t)).then(function(){return n.extend.apply(n,arguments)})},getStatusesByID:function(e){var t=this;return e.length?this.api.get({formatversion:2,action:"query",prop:"info",inprop:"watched",pageids:e}).then(function(e){return t._unmarshalGetResponse(e)}):n.Deferred().resolve({})},getStatusesByTitle:function(e){var t=this;return e.length?this.api.get(s({prop:"info",inprop:"watched",titles:e})).then(function(e){return t._unmarshalGetResponse(e)}):n.Deferred().resolve({})},postStatusesByTitle:function(e,t){var i={action:"watch",titles:e};return t||(i.unwatch=!t),this.api.postWithToken("watch",i)},_unmarshalGetResponse:function(e){return(e&&e.query&&e.query.pages||[]).reduce(function(e,t){return e[t.title]=t.watched,e},{})}},e.exports=a},"./src/mobile.startup/watchstar/WatchstarPageList.js":function(e,t,i){var n=i("./src/mobile.startup/PageList.js"),s=i("./src/mobile.startup/watchstar/Watchstar.js"),a=mw.user,o=i("./src/mobile.startup/util.js"),r=i("./src/mobile.startup/Page.js"),l=i("./src/mobile.startup/mfExtend.js"),c=i("./src/mobile.startup/watchstar/WatchstarGateway.js");function u(e){this.wsGateway=new c(e.api),n.apply(this,arguments)}l(u,n,{postRender:function(){var e,t,i=this,s=[],a=[];return n.prototype.postRender.apply(this),e=this.queryUnitializedItems(),t=this.parsePagesFromItems(e),Object.keys(t).forEach(function(e){var i=t[e];i&&"0"!==i?s.push(i):a.push(e)}),this.getPages(s,a).then(function(t){i.renderItems(e,t)})},queryUnitializedItems:function(){return this.$el.find("li:not(.with-watchstar)")},getPages:function(e,t){return a.isAnon()?o.Deferred().resolve({}):this.wsGateway.getStatuses(e,t)},parsePagesFromItems:function(e){var t=this,i={};return e.each(function(e,n){var s=t.$el.find(n);i[s.attr("title")]=s.data("id")}),i},renderItems:function(e,t){var i=this;a.isAnon()||e.each(function(e,n){var s=i.$el.find(n),a=new r({sections:[],title:s.attr("title"),id:s.data("id")}),o=i.parseHTML("<div>").appendTo(s),l=t[a.getTitle()];i._appendWatchstar(o,a,l),s.addClass("with-watchstar")})},_appendWatchstar:function(e,t,i){var n=new s({api:this.options.api,funnel:this.options.funnel,isAnon:a.isAnon(),isWatched:i,page:t,el:e});return o.repeatEvent(n,this,"watch"),o.repeatEvent(n,this,"unwatch"),n}}),e.exports=u},"./src/mobile.talk.overlays/TalkSectionAddOverlay.js":function(e,t,i){var n=i("./src/mobile.startup/mfExtend.js"),s=i("./src/mobile.startup/Overlay.js"),a=i("./src/mobile.startup/PageGateway.js"),o=i("./src/mobile.startup/util.js"),r=i("./src/mobile.talk.overlays/autosign.js"),l=i("./src/mobile.startup/toast.js"),c=i("./src/mobile.startup/Icon.js");function u(e){this.editorApi=e.api,this.pageGateway=new a(e.api),s.call(this,o.extend(e,{className:"talk-overlay overlay",events:{"input .wikitext-editor, .summary":"onTextInput","change .wikitext-editor, .summary":"onTextInput","click .confirm-save":"onSaveClick"}})),this.title=e.title,this.currentPageTitle=e.currentPageTitle,this.eventBus=e.eventBus,this._saveHit=!1}n(u,s,{defaults:o.extend({},s.prototype.defaults,{cancelMsg:mw.msg("mobile-frontend-editor-cancel"),topicTitlePlaceHolder:mw.msg("mobile-frontend-talk-add-overlay-subject-placeholder"),topicContentPlaceHolder:mw.msg("mobile-frontend-talk-add-overlay-content-placeholder"),editingMsg:mw.msg("mobile-frontend-talk-add-overlay-submit"),waitMsg:mw.msg("mobile-frontend-talk-topic-wait"),waitIcon:new c({name:"spinner",additionalClassNames:"savespinner loading"}).toHtmlString()}),template:mw.template.get("mobile.talk.overlays","SectionAddOverlay.hogan"),templatePartials:o.extend({},s.prototype.templatePartials,{contentHeader:mw.template.get("mobile.talk.overlays","SectionAddOverlay/contentHeader.hogan"),saveHeader:mw.template.get("mobile.editor.overlay","saveHeader.hogan")}),postRender:function(){s.prototype.postRender.call(this),this.showHidden(".initial-header"),this.$confirm=this.$el.find("button.confirm-save"),this.$subject=this.$el.find(".summary"),this.$ta=this.$el.find(".wikitext-editor")},hide:function(){var e,t=mw.msg("mobile-frontend-editor-cancel-confirm");return e=!this.$subject.val()&&!this.$ta.val(),!!(this._saveHit||e||window.confirm(t))&&s.prototype.hide.apply(this,arguments)},onTextInput:function(){var e=this;clearTimeout(this.timer),this.timer=setTimeout(function(){e.$ta.val().trim()&&e.$subject.val().trim()?e.$confirm.prop("disabled",!1):e.$confirm.prop("disabled",!0)},250)},onSaveClick:function(){var e=this,t=e.title===e.currentPageTitle;this.showHidden(".saving-header"),this.save().then(function(i){"ok"===i&&(t?e.eventBus.emit("talk-added-wo-overlay"):(e.pageGateway.invalidatePage(e.title),l.show(mw.msg("mobile-frontend-talk-topic-feedback")),e.eventBus.emit("talk-discussion-added"),e.hide()))},function(t){var i=mw.msg("mobile-frontend-talk-topic-error");switch(e.$confirm.prop("disabled",!1),t.details){case"protectedpage":i=mw.msg("mobile-frontend-talk-topic-error-protected");break;case"noedit":case"blocked":i=mw.msg("mobile-frontend-talk-topic-error-permission");break;case"spamdetected":i=mw.msg("mobile-frontend-talk-topic-error-spam");break;case"badtoken":i=mw.msg("mobile-frontend-talk-topic-error-badtoken");break;default:i=mw.msg("mobile-frontend-talk-topic-error")}l.show(i,{type:"error"}),e.showHidden(".save-header, .save-panel")})},save:function(){var e=this.$subject.val(),t=o.Deferred(),i=this.$ta.val();return this.$ta.removeClass("error"),this.$subject.removeClass("error"),this._saveHit=!0,this.$el.find(".content").empty().addClass("loading"),this.editorApi.postWithToken("csrf",{action:"edit",section:"new",sectiontitle:e,title:this.title,summary:mw.msg("newsectionsummary",e),text:r(i)}).then(function(){return"ok"},function(e){return t.reject({type:"error",details:e})})}}),e.exports=u},"./src/mobile.talk.overlays/TalkSectionOverlay.js":function(e,t,i){var n=mw.user,s=i("./src/mobile.startup/mfExtend.js"),a=i("./src/mobile.startup/PageGateway.js"),o=i("./src/mobile.startup/Overlay.js"),r=i("./src/mobile.startup/util.js"),l=i("./src/mobile.startup/toast.js"),c=i("./src/mobile.talk.overlays/autosign.js"),u=i("./src/mobile.startup/Page.js"),d=i("./src/mobile.startup/Button.js");function h(e){this.editorApi=e.api,this.pageGateway=new a(e.api),o.call(this,r.extend(e,{className:"talk-overlay overlay",events:{"focus textarea":"onFocusTextarea","click .save-button":"onSaveClick"}}))}s(h,o,{templatePartials:r.extend({},o.prototype.templatePartials,{header:mw.template.get("mobile.talk.overlays","Section/header.hogan"),content:mw.template.get("mobile.talk.overlays","Section/content.hogan")}),defaults:r.extend({},o.prototype.defaults,{saveButton:new d({block:!0,additionalClassNames:"save-button",progressive:!0,label:mw.msg("mobile-frontend-editor-save")}).options,title:void 0,section:void 0,reply:mw.msg("mobile-frontend-talk-reply"),info:mw.msg("mobile-frontend-talk-reply-info")}),postRender:function(){o.prototype.postRender.apply(this),this.$saveButton=this.$el.find(".save-button"),this.options.section?(this.hideSpinner(),this._enableComments()):this.renderFromApi(this.options)},_enableComments:function(){this.$commentBox=this.$el.find(".comment"),n.isAnon()?this.$commentBox.remove():this.$textarea=this.$commentBox.find("textarea")},renderFromApi:function(e){var t=this;this.pageGateway.getPage(e.title).then(function(i){var n=new u(i);e.section=n.getSection(e.id),t.render(e),t.hideSpinner()})},onFocusTextarea:function(){this.$textarea.removeClass("error")},onSaveClick:function(){var e=this.$textarea.val(),t=this;function i(){t.$saveButton.prop("disabled",!1)}e?(this.showSpinner(),this.$saveButton.prop("disabled",!0),e="\n\n"+c(e),this.editorApi.postWithToken("csrf",{action:"edit",title:this.options.title,section:this.options.id,appendtext:e,redirect:!0}).then(function(){l.show(mw.msg("mobile-frontend-talk-reply-success")),t.pageGateway.invalidatePage(t.options.title),t.renderFromApi(t.options),i()},function(e,n){var s;s=n.error&&["readonly","blocked","autoblocked"].indexOf(n.error.code)>-1?n.error.info:mw.msg("mobile-frontend-editor-error"),t.hideSpinner(),l.show(s,"toast error"),i()})):this.$textarea.addClass("error")}}),e.exports=h},"./src/mobile.talk.overlays/autosign.js":function(e,t){e.exports=function(e){return/~{3,5}/.test(e)?e:e+" ~~~~"}},"./src/mobile.talk.overlays/talkBoard.js":function(e,t,i){var n=i("./src/mobile.startup/util.js"),s=i("./src/mobile.startup/View.js");e.exports=function(e){var t,i=e.length>0?mw.msg("mobile-frontend-talk-explained"):mw.msg("mobile-frontend-talk-explained-empty");return(t=new s({className:"talk-board"})).append([n.parseHTML('<p class="content-header">').text(i),n.parseHTML('<ul class="topic-title-list">').append(e.map(function(e){return n.parseHTML("<li>").append(n.parseHTML("<a>").attr("href","#/talk/"+e.id).text(e.line))}))]),t}},"./src/mobile.talk.overlays/talkOverlay.js":function(e,t,i){var n=i("./src/mobile.talk.overlays/talkBoard.js"),s=i("./src/mobile.startup/PageGateway.js"),a=i("./src/mobile.startup/promisedView.js"),o=i("./src/mobile.startup/Anchor.js"),r=i("./src/mobile.startup/Overlay.js");e.exports=function(e){var t=e.title,i=mw.user,l=new s(e.api);return r.make({heading:"<strong>"+mw.msg("mobile-frontend-talk-overlay-header")+"</strong>",headerButtonsListClassName:"header-action",headerButtons:[i.isAnon()?{}:{href:"#/talk/new",className:"continue",msg:mw.msg("mobile-frontend-talk-add-overlay-submit")}],footerAnchor:new o({progressive:!0,href:mw.util.getUrl(t),additionalClassNames:"footer-link talk-fullpage",label:mw.msg("mobile-frontend-talk-fullpage")}).options,className:"talk-overlay overlay"},a(l.getSections(t).then(function(e){return n(e)})))}},"./tests/node-qunit/mobile.categories.overlays/CategoryGateway.test.js":function(e,t,i){(function(e){var t,n,s,a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend CategoryGateway.js",{beforeEach:function(){s=c.sandbox.create(),o.setUp(s,e),a.setUp(s,e),l.setUp(s,e),r.setUp(s,e),t=i("./src/mobile.startup/util.js"),n=i("./src/mobile.categories.overlays/CategoryGateway.js"),this.getSpy={get:s.stub().returns(t.Deferred().resolve({batchcomplete:!0,query:{pages:[{pageid:5,ns:0,title:"HelloWorld",categories:[{ns:14,title:"Category:Hello"}]}]}}))},this.postSpy={postWithToken:s.stub().returns(t.Deferred().resolve())}},afterEach:function(){a.tearDown(),s.restore()}}),QUnit.test("getCategories()",function(e){var t,i=this,s=new n(this.getSpy);return t=s.getCategories("HelloWorld"),e.notStrictEqual(t,!1,"result should not return false"),t.then(function(){e.strictEqual(s.canContinue,!1,"gateway should not continue"),e.ok(i.getSpy.get.calledWith({action:"query",prop:"categories",titles:"HelloWorld",clprop:"hidden",cllimit:50,formatversion:2}),"invalid data passed to get api request")})}),QUnit.test("save()",function(e){var t=this;return new n(this.postSpy).save("HelloWorld","[[Category:World]]").then(function(){e.ok(t.postSpy.postWithToken.calledWith("csrf",{action:"edit",title:"HelloWorld",appendtext:"[[Category:World]]",summary:mw.msg("mobile-frontend-categories-summary")}),"invalid data passed to post api request")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.editor.overlay/EditorGateway.test.js":function(e,t,i){(function(e){var t,n,s,a,o,r,l,c,u,d,h,p,m,g,f,b,w,v,y,k,E=i("./src/mobile.startup/util.js"),j={type:"image",mime:"image/png",id:"1852528679",url:"/w/index.php?title=Especial:Captcha/image&wpCaptchaId=1852528679"},x={error:{code:"readonly",info:"The wiki is currently in read-only mode.",readonlyreason:"This wiki is currently being upgraded to a newer software version."}},q=i("./tests/node-qunit/utils/jQuery.js"),C=i("./tests/node-qunit/utils/dom.js"),S=i("sinon"),T=i("./tests/node-qunit/utils/oo.js"),_=i("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend mobile.editor.overlay/EditorGateway",{beforeEach:function(){t=S.sandbox.create(),C.setUp(t,e),q.setUp(t,e),T.setUp(t,e),_.setUp(t,e),n=i("./src/mobile.editor.overlay/EditorGateway.js"),k=E.Deferred().resolve({query:{pages:[{revisions:[{timestamp:"2013-05-15T00:30:26Z",content:"section"}]}],userinfo:{id:0}}}),r=new mw.Api,o=new mw.Api,l=new mw.Api,c=new mw.Api,u=new mw.Api,d=new mw.Api,h=new mw.Api,p=new mw.Api,m=new mw.Api,g=new mw.Api,f=new mw.Api,b=new mw.Api,y=new mw.Api,w=new mw.Api,v=new mw.Api,t.stub(c,"postWithToken").returns(E.Deferred().resolve({edit:{result:"Failure",captcha:j}})),s=t.stub(r,"get").returns(k),t.stub(o,"get").returns(k),t.stub(y,"get").returns(k),t.stub(b,"get").returns(k),t.stub(w,"get").returns(k),t.stub(u,"get").returns(k),t.stub(h,"get").returns(k),t.stub(p,"get").returns(k),t.stub(g,"get").returns(k),t.stub(f,"get").returns(k),t.stub(m,"get").returns(k),t.stub(d,"get").returns(k),t.stub(c,"get").returns(k),t.stub(l,"get").returns(E.Deferred().resolve({error:{code:"rvnosuchsection"}})),t.stub(o,"postWithToken").returns(E.Deferred().resolve({error:{code:"error code"}})),t.stub(y,"postWithToken").returns(E.Deferred().reject()),a=t.stub(r,"postWithToken").returns(E.Deferred().resolve({edit:{result:"Success"}})),t.stub(w,"postWithToken").returns(E.Deferred().resolve({})),t.stub(b,"post").returns(E.Deferred().resolve({parse:{title:"test",text:{"*":"<h1>Heading 1</h1><h2>Heading 2</h2><p>test content</p>"},sections:{}}})),t.stub(v,"post").returns(E.Deferred().resolve({parse:{title:"test",text:{"*":"test content"},sections:{}}})),t.stub(f,"post").returns(E.Deferred().resolve({parse:{title:"test",text:{"*":"test content"},sections:{0:{line:"Testsection"},1:{line:"Testsection2"}}}})),t.stub(g,"postWithToken").onFirstCall().returns(E.Deferred().resolve({edit:{result:"Success"}})),t.stub(d,"postWithToken").returns(E.Deferred().resolve({edit:{code:"abusefilter-warning-usuwanie-tekstu",info:"Hit AbuseFilter: Usuwanie duej iloci tekstu",warning:"horrible desktop-formatted message",result:"Failure"}})),t.stub(u,"postWithToken").returns(E.Deferred().resolve({edit:{code:"abusefilter-disallow",info:"Scary filter",warning:"horrible desktop-formatted message",result:"Failure"}})),t.stub(h,"postWithToken").returns(E.Deferred().resolve({edit:{code:"abusefilter-something",info:"Scary filter",warning:"horrible desktop-formatted message",result:"Failure"}})),t.stub(p,"postWithToken").returns(E.Deferred().resolve({edit:{code:"testerror",result:"Failure"}})),t.stub(m,"postWithToken").returns(E.Deferred().reject("readonly",x))},afterEach:function(){q.tearDown(),t.restore()}}),QUnit.test("#getContent (no section)",function(e){return new n({api:r,title:"MediaWiki:Test.css"}).getContent().then(function(){e.ok(s.calledWith({action:"query",prop:["revisions","info"],meta:"userinfo",rvprop:["content","timestamp"],titles:"MediaWiki:Test.css",intestactions:"edit",intestactionsdetail:"full",uiprop:"options",formatversion:2}),"rvsection not passed to api request")})}),QUnit.test("#getContent",function(e){var t;return(t=new n({api:r,title:"test",sectionId:1})).getContent().then(function(i){return e.strictEqual(i.text,"section","return section content"),e.strictEqual(i.blockinfo,null),t.getContent()}).then(function(){e.strictEqual(s.callCount,1,"cache content")})}),QUnit.test("#getContent, new page",function(e){return new n({api:r,title:"test",isNewPage:!0}).getContent().then(function(t){e.strictEqual(t.text,"","return empty section"),e.strictEqual(t.blockinfo,void 0),e.notOk(s.called,"don't try to retrieve content using API")})}),QUnit.test("#getContent, missing section",function(e){var t=new n({api:l,title:"test",sectionId:1});e.rejects(t.getContent(),/^rvnosuchsection$/,"return error code")}),QUnit.test("#getBlockInfo",function(e){var t=new n({api:r,title:"test"}),i={blockedby:"Test"},s={revisions:[{}],actions:{edit:[{code:"blocked",data:{blockinfo:i}}]}};e.strictEqual(i,t.getBlockInfo(s))}),QUnit.test("#save, success",function(e){var t=new n({api:r,title:"test",sectionId:1});return t.getContent().then(function(){return t.setContent("section 1"),e.strictEqual(t.hasChanged,!0,"hasChanged is true"),t.save({summary:"summary"})}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"test",section:1,text:"section 1",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:"2013-05-15T00:30:26Z",starttimestamp:"2013-05-15T00:30:26Z"}),"save first section")})}),QUnit.test("#save, new page",function(e){var t=new n({api:r,title:"Talk:test",isNewPage:!0});return t.getContent(),t.setContent("section 0"),t.save({summary:"summary"}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"Talk:test",text:"section 0",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:void 0,starttimestamp:void 0}),"save lead section")})}),QUnit.test("#save, after #setPrependText",function(e){var t=new n({api:r,title:"test"});return t.setPrependText("abc"),t.save({summary:"summary"}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"test",prependtext:"abc",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:void 0,starttimestamp:void 0}),"prepend text")})}),QUnit.test("#save, submit CAPTCHA",function(e){var t=new n({api:r,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1")}).then(function(){return t.save({summary:"summary",captchaId:123,captchaWord:"abc"})}).then(function(){e.strictEqual(t.hasChanged,!1,"reset hasChanged"),e.ok(a.calledWith("csrf",{action:"edit",title:"test",section:1,text:"section 1",summary:"summary",captchaid:123,captchaword:"abc",basetimestamp:"2013-05-15T00:30:26Z",starttimestamp:"2013-05-15T00:30:26Z"}),"save first section")})}),QUnit.test("#save, request failure",function(e){var t=new n({api:y,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"http"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, API failure",function(e){var t=new n({api:o,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"error code"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, CAPTCHA response with image URL",function(e){var t=new n({api:c,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"captcha",details:j},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, AbuseFilter warning",function(e){var t=new n({api:d,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"abusefilter",details:{type:"warning",message:"horrible desktop-formatted message"}},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, AbuseFilter disallow",function(e){var t=new n({api:u,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"abusefilter",details:{type:"disallow",message:"horrible desktop-formatted message"}},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, AbuseFilter other",function(e){var t=new n({api:h,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"abusefilter",details:{type:"other",message:"horrible desktop-formatted message"}},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, extension errors",function(e){var t=new n({api:p,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"testerror"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, read-only error",function(e){var i=new n({api:m,title:"test",sectionId:1}),s=t.spy(),a=t.spy(),o=e.async(),r={type:"readonly",details:{code:"readonly",info:"The wiki is currently in read-only mode.",readonlyreason:"This wiki is currently being upgraded to a newer software version."}};i.getContent().then(function(){return i.setContent("section 1"),i.save()}).then(s,a).then(function(){e.strictEqual(a.calledWith(r),!0),e.strictEqual(s.called,!1,"don't call resolve"),o()})}),QUnit.test("#save, unknown errors",function(e){var t=new n({api:w,title:"test",sectionId:1});return t.getContent().then(function(){t.setContent("section 1"),e.rejects(t.save(),function(t){return e.propEqual(t,{type:"error",details:"unknown"},"called with correct arguments"),!0},"call fail")})}),QUnit.test("#save, without changes",function(e){var t=new n({api:r,title:"test",sectionId:1});return t.getContent().then(function(){return t.setContent("section")}).then(function(){return e.strictEqual(t.hasChanged,!1,"hasChanged is false"),t.save({summary:"summary"})}).then(function(){e.ok(r.postWithToken.calledWith("csrf",{action:"edit",title:"test",section:1,text:"section",summary:"summary",captchaid:void 0,captchaword:void 0,basetimestamp:"2013-05-15T00:30:26Z",starttimestamp:"2013-05-15T00:30:26Z"}),"save first section")})}),QUnit.test("#EditorGateway",function(e){var i=new n({api:b,title:"Test",sectionId:1}),s=t.spy();return i.getPreview({text:"test content"}).then(s).then(function(){e.ok(b.post.calledWithMatch({text:"test content"})),e.ok(s.calledWith({line:"",text:"<h1>Heading 1</h1><h2>Heading 2</h2><p>test content</p>"}))})}),QUnit.test("#EditorGateway, check without sectionLine",function(e){return new n({api:v,title:"Test",sectionId:1}).getPreview({text:"test content"}).then(function(t){e.strictEqual(t.line,"","Ok, no section line returned")})}),QUnit.test("#EditorGateway, check with sectionLine",function(e){return new n({api:f,title:"Test",sectionId:1}).getPreview({text:"test content"}).then(function(t){e.strictEqual(t.line,"Testsection","Ok, section line returned")})}),QUnit.test("#save, when token has expired",function(e){var t=new n({api:g,title:"MediaWiki:Test.css"});return t.getContent().then(function(){return t.setContent("section 1"),t.save().then(function(){e.strictEqual(g.postWithToken.callCount,1,"check the spy was called twice")})})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.editor.overlay/EditorOverlay.test.js":function(e,t,i){(function(e){var t,n,s,a,o,r,l,c=i("./tests/node-qunit/utils/jQuery.js"),u=i("sinon"),d=i("./src/mobile.startup/util.js"),h=i("./tests/node-qunit/utils/oo.js"),p=i("./tests/node-qunit/utils/dom.js"),m=i("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend mobile.editor.overlay/EditorOverlay",{beforeEach:function(){t=u.sandbox.create(),p.setUp(t,e),c.setUp(t,e),m.setUp(t,e),h.setUp(t,e),t.stub(mw,"msg").withArgs("mobile-frontend-editor-continue").returns("Continue").withArgs("mobile-frontend-editor-save").returns("Save"),o=i("./src/mobile.editor.overlay/EditorGateway.js"),r=i("./src/mobile.editor.overlay/EditorOverlay.js"),l=i("./src/mobile.editor.overlay/BlockMessage.js"),t.stub(r.prototype,"log").returns(d.Deferred().resolve()),n=t.stub(l.prototype,"initialize"),t.stub(l.prototype,"toggle"),s=t.stub(o.prototype,"getContent"),t.stub(mw.loader,"using").returns({then:function(e){e()}}),t.stub(mw,"confirmCloseWindow").returns({release:function(){}}),t.stub(window,"scrollTo"),t.stub(mw.util,"getUrl").returns("/w/index.php?title=User:Test"),t.stub(mw.config,"get").withArgs("wgMFEditorOptions").returns({skipPreview:!0}).withArgs("wgFormattedNamespaces").returns({2:"User"}),s.returns(d.Deferred().resolve({text:"section 0",user:{id:1,name:"Foo"},block:null,blockedByUser:null})),a=d.Deferred().resolve({text:"previewtest"}),t.stub(o.prototype,"getPreview").returns(a)},afterEach:function(){c.tearDown(),t.restore()}}),QUnit.test("#initialize, blocked user",function(e){var t=d.Deferred().resolve({text:"section 0",userinfo:{options:{gender:"female"}},blockinfo:{blockedby:"Test",blockexpiry:"infinity",blockreason:"Testreason"}});return s.returns(t),new r({title:"test.css"}),t.then(function(){e.ok(n.calledWith({className:"drawer position-fixed",events:{"click .cancel":"onCancel",click:"stopPropagation"},partial:!1,user:{options:{gender:"female"}},creator:{name:"Test",url:"/w/index.php?title=User:Test"},expiry:null,duration:null,reason:"Testreason"}),"There is a drawer notice, that i am blocked from editing")})}),QUnit.test("#initialize, with given page and section",function(e){var t=new r({title:"test",sectionId:0});return e.strictEqual(t.gateway.title,"test"),e.strictEqual(t.gateway.isNewPage,void 0),e.strictEqual(t.gateway.oldId,void 0),e.strictEqual(t.gateway.sectionId,0),s().then(function(){e.strictEqual(t.$content.val(),"section 0","load correct section")})}),QUnit.test("#initialize, without a section",function(e){var t=new r({title:"test.css"});return s().then(function(){e.strictEqual(t.gateway.title,"test.css"),e.strictEqual(t.gateway.isNewPage,void 0),e.strictEqual(t.gateway.oldId,void 0),e.strictEqual(t.gateway.sectionId,void 0)})}),QUnit.test("#preview",function(e){var t=new r({title:"test",sectionId:0});return t.onStageChanges(),a.then(function(){e.strictEqual(t.$preview.text(),"\npreviewtest\n","preview loaded correctly")})}),QUnit.test("#without-preview",function(e){var t=new r({title:"test",sectionId:0});return s().then(function(){e.strictEqual(t.$el.find(".continue").text(),"Save","no preview loaded")})}),QUnit.test("#initialize, as anonymous",function(e){var t=new r({title:"Main_page",isAnon:!0});return s().then(function(){e.ok(t.$anonWarning.length>0,"Editorwarning (IP will be saved) visible."),e.ok(t.$el.find(".anonymous").length>0,"Continue login has a second class.")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.languages.structured/LanguageSearcher.test.js":function(e,t,i){(function(e){var t,n,s=i("./tests/node-qunit/utils/jQuery.js"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/mw.js"),r=i("./tests/node-qunit/utils/oo.js"),l=i("sinon"),c=[{lang:"ar",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7",title:" ",autonym:""},{lang:"be",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:" ",autonym:""},{lang:"be-x-old",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:" ",autonym:" ()"},{lang:"ko",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88",title:" ",autonym:""},{lang:"ru",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA",title:", ",autonym:""},{lang:"uz",url:"https://uz.wikipedia.org/wiki/Barak_Obama",title:"Barak Obama",autonym:"ozbekcha/"},{lang:"zh",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC",title:"",autonym:""},{lang:"zh-min-nan",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",langname:"Chinese",autonym:"Bn-lm-g"},{lang:"zh-yue",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC",title:"",autonym:""},{lang:"zu",url:"https://zu.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",autonym:"isiZulu"}],u={"zh-min-nan":1,zh:2,en:10,ko:1};QUnit.module("MobileFrontend LanguageSearcher.js",{beforeEach:function(){n=l.sandbox.create(),a.setUp(n,e),s.setUp(n,e),r.setUp(n,e),o.setUp(n,e),t=i("./src/mobile.languages.structured/LanguageSearcher.js"),n.stub(mw.storage,"get").withArgs("langMap").returns(JSON.stringify(u)),this.languageSearcher=new t({languages:c,variants:[],deviceLanguage:"en-us"})},afterEach:function(){s.tearDown(),n.restore()}}),QUnit.test("render output",function(e){e.strictEqual(this.languageSearcher.$el.find(".site-link-list.suggested-languages a").length,3,"There are 3 suggested languages."),e.strictEqual(this.languageSearcher.$el.find(".site-link-list.all-languages a").length,7,"Seven languages are non-suggested.")}),QUnit.test("filterLanguages()",function(e){this.languageSearcher.filterLanguages("zh"),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,3,'Three languages match "zh" and only those languages are visible.'),this.languageSearcher.filterLanguages("ol"),e.ok(1===this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length&&this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").hasClass("be-x-old"),'One language (be-x-old) matches "ol" and only that language is visible.'),this.languageSearcher.filterLanguages("chin"),e.ok(1===this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length&&this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").hasClass("zh-min-nan"),'One language (zh-min-nan) matches "Chin" (langname) and only that language is visible.'),this.languageSearcher.filterLanguages(""),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,10,"The search filter has been cleared. All 10 languages (including variants) are visible."),this.languageSearcher.filterLanguages(""),e.strictEqual(this.languageSearcher.$el.find(".site-link-list a:not(.hidden)").length,1,'One language matches "" and only that language is visible.')})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.languages.structured/util.test.js":function(e,t,i){(function(e){var t,n,s=i("./tests/node-qunit/utils/jQuery.js"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/mw.js"),r=i("sinon");QUnit.module("MobileFrontend mobile.languages.structured/util.test.js",{beforeEach:function(){this.apiLanguages=[{lang:"ar",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7",title:" ",dir:"rtl",autonym:""},{lang:"be",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:" ",dir:"ltr",autonym:""},{lang:"be-x-old",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0",title:" ",autonym:" ()"},{lang:"es",url:"https://en.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"Spanish"},{lang:"ko",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88",title:" ",dir:"ltr",autonym:""},{lang:"ru",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA",title:", ",dir:"ltr",autonym:""},{lang:"uz",url:"https://uz.wikipedia.org/wiki/Barak_Obama",title:"Barak Obama",dir:"ltr",autonym:"ozbekcha/"},{lang:"zh",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC",title:"",dir:"ltr",autonym:""},{lang:"zh-min-nan",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"Bn-lm-g"},{lang:"zh-yue",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC",title:"",dir:"ltr",autonym:""},{lang:"zu",url:"https://zu.wikipedia.org/wiki/Barack_Obama",title:"Barack Obama",dir:"ltr",autonym:"isiZulu"}],this.apiVariants=[{autonym:"",lang:"zh",url:"/~bmansurov/mediawiki/index.php/3?variant=zh"},{autonym:"",lang:"zh-hans",url:"/~bmansurov/mediawiki/index.php/3?variant=zh-hans"}],this.deviceLanguage="en-us",this.frequentlyUsedLanguages={zh:2,ko:1},this.structuredLanguages={all:[{lang:"zh-min-nan",autonym:"Bn-lm-g",title:"Barack Obama",dir:"ltr",url:"https://zh-min-nan.wikipedia.org/wiki/Barack_Obama"},{lang:"zu",autonym:"isiZulu",title:"Barack Obama",dir:"ltr",url:"https://zu.wikipedia.org/wiki/Barack_Obama"},{lang:"uz",autonym:"ozbekcha/",title:"Barak Obama",dir:"ltr",url:"https://uz.wikipedia.org/wiki/Barak_Obama"},{lang:"es",autonym:"Spanish",title:"Barack Obama",dir:"ltr",url:"https://en.wikipedia.org/wiki/Barack_Obama"},{lang:"be",autonym:"",title:" ",dir:"ltr",url:"https://be.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0"},{lang:"be-x-old",autonym:" ()",title:" ",dir:"ltr",url:"https://be-x-old.wikipedia.org/wiki/%D0%91%D0%B0%D1%80%D0%B0%D0%BA_%D0%90%D0%B1%D0%B0%D0%BC%D0%B0"},{lang:"ru",autonym:"",title:", ",dir:"ltr",url:"https://ru.wikipedia.org/wiki/%D0%9E%D0%B1%D0%B0%D0%BC%D0%B0,_%D0%91%D0%B0%D1%80%D0%B0%D0%BA"},{lang:"ar",autonym:"",title:" ",dir:"rtl",url:"https://ar.wikipedia.org/wiki/%D8%A8%D8%A7%D8%B1%D8%A7%D9%83_%D8%A3%D9%88%D8%A8%D8%A7%D9%85%D8%A7"},{lang:"zh-yue",autonym:"",title:"",dir:"ltr",url:"https://zh-yue.wikipedia.org/wiki/%E5%A5%A7%E5%B7%B4%E9%A6%AC"}],suggested:[{frequency:2,lang:"zh",autonym:"",title:"",dir:"ltr",url:"https://zh.wikipedia.org/wiki/%E8%B4%9D%E6%8B%89%E5%85%8B%C2%B7%E5%A5%A5%E5%B7%B4%E9%A9%AC"},{frequency:1,lang:"ko",autonym:"",title:" ",dir:"ltr",url:"https://ko.wikipedia.org/wiki/%EB%B2%84%EB%9D%BD_%EC%98%A4%EB%B0%94%EB%A7%88"}]},n=r.sandbox.create(),a.setUp(n,e),s.setUp(n,e),o.setUp(n,e),n.stub(mw.storage,"get").withArgs("langMap").returns(JSON.stringify(this.frequentlyUsedLanguages)),t=i("./src/mobile.languages.structured/util.js"),this.saveSpy=n.stub(t,"saveFrequentlyUsedLanguages")},afterEach:function(){s.tearDown(),n.restore()}}),QUnit.test("#getFrequentlyUsedLanguages",function(e){e.propEqual(t.getFrequentlyUsedLanguages(),this.frequentlyUsedLanguages,"Frequently used languages is correct.")}),QUnit.test("#saveLanguageUsageCount",function(e){t.saveLanguageUsageCount("ko",t.getFrequentlyUsedLanguages()),e.ok(this.saveSpy.calledWith({zh:2,ko:2}),"Frequently used language is correctly saved.")}),QUnit.test("#getStructuredLanguages",function(e){var i=t.getStructuredLanguages(this.apiLanguages,!1,this.frequentlyUsedLanguages,this.deviceLanguage);e.propEqual(i,this.structuredLanguages,"Structured languages are correct, including sort order.")}),QUnit.test("#getStructuredLanguages device language",function(e){var i=t.getStructuredLanguages(this.apiLanguages,!1,{},"es-lx").suggested[0].lang;e.strictEqual(i,"es",'"es" is correctly selected as a suggested language even though the device language is "es-lx".')}),QUnit.test("#getStructuredLanguages variants",function(e){var i,n={};i=t.getStructuredLanguages(this.apiLanguages,this.apiVariants,{},this.deviceLanguage).suggested,this.apiVariants.forEach(function(e){n[e.lang]=e}),i.forEach(function(t){e.ok(Object.prototype.hasOwnProperty.call(n,t.lang),'Variant "'+t.lang+'" is in the list of suggested languages.')})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.mediaViewer/ImageGateway.test.js":function(e,t,i){(function(e){var t,n,s,a=i("sinon"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/jQuery.js"),c=i("./src/mobile.startup/util.js");QUnit.module("MobileFrontend mobile.mediaViewer/ImageGateway",{beforeEach:function(){t=a.sandbox.create(),o.setUp(t,e),l.setUp(t,e),r.setUp(t,e),n=i("./src/mobile.mediaViewer/ImageGateway.js"),s=n._findSizeBucket},afterEach:function(){l.tearDown(),t.restore()}}),QUnit.test("#findSizeBucket",function(e){e.strictEqual(s(300),320,"value lower than bucket"),e.strictEqual(s(800),800,"exact value"),e.strictEqual(s(9999),2880,"value greater than last bucket")}),QUnit.test("ImageGateway#getThumb (missing page)",function(e){var t;t=new n({api:{get:function(){return c.Deferred().resolve({query:{pages:[{title:"Hello",missing:!0}]}})}}}),e.rejects(t.getThumb("Missing"),function(e){return-1!==e.message.indexOf("The API failed")},"A missing page throws an error which the client must handle")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.mediaViewer/ImageOverlay.test.js":function(e,t,i){(function(e){var t,n,s=i("./src/mobile.startup/util.js"),a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend mobile.mediaViewer/ImageOverlay",{beforeEach:function(){t=c.sandbox.create(),o.setUp(t,e),a.setUp(t,e),l.setUp(t,e),r.setUp(t,e),n=i("./src/mobile.mediaViewer/ImageOverlay.js"),this.image={descriptionurl:"https://commons.wikimedia.org/wiki/File:The_Montgomery,_San_Francisco.jpg",thumbheight:1024,thumburl:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/676px-The_Montgomery%2C_San_Francisco.jpg",thumbwidth:676,url:"https://upload.wikimedia.org/wikipedia/commons/b/b1/The_Montgomery%2C_San_Francisco.jpg"},this.imageGateway={getThumb:function(){return s.Deferred().resolve({query:{pages:[{imageinfo:[this.image]}]}})}},this.router={getPath:function(){return"/media/File%3AA_cursiva.gif"}},this.thumbnails=[{filename:"foo",getFileName:function(){return""},getPath:function(){return""},getDescription:function(){return""}},{filename:"bar",getFileName:function(){return""},getPath:function(){return""},getDescription:function(){return""}}]},afterEach:function(){a.tearDown(),t.restore()}}),QUnit.test("Shows details bar and image with successful api response",function(e){var t=new n({gateway:this.imageGateway,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",router:this.router,eventBus:{on:function(){}}});return this.imageGateway.getThumb().then(function(){e.strictEqual(t.$el.find("img").length,1,"Image is present."),e.strictEqual(t.$el.find(".load-fail-msg").length,0,"Load error msg is not visible"),e.strictEqual(t.$el.find(".details.is-visible").length,1,"Details bar present")})}),QUnit.test("Shows error message with failed api response",function(e){var t,i={getThumb:function(){return s.Deferred().reject("Load Error")}};return t=new n({gateway:i,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",router:this.router,eventBus:{on:function(){}}}),i.getThumb().catch(function(){e.strictEqual(t.$el.find(".load-fail-msg").length,1,"Load error msg is visible"),e.strictEqual(t.$el.find(".details.is-visible").length,0,"Details bar is hidden")})}),QUnit.test("Toggling of details is disabled when overlay has load failure",function(e){var t,i={getThumb:function(){return s.Deferred().reject("Load Error")}};return t=new n({gateway:i,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",thumbnails:this.thumbnails,router:this.router,eventBus:{on:function(){}}}),i.getThumb().catch(function(){e.strictEqual(t.$el.find(".details.is-visible").length,0,"Details bar is hidden"),e.notStrictEqual(t.$el.find(".details"),"none","Slider buttons are shown"),e.notStrictEqual(t.$el.find(".cancel"),"none","Cancel button is still shown"),e.notStrictEqual(t.$el.find(".prev"),"none","Slider buttons are still shown"),t.$el.find(".image-wrapper").trigger("click"),e.notStrictEqual(t.$el.find(".details"),"none","Slider buttons are shown"),e.notStrictEqual(t.$el.find(".cancel"),"none","Cancel button is still shown"),e.notStrictEqual(t.$el.find(".prev"),"none","Slider buttons are still shown")})}),QUnit.test("Toggling of details is enabled when overlay loads successfully",function(e){var t=new n({gateway:this.imageGateway,title:decodeURIComponent(this.image.url),caption:"The Montgomery in 2012.",thumbnails:this.thumbnails,router:this.router,eventBus:{on:function(){}}});return this.imageGateway.getThumb().then(function(){e.strictEqual(t.$el.find(".details.is-visible").length,1,"Details bar is shown"),e.notStrictEqual(t.$el.find(".details").css("display"),"none","Ensure display none rule is not set"),e.notStrictEqual(t.$el.find(".cancel").css("display"),"none","Cancel button is shown"),e.notStrictEqual(t.$el.find(".prev").css("display"),"none","Slider buttons are shown"),t.$el.find(".image-wrapper").trigger("click"),e.strictEqual(t.$el.find(".details").css("display"),"none","Details bar is hidden"),e.strictEqual(t.$el.find(".cancel").css("display"),"none","Cancel button is hidden"),e.strictEqual(t.$el.find(".slider-button").css("display"),"none","Slider buttons are hidden")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.nearby.scripts/Nearby.test.js":function(e,t,i){(function(e){var t,n,s,a,o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./tests/node-qunit/utils/mw.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("sinon"),d={get:function(){}};QUnit.module("MobileFrontend Nearby.js",{beforeEach:function(){t=u.sandbox.create(),r.setUp(t,e),o.setUp(t,e),c.setUp(t,e),l.setUp(t,e),a=i("./src/mobile.startup/util.js"),n=i("./src/mobile.special.nearby.scripts/NearbyGateway.js"),s=i("./src/mobile.special.nearby.scripts/Nearby.js")},afterEach:function(){o.tearDown(),t.restore()}}),QUnit.test("refresh() with no results, renders empty list",function(e){var i=a.parseHTML("<div>"),o=t.stub(n.prototype,"getPages").returns(a.Deferred().resolve([])),r={api:d,latitude:37.7,longitude:-122,range:1e3,el:i,eventBus:{emit:function(){}}};return new s(r).refresh(r).then(function(){e.ok(o.calledWithMatch({latitude:37.7,longitude:-122},1e3),"Check API got called"),e.strictEqual(i.find("li").length,0,"0 pages render."),e.strictEqual(i.find(".errorbox").length,1,"Error message shown."),e.strictEqual(i.find(".loading").is(":visible"),!1,"No loader shown.")})}),QUnit.test("refresh() with results, renders with a location",function(e){var i,o=a.parseHTML("<div>"),r={api:d,latitude:37.7,longitude:-122,range:1e3,el:o,eventBus:{emit:function(){}}};return t.stub(d,"get").returns(a.Deferred().resolve({query:{pages:[{pageid:2,watched:!0},{pageid:3,watched:!1},{pageid:4,watched:!1}]}})),i=t.stub(n.prototype,"getPages").returns(a.Deferred().resolve([{title:"Sutro Tower",id:2},{title:"Golden Gate bridge",id:3},{title:"Golden Gate Park",id:4}])),new s(r).refresh(r).then(function(){e.ok(i.calledWithMatch({latitude:37.7,longitude:-122},1e3),"Check API got called"),e.strictEqual(o.find("li").length,3,"3 pages render.")})}),QUnit.test("refresh() with server error, renders error",function(e){var i,o=a.parseHTML("<div>"),r=t.stub(n.prototype,"getPages").returns(a.Deferred().reject()),l={api:d,latitude:37.7,longitude:-122,range:1e3,el:o,eventBus:{emit:function(){}}};return(i=new s(l)).refresh(l).then(function(){e.ok(r.calledWithMatch({latitude:37.7,longitude:-122},1e3),"Check API got called"),e.strictEqual(o.find(".errorbox").length,1,"Check error got rendered"),e.strictEqual(o.find(".errorbox h2").text(),i.errorMessages.http.heading,"Check it is the correct heading")})}),QUnit.test("refresh() getting a title triggers different API method",function(e){var i,o=a.parseHTML("<div>"),r={api:d,pageTitle:"Hello Friends!",range:1e3,el:o,eventBus:{emit:function(){}}};i=t.stub(n.prototype,"getPagesAroundPage").returns(a.Deferred().reject()),new s(r).refresh(r),e.ok(i.calledWithMatch("Hello Friends!",1e3),"Check API got called")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.nearby.scripts/NearbyGateway.test.js":function(e,t,i){(function(e){var t,n,s,a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend NearbyGateway.js",{beforeEach:function(){var u;t=c.sandbox.create(),o.setUp(t,e),a.setUp(t,e),l.setUp(t,e),r.setUp(t,e),t.stub(mw.config,"get").withArgs("wgArticlePath").returns("/w/").withArgs("wgMFDisplayWikibaseDescriptions",{}).returns({nearby:!0}).withArgs("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).returns(["h1","h2","h3","h4","h5"]),s=i("./src/mobile.startup/util.js"),n=i("./src/mobile.special.nearby.scripts/NearbyGateway.js"),u={ajax:function(){}},this.nearbyGateway=new n({api:u}),t.stub(mw.language,"convertNumber",function(e){return"1.20"===e?"1.2":String(e)}),t.stub(u,"ajax",function(){return s.Deferred().resolve({query:{pages:[{pageid:20004112,ns:0,title:"The Montgomery (San Francisco)",thumbnail:{source:"https://upload.wikimedia.org/wikipedia/commons/thumb/b/b1/The_Montgomery%2C_San_Francisco.jpg/119px-The_Montgomery%2C_San_Francisco.jpg",width:119,height:180},pageimage:"The_Montgomery,_San_Francisco.jpg",coordinates:[{lat:37.787,lon:-122.41,primary:"",globe:"earth",dist:120200}]},{pageid:18618509,ns:0,title:"Wikimedia Foundation",thumbnail:{source:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c4/Wikimedia_Foundation_RGB_logo_with_text.svg/180px-Wikimedia_Foundation_RGB_logo_with_text.svg.png",width:180,height:180},pageimage:"Wikimedia_Foundation_RGB_logo_with_text.svg",coordinates:[{lat:37.787,lon:-122.51,primary:"",globe:"earth",dist:0}]},{pageid:9297443,ns:0,title:"W San Francisco",coordinates:[{lat:37.7854,lon:-122.61,primary:"",globe:"earth",dist:177400}]}]}})})},afterEach:function(){a.tearDown(),t.restore()}}),QUnit.test("_distanceMessage()",function(e){var i=this,n="mobile-frontend-nearby-distance",s="mobile-frontend-nearby-distance-meters",a=[[.4834,s,"490"],[.5,s,"500"],[.723,s,"730"],[.999,n,"1"],[1.2,n,"1.2"],[1.588,n,"1.59"],[1.123,n,"1.13"],[2.561,n,"2.6"],[10.8334,n,"10.9"]];t.spy(mw,"msg"),a.forEach(function(t,n){i.nearbyGateway._distanceMessage(t[0]),e.propEqual(mw.msg.getCall(n).args,[t[1],t[2]])})}),QUnit.test("getPages()",function(e){return this.nearbyGateway.getPages({latitude:37.787,longitude:-122.51}).then(function(t){e.strictEqual(t.length,3),e.strictEqual(t[0].title,"Wikimedia Foundation"),e.strictEqual(t[0].thumbnail.isLandscape,!1),e.strictEqual(t[2].title,"W San Francisco"),e.strictEqual(t[2].thumbnail,!1),e.strictEqual(t[2].dist.toPrecision(6),"177.400")})}),QUnit.test("getPagesAroundPage()",function(e){return this.nearbyGateway.getPagesAroundPage("Wikimedia Foundation").then(function(t){e.strictEqual(t.length,2),e.strictEqual(t[1].title,"W San Francisco"),e.strictEqual(t[1].thumbnail,!1),e.strictEqual(t[1].dist.toPrecision(6),"177.400")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.uploads.scripts/PhotoListGateway.test.js":function(e,t,i){(function(e){var t,n,s,a=i("sinon"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/jQuery.js");QUnit.module("PhotoListGateway",{beforeEach:function(){n=a.sandbox.create(),o.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.special.uploads.scripts/PhotoListGateway.js"),s=t.test.getDescription},afterEach:function(){r.tearDown(),n.restore()}}),QUnit.test("#getDescription",function(e){[["File:Pirates in SF 2013-04-03 15-44.png","Pirates in SF"],["File:Unpadded 9 pirates in SF 2013-04-03 15-9.png","Unpadded 9 pirates in SF"],["File:Jon lies next to volcano 2013-03-18 13-37.jpeg","Jon lies next to volcano"],["hello world 37.jpg","hello world 37"],["hello world again.jpeg","hello world again"],["Fichier:French Photo Timestamp 2013-04-03 15-44.jpg","French Photo Timestamp"],["Fichier:Full stop. Photo.unknownfileextension","Full stop. Photo"],["File:No file extension but has a . in the title","No file extension but has a . in the title"],["Fichier:French Photo.jpg","French Photo"]].forEach(function(t,i){var n=s(t[0]);e.strictEqual(n,t[1],"test "+i)})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.watchlist.scripts/WatchList.test.js":function(e,t,i){(function(e){var t,n,s,a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend WatchList.js",{beforeEach:function(){s=c.sandbox.create(),o.setUp(s,e),a.setUp(s,e),l.setUp(s,e),r.setUp(s,e),s.stub(mw.user,"isAnon").returns(!1),t=i("./src/mobile.special.watchlist.scripts/WatchList.js"),n=i("./src/mobile.startup/Icon.js")},afterEach:function(){a.tearDown(),s.restore()}}),QUnit.test("In watched mode",function(e){var i={get:s.stub()},a=new t({eventBus:{on:function(){},off:function(){}},api:i,pages:[{title:"Title 30"},{title:"Title 50"},{title:"Title 60",watched:!0}]}),o=new n({name:"watched"}).getGlyphClassName();a.scrollEndEventEmitter.disable(),e.ok(i.get.notCalled,"Callback avoided"),e.strictEqual(a.$el.find(".watch-this-article").length,3,"3 articles have watch stars..."),e.strictEqual(a.$el.find("."+o).length,3,"...and all are marked as watched.")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.special.watchlist.scripts/WatchListGateway.test.js":function(e,t,i){(function(e){var t,n,s=i("./tests/node-qunit/utils/jQuery.js"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/mw.js"),r=i("./tests/node-qunit/utils/oo.js"),l=i("sinon"),c=i("./src/mobile.startup/util.js"),u={continue:{pageimages:{picontinue:9}},warnings:{query:{"*":"Formatting of continuation data will be changing soon. To continue using the current formatting, use the 'rawcontinue' parameter. To begin using the new format, pass an empty string for 'continue' in the initial query."}},query:{pages:[{pageid:2,ns:0,title:"Burrito",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-17T10:06:49Z",lastrevid:552,length:33534},{pageid:3,ns:0,title:"Albert Einstein",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-16T17:33:22Z",lastrevid:4,length:19},{pageid:9,ns:0,title:"Anne Dallas Dudley",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-17T10:00:13Z",lastrevid:18,length:12663},{pageid:10,ns:0,title:"San Francisco",contentmodel:"wikitext",pagelanguage:"en",touched:"2014-12-17T10:04:55Z",lastrevid:546,length:373791},{pageid:708,ns:0,title:"Functional logic programming",contentmodel:"wikitext",pagelanguage:"en",touched:"2015-01-12T13:04:23Z",lastrevid:1307,length:1392,new:""},{pageid:720,ns:0,title:"Functional programming",contentmodel:"wikitext",pagelanguage:"en",touched:"2015-01-12T13:04:35Z",lastrevid:1319,length:54839,new:""},{ns:0,title:"zzzz",missing:!0,contentmodel:"wikitext",pagelanguage:"en"}]}};QUnit.module("MobileFrontend WatchListGateway.js",{beforeEach:function(){n=l.sandbox.create(),a.setUp(n,e),s.setUp(n,e),r.setUp(n,e),o.setUp(n,e),n.stub(mw.config,"get").withArgs("wgMFDisplayWikibaseDescriptions",{}).returns({watchlist:!0}).withArgs("wgMFMobileFormatterHeadings",["h1","h2","h3","h4","h5"]).returns(["h1","h2","h3","h4","h5"]),n.stub(mw.util,"getUrl",function(){}),t=i("./src/mobile.special.watchlist.scripts/WatchListGateway.js")},afterEach:function(){s.tearDown(),n.restore()}}),QUnit.test("loadWatchlist() loads results from the first page",function(e){var i=new t(new mw.Api);return n.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve(u)),i.loadWatchlist().then(function(t){var i=mw.Api.prototype.get.firstCall.args[0];e.strictEqual(i.continue,"","It should set the continue parameter"),e.strictEqual(t.length,7,"Got all the results"),e.strictEqual(t[0].displayTitle,"Albert Einstein","Sorted alphabetically")})}),QUnit.test("loadWatchlist() loads results from the second page from last item of first",function(e){var i,s=new t(new mw.Api,"Albert Einstein"),a=c.extend({},u,{continue:{watchlistraw:{gwrcontinue:"0|Albert Einstein"}}});return i=n.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve(a)),s.loadWatchlist().then(function(t){var n=mw.Api.prototype.get.firstCall.args[0];return e.strictEqual(n.continue,"gwrcontinue||","It should set the continue parameter"),e.strictEqual(n.gwrcontinue,"0|Albert_Einstein","It should set the watchlistraw-specific continue parameter"),e.strictEqual(t.length,6,"Should have Albert removed from the results"),e.strictEqual(t[0].displayTitle,"Anne Dallas Dudley","First item should be Anne"),i.returns(c.Deferred().resolve(u)),s.loadWatchlist().then(function(t){e.strictEqual(t.length,7,"Albert should be in the results"),e.strictEqual(t[0].displayTitle,"Albert Einstein","First item should be Albert")})})}),QUnit.test("loadWatchlist() doesn't throw an error when no pages are returned",function(e){var i=new t(new mw.Api);return n.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve({batchcomplete:""})),i.loadWatchlist().then(function(t){e.propEqual(t,[])})}),QUnit.test("loadWatchlist() marks pages as new if necessary",function(e){var i=new t(new mw.Api);return n.stub(mw.Api.prototype,"get").returns(c.Deferred().resolve(u)),i.loadWatchlist().then(function(t){e.strictEqual(t[0].isMissing,!1,"Albert Einstein page isn't marked as new"),e.strictEqual(t[6].isMissing,!0,"zzzz page is marked as new")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Browser.test.js":function(e,t,i){(function(e){var t,n,s=i("./src/mobile.startup/Browser.js"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("sinon"),l=i("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend Browser.js",{beforeEach:function(){var i;n=r.sandbox.create(),a.setUp(n,e),o.setUp(n,e),l.setUp(n,e),i=window.document.implementation.createHTMLDocument("Test"),t=$(i)},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("isIos()",function(e){var i=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),n=new s("Mozilla/5.0 (iPad; CPU OS 4_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),a=new s("Mozilla/5.0 (iPad; CPU OS 5_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=new s("Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53",t);e.strictEqual(i.isIos(),!0),e.strictEqual(i.isIos(8),!1),e.strictEqual(i.isIos(4),!1),e.strictEqual(i.isIos(5),!1),e.strictEqual(o.isIos(),!0),e.strictEqual(o.isIos(8),!0),e.strictEqual(n.isIos(4),!0),e.strictEqual(a.isIos(5),!0)}),QUnit.test("Methods are cached",function(e){var i=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),n=new s("Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/8.0 Mobile/11A465 Safari/9537.53",t),a=new s("Android 2",t);function o(e,t){return e["__cache"+e[t].cacheId]}e.strictEqual(i.isIos(),!0),e.strictEqual(i.isIos(8),!1),e.strictEqual(a.isIos(8),!1),e.strictEqual(n.isIos(),!0),e.strictEqual(n.isIos(8),!0),e.strictEqual(Object.keys(o(i,"isIos")).length,2,"isIos on ipad cached as expected"),e.strictEqual(Object.keys(o(a,"isIos")).length,1,"isIos on android cached as expected"),e.strictEqual(Object.keys(o(n,"isIos")).length,2,"isIos on iphone cached as expected")}),QUnit.test("lockViewport()",function(e){var i,n=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);n.$el.find("head").append('<meta name="viewport"/>'),n.lockViewport(),i=n.$el.find('meta[name="viewport"]').attr("content"),e.strictEqual(i,"initial-scale=1.0, maximum-scale=1.0, user-scalable=no")}),QUnit.test("isWideScreen()",function(e){var i=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);n.stub(mw.config,"get",function(){return"720px"}),e.strictEqual(i.isWideScreen(),!0)}),QUnit.test("supportsAnimations() - true",function(e){var i,a=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=n.stub(document,"createElement",function(){return{style:{animationName:"",transform:"",transition:""}}});i=a.supportsAnimations(),o.restore(),e.strictEqual(i,!0)}),QUnit.test("supportsAnimations() - false",function(e){var i,a=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t),o=n.stub(document,"createElement",function(){return{style:{}}});i=a.supportsAnimations(),o.restore(),e.strictEqual(i,!1)}),QUnit.test("supportsTouchEvents()",function(e){var i=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);window.ontouchstart=window.ontouchstart||void 0,e.strictEqual(i.supportsTouchEvents(),!0)}),QUnit.test("supportsGeoLocation()",function(e){var i=new s("Mozilla/5.0 (iPad; CPU OS 7_0 like Mac OS X) AppleWebKit/537.51.1 (KHTML, like Gecko)",t);window.navigator.geolocation=window.navigator.geolocation||void 0,e.strictEqual(i.supportsGeoLocation(),!0)})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Button.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/oo.js"),l=i("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend Button.js",{beforeEach:function(){n=s.sandbox.create(),a.setUp(n,e),o.setUp(n,e),r.setUp(n,e),l.setUp(n,e),t=i("./src/mobile.startup/Button.js")},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("creates a link if passed href option",function(e){var i=new t({href:"https://www.foo.com"});e.strictEqual(i.$el[0].tagName,"A"),e.strictEqual(i.$el[0].getAttribute("href"),"https://www.foo.com")}),QUnit.test("does not add href attribute when not a link",function(e){var i=new t({tagName:"div"});e.strictEqual(i.$el[0].tagName,"DIV"),e.strictEqual(i.$el[0].href,void 0)})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js":function(e,t){e.exports={defaultURLs:'\n\t\t<div class=" drawer position-fixed view-border-box ">\n\t\t\t<div\n\t\t\t\tclass=" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel "\n\t\t\t\ttitle=""\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=" logIn " class=" mw-ui-button mw-ui-progressive ">\n\t\t\t\tLog in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=" signUp " class=" mw-ui-anchor mw-ui-progressive ">\n\t\t\t\t\tSign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t',overrideURLs:'\n\t\t<div class=" drawer position-fixed view-border-box ">\n\t\t\t<div\n\t\t\t\tclass=" mw-ui-icon mw-ui-icon-mf-arrow mw-ui-icon-element cancel "\n\t\t\t\ttitle=""\n\t\t\t> </div>\n\t\t\t<p> </p>\n\t\t\t<a href=" customLogIn " class=" mw-ui-button mw-ui-progressive ">\n\t\t\t\tcustom log in\n\t\t\t</a>\n\t\t\t<div>\n\t\t\t\t<a href=" customSignUp " class=" mw-ui-anchor mw-ui-progressive ">\n\t\t\t\t\tcustom sign up\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n\t'}},"./tests/node-qunit/mobile.startup/CtaDrawer.test.js":function(e,t,i){(function(e){var t,n,s,a,o,r,l=i("./tests/node-qunit/utils/dom.js"),c=i("./tests/node-qunit/utils/jQuery.js"),u=i("./tests/node-qunit/utils/mw.js"),d=i("./tests/node-qunit/utils/oo.js"),h=i("sinon");QUnit.module("MobileFrontend CtaDrawer.js",{beforeEach:function(){o=h.sandbox.create(),l.setUp(o,e),c.setUp(o,e),d.setUp(o,e),u.setUp(o,e),o.stub(e.mw,"msg",function(e){switch(e){case"mobile-frontend-watchlist-cta-button-login":return"Log in";case"mobile-frontend-watchlist-cta-button-signup":return"Sign up"}return e}),o.stub(e.mw.util,"getUrl",function(e,t){return t.type?"signUp":"logIn"}),n=i("./src/mobile.startup/Anchor.js"),s=i("./src/mobile.startup/Button.js"),a=i("./src/mobile.startup/Drawer.js"),t=i("./src/mobile.startup/CtaDrawer.js"),o.stub(a.prototype,"appendToElement","#ctaDrawerParent"),(r=document.createElement("div")).id="ctaDrawerParent",document.documentElement.appendChild(r)},afterEach:function(){document.documentElement.removeChild(r),r=void 0,t=void 0,a=void 0,s=void 0,n=void 0,c.tearDown(),o.restore()}},function(){QUnit.module("redirectParams()",function(){QUnit.test("empty props, default URL",function(i){var n=t.prototype.test.redirectParams;o.stub(e.mw.config,"get",function(){return"pageName"}),i.propEqual(n({}),{returnto:"pageName"})}),QUnit.test("empty props, nondefault URL",function(e){var i=t.prototype.test.redirectParams;e.propEqual(i({},"url"),{returnto:"url"})}),QUnit.test("nonempty props",function(e){var i=t.prototype.test.redirectParams;e.propEqual(i({key:"val"},"url"),{key:"val",returnto:"url"})})}),QUnit.module("signUpParams()",function(){QUnit.test("empty props",function(e){var i=t.prototype.test.signUpParams;e.propEqual(i({}),{type:"signup"})}),QUnit.test("nonempty props",function(e){var i=t.prototype.test.signUpParams;e.propEqual(i({key:"val"}),{key:"val",type:"signup"})})}),QUnit.module("HTML",function(){QUnit.test("defaults",function(e){var n=new t,s=new RegExp(i("./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js").defaultURLs.replace(/\s+/g,"\\s*"));h.assert.match(n.$el.get(0).outerHTML,s),e.ok(!0)}),QUnit.test("overrides",function(e){var a=new t({progressiveButton:new s({progressive:!0,label:"custom log in",href:"customLogIn"}).options,actionAnchor:new n({progressive:!0,label:"custom sign up",href:"customSignUp"}).options}),o=new RegExp(i("./tests/node-qunit/mobile.startup/CtaDrawer.test.html.js").overrideURLs.replace(/\s+/g,"\\s*"));h.assert.match(a.$el.get(0).outerHTML,o),e.ok(!0)})})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Drawer.test.js":function(e,t,i){(function(e){var t,n,s,a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon"),u=i("./src/mobile.startup/util.js");function d(e,t){e.on("show",function(){setTimeout(t,e.minHideDelay)})}function h(){c.assert.match(s.className,/^((?!\bdrawer-visible\b).)*$/)}QUnit.module("MobileFrontend Drawer.js",{beforeEach:function(){n=c.sandbox.create(),a.setUp(n,e),o.setUp(n,e),l.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.startup/Drawer.js"),n.stub(t.prototype,"appendToElement","#drawerParent"),(s=document.createElement("div")).id="drawerParent",document.documentElement.appendChild(s)},afterEach:function(){document.documentElement.removeChild(s),s=void 0,t=void 0,o.tearDown(),n.restore()}}),QUnit.test("appends self to parent when DOM is loaded",function(e){var i=e.async(),n=new t;u.docReady(function(){e.strictEqual(n.$el.parent().get(0),s),i()})}),QUnit.test("adds class to parent when DOM is loaded",function(e){var i=e.async();new t,u.docReady(function(){e.strictEqual(s.className,"has-drawer"),i()})}),QUnit.test("consumes clicks",function(e){var i=e.async(),n=new window.Event("click"),s=new t;n.stopPropagation=function(){e.ok(!0),i()},s.$el.get(0).dispatchEvent(n)}),QUnit.test("visible on show()",function(e){var i=e.async(),n=new t;n.on("show",function(){c.assert.match(s.className,/.*\bdrawer-visible\b.*/),e.ok(!0),i()}),n.show()}),QUnit.test("hidden on hide()",function(e){var i=e.async(),n=new t;n.on("hide",function(){h(),e.ok(!0),i()}),n.hide()}),QUnit.test("hidden on click once presented",function(e){var i=e.async(),n=new t;n.on("hide",function(){h(),e.ok(!0),i()}),d(n,function(){s.click()}),n.show()}),QUnit.test("hidden on scroll once presented",function(e){var i=e.async(),n=new t;n.on("hide",function(){h(),e.ok(!0),i()}),d(n,function(){var e=new window.Event("scroll",{bubbles:!0});s.dispatchEvent(e)}),n.show()}),QUnit.test("HTML is valid",function(e){var i=new t;e.strictEqual(i.$el.get(0).outerHTML,'<div class="drawer position-fixed view-border-box"></div>')})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Overlay.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./src/mobile.startup/mfExtend.js"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./tests/node-qunit/utils/mw.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("./src/mobile.startup/util.js"),d=i("./node_modules/hogan.js/lib/hogan.js");QUnit.module("MobileFrontend: Overlay.js",{beforeEach:function(){n=s.sandbox.create(),r.setUp(n,e),a.setUp(n,e),c.setUp(n,e),l.setUp(n,e),t=i("./src/mobile.startup/Overlay.js"),n.stub(e.window,"scrollTo"),u.getDocument().find("#mw-mf-viewport").length||(this.$viewport=u.parseHTML("<div>").attr("id","mw-mf-viewport").appendTo("body"))},afterEach:function(){this.$viewport&&this.$viewport.remove(),a.tearDown(),n.restore()}}),QUnit.test("Simple overlay",function(e){var i;i=new t({heading:"<h2>Overlay Title</h2>"}).$el.find('h2:contains("Overlay Title")'),e.strictEqual(i.length,1)}),QUnit.test("#make",function(e){var i=t.make({heading:"Fresh from factory"},new t({className:"overlay-child",heading:"overlay in overlay"}));e.strictEqual(i.$el.find(".overlay-child").length,1,"there is an overlay in the overlay!"),e.strictEqual(i.$el.find(".overlay-title").eq(0).text().trim(),"Fresh from factory","First heading found"),e.strictEqual(i.$el.find(".overlay-content .overlay-title").text().trim(),"overlay in overlay","Second heading found in overlay-content")}),QUnit.test("HTML overlay",function(e){var i;function n(){t.apply(this,arguments)}o(n,t,{templatePartials:u.extend({},t.prototype.templatePartials,{content:d.compile('<div class="content">YO</div>')})}),i=new n({heading:"Awesome"}),e.strictEqual(i.$el.find("h2").html(),"Awesome"),e.strictEqual(i.$el.find(".content").text(),"YO")}),QUnit.test("Close overlay",function(e){var i=new t({heading:"<h2>Title</h2>",content:"Text"});i.show(),i.hide(),e.strictEqual(i.$el[0].parentNode,null,"No longer in DOM")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/OverlayManager.test.js":function(e,t,i){(function(e){var t,n,s,a,o=i("sinon"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./tests/node-qunit/utils/jQuery.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("./src/mobile.startup/util.js"),d=i("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend mobile.startup/OverlayManager",{beforeEach:function(){a=o.sandbox.create(),r.setUp(a,e),c.setUp(a,e),l.setUp(a,e),d.setUp(a,e),a.stub(e.window,"scrollTo"),t=i("./src/mobile.startup/OverlayManager.js"),this.createFakeOverlay=function(e){var t=new OO.EventEmitter;return t.hasLoadError=!1,t.show=a.spy(),t.hide=function(){return this.emit("hide"),!0},t.$el=$("div"),a.spy(t,"hide"),u.extend(t,e),t},(n=new OO.EventEmitter).getPath=a.stub().returns(""),n.back=a.spy(),a.stub(mw.loader,"require").withArgs("mediawiki.router").returns(n),s=new t(n,"body")},afterEach:function(){l.tearDown(),a.restore()}}),QUnit.test("#getSingleton",function(e){var i=t.getSingleton();e.ok(i instanceof t,"singleton exists"),e.strictEqual(i,t.getSingleton(),"same object returned each time")}),QUnit.test("#add",function(e){var t=this.createFakeOverlay();s.add(/^test$/,function(){return t}),n.emit("route",{path:"test"}),e.strictEqual(t.show.callCount,1,"show registered overlay")}),QUnit.test("#show",function(e){var t=this.createFakeOverlay(),i=a.spy(s,"_show");s.add(/^showTest$/,function(){return t}),n.emit("route",{path:"showTest"}),e.strictEqual(i.callCount,1,"OverlayManager.show called on route change")}),QUnit.test("#add, with $.Deferred factory",function(e){var t=u.Deferred(),i=this.createFakeOverlay();return t.show=a.spy(),s.add(/^foo$/,function(){return t}),n.emit("route",{path:"foo"}),t.resolve(i),t.then(function(){e.notOk(t.show.called,"don't call show on Deferred"),e.strictEqual(i.show.callCount,1,"show registered overlay")})}),QUnit.test("#add, with current path",function(e){var t=this.createFakeOverlay(),i=u.Deferred();return n.getPath=a.stub().returns("baha"),s.add(/^baha$/,function(){return t}),u.docReady(function(){i.resolve()}),i.then(function(){e.strictEqual(t.show.callCount,1,"show registered overlay")})}),QUnit.test("#replaceCurrent",function(e){var t=this.createFakeOverlay(),i=this.createFakeOverlay();s.add(/^test$/,function(){return t}),n.emit("route",{path:"test"}),s.replaceCurrent(i),e.strictEqual(t.hide.callCount,1,"hide overlay"),e.strictEqual(i.show.callCount,1,"show another overlay"),n.emit("route",{path:""}),e.strictEqual(i.hide.callCount,1,"hide another overlay")}),QUnit.test("route with params",function(e){var t=this.createFakeOverlay(),i=a.stub().returns(t);s.add(/^sam\/(\d+)$/,i),n.emit("route",{path:"sam/123"}),e.ok(i.calledWith("123"),"pass params from the route")}),QUnit.test("hide when route changes",function(e){var t=this.createFakeOverlay(),i=a.stub().returns(t);s.add(/^jon$/,i),n.emit("route",{path:"jon"}),n.emit("route",{path:""}),n.emit("route",{path:"jon"}),n.emit("route",{path:"other"}),e.strictEqual(t.hide.callCount,2,"hide overlay"),e.ok(t.hide.getCall(0).notCalledWith(!0),"don't force hide (first)"),e.ok(t.hide.getCall(1).notCalledWith(!0),"don't force hide (second)")}),QUnit.test("go back (change route) if overlay hidden but not by route change",function(e){var t=this.createFakeOverlay(),i=a.stub().returns(t);s.add(/^joakino$/,i),n.emit("route",{path:"joakino"}),t.hide(),e.strictEqual(n.back.callCount,1,"route back")}),QUnit.test("stacked overlays",function(e){var t=this.createFakeOverlay(),i=a.stub().returns(t),o=this.createFakeOverlay(),r=a.stub().returns(o);s.add(/^parent$/,r),s.add(/^child$/,i),n.emit("route",{path:"parent"}),e.strictEqual(o.show.callCount,1,"show parent"),n.emit("route",{path:"child"}),e.strictEqual(o.hide.callCount,1,"hide parent"),e.ok(o.hide.calledWith(!0),"hide parent forcefully (no confirmation)"),e.strictEqual(t.show.callCount,1,"show child"),n.emit("route",{path:"parent"}),e.strictEqual(t.hide.callCount,1,"hide child"),e.strictEqual(o.show.callCount,2,"show parent again"),e.strictEqual(r.callCount,1,"create parent only once")}),QUnit.test("prevent route change",function(e){var t=this.createFakeOverlay({hide:a.stub().returns(!1)}),i=a.stub().returns(t),o={path:"",preventDefault:a.spy()};s.add(/^rob$/,i),n.emit("route",{path:"rob"}),n.emit("route",o),e.ok(o.preventDefault.calledOnce,"prevent route change")}),QUnit.test("reload failed overlay when navigating to it again from another overlay",function(e){var t,i,o=this.createFakeOverlay(),r=this.createFakeOverlay();o.hasLoadError=!0,(i=a.stub()).onCall(0).returns(o),i.onCall(1).returns(r),t=function(e){return"0"===e?i():r},s.add(/^test\/(\d+)$/,t),n.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack is correct size"),e.ok(s.stack[0].overlay.hasLoadError,"first overlay has load error"),n.emit("route",{path:"test/1"}),e.strictEqual(s.stack.length,2,"stack is correct size"),e.notOk(s.stack[0].overlay.hasLoadError,"second overlay loads successfully"),n.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack decreases when going back to already visited overlay"),e.notOk(s.stack[0].overlay.hasLoadError,"Failed attempt is not cached and new overlay is loaded")}),QUnit.test("replace overlay when route event path is equal to current path",function(e){var t,i=this.createFakeOverlay(),o=this.createFakeOverlay();i.hasLoadError=!0,(t=a.stub()).onCall(0).returns(i),t.onCall(1).returns(o),s.add(/^test\/(\d+)$/,t),n.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack is correct size"),e.ok(s.stack[0].overlay.hasLoadError,"overlay has load error"),n.emit("route",{path:"test/0"}),e.strictEqual(s.stack.length,1,"stack is correct size (did not increase upon reload)"),e.notOk(s.stack[0].overlay.hasLoadError,"overlay retry loads successfully")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Page.test.js":function(e,t,i){(function(e){var t,n,s,a,o,r,l,c=i("./tests/node-qunit/utils/dom.js"),u=i("./tests/node-qunit/utils/jQuery.js"),d=i("./tests/node-qunit/utils/mw.js"),h=i("./tests/node-qunit/utils/oo.js"),p=i("sinon"),m='<div class="mw-parser-output">';QUnit.module("MobileFrontend Page",{beforeEach:function(){var g=function(e){return'<div class="ambox">'+e+"</div>"},f=function(e){return'<h2 class="section-heading">'+e+"</h2>"},b=function(e,t){var i=t||"h3";return"<"+i+">"+e+"</"+i+">"},w=function(e,t){return'<div class="mf-section-'+e+'">'+t+"</div>"};s=p.sandbox.create(),c.setUp(s,e),d.setUp(s,e),u.setUp(s,e),h.setUp(s,e),t=i("./src/mobile.startup/Page.js"),n=i("./src/mobile.startup/util.js"),a=new t({el:n.parseHTML(m).html("<p>lead</p>"+g("a0"))}),o=new t({el:n.parseHTML(m).html(w(0,g("a0")+'<p>lead</p><div class="toc-mobile view-border-box"><h2></h2><div></div></div>')+f("1")+w(1,g("a1")+b("1.1")+g("a1.1")))}),r=new t({el:n.parseHTML(m).html("<p>lead</p>"+g("a0")+b("1","h2")+g("a1")+b("1.1")+g("a1.1"))}),l=new t({el:n.parseHTML(m).html(w(0,"<p>lead</p>"+g("a0"))+f("1")+w(1,g("a1")+b("1.1")+g("a1.1")+b("1.1.1","h4")+g("a1.1.1")+b("1.1.2","h4")+g("a1.1.2")+b("1.2")+g("a1.1"))+f("2")+w(6,g("a2"))+f("3")+w(7,g("a3"))+f("Section with nested Ambox")+w(8,g("<p>nested-ambox-parent,</p>"+g("nested-ambox-1,")+g("nested-ambox-2")))+f("Sub-section with nested Ambox")+w(9,g("<p>nested-ambox-parent,</p>"+g("nested-ambox-1,")+g("nested-ambox-2"))+b("subsection heading")+b("Another subsection heading")))})},afterEach:function(){u.tearDown(),s.restore()}}),QUnit.test("#findInSectionLead",function(e){[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[3,"","h4","selector does not match",".foo"],[111,"","Non-existent section"]].forEach(function(t,i){var n=t[0],s=t[1],a=t[2],o=t[3]||".ambox";e.strictEqual(r.findChildInSectionLead(n,o).text(),s,"Found correct text in desktop test "+i+" case: "+a)}),[[0,"a0","lead section"],[3,"","h4","selector does not match",".foo"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(a.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Stub: Found correct text in desktop test case:"+t[2])}),[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[3,"a1.1.1","h4"],[3,"","h4","selector does not match",".foo"],[7,"a3","h2 later"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(l.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Mobile: Found correct text in test case:"+t[2])}),[[0,"a0","lead section"],[1,"a1","h2"],[2,"a1.1","h3"],[111,"","Non-existent section"]].forEach(function(t){e.strictEqual(o.findChildInSectionLead(t[0],t[3]||".ambox").text(),t[1],"Mobile with table of contents: Found correct text in test case:"+t[2])}),[[8,".ambox","nested-ambox-parent,nested-ambox-1,nested-ambox-2","Nested elements in section"],[9,".ambox","nested-ambox-parent,nested-ambox-1,nested-ambox-2","Nested elements in subsection"]].forEach(function(t){var i=l.findChildInSectionLead(t[0],t[1]);e.strictEqual(i.not(i.children()).text(),t[2],"Mobile: Found correct text in test case:"+t[3])})}),QUnit.test("#isMainPage",function(e){var i=new t({title:"Main Page",isMainPage:!0}),n=new t({title:"Foo"});e.strictEqual(i.isMainPage(),!0,"check main page flag is updated"),e.strictEqual(n.isMainPage(),!1,"check not marked as main page")}),QUnit.test("#getThumbnails",function(e){var i,s,a,o,r,l,c,u,d,h;i=new t({el:n.parseHTML('<div><a href="/wiki/File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),s=new t({el:n.parseHTML("<div></div>")}),a=new t({el:n.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),o=i.getThumbnails(),r=new t({el:n.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box noviewer"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),l=new t({el:n.parseHTML('<div><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" class="metadata" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),h=new t({el:n.parseHTML('<div class="noviewer"><a href="/wikpa/index.php?title=File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" class="image view-border-box"><img alt="Cyanolimnas cerverai by Allan Brooks cropped.jpg" src="//upload.wikimedia.org/wikipedia/commons/thumb/0/0d/Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg/300px-Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg" width="300" height="303" data-file-width="454" data-file-height="459"></a></div>')}),c=new t({el:n.parseHTML('<div><a href="/wiki/File:Design_portal_logo.jpg" class="image"><span class="lazy-image-placeholder" style="width: 28px;height: 28px;" data-src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg" data-alt="icon" data-width="28" data-height="28" data-class="noviewer">&nbsp;</span></a></div>')}),d=new t({el:n.parseHTML('<div><a href="/wiki/File:Design_portal_logo.jpg" class="image"><span class="lazy-image-placeholder" style="width: 28px;height: 28px;" data-src="//upload.wikimedia.org/wikipedia/commons/thumb/3/3b/Design_portal_logo.jpg/28px-Design_portal_logo.jpg" data-alt="icon" data-width="28" data-height="28" data-class="wot noviewerz bar">&nbsp;</span></a></div>')}),u=new t({el:n.parseHTML('<div><table class="plainlinks metadata ambox ambox-content ambox-Unreferenced" role="presentation"><tr><td class="mbox-image"><div style="width:52px"><a href="/wiki/File:Question_book-new.svg" class="image"><span class="lazy-image-placeholder" style="width: 50px;height: 39px;" data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/50px-Question_book-new.svg.png" data-alt="" data-width="50" data-height="39" data-srcset="https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/75px-Question_book-new.svg.png 1.5x, https://upload.wikimedia.org/wikipedia/commons/thumb/9/99/Question_book-new.svg/100px-Question_book-new.svg.png 2x"> </span></a></div></td></tr></table>')}),e.strictEqual(o.length,1,"Found expected number of thumbnails."),e.strictEqual(o[0].getFileName(),"File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg","Found expected filename."),o=s.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=a.getThumbnails(),e.strictEqual(o.length,1,"Found expected number of thumbnails."),e.strictEqual(o[0].getFileName(),"File:Cyanolimnas_cerverai_by_Allan_Brooks_cropped.jpg","Found expected filename."),o=r.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=l.getThumbnails(),e.strictEqual(o.length,0,"This page has no thumbnails."),o=h.getThumbnails(),e.strictEqual(o.length,0,"Images inside a container with the class are not included. Images inside tables for example."),o=c.getThumbnails(),e.strictEqual(o.length,0,"Consider whether the class is on an image which has not been lazy loaded."),o=u.getThumbnails(),e.strictEqual(o.length,0,"Consider whether the lazy loaded image is inside a .metadata container."),o=d.getThumbnails(),e.strictEqual(o.length,1,"Thumbnail found if there is a typo.")}),QUnit.test("#getNamespaceId",function(e){[["Main Page",0],["San Francisco",0],["San Francisco: Talk:2",0],["San Francisco: The Sequel",0],["Talk:Foo",1],["Project:Bar",4],["User talk:Jon",3],["Special:Nearby",-1]].forEach(function(i){var n=new t({title:i[0]});e.strictEqual(n.getNamespaceId(),i[1],"Check namespace is as expected")})}),QUnit.test("#isTalkPage",function(e){[["Main Page",!1],["San Francisco",!1],["San Francisco: Talk:2",!1],["San Francisco: The Sequel",!1],["Talk:Foo",!0],["Project talk:Bar",!0],["User talk:Jon",!0],["Special:Nearby",!1]].forEach(function(i){var n=new t({title:i[0]});e.strictEqual(n.isTalkPage(),i[1],"Check test is as expected")})}),QUnit.test("#isMissing",function(e){var i,n;i=[new t({title:"Hello",id:0}),new t({title:"Hello",id:5,isMissing:!0}),new t({title:"Hello",isMissing:!0})],n=[new t({title:"Hello",id:4}),new t({title:"Hello",id:4,isMissing:!1}),new t({title:"Hello",isMissing:!1}),new t({title:"Hello",id:0,isMissing:!1})],i.forEach(function(t,i){e.strictEqual(t.isMissing,!0,"page "+i+" is missing")}),n.forEach(function(t,i){e.strictEqual(t.isMissing,!1,"page "+i+" is not missing")})}),QUnit.test("#allowsXSS",function(e){var i=new t({title:'<script>alert("oops, XSS possible!");<\/script>'});e.strictEqual(i.getDisplayTitle(),"&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;","Check against XSS in Page.js constructor displaytitle (when title set)"),[{thumbnail:!1,title:'<script>alert("oops, XSS possible!");<\/script>',terms:!1,testDesc:"Check against XSS in Page.newFromJSON displaytitle (when title set)"},{thumbnail:!1,pageprops:[],terms:{label:['<script>alert("oops, XSS possible!");<\/script>']},testDesc:"Check against XSS in Page.newFromJSON displaytitle (when Wikibase label set)"}].forEach(function(n){i=t.newFromJSON(n),e.strictEqual(i.getDisplayTitle(),"&lt;script&gt;alert(&quot;oops, XSS possible!&quot;);&lt;/script&gt;",n.testDesc)})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/PageGateway.test.js":function(e,t,i){(function(e){var t,n,s,a,o=i("sinon"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./tests/node-qunit/utils/mw.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("./tests/node-qunit/utils/jQuery.js"),d=i("./tests/node-qunit/utils/PageInputs.html.js"),h=d.page,p=d.page2,m=i("./tests/node-qunit/utils/PageGateway.responses.js");QUnit.module("MobileFrontend PageGateway",{beforeEach:function(){a=o.sandbox.create(),r.setUp(a,e),u.setUp(a,e),l.setUp(a,e),c.setUp(a,e),t=i("./src/mobile.startup/util.js"),n=i("./src/mobile.startup/PageGateway.js"),this.api=new mw.Api,s=new n(this.api)},afterEach:function(){u.tearDown(),a.restore()}}),QUnit.test("#getSections (has sections)",function(e){var i=new n;return a.stub(i,"getPage").returns(t.Deferred().resolve({sections:[{line:"1"}]})),i.getSections(i,"Title").then(function(t){e.strictEqual(t.length,1,"1 section is returned")})}),QUnit.test("#getSections (missing titles)",function(e){var i=new n;return a.stub(i,"getPage").returns(t.Deferred().reject("missingtitle")),i.getSections(i,"Title").then(function(t){e.strictEqual(t.length,0,"0 sections are returned")})}),QUnit.test("#getSections (other failures)",function(e){var i=new n;a.stub(i,"getPage").returns(t.Deferred().reject()),e.throws(i.getSections(i,"Title"),"an exception is thrown")}),QUnit.test("#getPage (h1s)",function(e){return a.stub(this.api,"get").returns(t.Deferred().resolve(m.getPageHeadings.input)),s.invalidatePage("Test"),a.stub(mw.util,"getUrl").returns("Test:History"),s.getPage("Test").then(function(t){e.propEqual(t,m.getPageHeadings.output,"return lead and sections test 1")})}),QUnit.test("#getPage",function(e){var i=a.stub(this.api,"get").returns(t.Deferred().resolve(m.getPage.input));return a.stub(mw.util,"getUrl").returns("Test:History"),s.invalidatePage("Test"),s.getPage("Test").then(function(t){return e.propEqual(t,m.getPage.output,"return lead and sections test 2"),s.getPage("Test")}).then(function(){e.strictEqual(i.callCount,1,"cache page")})}),QUnit.test("#getPageLanguages (response)",function(e){return a.stub(this.api,"get").returns(t.Deferred().resolve(m.getPageLanguagesResponse.input)),s.getPageLanguages("Test").then(function(t){e.propEqual(t.languages,m.getPageLanguagesResponse.output.languages,"return augmented language links"),e.propEqual(t.variants,m.getPageLanguagesResponse.output.variants,"return augmented language variant links")})}),QUnit.test("#getPageLanguages (call)",function(e){var i=a.stub(this.api,"get").returns(t.Deferred().reject());a.stub($,"ajax").returns(t.Deferred().resolve()),s.getPageLanguages("Title","fr"),e.ok(i.calledWith(m.getPageLanguagesCall.output))}),QUnit.test("#_getAPIResponseFromHTML",function(e){var i=s._getAPIResponseFromHTML(t.parseHTML(h));e.propEqual(m.getAPIResponseFromHTML.input,i)}),QUnit.test("#getSectionsFromHTML malformed (h2 before h1)",function(e){var i=s.getSectionsFromHTML(t.parseHTML(p));e.propEqual(i,[{line:"A1",level:"2",anchor:"1.0",text:'<h3 id="">A2.1</h3>\n\n',subsections:[{line:"A2.1",level:"3",anchor:"",text:"",subsections:[]}]},{line:"A2.2",level:"2",anchor:"",text:"",subsections:[]},{line:"A2",level:"1",anchor:"",text:'<h2 id="">A2.1</h2>\n\n',subsections:[{line:"A2.1",level:"2",anchor:"",text:"",subsections:[]}]}])}),QUnit.test("#getPage (forwards api errors)",function(e){return a.stub(this.api,"get").returns(t.Deferred().reject("missingtitle")),s.getPage("Err").catch(function(t){e.strictEqual(t,"missingtitle")})}),QUnit.test("#getPage (move protected page)",function(e){var i={edit:["*"],move:["sysop"]};return a.stub(this.api,"get").returns(t.Deferred().resolve({mobileview:{id:-1,displaytitle:"Test",revId:42,lastmodifiedby:{name:"bob",gender:"unknown"},protection:{move:["sysop"]},lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:""}]}})),s.invalidatePage("Test"),s.getPage("Test").then(function(t){e.propEqual(t.protection,i)})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Panel.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend Panel.js",{beforeEach:function(){n=s.sandbox.create(),a.setUp(n,e),o.setUp(n,e),l.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.startup/Panel.js")},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("show() when not visible",function(e){var i=e.async(),n=new t;n.on("show",function(){e.ok(n.$el.hasClass("visible"),"Visible class is set"),e.ok(n.$el.hasClass("animated"),"Animated class is set"),i()}),n.show()}),QUnit.test("hide() when visible",function(e){var i=e.async(),n=new t;n.on("hide",function(){e.notOk(n.$el.hasClass("visible","Visible class is removed")),i()}),n.show(),n.hide()}),QUnit.test("isVisible() when visible",function(e){var i=e.async(),n=new t;n.on("show",function(){e.ok(n.isVisible(),"Returns true when visible"),i()}),n.show()}),QUnit.test("isVisible() when not visible",function(e){var i=new t;e.notOk(i.isVisible(),"Returns false when not visible")}),QUnit.test("onCancel()",function(e){var i=e.async(),n=new t;n.on("hide",function(){e.notOk(n.$el.hasClass("visible"),"Removes visible class"),i()}),n.show(),n.onCancel({preventDefault:function(){}})}),QUnit.test("toggle()",function(e){var i=e.async(),n=new t;n.on("show",function(){e.ok(n.isVisible(),"Shows panel when not visible"),n.toggle()}),n.on("hide",function(){e.notOk(n.isVisible(),"Hides panel when visible"),i()}),n.toggle()})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/ScrollEndEventEmitter.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend ScrollEndEventEmitter.js",{beforeEach:function(){t=s.sandbox.create(),a.setUp(t,e),n=i("./src/mobile.startup/ScrollEndEventEmitter.js")},afterEach:function(){t.restore()}}),QUnit.test("initializes properly",function(e){var t={on:s.spy()},i=new n(t,500),a=new n(t);e.strictEqual(i.enabled,!0,"Emission is enabled by default"),e.strictEqual(i.threshold,500,"Threshold is saved"),e.strictEqual(a.threshold,100,"Without a threshold we get a default"),e.strictEqual(t.on.withArgs("scroll:throttled",i._scrollHandler).calledOnce,!0,"Scrolling handler is bound")}),QUnit.test("emits scroll end event",function(e){var i={on:function(e,t){this.handler=t},off:function(){}},s=new n(i);t.stub(s,"scrollNearEnd").returns(!0),s.setElement({}),s.on(n.EVENT_SCROLL_END,function(){e.ok(!0,"scroll end event emitted")}),i.handler()}),QUnit.test("doesn't emit when disabled",function(e){var i=t.spy(n.prototype,"emit"),s={on:function(e,t){this.handler=t},off:function(){}},a=new n(s);a.setElement({}),a.disable(),s.handler(),e.strictEqual(i.called,!1,"emit should not be called")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Section.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend Section.js",{beforeEach:function(){n=s.sandbox.create(),a.setUp(n,e),o.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.startup/Section.js")},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("initialize with options",function(e){var i=new t({level:"1",line:"Line",text:"Text",hasReferences:!0,id:"ID",anchor:"Anchor"});e.strictEqual(i.line,"Line","line is set"),e.strictEqual(i.text,"Text","text is set"),e.strictEqual(i.hasReferences,!0,"hasReferences is set"),e.strictEqual(i.id,"ID","id is set"),e.strictEqual(i.anchor,"Anchor","anchor is set"),e.strictEqual(i.subsections.length,0,"Subsections are empty")}),QUnit.test("initialize with subsections",function(e){var i=new t({subsections:[{level:"",line:"Line",text:"Text",hasReferences:!0,id:"ID",anchor:"Anchor"}]}),n=i.subsections[0];e.strictEqual(i.subsections.length,1,"Subsection is added to array"),e.ok(n instanceof t,"Subsections are instances of Section"),e.strictEqual(n.line,"Line","line is set"),e.strictEqual(n.text,"Text","text is set"),e.strictEqual(n.hasReferences,!0,"hasReferences is set"),e.strictEqual(n.id,"ID","id is set"),e.strictEqual(n.anchor,"Anchor","anchor is set"),e.strictEqual(n.subsections.length,0,"Subsection children are empty")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/Toggler.test.js":function(e,t,i){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,s,a,o=i("sinon"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./tests/node-qunit/utils/jQuery.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("./tests/node-qunit/utils/mw.js");QUnit.module("MobileFrontend Toggler.js",{beforeEach:function(){n=o.sandbox.create(),r.setUp(n,e),l.setUp(n,e),c.setUp(n,e),u.setUp(n,e),s=i("./src/mobile.startup/Browser.js").getSingleton(),a=i("./src/mobile.startup/Toggler.js"),n.stub(mw.config,"get").withArgs("wgMFCollapseSectionsByDefault").returns(!0),n.stub(s,"isWideScreen").returns(!1),this.page={title:"Toggle test"},this.$container=$("<div>").html('\n\t\t<h2>\n\t\t<span id="First_Section">First Section</span>\n\t\t</h2>\n\t\t<div>\n\t\t\t<p>Text</p>\n\t\t</div>\n\t\t<h2 id="section_1">\n\t\t\t<a href="#foo">Dummy Link</a>\n\t\t</h2>\n\t\t<div></div>\n\t\t<h2>References</h2>\n\t\t<div data-is-reference-section="1">\n\t\t\t<ol class="references">\n\t\t\t\t<li id="cite_note-1">\n\t\t\t\t\t<span class="mw-cite-backlink">\n\t\t\t\t\t\t<a href="#cite_ref-1"></a>\n\t\t\t\t\t</span> <span class="reference-text">hello</span>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</div>\n'),this.$section0=this.$container.find("h2").eq(0),this.title=this.page.title,this.headline=this.$section0.find("span").attr("id")},afterEach:function(){mw.storage.remove("expandSections"),mw.storage.remove("expandedSections"),l.tearDown(),n.restore()}}),QUnit.test("Mobile mode - Toggle section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),i=this.$section0,n=this.$container.find(".collapsible-block").eq(0);t.toggle(i),e.strictEqual(i.hasClass("open-block"),!0,"open-block class present"),t.toggle(i),e.strictEqual(n.hasClass("open-block"),!1,"check content gets closed on a toggle"),e.strictEqual(i.hasClass("open-block"),!1,"check section is closed"),t.toggle(i),e.strictEqual(n.hasClass("open-block"),!0,"check content reopened"),e.strictEqual(i.hasClass("open-block"),!0,"check section has reopened")}),QUnit.test("Mobile mode - Clicking a hash link to reveal an already open section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page});t.toggle(this.$section0),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open"),t.reveal("First_Section",this.$container),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is still open")}),QUnit.test("Mobile mode - Reveal element",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page});t.toggle(this.$section0),t.reveal("First_Section"),e.strictEqual(this.$container.find(".collapsible-block").eq(0).hasClass("open-block"),!0,"check content is visible"),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open")}),QUnit.test("Mobile mode - Clicking hash links",function(e){new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}).toggle(this.$section0),this.$container.find('[href="#First_Section"]').trigger("click"),e.strictEqual(this.$container.find(".collapsible-block").eq(0).hasClass("open-block"),!0,"check content is visible"),e.strictEqual(this.$section0.hasClass("open-block"),!0,"check section is open")}),QUnit.test("Mobile mode - Tap event toggles section",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),i=this.$container.find(".collapsible-block").eq(1);t.toggle(this.$section0),e.strictEqual(i.hasClass("open-block"),!1,"check content is hidden at start"),this.$container.find("#section_1").trigger("click"),e.strictEqual(i.hasClass("open-block"),!0,"check content is shown on a toggle")}),QUnit.test("Accessibility - Verify aria attributes",function(e){var t=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),i=this.$container.find("#section_1"),n=this.$container.find(".collapsible-block").eq(1);t.toggle(this.$section0),e.strictEqual(n.hasClass("open-block"),!1,"check content is hidden at start"),e.strictEqual(n.attr("aria-pressed"),"false","check aria-pressed is false at start"),e.strictEqual(n.attr("aria-expanded"),"false","check aria-expanded is false at start"),i.trigger("click"),e.strictEqual(n.hasClass("open-block"),!0,"check content is visible after toggling"),e.strictEqual(n.attr("aria-pressed"),"true","check aria-pressed is true after toggling"),e.strictEqual(n.attr("aria-expanded"),"true","check aria-expanded is true after toggling"),i.trigger("click"),e.strictEqual(n.hasClass("open-block"),!1,"check content is hidden after toggling"),e.strictEqual(n.attr("aria-pressed"),"false","check aria-pressed is false after toggling"),e.strictEqual(n.attr("aria-expanded"),"false","check aria-expanded is false after toggling")}),QUnit.test("Tablet mode - Open by default",function(e){s.isWideScreen.returns(!0),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(this.$container.find(".collapsible-block").eq(1).hasClass("open-block"),!0,"check section is visible at start"),e.strictEqual(this.$container.find(".collapsible-block").eq(2).hasClass("open-block"),!1,"check reference section is hidden at start")}),QUnit.test("Tablet mode - Open by default 2",function(e){mw.config.get.withArgs("wgMFCollapseSectionsByDefault").returns(!1),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(this.$container.find(".collapsible-block").eq(1).hasClass("open-block"),!0,"check section is visible at start")}),QUnit.test("Accessibility - Pressing space/ enter toggles a heading",function(e){var t,i=this.$container.find("#section_1"),n=$.Event("keypress");s.isWideScreen.returns(!1),mw.config.get.withArgs("wgMFCollapseSectionsByDefault").returns(!0),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),t=this.$container.find(".collapsible-block").eq(1),e.strictEqual(t.hasClass("open-block"),!1,"check content is hidden at start"),n.which=32,i.trigger(n),e.strictEqual(t.hasClass("open-block"),!0,"check content is shown after pressing space"),n.which=13,i.trigger(n),e.strictEqual(t.hasClass("open-block"),!1,"check content is hidden after pressing enter")}),QUnit.test("Clicking a link within a heading isn't triggering a toggle",function(e){var t=$("#section_1"),i=$(".collapsible-block").eq(1);new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),e.strictEqual(i.hasClass("open-block"),!1,"check content is hidden at start"),t.find("> a").eq(0).trigger("mouseup"),e.strictEqual(i.hasClass("open-block"),!1,"check content is still being hidden after clicking on the link")}),QUnit.test("Toggling a section stores its state.",function(e){var i,s,o=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),r=this.$container.find("h2"),l=a._getExpandedSections(this.page),c=n.spy(mw.storage,"set");e.strictEqual($.isEmptyObject(l[this.title]),!0,"no user setting about an expanded section exists already"),o.toggle(r),i=JSON.parse(c.getCall(0).args[1]),e.strictEqual(t(i[this.title][this.headline]),"number","the just toggled section state has been saved"),o.toggle(r),s=JSON.parse(c.getCall(1).args[1]),e.strictEqual(s[this.title][this.headline],void 0,"the just toggled section state has been removed")}),QUnit.test("Check for and remove obsolete stored sections.",function(e){var i,s,o,r;(o={})[this.title]={},o[this.title][this.headline]=new Date(1990,1,1).getTime(),n.stub(mw.storage,"get",function(){return JSON.stringify(o)}),i=a._getExpandedSections(this.page),e.strictEqual(t(i[this.title][this.headline]),"number","manually created section state has been saved correctly"),s=n.spy(mw.storage,"set"),a._cleanObsoleteStoredSections(this.page),r=JSON.stringify(["expandedSections",'{"Toggle test":{}}']),e.strictEqual(JSON.stringify(s.getCall(0).args),r,"section, whose store time is manually changed to an older date,has been removed from storage correctly")}),QUnit.test("Expanding already expanded section does not toggle it.",function(e){var i,s,o=new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),r=this.$container.find("h2"),l=a._getExpandedSections(this.page);e.strictEqual($.isEmptyObject(l[this.title]),!0,"no expanded sections are stored in localStorage yet"),e.strictEqual(r.hasClass("open-block"),!1,"section does not have open-block class"),i=n.spy(mw.storage,"set"),o.toggle(r),e.strictEqual(r.hasClass("open-block"),!0,"revealed section has open-block class"),l=a._getExpandedSections(this.page),s=JSON.parse(i.getCall(0).args[1]),e.strictEqual(t(s[this.title][this.headline]),"number","manually revealed section state has been correctly saved in localStorage"),a._expandStoredSections(o,this.$container,this.page),e.strictEqual(r.hasClass("open-block"),!0,"already revealed section still has open-block class after expanding sections")}),QUnit.test("MobileFrontend toggle.js - Expand stored sections.",function(e){var i,s=this.$container.find("h2").eq(0),o=a._getExpandedSections(this.page);this.$container.find("h2").addClass("section-heading"),e.strictEqual(s.hasClass("open-block"),!1,"Section is collapsed."),e.strictEqual($.isEmptyObject(o[this.title]),!0,"no user setting about an expanded section exists already"),o[this.title][this.headline]=(new Date).getTime(),n.stub(mw.storage,"get",function(){return JSON.stringify(o)}),i=a._getExpandedSections(this.page),e.strictEqual(t(i[this.title][this.headline]),"number","manually created section state has been saved correctly"),new a({eventBus:new OO.EventEmitter,$container:this.$container,prefix:"",page:this.page}),o=a._getExpandedSections(this.page),e.strictEqual(t(o[this.title][this.headline]),"number","manually created section state is still active after toggle.init()"),e.strictEqual(s.hasClass("open-block"),!0,"Saved section has been auto expanded.")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/View.test.js":function(e,t,i){(function(e){var t,n,s=i("./node_modules/hogan.js/lib/hogan.js"),a=i("./tests/node-qunit/utils/mw.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./src/mobile.startup/mfExtend.js"),c=i("./src/mobile.startup/util.js"),u=i("./tests/node-qunit/utils/oo.js"),d=i("sinon");QUnit.module("MobileFrontend mobile.startup/View",{beforeEach:function(){n=d.sandbox.create(),r.setUp(n,e),o.setUp(n,e),u.setUp(n,e),a.setUp(n,e),t=i("./src/mobile.startup/View.js")},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("View",function(e){var i=new t({el:"body"});e.ok(i.$el instanceof $,"assign jQuery object to $el"),e.strictEqual(i.$el[0].tagName.toUpperCase(),"BODY","assign proper jQuery object to $el")}),QUnit.test("View, jQuery proxy functions",function(e){var i=new t({el:"body"});["append","prepend","appendTo","prependTo","after","before","insertAfter","insertBefore","remove","detach"].forEach(function(t){var s=n.stub(i.$el,t);i[t]("test",1),e.ok(s.calledWith("test",1)),s.restore()})}),QUnit.test("View#preRender",function(e){var i;function n(){t.apply(this,arguments)}l(n,t,{template:s.compile("<p>{{text}}</p>"),preRender:function(){this.options.text="hello"}}),i=new n,e.strictEqual(i.$el.html(),"<p>hello</p>","manipulate template data")}),QUnit.test("View#postRender",function(e){var i=n.spy();function s(){t.apply(this,arguments)}l(s,t,{postRender:function(){i()}}),new s,e.strictEqual(i.callCount,1,"invoke postRender")}),QUnit.test("View#delegateEvents",function(e){var i;function n(i){t.call(this,c.extend({events:{"click p span":function(t){t.preventDefault(),e.ok(!0,"Span was clicked and handled")},"click p":"onParagraphClick",click:"onClick"}},i))}l(n,t,{template:s.compile("<p><span>test</span></p>"),onParagraphClick:function(t){t.preventDefault(),e.ok(!0,"Paragraph was clicked and handled")},onClick:function(t){t.preventDefault(),e.ok(!0,"View was clicked and handled")}}),(i=new n).appendTo("body"),i.$el.find("span").trigger("click"),i.$el.find("p").trigger("click"),i.$el.trigger("click"),i.undelegateEvents(),i.$el.find("span").trigger("click"),i.$el.find("p").trigger("click"),i.$el.trigger("click")}),QUnit.test("View#render (with isTemplateMode)",function(e){var i,n,a,o=$("<div>");function r(){t.apply(this,arguments)}function c(){t.call(this,{className:"bar"})}l(r,t,{template:s.compile('<p class="foo"><span>{{text}}</span></p>'),isTemplateMode:!0}),l(c,t,{template:s.compile('<p class="foo"><span>test</span></p>')}),a=(i=new r).$el.text(),n=new c,i.render(),n.render(),i.$el.appendTo(o),i.render({text:"hello"}),e.ok(i.$el.hasClass("foo")),e.ok(n.$el.hasClass("bar")),e.strictEqual(a,"","first run, no text defined"),e.strictEqual(i.$el.text(),"hello","second run, text has been defined"),e.strictEqual(i.$el.parent(o).length,1,"A re-rendered view thats attached to the DOM remains attached to the DOM")}),QUnit.test("View#render events (with isTemplateMode)",function(e){var i;function n(e){t.call(this,c.extend({events:{"click span":"onClick"}},e))}l(n,t,{onClick:function(){this.$el.empty().text("hello world")},template:s.compile('<p class="foo"><span>test</span></p>'),isTemplateMode:!0}),(i=new n).$el.find("span").trigger("click"),e.strictEqual(i.$el.text(),"hello world","event was called"),e.strictEqual(i.$el.find("span").length,0,"span disappeared"),(i=new n).render(),i.$el.find("span").trigger("click"),e.strictEqual(i.$el.text(),"hello world","event was called"),e.strictEqual(i.$el.find("span").length,0,"span disappeared")}),QUnit.test("View with className option",function(e){[[new t,"view-border-box","className not defined on a normal View without options and isBorderBox is default"],[new t({}),"view-border-box","className not defined on a normal View with empty options and isBorderBox is default"],[new t({className:"banana"}),"banana view-border-box","option is passed to View (along with default isBorderBox property)"],[new t({isBorderBox:!1}),void 0,"Passing isBorderBox option removes default view-border-box class"],[new t({isBorderBox:!0}),"view-border-box","Passing isBorderBox option as true retains default view-border-box class"]].forEach(function(t){e.strictEqual(t[0].$el.attr("class"),t[1],t[2])})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/cache.test.js":function(e,t,i){var n=new(0,i("./src/mobile.startup/cache.js").MemoryCache);QUnit.module("MobileFrontend cache.js"),QUnit.test("cache set() and get()",function(e){n.set("key","value"),e.strictEqual(n.get("key"),"value")})},"./tests/node-qunit/mobile.startup/context.test.js":function(e,t,i){(function(e){var t,n=i("sinon"),s=i("./tests/node-qunit/utils/mw.js"),a=i("./src/mobile.startup/context.js");QUnit.module("MobileFrontend context.js",{beforeEach:function(){t=n.sandbox.create(),s.setUp(t,e)},afterEach:function(){t.restore()}}),QUnit.test("getMode()",function(e){t.stub(mw.config,"get").withArgs("wgMFMode").returns("stable"),e.strictEqual(a.getMode(),"stable","Value comes straight from config")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/extendSearchParams.test.js":function(e,t,i){(function(e){var t,n,s=i("./tests/node-qunit/utils/jQuery.js"),a=i("./tests/node-qunit/utils/mw.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("sinon");QUnit.module("MobileFrontend extendSearchParams.js",{beforeEach:function(){t=r.sandbox.create(),a.setUp(t,e),o.setUp(t,e),s.setUp(t,e),t.stub(mw.config,"get").withArgs("wgMFSearchAPIParams").returns({foo:"bar"}).withArgs("wgMFDisplayWikibaseDescriptions").returns({search:!0,nearby:!1}).withArgs("wgMFQueryPropModules").returns(["baz"]),n=i("./src/mobile.startup/extendSearchParams.js")},afterEach:function(){s.tearDown(),t.restore()}}),QUnit.test("it throws if the feature is invalid",function(e){var t=new Error('"foo" isn\'t a feature that shows Wikibase descriptions.');e.throws(function(){n("foo",{})},t)}),QUnit.test("it extends the parameters",function(e){var t=n("search",{qux:"quux",prop:["corge"]});e.propEqual(t,{action:"query",formatversion:2,qux:"quux",foo:"bar",prop:["corge","baz","description"]})}),QUnit.test("it doesn't include Wikibase-specific parameters if the feature is disabled",function(e){var t=n("nearby",{qux:"quux"});e.strictEqual(t.prop.indexOf("description"),-1),e.strictEqual(t.wbptterms,void 0)}),QUnit.test("it adds the MobileFrontend configuration to given terms types",function(e){var t=n("search",{wbptterms:"grault"});e.strictEqual(t.wbptterms,"grault",'The given "wbptterms" is added to the default.')}),QUnit.test("it prioritizes MobileFrontend configuration",function(e){var t=n("search",{foo:"quux"});e.propEqual(t,{action:"query",formatversion:2,foo:"bar",prop:["baz","description"]},'The value of "foo" is overridden by the configuration.')}),QUnit.test("it is variadic",function(e){var t=n("search",{baz:"qux"},{quux:"corge"});e.propEqual(t,{action:"query",formatversion:2,foo:"bar",baz:"qux",quux:"corge",prop:["baz","description"]})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/icons.test.js":function(e,t,i){(function(e){var t,n,s,a=i("sinon"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/jQuery.js"),l=i("./tests/node-qunit/utils/mw.js"),c=i("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend icons.js",{beforeEach:function(){t=a.sandbox.create(),o.setUp(t,e),r.setUp(t,e),c.setUp(t,e),l.setUp(t,e),n=i("./src/mobile.startup/icons.js"),s=t.spy(n,"Icon")},afterEach:function(){t.restore(),r.tearDown()}}),QUnit.test("#cancel()",function(e){n.cancel(),e.propEqual(s.getCall(0).args[0],{tagName:"button",name:n.CANCEL_GLYPH,additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},"Options are passed down")}),QUnit.test("#cancel(variant)",function(e){n.cancel("gray"),e.propEqual(s.getCall(0).args[0],{tagName:"button",name:n.CANCEL_GLYPH+"-gray",additionalClassNames:"cancel",label:mw.msg("mobile-frontend-overlay-close")},"Options are passed down")}),QUnit.test("#spinner()",function(e){n.spinner({foo:"will be passed down",additionalClassNames:"will-be-ignored"}),e.propEqual(s.getCall(0).args[0],{foo:"will be passed down",additionalClassNames:"spinner loading",name:"spinner",label:mw.msg("mobile-frontend-loading-message")},"Options are passed down")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/lazyReferencesLoader.test.js":function(e,t,i){(function(e){var t,n,s,a=i("./tests/node-qunit/utils/PageInputs.html.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/dom.js"),l=i("./tests/node-qunit/utils/mw.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("sinon"),d=i("./src/mobile.startup/util.js");QUnit.module("MobileFrontend lazyReferencesLoader.js",{beforeEach:function(){n=u.sandbox.create(),r.setUp(n,e),o.setUp(n,e),c.setUp(n,e),l.setUp(n,e),s=i("./src/mobile.startup/Page.js"),t=i("./src/mobile.startup/lazyReferencesLoader.js")},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("#lazyReferencesLoader collapsed",function(e){var i=d.parseHTML("<div>").append(a.skinPage),o={getReferencesLists:function(){},getReferencesList:function(){}},r=new s({title:"Foo"});return n.stub(o,"getReferencesLists").returns(d.Deferred().resolve({})),n.stub(o,"getReferencesList").withArgs(r,"Notes_and_references").returns(d.Deferred().resolve(d.parseHTML("<p>").text("P"))).withArgs(r,"Notes").returns(d.Deferred().resolve(d.parseHTML("<p>").text("A"))).withArgs(r,"Refs").returns(d.Deferred().resolve(d.parseHTML("<p>").text("B"))).withArgs(r,"More_refs").returns(d.Deferred().resolve(d.parseHTML("<p>").html("<p>E</p><p>F</p>").children())),t.loadReferences({on:function(){},off:function(){},emit:function(){}},{expanded:!1,page:r,isReferenceSection:!0,$heading:i.find("#Notes_and_references").parent()},o,r).then(function(){e.strictEqual(i.find(".mf-section-2").text().replace(/[\t\n]/g,""),"TextPNotesARefsBno forgetMore refs1E2F3","Check all the references section is populated correctly.")})}),QUnit.test("#lazyReferencesLoader expanded",function(e){var i,n=d.parseHTML("<div>").append(a.skinPage),o=new s({title:"Foo"});i=t.loadReferences({on:function(){},off:function(){},emit:function(){}},{expanded:!0,page:o,isReferenceSection:!0,$heading:n.find("#Notes_and_references").parent()},{getReferencesLists:function(){},getReferencesList:function(){}},o),e.strictEqual(i,void 0)}),QUnit.test("#getSectionId",function(e){var i=d.parseHTML(["<div>",'<h2><span class="mw-headline" id="heading">H</span></h2>',"<div>",'<h3><span class="mw-headline" id="subheading">Subh</span></h3>','<a class="element"></a>',"</div>","</div>"].join("")),n=d.parseHTML(["<div>",'<h2><span class="mw-headline" id="Notes_and_references">Notes and references</span></h2>',"<div>",'<h3 class="in-block"><span class="mw-headline" id="Notes">Notes</span></h3>','<div class="reflist"><a class="element"></a></div>',"</div>","</div>"].join("")),s=d.parseHTML(['<div id="mw-content-text">','<h2><span class="mw-headline" id="heading">Heading</span></h2>','<div><a class="element"></a></div>',"</div>"].join("")),a=d.parseHTML(['<div id="mw-content-text">','<div><a class="element"></a></div>'].join("")),o=d.parseHTML(['<div id="mw-content-text">','<h2><span class="mw-headline" id="Foo">Foo</span></h2>',"<div>","<p>Foo content.</p>","</div>",'<h2><span class="mw-headline" id="Bar">Bar</span></h2>','<div class="reflist"><a class="element"></a></div>',"</div>","</div>"].join(""));e.strictEqual(t.test.getSectionId(i.find(".element")),"subheading"),e.strictEqual(t.test.getSectionId(n.find(".element")),"Notes","https://phabricator.wikimedia.org/T146394"),e.strictEqual(t.test.getSectionId(s.find(".element")),"heading"),e.strictEqual(t.test.getSectionId(a.find(".element")),null),e.strictEqual(t.test.getSectionId(o.find(".element")),"Bar")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/mfExtend.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/oo.js");QUnit.module("MobileFrontend mfExtend.test.js",{beforeEach:function(){n=s.sandbox.create(),a.setUp(n,e),t=i("./src/mobile.startup/mfExtend.js")},afterEach:function(){n.restore()}}),QUnit.test("mfExtend() - extending from constructor",function(e){function i(){}function n(){}t(i,n,{}),e.strictEqual(i.prototype instanceof n,!0)}),QUnit.test("mfExtend() - extending from object",function(e){var i,n=new function(){this.protoMethod=function(){return!0}};function s(){}t(s,n),i=new s,e.strictEqual(i.protoMethod(),!0)}),QUnit.test("mfExtend() - extending from constructor with overrides",function(e){var i;function n(){}t(n,function(){this.protoMethod=function(){return!0}},{protoMethod:function(){return!1}}),i=new n,e.strictEqual(i.protoMethod(),!1)})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/moduleLoader.test.js":function(e,t,i){(function(e){var t,n,s=i("./tests/node-qunit/utils/oo.js"),a=i("sinon");QUnit.module("MobileFrontend ModuleLoader",{beforeEach:function(){n=a.sandbox.create(),s.setUp(n,e),t=i("./src/mobile.startup/moduleLoader.js"),this.loader=new t},afterEach:function(){n.restore()}}),QUnit.test("#require",function(e){this.loader.define("foo",1),this.loader.define("bar",5),e.strictEqual(this.loader.require("foo"),1,"Returns appropriate module"),e.strictEqual(this.loader.require("bar"),5,"Returns appropriate module"),e.throws(function(){this.loader.require("undefinedmodule")},"Cannot require an undefined module."),e.throws(function(){this.loader.require("mobile.modules/Foo")},"Cannot require an undefined export on a known module.")}),QUnit.test("#define",function(e){var t=this.loader;t.define("foo",1),t.define("bar",5),e.throws(function(){t.define("bar",50)},"Cannot define two modules with the same name"),e.strictEqual(this.loader.require("bar"),5,"Returns first definition of module.")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/promisedView.test.js":function(e,t,i){(function(e){var t,n,s,a,o=i("./src/mobile.startup/util.js"),r=i("./tests/node-qunit/utils/jQuery.js"),l=i("./tests/node-qunit/utils/dom.js"),c=i("./tests/node-qunit/utils/oo.js"),u=i("./tests/node-qunit/utils/mw.js"),d=i("sinon");QUnit.module("MobileFrontend promisedView.js",{beforeEach:function(){s=d.sandbox.create(),l.setUp(s,e),r.setUp(s,e),c.setUp(s,e),u.setUp(s,e),n=i("./src/mobile.startup/View.js"),t=i("./src/mobile.startup/promisedView.js"),(a=new n({isBorderBox:!1,className:"test"})).append(""),s.stub(mw,"msg").withArgs("mobile-frontend-loading-message").returns("")},afterEach:function(){r.tearDown(),s.restore()}}),QUnit.test("#constructor",function(e){var i=o.Deferred(),n=t(i);return e.strictEqual(n.$el.text(),"","the view is waiting to resolve"),e.ok(n.$el.hasClass("promised-view"),"parent element has loading class when loading"),i.resolve(a),i.then(function(){e.strictEqual(n.$el.attr("class"),"test","fully replaces its parent element with happyView's parent element"),e.strictEqual(n.$el.text(),"","the view resolved correctly")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/rlModuleLoader.test.js":function(e,t,i){(function(e){var t,n,s=i("sinon"),a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./tests/node-qunit/utils/oo.js"),l=i("./tests/node-qunit/utils/mw.js"),c=i("./src/mobile.startup/util.js");function u(e,i,s,a){var o,r=this;return n.stub(t,"newLoadingOverlay").returns(this.stub),o=t.loadModule(i,s,a),e.strictEqual(this.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(this.stub.show.getCall(0).args.length,0,"LoadingOverlay show() called with no args"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide not called"),this.deferred.resolve(),o.then(function(t){e.strictEqual(t,r.stub,"Promise resolves to overlay instance"),e.strictEqual(r.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(r.stub.hide.callCount,1,"LoadingOverlay hide() called once"),e.strictEqual(r.stub.hide.getCall(0).args.length,0,"LoadingOverlay hide() called with no args")})}QUnit.module("MobileFrontend rlModuleLoader.js",{beforeEach:function(){n=s.sandbox.create(),a.setUp(n,e),o.setUp(n,e),r.setUp(n,e),l.setUp(n,e),t=i("./src/mobile.startup/rlModuleLoader.js"),n.stub(e.window,"scrollTo"),this.stub={appendTo:n.spy(),show:n.spy(),hide:n.spy()},this.deferred=c.Deferred(),n.stub(mw.loader,"using").withArgs("mobile.mediaViewer").returns(this.deferred)},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("#newLoadingOverlay does not blow up",function(e){e.expect(0),t.newLoadingOverlay()}),QUnit.test("#loadModule when instructed to show/hide overlay and successful",function(e){return u.apply(this,[e,"mobile.mediaViewer",!1,!0])}),QUnit.test("#loadModule when instructed to show/hide overlay (default args) and successful",function(e){return u.apply(this,[e,"mobile.mediaViewer",!1])}),QUnit.test("#loadModule when instructed to show/hide overlay and not successful",function(e){var i,s=this;return n.stub(t,"newLoadingOverlay").returns(this.stub),i=t.loadModule("mobile.mediaViewer",!1,!0),this.deferred.reject(),e.rejects(i,"returned promise rejects"),i.catch(function(){e.strictEqual(s.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(s.stub.appendTo.callCount,1,"LoadingOverlay appendTo() called once"),e.strictEqual(s.stub.hide.callCount,1,"LoadingOverlay hide() called once"),e.strictEqual(s.stub.hide.getCall(0).args.length,0,"LoadingOverlay hide() called with no args")})}),QUnit.test("#loadModule when instructed to show/not hide overlay and successful",function(e){var i,s=this;return n.stub(t,"newLoadingOverlay").returns(this.stub),i=t.loadModule("mobile.mediaViewer",!0,!0),e.strictEqual(this.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(this.stub.show.getCall(0).args.length,0,"LoadingOverlay show() called with no args"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide() not called"),this.deferred.resolve(),i.then(function(t){e.strictEqual(t,s.stub,"Promise resolves to overlay instance"),e.strictEqual(s.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to show/not hide overlay and not successful",function(e){var i,s=this;return n.stub(t,"newLoadingOverlay").returns(this.stub),i=t.loadModule("mobile.mediaViewer",!0,!0),this.deferred.reject(),e.rejects(i,"returned promise rejects"),i.catch(function(){e.strictEqual(s.stub.show.callCount,1,"LoadingOverlay show() called once"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to not show overlay and successful",function(e){var i,s=this;return n.stub(t,"newLoadingOverlay").returns(this.stub),i=t.loadModule("mobile.mediaViewer",!1,!1),e.strictEqual(this.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(this.stub.hide.callCount,0,"LoadingOverlay hide() not called"),this.deferred.resolve(),i.then(function(t){e.strictEqual(t,s.stub,"Promise resolves to overlay instance"),e.strictEqual(s.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})}),QUnit.test("#loadModule when instructed to not show overlay and not successful",function(e){var i,s=this;return n.stub(t,"newLoadingOverlay").returns(this.stub),i=t.loadModule("mobile.mediaViewer",!1,!1),this.deferred.reject(),e.rejects(i,"returned promise rejects"),i.catch(function(){e.strictEqual(s.stub.show.callCount,0,"LoadingOverlay show() not called"),e.strictEqual(s.stub.hide.callCount,0,"LoadingOverlay hide() not called")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.startup/time.test.js":function(e,t,i){var n=i("./src/mobile.startup/time.js");QUnit.module("MobileFrontend time.js"),QUnit.test("timeAgo()",function(e){e.propEqual(n.timeAgo(40),{value:40,unit:"seconds"}),e.propEqual(n.timeAgo(149),{value:2,unit:"minutes"}),e.propEqual(n.timeAgo(150),{value:3,unit:"minutes"}),e.propEqual(n.timeAgo(7500),{value:2,unit:"hours"}),e.propEqual(n.timeAgo(9e4),{value:1,unit:"days"}),e.propEqual(n.timeAgo(9e6),{value:3,unit:"months"}),e.propEqual(n.timeAgo(32e6),{value:1,unit:"years"}),e.propEqual(n.timeAgo(102e6),{value:3,unit:"years"})})},"./tests/node-qunit/mobile.startup/util.test.js":function(e,t,i){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,s,a=i("./tests/node-qunit/utils/dom.js"),o=i("./tests/node-qunit/utils/mw.js"),r=i("./tests/node-qunit/utils/jQuery.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend util.js",{beforeEach:function(){s=c.sandbox.create(),a.setUp(s,e),o.setUp(s,e),r.setUp(s,e),l.setUp(s,e),n=i("./src/mobile.startup/util.js")},afterEach:function(){r.tearDown(),s.restore()}}),QUnit.test("escapeSelector()",function(e){e.strictEqual(n.escapeSelector("#selector-starts-with-hash"),"\\#selector-starts-with-hash")}),QUnit.test("grep()",function(e){e.propEqual(n.grep([1,2],function(e){return e>1}),[2])}),QUnit.test("docReady()",function(e){var t=n.docReady();e.strictEqual(t instanceof $,!0)}),QUnit.test("when()",function(e){return n.when({resolved:!0}).then(function(t){e.strictEqual(t.resolved,!0)})}),QUnit.test("Deferred() - resolve",function(e){var t=new n.Deferred;return t.resolve("response"),t.then(function(t){e.strictEqual(t,"response")})}),QUnit.test("Deferred() - reject",function(e){var t=new n.Deferred;return t.reject("response"),t.catch(function(t){e.strictEqual(t,"response")})}),QUnit.test("getDocument()",function(e){e.strictEqual(n.getDocument().length,1)}),QUnit.test("getWindow()",function(e){e.strictEqual(n.getWindow().length,1)}),QUnit.test("parseHTML()",function(e){var i=n.parseHTML("<p>element content</p>",document);e.strictEqual("object"===t(i),!0),e.strictEqual(i[0].innerHTML,"element content")}),QUnit.test("isNumeric()",function(e){e.strictEqual(n.isNumeric(123),!0),e.strictEqual(n.isNumeric("123"),!0),e.strictEqual(n.isNumeric("The string 123 is true? I don't like it."),!1),e.strictEqual(n.isNumeric(NaN),!1)}),QUnit.test("extend()",function(e){var t={a:"apple"};n.extend(t,{b:"banana"}),e.strictEqual(JSON.stringify(t),'{"a":"apple","b":"banana"}')}),QUnit.test("escapeHash()",function(e){e.strictEqual(n.escapeHash("#escape:...hash"),"#escape\\:\\.\\.\\.hash")}),QUnit.test("isModifiedEvent() - true",function(e){var t=document.createElement("div");t.addEventListener("click",function(t){e.strictEqual(n.isModifiedEvent(t),!0)}),t.dispatchEvent(new window.MouseEvent("click",{ctrlKey:!0}))}),QUnit.test("isModifiedEvent() - false",function(e){var t=document.createElement("div");t.addEventListener("click",function(t){e.strictEqual(n.isModifiedEvent(t),!1)}),t.dispatchEvent(new window.MouseEvent("click"))}),QUnit.test("repeatEvent",function(e){var t=new OO.EventEmitter,i=new OO.EventEmitter;n.repeatEvent(i,t,"test"),t.on("test",function(t){e.strictEqual(t,"test data","proxy responds to source events correctly")}),i.emit("test","test data")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/TalkSectionAddOverlay.test.js":function(e,t,i){(function(e){var t,n,s=i("./src/mobile.startup/util.js"),a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend TalkSectionAddOverlay",{beforeEach:function(){n=c.sandbox.create(),o.setUp(n,e),a.setUp(n,e),l.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.talk.overlays/TalkSectionAddOverlay.js")},afterEach:function(){a.tearDown(),n.restore()}}),QUnit.test("save()",function(e){var i=new t({api:{postWithToken:n.stub().returns(s.Deferred().resolve())},title:"Talk:No exist"});return i.$el.find("input").val("Testtitle"),i.$el.find("textarea").val("Testcontent"),e.strictEqual(i.$el.find("input").val(),"Testtitle","Testtitle set"),e.strictEqual(i.$el.find("textarea").val(),"Testcontent","Testcontent set"),i.save().then(function(t){e.strictEqual(t,"ok","The new discussion was saved"),e.strictEqual(i._saveHit,!0,"The save was recognized")})})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/TalkSectionOverlay.test.js":function(e,t,i){(function(e){var t,n,s=i("./src/mobile.startup/util.js"),a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend TalkSectionOverlay.js - logged in",{beforeEach:function(){n=c.sandbox.create(),o.setUp(n,e),a.setUp(n,e),l.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.talk.overlays/TalkSectionOverlay.js"),this.toastStub=n.stub(mw,"notify"),n.stub(mw.user,"isAnon").returns(!1),this.renderFromApiSpy=n.stub(t.prototype,"renderFromApi")},afterEach:function(){a.tearDown(),n.restore()}}),QUnit.test("Load section from api only, if needed",function(e){new t({api:{},section:"Testtext"}),e.strictEqual(this.renderFromApiSpy.callCount,0,"Section requested from api, if no section given."),new t({api:{}}),e.strictEqual(this.renderFromApiSpy.callCount,1,"No Api request, if section given")}),QUnit.test("Check comment box for logged in users",function(e){var i=new t({api:{},section:"Test"});e.ok(i.$el.find(".comment").length>0,"There is a visible comment box")}),QUnit.test("Check error class on textarea",function(e){var i;(i=new t({api:{},section:"Test"})).onSaveClick(),e.ok(i.$textarea.hasClass("error"),"Error class added when try to submit empty comment box."),i.onFocusTextarea(),e.strictEqual(i.$textarea.hasClass("error"),!1,"Error class removed after comment box get focus.")}),QUnit.test("Check api request on save",function(e){var i=s.Deferred().resolve(),a=n.stub().returns(i),o=new t({api:{postWithToken:a},title:"Talk:Test",id:1,section:"Test"});return o.$textarea.val("Testcomment"),o.onSaveClick(),i.then(function(){e.ok(a.calledWith("csrf",{action:"edit",title:"Talk:Test",section:1,appendtext:"\n\nTestcomment ~~~~",redirect:!0}),"Save request passes!")})}),QUnit.module("MobileFrontend TalkSectionOverlay.js - anonymous (logged out)",{beforeEach:function(){n=c.sandbox.create(),o.setUp(n,e),a.setUp(n,e),l.setUp(n,e),r.setUp(n,e),t=i("./src/mobile.talk.overlays/TalkSectionOverlay.js"),n.stub(mw.user,"isAnon").returns(!1)},afterEach:function(){a.tearDown(),n.restore()}}),QUnit.test("Check comment box for logged out users",function(e){var i=new t({api:{},section:"Test"});e.ok(i.$el.find(".comment").length>0,"There is a visible comment box")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/autosign.test.js":function(e,t,i){var n=i("./src/mobile.talk.overlays/autosign.js");QUnit.module("MobileFrontend autosign.js"),QUnit.test("#autosign",function(e){[["foo","foo ~~~~"],["foo ~~~","foo ~~~"],["foo ~~~~~","foo ~~~~~"],["foo ~~~~","foo ~~~~"],["foo ~~~~ yolo","foo ~~~~ yolo"],["~~~~ yolo","~~~~ yolo"]].forEach(function(t){e.strictEqual(n(t[0]),t[1],"Autosigning works as expected")})})},"./tests/node-qunit/mobile.talk.overlays/talkBoard.test.js":function(e,t,i){(function(e){var t,n,s,a=i("./tests/node-qunit/utils/jQuery.js"),o=i("./tests/node-qunit/utils/dom.js"),r=i("./tests/node-qunit/utils/mw.js"),l=i("./tests/node-qunit/utils/oo.js"),c=i("sinon");QUnit.module("MobileFrontend mobile.talk.overlays/talkBoard",{beforeEach:function(){s=c.sandbox.create(),o.setUp(s,e),a.setUp(s,e),l.setUp(s,e),r.setUp(s,e),s.stub(mw,"msg").withArgs("mobile-frontend-talk-explained").returns("things").withArgs("mobile-frontend-talk-explained-empty").returns("empty"),t=i("./src/mobile.talk.overlays/talkBoard.js"),n=i("./src/mobile.startup/Section.js")},afterEach:function(){a.tearDown(),s.restore()}}),QUnit.test("no sections",function(e){var i=t([]);e.strictEqual(i.$el.find(".content-header").text().trim(),"empty"),e.strictEqual(i.$el.find("ul").children().length,0,"no topics")}),QUnit.test("sections",function(e){var i=t([new n({line:"1",id:"2"})]);e.strictEqual(i.$el.find(".content-header").text().trim(),"things"),e.strictEqual(i.$el.find("ul").children().length,1,"1 topic")})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/mobile.talk.overlays/talkOverlay.test.js":function(e,t,i){(function(e){var t,n,s,a,o=i("./tests/node-qunit/utils/jQuery.js"),r=i("./src/mobile.startup/util.js"),l=i("./tests/node-qunit/utils/dom.js"),c=i("./tests/node-qunit/utils/mw.js"),u=i("./tests/node-qunit/utils/oo.js"),d=i("sinon");QUnit.module("MobileFrontend mobile.talk.overlays/talkOverlay",{beforeEach:function(){n=d.sandbox.create(),l.setUp(n,e),o.setUp(n,e),u.setUp(n,e),c.setUp(n,e),n.stub(mw,"msg").returns("msg-key"),t=i("./src/mobile.talk.overlays/talkOverlay.js"),s=i("./src/mobile.startup/Overlay.js"),a=i("./src/mobile.startup/PageGateway.js")},afterEach:function(){o.tearDown(),n.restore()}}),QUnit.test("talkOverlay add discussion button",function(e){var i,o={},l=r.Deferred().resolve([]),c=n.stub(s,"make");return n.stub(a.prototype,"getSections").returns(l),i=n.stub(mw.user,"isAnon").returns(!0),t({title:"Foo",api:o}),i.restore(),n.stub(mw.user,"isAnon").returns(!1),t({title:"overlay logged in",user:{isAnon:function(){return!0}},api:o}),e.propEqual(c.args[1][0].headerButtons[0].href,"#/talk/new","logged in users have the add discussion button"),e.propEqual(c.args[0][0].headerButtons[0],{},"anons do not have the add discussion button"),l})}).call(this,i("./node_modules/webpack/buildin/global.js"))},"./tests/node-qunit/utils/PageGateway.responses.js":function(e,t){e.exports={getPageHeadings:{input:{mobileview:{id:-1,displaytitle:"Test",revId:42,lastmodifiedby:{name:"bob",gender:"unknown"},protection:[],lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:""},{level:"1",line:"1",anchor:"1",id:1,text:"<p>Text of 1\n</p>"},{level:"2",line:"<i>1.1</i>",anchor:"1.1",id:2,text:"<p>Text of 1.1\n</p>"},{level:"1",line:"2",anchor:"2",id:3,text:"<p>Text of 2\n</p>"},{level:"2",line:"2.1",anchor:"2.1",id:4,text:"<p>Text of 2.1\n</p>"}]}},output:{historyUrl:"Test:History",lastModifiedUserName:"bob",lastModifiedUserGender:"unknown",lastModifiedTimestamp:1382986196,title:"Test",revId:42,displayTitle:"Test",id:-1,protection:{edit:["*"]},isMainPage:!1,languageCount:10,hasVariants:!1,lead:"",sections:[{level:"1",line:"1",anchor:"1",id:1,text:'<p>Text of 1\n</p><h2 id="1.1"><i>1.1</i></h2>\n<p>Text of 1.1\n</p>\n',subsections:[{level:"2",line:"<i>1.1</i>",anchor:"1.1",id:2,text:"<p>Text of 1.1\n</p>",subsections:[]}]},{level:"1",line:"2",anchor:"2",id:3,text:'<p>Text of 2\n</p><h2 id="2.1">2.1</h2>\n<p>Text of 2.1\n</p>\n',subsections:[{level:"2",line:"2.1",anchor:"2.1",id:4,text:"<p>Text of 2.1\n</p>",subsections:[]}]}]}},getPage:{input:{mobileview:{id:-1,protection:{edit:["sysop"]},lastmodifiedby:{name:"Melissa",gender:"female"},revId:42,displaytitle:"Test",lastmodified:"2013-10-28T18:49:56Z",languagecount:10,sections:[{id:0,text:"lead content"},{level:"2",line:"Aaa section",anchor:"Aaa_section",id:1,text:"aaa content"},{level:"3",line:"Subaaa section",anchor:"Subaaa_section",id:2,text:"subaaa content"},{level:"2",line:"Bbb section",anchor:"Bbb_section",id:3,text:"bbb content"},{level:"2",line:"References",references:"",anchor:"References",id:4,text:"references"}]}},output:{historyUrl:"Test:History",lastModifiedUserName:"Melissa",lastModifiedUserGender:"female",lastModifiedTimestamp:1382986196,protection:{edit:["sysop"]},title:"Test",displayTitle:"Test",id:-1,isMainPage:!1,revId:42,languageCount:10,hasVariants:!1,lead:"lead content",sections:[{level:"2",line:"Aaa section",anchor:"Aaa_section",id:1,text:'aaa content<h3 id="Subaaa_section">Subaaa section</h3>\nsubaaa content\n',subsections:[{level:"3",line:"Subaaa section",anchor:"Subaaa_section",id:2,text:"subaaa content",subsections:[]}]},{level:"2",line:"Bbb section",anchor:"Bbb_section",id:3,text:"bbb content",subsections:[]},{level:"2",line:"References",references:"",anchor:"References",id:4,text:"references",subsections:[]}]}},getPageLanguagesResponse:{input:{query:{pages:[{pageid:94,ns:0,title:"San Francisco",langlinks:[{lang:"es",url:"http://es.wikipedia.org/wiki/San_Francisco_(California)",title:"San Francisco (California)",autonym:"espaol"},{lang:"pl",url:"http://pl.wikipedia.org/wiki/San_Francisco",title:"San Francisco",autonym:"polski"},{lang:"sr",url:"http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE",title:" ",autonym:" / srpski"}]}],general:{variants:[{code:"sr",name:"sr"},{code:"sr-ec",name:""},{code:"sr-el",name:"Latinica"}],variantarticlepath:"/$2/$1"},languages:[{code:"sr",name:" / srpski"},{code:"sr-ec",name:" ()"},{code:"sr-el",name:"srpski (latinica)"},{code:"es",name:"espaol"},{code:"pl",name:"polski"}]},limits:{langlinks:500}},output:{languages:[{lang:"es",url:"http://es.wikipedia.org/wiki/San_Francisco_(California)",title:"San Francisco (California)",autonym:"espaol"},{lang:"pl",url:"http://pl.wikipedia.org/wiki/San_Francisco",title:"San Francisco",autonym:"polski"},{lang:"sr",url:"http://sr.wikipedia.org/wiki/%D0%A1%D0%B0%D0%BD_%D0%A4%D1%80%D0%B0%D0%BD%D1%86%D0%B8%D1%81%D0%BA%D0%BE",title:" ",autonym:" / srpski"}],variants:[{lang:"sr",autonym:"sr",url:"/sr/Test"},{lang:"sr-ec",autonym:"",url:"/sr-ec/Test"},{lang:"sr-el",autonym:"Latinica",url:"/sr-el/Test"}]}},getPageLanguagesCall:{output:{action:"query",meta:"siteinfo",siprop:"general",prop:"langlinks",llprop:"url|autonym|langname",llinlanguagecode:"fr",lllimit:"max",titles:"Title",formatversion:2}},getAPIResponseFromHTML:{input:[{line:"A1",level:"1",anchor:"1.0",text:""},{line:"A2.1",level:"2",anchor:"",text:""},{line:"A2.2",level:"2",anchor:"",text:""},{line:"A2",level:"1",anchor:"",text:""},{line:"A2.1",level:"2",anchor:"",text:""}]}}},"./tests/node-qunit/utils/PageInputs.html.js":function(e,t){var i,n,s,a,o;i='<div>\n\t<h1><span class="mw-headline" id="1.0">A1</span></h1>\n\t<h2><span class="mw-headline">A2.1</span></h2>\n\t<h2><span class="mw-headline">A2.2</span></h2>\n\t<h1><span class="mw-headline">A2</span></h1>\n\t<h2><span class="mw-headline">A2.1</span><span>[<a href="#">edit</a>]</span></h2>\n\t<h1>Not to be shown in the TOC<span class="placeholder"></span></h1>\n</div>',n='<div>\n<h2><span class="mw-headline" id="1.0">A1</span></h2>\n<h3><span class="mw-headline">A2.1</span></h3>\n<h2><span class="mw-headline">A2.2</span></h2>\n<h1><span class="mw-headline">A2</span></h1>\n<h2><span class="mw-headline">A2.1</span></h2>\n</div>',s='<div id="mw-content-text">\n\t<h2 class="section-heading collapsible-heading open-block">\n\t\t<span class="mw-headline" id="Notes_and_references">Notes and references</span>\n\t</h2>\n\t<div class="mf-section-2 collapsible-block open-block" data-is-reference-section="1">\n\t\t<p>Text</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<h3><span class="mw-headline" id="Notes">Notes</span></h3>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<h4 class="in-block"><span class="mw-headline" id="Refs">Refs</span></h4>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>no forget</p>\n\t\t<h5 class="in-block"><span class="mw-headline" id="More_refs">More refs</span></h5>\n\t\t<p>1</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>2</p>\n\t\t<a class="mf-lazy-references-placeholder"></a>\n\t\t<p>3</p>\n\t</div>\n</div>',a='<div id="mfe-test-references">\n<sup id="cite_ref-1" class="reference">\n\t<a href="#cite_note-1">[1]</a>\n</sup>\n<p>\n\tsup with encoded href attribute\n\t<sup id="cite_ref-Obama_1995,_2004,_pp._910_11-0" class="reference">\n\t\t<a href="#cite_note-Obama_1995,_2004,_pp._9%E2%80%9310-11">[11]</a>\n\t</sup>\n</p>\n<ol class="references">\n\t<li id="cite_note-1">\n\t\t<span class="mw-cite-backlink">\n\t\t\t<a href="#cite_ref-1"></a>\n\t\t</span> <span class="reference-text">hello</span>\n\t</li>\n\t<li id="cite_note-Obama_1995,_2004,_pp._910-11">\n\t\t<span class="mw-cite-backlink">\n\t\t\t<a href="#cite_ref-1"></a>\n\t\t</span> <span class="reference-text">found</span>\n\t</li>\n</ol>\n</div>',o='<div>\n<h2><span class="mw-headline" id="1.0">A1</span></h1>\n<div>text</div>\n<h2>references</h2>\n<div>\n\t<a class="mf-lazy-references-placeholder">View citations</a>\n</div>\n</div>',e.exports={lazyLoadedReferencesPage:o,referencesPage:a,skinPage:s,page:i,page2:n}},"./tests/node-qunit/utils/blank.json":function(e){e.exports={}},"./tests/node-qunit/utils/dom.js":function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":n(window)),a=s&&i("jsdom");e.exports={setUp:function(e,t){s&&(t.window=t.window||void 0,t.document=t.document||void 0,e.stub(t,"window",(new a.JSDOM).window),e.stub(t,"document",window.document),t.Image=t.window.Image,t.Event=t.window.Event)}}},"./tests/node-qunit/utils/jQuery.js":function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":n(window));e.exports={setUp:function(e,t){s&&(t.$=t.$||void 0,e.stub(t,"$",i("jquery")))},tearDown:function(){s&&delete i.c.jquery}}},"./tests/node-qunit/utils/mw.js":function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":n(window)),a=i("./tests/node-qunit/utils/blank.json");e.exports={setUp:function(e,t){s&&(t.mw=t.mw||void 0,e.stub(t,"mw",a()))}}},"./tests/node-qunit/utils/oo.js":function(e,t,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var s="object"!==("undefined"==typeof window?"undefined":n(window));e.exports={setUp:function(e,t){var n;s&&((n=i("oojs")).ui={Element:{static:{getClosestScrollableContainer:function(){}}},Tool:function(){}},t.OO=t.OO||void 0,e.stub(t,"OO",n))}}},0:function(e,t,i){i("./tests/node-qunit/mobile.categories.overlays/CategoryGateway.test.js"),i("./tests/node-qunit/mobile.editor.overlay/EditorGateway.test.js"),i("./tests/node-qunit/mobile.editor.overlay/EditorOverlay.test.js"),i("./tests/node-qunit/mobile.languages.structured/LanguageSearcher.test.js"),i("./tests/node-qunit/mobile.languages.structured/util.test.js"),i("./tests/node-qunit/mobile.mediaViewer/ImageGateway.test.js"),i("./tests/node-qunit/mobile.mediaViewer/ImageOverlay.test.js"),i("./tests/node-qunit/mobile.special.nearby.scripts/Nearby.test.js"),i("./tests/node-qunit/mobile.special.nearby.scripts/NearbyGateway.test.js"),i("./tests/node-qunit/mobile.special.uploads.scripts/PhotoListGateway.test.js"),i("./tests/node-qunit/mobile.special.watchlist.scripts/WatchList.test.js"),i("./tests/node-qunit/mobile.special.watchlist.scripts/WatchListGateway.test.js"),i("./tests/node-qunit/mobile.startup/Browser.test.js"),i("./tests/node-qunit/mobile.startup/Button.test.js"),i("./tests/node-qunit/mobile.startup/cache.test.js"),i("./tests/node-qunit/mobile.startup/context.test.js"),i("./tests/node-qunit/mobile.startup/CtaDrawer.test.js"),i("./tests/node-qunit/mobile.startup/Drawer.test.js"),i("./tests/node-qunit/mobile.startup/extendSearchParams.test.js"),i("./tests/node-qunit/mobile.startup/icons.test.js"),i("./tests/node-qunit/mobile.startup/lazyReferencesLoader.test.js"),i("./tests/node-qunit/mobile.startup/mfExtend.test.js"),i("./tests/node-qunit/mobile.startup/moduleLoader.test.js"),i("./tests/node-qunit/mobile.startup/Overlay.test.js"),i("./tests/node-qunit/mobile.startup/OverlayManager.test.js"),i("./tests/node-qunit/mobile.startup/Page.test.js"),i("./tests/node-qunit/mobile.startup/PageGateway.test.js"),i("./tests/node-qunit/mobile.startup/Panel.test.js"),i("./tests/node-qunit/mobile.startup/promisedView.test.js"),i("./tests/node-qunit/mobile.startup/rlModuleLoader.test.js"),i("./tests/node-qunit/mobile.startup/ScrollEndEventEmitter.test.js"),i("./tests/node-qunit/mobile.startup/Section.test.js"),i("./tests/node-qunit/mobile.startup/time.test.js"),i("./tests/node-qunit/mobile.startup/Toggler.test.js"),i("./tests/node-qunit/mobile.startup/util.test.js"),i("./tests/node-qunit/mobile.startup/View.test.js"),i("./tests/node-qunit/mobile.talk.overlays/autosign.test.js"),i("./tests/node-qunit/mobile.talk.overlays/talkBoard.test.js"),i("./tests/node-qunit/mobile.talk.overlays/talkOverlay.test.js"),i("./tests/node-qunit/mobile.talk.overlays/TalkSectionAddOverlay.test.js"),e.exports=i("./tests/node-qunit/mobile.talk.overlays/TalkSectionOverlay.test.js")},jquery:function(e,t){!function(){e.exports=this.jquery}()},jsdom:function(e,t){!function(){e.exports=this.jsdom}()},oojs:function(e,t){!function(){e.exports=this.oojs}()},sinon:function(e,t){!function(){e.exports=this.sinon}()}},[[0,0]]]);
//# sourceMappingURL=tests.mobilefrontend.js.map.json