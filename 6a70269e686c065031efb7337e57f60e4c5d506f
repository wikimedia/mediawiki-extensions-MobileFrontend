{
  "comments": [
    {
      "key": {
        "uuid": "4e506ba4_cde4e4a5",
        "filename": "resources/mobile.startup/Skin.js",
        "patchSetId": 5
      },
      "lineNbr": 239,
      "author": {
        "id": 34
      },
      "writtenOn": "2017-04-20T01:01:17Z",
      "side": 1,
      "message": "attr(\u0027style\u0027, \u0027\u0027) or removeAttr(\u0027style\u0027) might be cleaner and performs better.\n\nAlternatively, we should consider simply doing $placeholder.replaceWith($downloadingImage) so that the DOM matches the non-lazyload use case exactly. However for that to work, transitions need to be converted to use animations and need to be changed to start immediately racing with load instead of merely starting after the load - this would imho improve perceptual performance overall. E.g. fade of 200ms is fine if it loaded pretty quickly, but if it takes 3 seconds to load, having the browser render that progressively in the open is probably better to showing a blank canvas for three seconds and then fading in.\n\nTriggering the transition directly or using an animation achieves that, e.g. duration 200ms + delay of X starting immediately at load start.",
      "range": {
        "startLine": 239,
        "startChar": 6,
        "endLine": 239,
        "endChar": 9
      },
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e506ba4_4df9b449",
        "filename": "resources/mobile.startup/Skin.js",
        "patchSetId": 5
      },
      "lineNbr": 239,
      "author": {
        "id": 34
      },
      "writtenOn": "2017-04-20T01:02:15Z",
      "side": 1,
      "message": "Looking at open tasks about lazy loading, replaceWith() would likely solve 5 of 6.",
      "parentUuid": "4e506ba4_cde4e4a5",
      "range": {
        "startLine": 239,
        "startChar": 6,
        "endLine": 239,
        "endChar": 9
      },
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e506ba4_d7830956",
        "filename": "resources/mobile.startup/Skin.js",
        "patchSetId": 5
      },
      "lineNbr": 239,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-04-20T18:16:37Z",
      "side": 1,
      "message": "I avoiding using attr(\u0027style\u0027) as we currently don\u0027t copy the style attribute to the downloaded image. We only copy width/height so I was a little hesitant.\n\nBy animate do you mean jQuery\u0027s animate method?",
      "parentUuid": "4e506ba4_4df9b449",
      "range": {
        "startLine": 239,
        "startChar": 6,
        "endLine": 239,
        "endChar": 9
      },
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e506ba4_b21c4b6b",
        "filename": "resources/mobile.startup/Skin.js",
        "patchSetId": 5
      },
      "lineNbr": 239,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-04-20T19:51:24Z",
      "side": 1,
      "message": "How about rather than outputting \u0027width\u0027 and \u0027height\u0027 for the placeholder, we output a style that looks like this: { width: Xpx; height: auto; max-width: 100%;}? That way there won\u0027t be need for this kind of code.",
      "parentUuid": "4e506ba4_d7830956",
      "range": {
        "startLine": 239,
        "startChar": 6,
        "endLine": 239,
        "endChar": 9
      },
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e506ba4_325fdb14",
        "filename": "resources/mobile.startup/Skin.js",
        "patchSetId": 5
      },
      "lineNbr": 239,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-04-20T20:32:01Z",
      "side": 1,
      "message": "@krinkle I tried the replaceWith solution here: https://gerrit.wikimedia.org/r/#/c/349131/1\n\nI ran the animation by Nirzar. He says the animation is slightly different but it\u0027s acceptable so it\u0027s definitely something we can consider.\n\n@bmansurov I\u0027d rather not add css in JavaScript or interfere with the existing inline styles of the placeholder (which were originally on the image). I only wipe out width and height as I am knowingly copying them across to the image.\n\nI\u0027d rather not do this at all tbh.",
      "parentUuid": "4e506ba4_b21c4b6b",
      "range": {
        "startLine": 239,
        "startChar": 6,
        "endLine": 239,
        "endChar": 9
      },
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e506ba4_7711d55e",
        "filename": "resources/skins.minerva.content.styles/images.less",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-04-20T19:51:24Z",
      "side": 1,
      "message": "Why is this rule needed when the image can be only stretched to the width of the placeholder, which can only stretch as far as it\u0027s container\u0027s width since you\u0027re removing the placeholder width and height in https://gerrit.wikimedia.org/r/#/c/349107/5/resources/mobile.startup/Skin.js\n\nI can see the problem doesn\u0027t happen without this rule too.",
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e506ba4_5212a702",
        "filename": "resources/skins.minerva.content.styles/images.less",
        "patchSetId": 5
      },
      "lineNbr": 63,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-04-20T20:32:01Z",
      "side": 1,
      "message": "The width and height only get removed when the image is loaded.\nThis is for images that have not been loaded.",
      "parentUuid": "4e506ba4_7711d55e",
      "revId": "6a70269e686c065031efb7337e57f60e4c5d506f",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}