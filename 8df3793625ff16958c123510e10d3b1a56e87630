{
  "comments": [
    {
      "key": {
        "uuid": "2ef897d1_e5c9df7c",
        "filename": "includes/skins/MinervaTemplate.php",
        "patchSetId": 2
      },
      "lineNbr": 74,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-02-02T22:55:30Z",
      "side": 1,
      "message": "The function is already doing too many things. I suggest we create two helper functions that return data based on the mobile mode. Those functions may delegate to other helper functions, ideally.",
      "revId": "8df3793625ff16958c123510e10d3b1a56e87630",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2ef897d1_a5de4712",
        "filename": "includes/skins/MinervaTemplate.php",
        "patchSetId": 2
      },
      "lineNbr": 74,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-02-02T23:04:36Z",
      "side": 1,
      "message": "Please could you define \"too many things\" for me?  I\u0027m not sure how I could simplify this method as I only see it doing 2 things (but maybe you can break it down more?)\n\nFrom what I understand it does the following\n1) Contains logic for creating template data for new and old footer\n2) Loops through data[\u0027footerlinks\u0027] which is created by core to construct some template data that we can actually use for our footer.\nThis involves plucking out the license and converting the rest of the links into Mustache friendly variables. How would I do this if not at the same time and avoid iterating through it twice?\n\n#1 is removed in the follow up where we only need to support one footer.",
      "parentUuid": "2ef897d1_e5c9df7c",
      "revId": "8df3793625ff16958c123510e10d3b1a56e87630",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2ef897d1_a5340747",
        "filename": "includes/skins/MinervaTemplate.php",
        "patchSetId": 2
      },
      "lineNbr": 74,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-02-02T23:18:23Z",
      "side": 1,
      "message": "Sorry, I should have been clearer. Broadly speaking the function is doing two things: getting data for mobile mode and non-mobile mode. Well constructed functions should only do one thing. As you say it\u0027s also rendering two different versions of the footer, which will be removed in a follow up patch, so that\u0027s not my concern here.",
      "parentUuid": "2ef897d1_a5de4712",
      "revId": "8df3793625ff16958c123510e10d3b1a56e87630",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2ef897d1_454433bd",
        "filename": "includes/skins/MinervaTemplate.php",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-02-02T23:18:23Z",
      "side": 1,
      "message": "By looking at this line my immediate thought is \"Why `mobile-license` may not be defined?\".\n\nIf we had two functions for getting the footer template data depending on the mobile mode, it would have been much clearer, because when I\u0027m looking at the function that gets the data for non-mobile site, then it\u0027s immediately clear that `mobile-license` is not defined here.",
      "revId": "8df3793625ff16958c123510e10d3b1a56e87630",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2ef897d1_65e96f7b",
        "filename": "includes/skins/MinervaTemplate.php",
        "patchSetId": 2
      },
      "lineNbr": 76,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-02-02T23:27:19Z",
      "side": 1,
      "message": "The code\u0027s hacky.\n\nI agree it\u0027s a pain but that\u0027s how things work right now and how we\u0027ve architected the skin word.\n\nmobileFooter inside MobileFrontend.skin.hooks.php only runs on the mobile site. This is what sets mobile-license and footer-site-heading-html. We can of course make sure those always get set, but MobileFrontend\u0027s hooks are not invoked in desktop so then we\u0027re back to square one...\n\nA second approach would then be to do some \"am i the mobile site?\" checks inside this code. However, remember the long term plan is for Minerva to be in its own repo and not depend on MobileFrontend.\n\nFor this reason MinervaTemplate is supposed to be agnostic about whether it is running in desktop or mobile mode and should not be querying MobileContext to see where it\u0027s running.\n\nSo this seemed like the less evil way of doing this.\n\nA better approach would be for core to set the license field outside an array e.g. \u0027license\u0027 - we could then override it in MobileFrontend\u0027s skin hook and it would always be set.\n\nI guess similar footer-site-heading-html could be consolidated so that it shares code with the code that powers the image in the top left corner of Vector.\n\nThat\u0027s how I\u0027d do it in anyway.. but that\u0027s quite a big chunk of work for a patch to remove some php warnings.",
      "parentUuid": "2ef897d1_454433bd",
      "revId": "8df3793625ff16958c123510e10d3b1a56e87630",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2ef897d1_6515ef9b",
        "filename": "includes/skins/MinervaTemplate.php",
        "patchSetId": 2
      },
      "lineNbr": 112,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-02-02T23:18:23Z",
      "side": 1,
      "message": "Here also, separation would make it easy to understand what\u0027s going on. Once I\u0027m reading a function, I should mentally be thinking about mobile only, or desktop only. This kind of `if` checks divert my attention and make it hard for me to keep track of multiple possibilities.\n\nAnd lastly, testing this function will be hard. Had the function not have so many code paths, it would be easy to test.",
      "revId": "8df3793625ff16958c123510e10d3b1a56e87630",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}