{
  "comments": [
    {
      "key": {
        "uuid": "ce8c5bf9_82eba808",
        "filename": "includes/specials/SpecialUploads.php",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 890
      },
      "writtenOn": "2014-10-05T13:48:55Z",
      "side": 1,
      "message": "This would result into the following message:\nA $1 is required to view the uploads page.\n\n(This message key expect a parameter $1, containing a link to the user login page and the value of user-account message key, which you can\u0027t give here, so it will just return the plain parameter name ($1)) :)\n\nThe next point is, that mobile-frontend-donate-image-anon isn\u0027t a valid message for login page redirection. Background: SpecialPage::requireLogin() will result into a new UserNotLoggedIn exception. UserNotLoggedIn::report() will check, if the provided message key (-donate-image-anon) is in the list of valid messages of LoginForm (LoginForm::$validErrorMessages) [1][2]. Our message isn\u0027t in the list, so there will be no redirect and \"only\" an error page :)\n\nBecause there is no easy way to add a message key out of an extension, i suggest to just use the generic message key (exception-nologin-text) with a @todo to revisit later, when (maybe) a way was implemented.\n\n[1] https://github.com/wikimedia/mediawiki-core/blob/87b169260c66921d5c5652a4c5c1228f1bcb50ea/includes/exception/UserNotLoggedIn.php#L80\n[2] https://github.com/wikimedia/mediawiki-core/blob/master/includes/specials/SpecialUserlogin.php#L59",
      "revId": "8e22c968a8d3a363a7aebb669ec531ee2e54e7b2",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce8c5bf9_a82d6d8d",
        "filename": "includes/specials/SpecialUploads.php",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 890
      },
      "writtenOn": "2014-10-05T22:07:01Z",
      "side": 1,
      "message": "Sorry, i forgot, that LoginForm::$validErrorMessages is public, so you can simply add our error message, e.g.:\narray_push(\nLoginForm::$validErrorMessages,                                              \u0027mobile-frontend-donate-image-anon\u0027                                  );\n\nBut i haven\u0027t tested it atm :)",
      "parentUuid": "ce8c5bf9_82eba808",
      "revId": "8e22c968a8d3a363a7aebb669ec531ee2e54e7b2",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce8c5bf9_88d749f2",
        "filename": "includes/specials/SpecialUploads.php",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 890
      },
      "writtenOn": "2014-10-06T07:21:10Z",
      "side": 1,
      "message": "Forget it, the message is checked in UserNotLoggedIn and in LoginForm, so my first sentence seems to be right: \"there is no easy way to add a message key\"",
      "parentUuid": "ce8c5bf9_a82d6d8d",
      "revId": "8e22c968a8d3a363a7aebb669ec531ee2e54e7b2",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce8c5bf9_a821edf7",
        "filename": "includes/specials/SpecialUploads.php",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 890
      },
      "writtenOn": "2014-10-06T07:47:56Z",
      "side": 1,
      "message": "Sorry for the spam :(\n\nAlso, you can use the \"solution\" in my second command, if you set it into the Setup-function of MobileFrontend :)",
      "parentUuid": "ce8c5bf9_88d749f2",
      "revId": "8e22c968a8d3a363a7aebb669ec531ee2e54e7b2",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce8c5bf9_9ff45685",
        "filename": "includes/specials/SpecialUploads.php",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 1963
      },
      "writtenOn": "2014-10-06T22:44:21Z",
      "side": 1,
      "message": "Can you explain your last point? I\u0027m using \u0027exception-nologin-text\u0027 for now.",
      "parentUuid": "ce8c5bf9_a821edf7",
      "revId": "8e22c968a8d3a363a7aebb669ec531ee2e54e7b2",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ce8c5bf9_f89ed965",
        "filename": "includes/specials/SpecialUploads.php",
        "patchSetId": 2
      },
      "lineNbr": 23,
      "author": {
        "id": 890
      },
      "writtenOn": "2014-10-07T05:42:24Z",
      "side": 1,
      "message": "Sorry for the confusion :)\n\nSo, our goal is, to pomote our error message to be valid for Login redirection. For this we need to push the message key into LoginForm::$validErrorMessages in an early setup process of MediaWiki. For this we can/should use the setup function in MobileFrontend.php (efMobileFrontend_Setup()). Just add\n\narray_push(\n   LoginForm::$validErrorMessages,\n   \u0027mobile-frontend-donate-image-anon\u0027\n);\n\ninto it. After this, you should be able to use it here.",
      "parentUuid": "ce8c5bf9_9ff45685",
      "revId": "8e22c968a8d3a363a7aebb669ec531ee2e54e7b2",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}