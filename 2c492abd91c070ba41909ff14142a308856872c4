{
  "comments": [
    {
      "key": {
        "uuid": "0e1cb3f9_2766f6b7",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 82,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-10T23:59:21Z",
      "side": 1,
      "message": "Looks like you\u0027ve introduced this for writing tests? It seemed tests could be written without this change too.",
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_8a3d898c",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 82,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-05-11T07:22:13Z",
      "side": 1,
      "message": "showReference is asynchronous.\nTest assertions need to be run after showReference has been called.\nI\u0027m testing this method not a stub of this method.\nI\u0027m not sure how tests can be written without this change.\n\nWhy is this a problem?",
      "parentUuid": "0e1cb3f9_2766f6b7",
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_f5789def",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 82,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-12T17:55:21Z",
      "side": 1,
      "message": "I\u0027ve added a comment about how we can test in the test file at https://gerrit.wikimedia.org/r/#/c/352614/3/tests/qunit/mobile.references/test_ReferencesDrawer.js\n\nThis is a problem because we can test the function without changing the function signature and without making the function more complicated.",
      "parentUuid": "0e1cb3f9_8a3d898c",
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_2714b6eb",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 96,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-10T23:59:21Z",
      "side": 1,
      "message": "If a reference is already visible, you\u0027d be calling this again. We should only run this if the drawer is not already visible.",
      "range": {
        "startLine": 95,
        "startChar": 5,
        "endLine": 96,
        "endChar": 48
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_6a459517",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 96,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-05-11T07:22:13Z",
      "side": 1,
      "message": "That was also the case in resources/skins.minerva.scripts/references.js\nand it seems to be intentional\n\nI don\u0027t completely understand the reasoning behind calling this in a timeout but I\u0027m sure there was a good reason and I do not feel comfortable changing that!",
      "parentUuid": "0e1cb3f9_2714b6eb",
      "range": {
        "startLine": 95,
        "startChar": 5,
        "endLine": 96,
        "endChar": 48
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_753ecd27",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 96,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-12T17:55:21Z",
      "side": 1,
      "message": "In https://phabricator.wikimedia.org/diffusion/EMFR/browse/master/resources/skins.minerva.scripts/references.js;cc7beb67f14f85cf7e91d3461723633df39a4643$67\nthe function is run only if the drawer is invisible, unlike in here.",
      "parentUuid": "0e1cb3f9_6a459517",
      "range": {
        "startLine": 95,
        "startChar": 5,
        "endLine": 96,
        "endChar": 48
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_67f38ee4",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 100,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-10T23:59:21Z",
      "side": 1,
      "message": "Since the function is now responsible for hiding the drawer too, I suggest we rename the function to something that captures this change.",
      "range": {
        "startLine": 97,
        "startChar": 6,
        "endLine": 100,
        "endChar": 5
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_4a48d132",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 100,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-05-11T07:22:13Z",
      "side": 1,
      "message": "The function is still showing a reference, it\u0027s just doing it via a different mechanism to the reference drawer - it\u0027s showing the reference in the actual page. The method is showReference not showReferenceDrawer.\n\nThis name fits for me, what would you suggest it be renamed to?\n\nAn alternative way to do this would be to show an error here and let the caller do the handling.\n\n```\ndrawer.showReference( href, page, $dest.text() ).then( function ( ref ) {\n  if ( !ref) {\n     window.location.hash \u003d id;\n     drawer.hide();\n  }\n} );\n```\n\nWould that be better in your opinion?\n(I should note that I can\u0027t test it this way which is why I did it like this)",
      "parentUuid": "0e1cb3f9_67f38ee4",
      "range": {
        "startLine": 97,
        "startChar": 6,
        "endLine": 100,
        "endChar": 5
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_154431bc",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 100,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-12T17:55:21Z",
      "side": 1,
      "message": "That makes sense. We may want to update the description of the function to include the extra work the new function is doing then.",
      "parentUuid": "0e1cb3f9_4a48d132",
      "range": {
        "startLine": 97,
        "startChar": 6,
        "endLine": 100,
        "endChar": 5
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_07f652c2",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 106,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-10T23:59:21Z",
      "side": 1,
      "message": "Since you\u0027ve moved the code that\u0027s responsible to showing the drawer from references.js to line 96 of this file, this drawer won\u0027t be shown if it\u0027s not already visible.",
      "range": {
        "startLine": 102,
        "startChar": 4,
        "endLine": 106,
        "endChar": 8
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_ca5aa1f9",
        "filename": "resources/mobile.references/ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 106,
      "author": {
        "id": 94
      },
      "writtenOn": "2017-05-11T07:22:13Z",
      "side": 1,
      "message": "Done.",
      "parentUuid": "0e1cb3f9_07f652c2",
      "range": {
        "startLine": 102,
        "startChar": 4,
        "endLine": 106,
        "endChar": 8
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e1cb3f9_d57b19ea",
        "filename": "tests/qunit/mobile.references/test_ReferencesDrawer.js",
        "patchSetId": 3
      },
      "lineNbr": 29,
      "author": {
        "id": 1963
      },
      "writtenOn": "2017-05-12T17:55:21Z",
      "side": 1,
      "message": "This can be modified as seen below code without changing the showReference() function signature:\n\n\t\tthis.drawer.showReference( \u0027#cite_note-bad\u0027, this.page, \u00271\u0027 );\n\t\tsetTimeout( function () {\n\t\t\tassert.ok( hideSpy.calledOnce, \u0027Hide is called.\u0027 );\n\t\t\tdone();\n\t\t}, 0 );",
      "range": {
        "startLine": 26,
        "startChar": 0,
        "endLine": 29,
        "endChar": 6
      },
      "revId": "2c492abd91c070ba41909ff14142a308856872c4",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}